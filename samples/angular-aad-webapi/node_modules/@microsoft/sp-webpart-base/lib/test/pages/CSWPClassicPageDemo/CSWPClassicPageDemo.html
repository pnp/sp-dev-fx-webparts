<!-- Test page to mimic webpart loading for Classic pages. There are very specific reasons why code in this page looks a certain way.
     !!! WARNING !!! Please discuss with the webpart feature crew before you make any changes to this page -->
<!DOCTYPE html>
<html dir="ltr">

<head>
  <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />

  <title>SharePoint classic page demo</title>

  <link rel="stylesheet" href="https://appsforoffice.microsoft.com/fabric/2.0.1/fabric.min.css">
  <link rel="stylesheet" href="https://appsforoffice.microsoft.com/fabric/2.0.1/fabric.components.min.css">
  <script type="text/javascript" src="http://localhost:4321/temp/manifests.js"></script>
  <script type="text/javascript" src="http://localhost:4321/node_modules/@microsoft/sp-webpart-workbench/node_modules/@microsoft/sp-module-loader/dist/sp-module-loader.js"></script>

  <script type="text/javascript">
    window.DEBUG = true;
    window.ENVIRONMENTTYPE = 'Local';
    window.SP = {};
    window._spClientRenderedPageContext = {
      appId: "",
      contextWebInfo: {},
      item: {},
      list: {},
      user: {},
      web: {
        ServerRelativeUrl: "",
        Url: ""
      }
    };
  </script>
</head>
<body>

  <div class="suite-nav">
    <div class="topnav-left"></div>
    <div class="topnav-center"></div>
    <div class="topnav-right"></div>
  </div>

  <!-- On a classic sharepoint page, the server renders placeholder divs for the client side webparts. -->
  <div class="top-container">
    <div class="left-nav">&nbsp;</div>
    <div class="main-page">
      <div class="banner">
          <h1 spellcheck="true" autocapitalize="true" class="HeadlineTitle ms-font-su ms-font-weight-regular ms-font-color-white" contenteditable="false" tabindex="-1">Sharepoint classic page demo </h1>
      </div>
      <div class='column'>
        <div class="demo-title">Quick Chart
          <button onclick="g_cswp.configureStart('demo_cswp_100')" style="float: right">Configure</button>
        </div>
        <div class="cswp" data-sp-cs-webpartid='demo_cswp_100'>
          <script type="text/javascript">

            (function cswp_1() {
              try {
                if (!window.preloadedData) {
                  window.preloadedData = {
                    'clientSideApplicationId': 'eb4b666b-5c29-4dad-9a99-23613f21a2b7',
                    manifests: debugManifests.getLocalPageManifests(),
                    spPageContextInfo: {
                      'currentCultureName': 'en-us'
                    }
                  }
                }

                window.spModuleLoader.initialize(window.preloadedData).then(function() {
                  window.spModuleLoader.loadManifestModules('91a50c94-865f-4f5c-8b4e-e49659e69772').then(function() {
                      g_cswp.loadClientSideWebPart('demo_cswp_100', window.spModuleLoader.getManifestById('91a50c94-865f-4f5c-8b4e-e49659e69772'));
                  });
                });
              } catch (e) {
                if (g_cswp) {
                  g_cswp.logClientSideWebPartLoadError('demo_cswp_100', e.message)
                } else {
                  console.error('Web part framework is not loaded.');
                }
              };
            })();

          </script>
        </div>
    </div>
      <div class='column'>
        <div class="demo-title">Quick Chart
          <button onclick="g_cswp.configureStart('demo_cswp_101')" style="float: right">Configure</button>
        </div>
        <div class="cswp" data-sp-cs-webpartid='demo_cswp_101'>
          <script type="text/javascript">

            (function cswp_1() {
              try {
                if (!window.preloadedData) {
                  window.preloadedData = {
                    'clientSideApplicationId': 'eb4b666b-5c29-4dad-9a99-23613f21a2b7',
                    manifests: debugManifests.getLocalPageManifests(),
                    spPageContextInfo: {
                      'currentCultureName': 'en-us'
                    }
                  }
                }

                window.spModuleLoader.initialize(window.preloadedData).then(function() {
                  window.spModuleLoader.loadManifestModules('91a50c94-865f-4f5c-8b4e-e49659e69772').then(function() {
                      g_cswp.loadClientSideWebPart('demo_cswp_101', window.spModuleLoader.getManifestById('91a50c94-865f-4f5c-8b4e-e49659e69772'));
                  });
                });
              } catch (e) {
                if (g_cswp) {
                  g_cswp.logClientSideWebPartLoadError('demo_cswp_101', e.message)
                } else {
                  console.error('Web part framework is not loaded.');
                }
              };
            })();

          </script>
        </div>
    </div>
  </div>
</body>
</html>
