function ULSgsX(){var o=new Object;o.ULSTeamName="Microsoft SharePoint Foundation";o.ULSFileName="SP.RequestExecutor.js";return o;}
if("undefined"==typeof g_all_modules)g_all_modules={};g_all_modules["sp.requestexecutor.js"]={version:{rmj:16,rmm:0,rup:5813,rpr:1200}};typeof spWriteProfilerMark=="function"&&spWriteProfilerMark("perfMarkBegin_sp.requestexecutor.js");if(window.Type&&window.Type.registerNamespace)Type.registerNamespace("SP");else if(typeof window.SP=="undefined"){window.SP={};window.SP.__namespace=true}SP.PostMessageRequestInfo=function(){};SP.PostMessageResponseInfo=function(){};SP.RequestInfo=function(){};SP.AppWebProxyRequestInfo=function(){};SP.ResponseInfo=function(){};SP.RequestExecutorOptions=function(){};SP.RequestExecutorMessageProcessorFormDigestInfo=function(){};SP.RequestExecutorMessageProcessorInitInfo=function(){};SP.PostMessageCommands=function(){};SP.ProxyWebRequestExecutorInternal=function(){};SP.ProxyWebRequestExecutorInternal.processSuccessCallback=function(b,a){ULSgsX:;b.$1W_1(a)};SP.ProxyWebRequestExecutorInternal.processErrorCallback=function(d,b,c,a){ULSgsX:;d.$1V_1(b,c,a)};SP.ProxyWebRequestExecutor=function(a,b){ULSgsX:;SP.ProxyWebRequestExecutor.initializeBase(this);this.$A_1=a;this.$7_1=b};SP.ProxyWebRequestExecutor.prototype={$A_1:null,$7_1:null,$19_1:false,$1C_1:false,$1B_1:false,$8_1:null,get_aborted:function(){ULSgsX:;return this.$19_1},get_responseAvailable:function(){ULSgsX:;return!!this.$8_1&&this.$8_1.responseAvailable},get_responseData:function(){ULSgsX:;return!this.$8_1?null:this.$8_1.body},get_started:function(){ULSgsX:;return this.$1B_1},get_statusCode:function(){ULSgsX:;return!this.$8_1?0:this.$8_1.statusCode},get_statusText:function(){ULSgsX:;return!this.$8_1?null:this.$8_1.statusText},get_timedOut:function(){ULSgsX:;return this.$1C_1},get_xml:function(){ULSgsX:;return null},abort:function(){ULSgsX:;this.$19_1=true},executeRequest:function(){ULSgsX:;var b=this.get_webRequest(),f=new SP.RequestExecutor(this.$A_1,this.$7_1),a=new SP.RequestInfo;a.body=b.get_body();a.headers={};if(b.get_headers()){var d=b.get_headers();for(var e in d){var c={key:e,value:d[e]},g=b.get_headers()[c.key];if(typeof g!=="function")a.headers[c.key]=b.get_headers()[c.key]}}a.method=b.get_httpVerb();a.url=b.get_url();a.timeout=b.get_timeout();a.success=SP.RequestExecutorNative.getProxyWebRequestExecutorSuccessCallback(this);a.error=SP.RequestExecutorNative.getProxyWebRequestExecutorErrorCallback(this);this.$1B_1=true;f.executeAsync(a)},$1W_1:function(a){ULSgsX:;this.$8_1=a;this.get_webRequest().completed(Sys.EventArgs.Empty)},$1V_1:function(b,a,c){ULSgsX:;if(a===SP.RequestExecutorErrors.requestAbortedOrTimedout)this.$1C_1=true;this.$8_1=b;this._SPError_=c;this._SPErrorCode_=a;this.get_webRequest().completed(Sys.EventArgs.Empty)},getAllResponseHeaders:function(){ULSgsX:;return!this.$8_1?null:this.$8_1.allResponseHeaders},getResponseHeader:function(a){ULSgsX:;return!this.$8_1||!this.$8_1.headers?null:!a?null:this.$8_1.headers[a.toUpperCase()]}};SP.ProxyWebRequestExecutorFactory=function(c,a){ULSgsX:;var b;if(SP.RequestExecutorUtility.$0(a)){a=new SP.RequestExecutorOptions;b=null}else if(typeof a==="string"){b=a;a=new SP.RequestExecutorOptions;a.viaUrl=b}else{SP.RequestExecutor.$1e(a);b=a.viaUrl}SP.RequestExecutorUtility.$6(c,"url","string",true);SP.RequestExecutorUtility.$6(b,"viaUrl","string",false);SP.RequestExecutorUtility.$X(c,"url");var d=c.indexOf("?");if(d>=0)throw SP.RequestExecutorUtility.$J("url");this.$A_0=c;this.$7_0=a};SP.ProxyWebRequestExecutorFactory.prototype={$A_0:null,$7_0:null,createWebRequestExecutor:function(){ULSgsX:;return new SP.ProxyWebRequestExecutor(this.$A_0,this.$7_0)}};SP.RequestExecutor=function(a,b){ULSgsX:;var c;if(SP.RequestExecutorUtility.$0(b)){b=new SP.RequestExecutorOptions;c=null}else if(typeof b==="string"){c=b;b=new SP.RequestExecutorOptions;b.viaUrl=c}else{SP.RequestExecutor.$1e(b);c=b.viaUrl}SP.RequestExecutorUtility.$6(a,"url","string",true);SP.RequestExecutorUtility.$6(c,"viaUrl","string",false);if(SP.RequestExecutorUtility.$2(c)){if(SP.RequestExecutorUtility.$2(a))throw SP.RequestExecutorUtility.$J("url");var d=a.indexOf("?");if(d>=0)throw SP.RequestExecutorUtility.$J("url");d=a.indexOf("#");if(d>=0)throw SP.RequestExecutorUtility.$J("url");if(a.charAt(0)==="/")a=SP.RequestExecutor.$b(window.location.href,a);SP.RequestExecutorUtility.$X(a,"url");if(a.charCodeAt(a.length-1)==="/")a=a.substr(0,a.length-1);this.$A_0=a;if(SP.RequestExecutorInternalSharedUtility.$U(a).toLowerCase()===SP.RequestExecutorInternalSharedUtility.$U(window.location.href).toLowerCase())this.$O_0=1;else{this.$O_0=2;if(a.charAt(a.length-1)!=="/")a=a+"/";this.$1A_0=a}}else{SP.RequestExecutorUtility.$X(a,"url");this.$O_0=3;this.$A_0=a;this.$v_0=c}this.$7_0=b;this.formDigestHandlingEnabled=true;this.iFrameSourceUrl="_layouts/15/AppWebProxy.aspx"};SP.RequestExecutor.getLoginUrl=function(d,c,b){ULSgsX:;SP.RequestExecutorUtility.$X(d,"returnUrl");SP.RequestExecutorUtility.$X(c,"appWebUrl");SP.RequestExecutorUtility.$6(b,"signInWebUrl","string",false);var a=SP.RequestExecutor.$b(c,"_layouts/15/AppWebProxy.aspx");if(!SP.RequestExecutorUtility.$2(b)){a=SP.RequestExecutorUtility.$G(a);a=a+"SP.SignInWebUrl="+SP.RequestExecutorHttpUtility.$R(b,false,false)}a=SP.RequestExecutorUtility.$G(a);a=a+"SP.ReturnUrl="+SP.RequestExecutorHttpUtility.$R(d,false,false);return a};SP.RequestExecutor.$b=function(a,b){ULSgsX:;SP.RequestExecutorUtility.$X(a,"baseUrl");if(b.substr(0,8).toLowerCase()==="https://"||b.substr(0,7).toLowerCase()==="http://")return b;else if(b.charAt(0)==="/"){var c=a.indexOf("://");c=a.indexOf("/",c+3);if(c>0)a=a.substr(0,c);return a+b}else{if(a.charAt(a.length-1)!=="/")a=a+"/";return a+b}};SP.RequestExecutor.$U=function(a){ULSgsX:;SP.RequestExecutorUtility.$X(a,"url");return SP.RequestExecutorInternalSharedUtility.$U(a)};SP.RequestExecutor.$t=function(a){ULSgsX:;return SP.RequestExecutor.$l[a]?document.getElementById("SPRequestExecutor"+a):null};SP.RequestExecutor.$1h=function(c,j,k){ULSgsX:;var g="SPRequestExecutor"+c,f=document.getElementById(g);if(f&&f.parentNode){SP.RequestExecutor.$1("Remove the existing IFRAME for "+c);f.parentNode.removeChild(f)}var b;b=document.createElement("IFRAME");var a=c;if(!SP.RequestExecutorUtility.$2(j)){a=SP.RequestExecutorUtility.$G(a);a=a+"SP.SignInWebUrl="+SP.RequestExecutorHttpUtility.$R(j,false,false)}if(!SP.RequestExecutorUtility.$2(k)){a=SP.RequestExecutorUtility.$G(a);a=a+"SP.ClientTag="+SP.RequestExecutorHttpUtility.$R(k,false,false)}var d=document.URL,e=d.indexOf("?");if(e>0)d=d.substr(0,e);e=d.indexOf("#");if(e>0)d=d.substr(0,e);a=SP.RequestExecutorUtility.$G(a);a=a+"SP.AppPageUrl="+SP.RequestExecutorHttpUtility.$R(d,false,false);b.src=a;b.id=g;b.style.display="none";var h=SP.RequestExecutorNative.getIFrameOnloadCallback(c);if(b.addEventListener)b.addEventListener("load",h,false);else if(b.attachEvent)b.attachEvent("onload",h);else throw SP.RequestExecutorUtility.$10();document.body.appendChild(b);SP.RequestExecutor.$l[c]=true;SP.RequestExecutor.$1("Created IFrame "+a);var i=window.setTimeout(function(){ULSgsX:;delete SP.RequestExecutor.$B[c];SP.RequestExecutor.$1("IFrameLoadTimeout, display failure");SP.RequestExecutor.$1Z(c)},3e4);SP.RequestExecutor.$1("Create IFrameLoadTimeout "+i);SP.RequestExecutor.$B[c]=i;return b};SP.RequestExecutor.$1S=function(b,c){ULSgsX:;var a=SP.RequestExecutorUtility.$g(b);a=SP.RequestExecutorUtility.$G(a);a=a+"MS.SP.url="+encodeURIComponent(c);return a};SP.RequestExecutor.$1N=function(c,g,h,b,e){ULSgsX:;if(!SP.RequestExecutor.$d)SP.RequestExecutor.$d={};if(!SP.RequestExecutor.$k)SP.RequestExecutor.$k={};var f=new Date;if(!h||b.method.toUpperCase()==="GET"||!SP.RequestExecutorUtility.$0(SP.RequestExecutor.$d[c])&&SP.RequestExecutor.$d[c]>f.getTime())e(SP.RequestExecutor.$k[c],b);else{var a=SP.RequestExecutor.$u();a.open("POST",g);a.setRequestHeader("accept","application/json;odata=verbose");var d=0;if(b.timeout>0)d=window.setTimeout(function(){ULSgsX:;a.onreadystatechange=SP.RequestExecutorNative.emptyCallback;try{a.abort()}catch(c){}SP.RequestExecutor.$c(b,SP.RequestExecutorErrors.requestAbortedOrTimedout,SP.RequestExecutorResources.getString("RE_RequestAbortedOrTimedout"))},b.timeout);a.onreadystatechange=function(){ULSgsX:;if(a.readyState===4){d&&window.clearTimeout(d);a.onreadystatechange=SP.RequestExecutorNative.emptyCallback;if(a.status!==200||!a.getResponseHeader("content-type")||a.getResponseHeader("content-type").toLowerCase().indexOf("application/json")<0){var f=SP.RequestExecutorResources.getString("RE_RequestUnexpectedResponseWithContentTypeAndStatus");f=SP.RequestExecutorUtility.$T(f,a.getResponseHeader("content-type"),a.status.toString());SP.RequestExecutor.$c(b,SP.RequestExecutorErrors.unexpectedResponse,f)}else{var g=JSON.parse(a.responseText);if(SP.RequestExecutorUtility.$0(g))SP.RequestExecutor.$c(b,SP.RequestExecutorErrors.unexpectedResponse,SP.RequestExecutorResources.getString("RE_RequestUnexpectedResponse"));else{var h=g.d.GetContextWebInformation.FormDigestValue,i=g.d.GetContextWebInformation.FormDigestTimeoutSeconds,j=+new Date+i*750;SP.RequestExecutor.$k[c]=h;SP.RequestExecutor.$d[c]=j;e(h,b)}}}};a.send("")}};SP.RequestExecutor.$c=function(b,c,d){ULSgsX:;if(b.error){var a=new SP.ResponseInfo;a.state=b.state;a.body="";b.error(a,c,d)}};SP.RequestExecutor.$q=function(){ULSgsX:;var a=window.postMessage;if(SP.RequestExecutorUtility.$9(a))throw SP.RequestExecutorUtility.$10();a=window.JSON;if(SP.RequestExecutorUtility.$9(a)||SP.RequestExecutorUtility.$9(a.stringify)||SP.RequestExecutorUtility.$9(a.parse))throw SP.RequestExecutorUtility.$10();};SP.RequestExecutor.$1g=function(){ULSgsX:;var a=window.ArrayBuffer;if(SP.RequestExecutorUtility.$9(a))throw SP.RequestExecutorUtility.$12();a=window.Uint8Array;if(SP.RequestExecutorUtility.$9(a))throw SP.RequestExecutorUtility.$12();if(SP.RequestExecutorUtility.$9(window.BlobBuilder)&&SP.RequestExecutorUtility.$9(window.MozBlobBuilder)&&SP.RequestExecutorUtility.$9(window.Blob))throw SP.RequestExecutorUtility.$12();};SP.RequestExecutor.$F=function(a){ULSgsX:;SP.RequestExecutorUtility.$6(a.postMessageId,"requestInfo.postMessageId","string",true);SP.RequestExecutorUtility.$6(a.appWebProxyUrl,"requestInfo.appWebProxyUrl","string",true);var c=SP.RequestExecutor.$t(a.appWebProxyUrl);if(!c)throw SP.RequestExecutorUtility.$11();if(!SP.RequestExecutor.$4)SP.RequestExecutor.$4={};SP.RequestExecutor.$4[a.postMessageId]=a;var b=new SP.PostMessageRequestInfo;b.command=a.command;b.url=a.requestInfo.url;b.method=a.requestInfo.method;b.body=a.requestInfo.body;b.headers=a.requestInfo.headers;b.postMessageId=a.postMessageId;b.timeout=a.requestInfo.timeout;b.accessToken=a.requestInfo.$o_0;b.binaryStringRequestBody=a.requestInfo.binaryStringRequestBody;b.binaryStringResponseBody=a.requestInfo.binaryStringResponseBody;var d=JSON.stringify(b),e=a.appWebProxyUrl;SP.RequestExecutor.$1("RequestExecutor.PostMessage.Message: "+d);SP.RequestExecutor.$1("RequestExecutor.PostMessage.Target: "+e);c.contentWindow.postMessage(d,e)};SP.RequestExecutor.internalProcessIFrameOnload=function(a){ULSgsX:;SP.RequestExecutor.$1("Processing IFRAME onload event");SP.RequestExecutor.$V[a]=true;if(!SP.RequestExecutorUtility.$0(SP.RequestExecutor.$B[a])){SP.RequestExecutor.$1("Clear IFrameLoadTimeout "+SP.RequestExecutor.$B[a]);window.clearTimeout(SP.RequestExecutor.$B[a]);delete SP.RequestExecutor.$B[a]}if(!SP.RequestExecutorUtility.$0(SP.RequestExecutor.$N[a])){SP.RequestExecutor.$1("Clear IFramePingTimeout"+SP.RequestExecutor.$N[a]);window.clearTimeout(SP.RequestExecutor.$N[a]);delete SP.RequestExecutor.$N[a]}if(!SP.RequestExecutorUtility.$0(SP.RequestExecutor.$I[a]))delete SP.RequestExecutor.$I[a];SP.RequestExecutor.$1("Start to ping the IFRAME "+a);SP.RequestExecutor.$1b(a)};SP.RequestExecutor.$1b=function(b){ULSgsX:;SP.RequestExecutor.$m++;var a=new SP.AppWebProxyRequestInfo;a.command="Ping";a.postMessageId=SP.RequestExecutorInternalSharedUtility.$j+SP.RequestExecutor.$m.toString();a.appWebProxyUrl=b;var c=window.setTimeout(function(){ULSgsX:;SP.RequestExecutor.$1("Ping timeout");delete SP.RequestExecutor.$B[b];SP.RequestExecutor.$1x(a.postMessageId,b)},1e3);SP.RequestExecutor.$1("Create IFramePingTimeout "+c);a.timeoutId=c;a.requestInfo=new SP.RequestInfo;SP.RequestExecutor.$4[a.postMessageId]=a;SP.RequestExecutor.$N[b]=c;SP.RequestExecutor.$F(a)};SP.RequestExecutor.$1x=function(b,a){ULSgsX:;var c=SP.RequestExecutor.$4[b];if(SP.RequestExecutorUtility.$0(c))return;if(SP.RequestExecutor.$Q[a])return;SP.RequestExecutor.$4[b]=null;delete SP.RequestExecutor.$4[b];if(SP.RequestExecutorUtility.$0(SP.RequestExecutor.$I[a]))SP.RequestExecutor.$I[a]=1;else SP.RequestExecutor.$I[a]=SP.RequestExecutor.$I[a]+1;SP.RequestExecutor.$1("Ping timeout count = "+SP.RequestExecutor.$I[a]);if(SP.RequestExecutor.$I[a]>25){SP.RequestExecutor.$1("Ping timeout count for "+a+" exceeds threshold, display failure");SP.RequestExecutor.$1Z(a)}else{SP.RequestExecutor.$1("Send ping again for "+a);SP.RequestExecutor.$1b(a)}};SP.RequestExecutor.$1Z=function(a){ULSgsX:;var d=SP.RequestExecutor.$P[a];if(!SP.RequestExecutorUtility.$0(d)&&!d.closed)SP.RequestExecutor.$z(a);else{for(var e=false,f=SP.RequestExecutor.$E[a],b=0;b<f.length;b++){var c=f[b];if(c.command==="Query"&&SP.RequestExecutorUtility.$17(c.requestInfo.url,c.requestInfo.method))e=true}if(!e&&(SP.RequestExecutorUtility.$0(SP.RequestExecutor.$H[a])||SP.RequestExecutor.$H[a]<1))SP.RequestExecutorNotificationPanel.$22(a);else SP.RequestExecutor.$1F(a,"RE_CannotAccessSite")}};SP.RequestExecutor.$1v=function(a){ULSgsX:;var b=a;b=SP.RequestExecutorUtility.$G(b);b=b+"SP.CloseWindow=true";var c=window.open(b);if(SP.RequestExecutorUtility.$0(c))SP.RequestExecutor.$1F(a,"RE_CannotAccessSiteOpenWindowFailed");else{SP.RequestExecutor.$P[a]=c;if(SP.RequestExecutorUtility.$0(SP.RequestExecutor.$H[a]))SP.RequestExecutor.$H[a]=1;else SP.RequestExecutor.$H[a]=SP.RequestExecutor.$H[a]+1;SP.RequestExecutor.$z(a)}};SP.RequestExecutor.$1F=function(a,h){ULSgsX:;SP.RequestExecutor.$1("Failed to load IFRAME for "+a);SP.RequestExecutor.$a[a]=true;var c=SP.RequestExecutor.$E[a];SP.RequestExecutor.$E[a]=[];if(!SP.RequestExecutorUtility.$0(SP.RequestExecutor.$B[a])){window.clearTimeout(SP.RequestExecutor.$B[a]);delete SP.RequestExecutor.$B[a]}SP.RequestExecutor.$1z(a);if(c)for(var f=SP.RequestExecutor.$1m(a,h),d=0;d<c.length;d++){var b=c[d],e=b.postMessageId,g=SP.RequestExecutor.$4[e];if(!SP.RequestExecutorUtility.$0(g)){SP.RequestExecutor.$4[e]=null;delete SP.RequestExecutor.$4[e];!SP.RequestExecutorUtility.$0(b.timeoutId)&&window.clearTimeout(b.timeoutId);SP.RequestExecutor.$c(b.requestInfo,SP.RequestExecutorErrors.iFrameLoadError,f)}}};SP.RequestExecutor.$1z=function(a){ULSgsX:;var b=SP.RequestExecutor.$t(a);b&&b.parentNode&&b.parentNode.removeChild(b);if(SP.RequestExecutor.$E)delete SP.RequestExecutor.$E[a];if(SP.RequestExecutor.$B)delete SP.RequestExecutor.$B[a];if(SP.RequestExecutor.$V)delete SP.RequestExecutor.$V[a];if(SP.RequestExecutor.$Q)delete SP.RequestExecutor.$Q[a];if(SP.RequestExecutor.$N)delete SP.RequestExecutor.$N[a];if(SP.RequestExecutor.$a)delete SP.RequestExecutor.$a[a];if(SP.RequestExecutor.$P)delete SP.RequestExecutor.$P[a];if(SP.RequestExecutor.$H)delete SP.RequestExecutor.$H[a]};SP.RequestExecutor.$z=function(a){ULSgsX:;var c=SP.RequestExecutor.$P[a];if(c)if(c.closed){delete SP.RequestExecutor.$P[a];var d=SP.RequestExecutor.$t(a);SP.RequestExecutor.$Q[a]=false;SP.RequestExecutor.$V[a]=false;SP.RequestExecutor.$a[a]=false;a=SP.RequestExecutorUtility.$G(a);var b=a;b=SP.RequestExecutorUtility.$G(b);b=b+"SP.AppWebProxyUrl="+SP.RequestExecutorHttpUtility.$R(a,false,false);b=b+"&ts="+Math.random().toString();SP.RequestExecutor.$1("Reload IFRAME for "+a+". Src="+b);d.src=b}else window.setTimeout(function(){ULSgsX:;SP.RequestExecutor.$z(a)},500)};SP.RequestExecutor.$1w=function(a){ULSgsX:;SP.RequestExecutor.$1("Successfully load frame for "+a);SP.RequestExecutor.$Q[a]=true;SP.RequestExecutorNotificationPanel.$1y(a);var c=SP.RequestExecutor.$E[a];if(c){SP.RequestExecutor.$E[a]=[];for(var d=0;d<c.length;d++){var b=c[d];if(SP.RequestExecutor.$4[b.postMessageId])if(b.requestInfo.$r_0)SP.RequestExecutor.$1K(b);else SP.RequestExecutor.$F(b)}}};SP.RequestExecutor.$1K=function(a){ULSgsX:;!SP.RequestExecutorUtility.$0(a.timeoutId)&&window.clearTimeout(a.timeoutId);var b=new SP.ResponseInfo;b.responseAvailable=false;b.body="";b.state=a.requestInfo.state;a.requestInfo.success&&a.requestInfo.success(b)};SP.RequestExecutor.internalProcessIFrameRequestTimeoutCallback=function(a){ULSgsX:;if(!SP.RequestExecutor.$4)return;var b=SP.RequestExecutor.$4[a];if(SP.RequestExecutorUtility.$0(b))return;SP.RequestExecutor.$4[a]=null;delete SP.RequestExecutor.$4[a];SP.RequestExecutor.$c(b.requestInfo,SP.RequestExecutorErrors.requestAbortedOrTimedout,SP.RequestExecutorResources.getString("RE_RequestAbortedOrTimedout"))};SP.RequestExecutor.internalProcessXMLHttpRequestTimeoutCallback=function(a,b){ULSgsX:;a.onreadystatechange=SP.RequestExecutorNative.emptyCallback;try{a.abort()}catch(c){}SP.RequestExecutor.$c(b,SP.RequestExecutorErrors.requestAbortedOrTimedout,SP.RequestExecutorResources.getString("RE_RequestAbortedOrTimedout"))};SP.RequestExecutor.internalProcessXMLHttpRequestOnreadystatechange=function(b,c,d){ULSgsX:;if(b.readyState===4){d&&window.clearTimeout(d);b.onreadystatechange=SP.RequestExecutorNative.emptyCallback;var a=new SP.ResponseInfo;a.state=c.state;a.responseAvailable=true;if(c.binaryStringResponseBody)a.body=SP.RequestExecutorInternalSharedUtility.$1L(b.response);else a.body=b.responseText;a.statusCode=b.status;a.statusText=b.statusText;a.contentType=b.getResponseHeader("content-type");a.allResponseHeaders=b.getAllResponseHeaders();a.headers=SP.RequestExecutor.$1X(a.allResponseHeaders);if(b.status>=200&&b.status<300||b.status===1223)c.success&&c.success(a);else{var e=SP.RequestExecutorErrors.httpError,f=b.statusText;c.error&&c.error(a,e,f)}}};SP.RequestExecutor.internalOnMessage=function(h){ULSgsX:;SP.RequestExecutor.$1("RequestExecutor.OnMessage");if(SP.RequestExecutorUtility.$0(h)){SP.RequestExecutor.$1("RequestExecutor.OnMessage: message is null");return}var f=h.data,g=h.origin;SP.RequestExecutor.$1("RequestExecutor.OnMessage: Message.data="+f);SP.RequestExecutor.$1("RequestExecutor.OnMessage: Message.origin="+g);if(SP.RequestExecutorUtility.$2(g)||SP.RequestExecutorUtility.$2(f))return;if(!SP.RequestExecutor.$4)return;var a=JSON.parse(f);if(SP.RequestExecutorUtility.$0(a))return;if(SP.RequestExecutorUtility.$2(a.postMessageId))return;var b=SP.RequestExecutor.$4[a.postMessageId];if(SP.RequestExecutorUtility.$0(b))return;var i=SP.RequestExecutor.$U(g),j=SP.RequestExecutor.$U(b.appWebProxyUrl);if(i.toLowerCase()!==j.toLowerCase())return;var k=a.postMessageId;delete SP.RequestExecutor.$4[k];if(!SP.RequestExecutorUtility.$0(b.timeoutId)){window.clearTimeout(b.timeoutId);b.timeoutId=0;delete b.timeoutId}if(a.command==="Ping"){var l=b.appWebProxyUrl;SP.RequestExecutor.$1w(l)}else if(a.command==="Query"){var c=new SP.ResponseInfo;c.responseAvailable=a.responseAvailable;c.body=a.responseText;c.statusCode=a.statusCode;c.statusText=a.statusText;c.contentType=a.contentType;c.state=b.requestInfo.state;c.allResponseHeaders=a.allResponseHeaders;c.headers=SP.RequestExecutor.$1X(a.allResponseHeaders);c.binaryStringResponseBody=a.binaryStringResponseBody;if(SP.RequestExecutorUtility.$0(c.body))c.body="";var d=0,e=null;if(a.errorCode){d=a.errorCode;e=a.errorMessage}else if(a.statusCode>=200&&a.statusCode<300||a.statusCode===1223){d=0;e=null}else if(!SP.RequestExecutorUtility.$17(b.requestInfo.url,b.requestInfo.method)){d=SP.RequestExecutorErrors.httpError;e=a.statusText}if(!d)b.requestInfo.success&&b.requestInfo.success(c);else b.requestInfo.error&&b.requestInfo.error(c,d,e)}};SP.RequestExecutor.get_$y=function(){ULSgsX:;return!!document.body||SP.RequestExecutor.$1H};SP.RequestExecutor.$x=function(a,b){ULSgsX:;if(!SP.RequestExecutor.$f)SP.RequestExecutor.$f=[];if(!SP.RequestExecutor.$e)SP.RequestExecutor.$e=[];SP.RequestExecutor.$1("Adding request to queue");SP.RequestExecutor.$f.push(a);SP.RequestExecutor.$e.push(b)};SP.RequestExecutor.internalProcessWindowLoad=function(){ULSgsX:;SP.RequestExecutor.$1H=true;var b=SP.RequestExecutor.$f;SP.RequestExecutor.$f=null;var c=SP.RequestExecutor.$e;SP.RequestExecutor.$e=null;if(b)for(var a=0;a<b.length;a++){var d=b[a],e=c[a];d.executeAsync(e)}};SP.RequestExecutor.$u=function(){ULSgsX:;var a=window.XMLHttpRequest;if(SP.RequestExecutorUtility.$9(a))throw SP.RequestExecutorUtility.$S(SP.RequestExecutorResources.getString("RE_BrowserNotSupported"),SP.RequestExecutorExceptions.browserNotSupported);return new XMLHttpRequest};SP.RequestExecutor.$1X=function(h){ULSgsX:;if(SP.RequestExecutorUtility.$2(h))return null;for(var f={},i=new RegExp("\x0d?\x0a"),g=h.split(i),b=0;b<g.length;b++){var a=g[b];if(!SP.RequestExecutorUtility.$2(a)){var c=a.indexOf(":");if(c>0){var d=a.substr(0,c),e=a.substr(c+1);d=SP.RequestExecutorNative.trim(d);e=SP.RequestExecutorNative.trim(e);f[d.toUpperCase()]=e}}}return f};SP.RequestExecutor.$1e=function(a){ULSgsX:;if(SP.RequestExecutorUtility.$0(a))throw SP.RequestExecutorUtility.$J("options");SP.RequestExecutorUtility.$6(a.clientId,"options.clientId","string",false);SP.RequestExecutorUtility.$6(a.accessToken,"options.accessToken","string",!SP.RequestExecutorUtility.$2(a.clientId));SP.RequestExecutorUtility.$6(a.viaUrl,"options.viaUrl","string",false);SP.RequestExecutorUtility.$6(a.signInWebUrl,"options.signInWebUrl","string",false)};SP.RequestExecutor.$23=function(a){ULSgsX:;if(SP.RequestExecutorUtility.$0(a))throw SP.RequestExecutorUtility.$J("requestInfo");SP.RequestExecutorUtility.$6(a.url,"requestInfo.url","string",true);SP.RequestExecutorUtility.$6(a.body,"requestInfo.body","string",false);SP.RequestExecutorUtility.$6(a.success,"requestInfo.success","function",false);SP.RequestExecutorUtility.$6(a.error,"requestInfo.error","function",false);SP.RequestExecutorUtility.$6(a.timeout,"requestInfo.timeout","number",false);SP.RequestExecutorUtility.$6(a.method,"requestInfo.method","string",false);SP.RequestExecutorUtility.$6(a.binaryStringRequestBody,"requestInfo.BinaryRequestBody","boolean",false);SP.RequestExecutorUtility.$6(a.binaryStringResponseBody,"requestInfo.BinaryResponseBody","boolean",false);if(SP.RequestExecutorUtility.$2(a.method))a.method="GET";else a.method=a.method.toUpperCase();if(SP.RequestExecutorUtility.$0(a.timeout))a.timeout=9e4;if(a.timeout<0)throw SP.RequestExecutorUtility.$J("requestInfo.timeout");if(SP.RequestExecutorUtility.$2(a.url))throw SP.RequestExecutorUtility.$J("requestInfo.url");};SP.RequestExecutor.$1m=function(d,e){ULSgsX:;var a=d,c=a.indexOf("/_layouts");if(c>0)a=a.substr(0,c);var b=SP.RequestExecutorResources.getString(e);b=SP.RequestExecutorUtility.$T(b,a);return b};SP.RequestExecutor.internalLoginButtonHandler=function(c){ULSgsX:;var b=SP.RequestExecutorNotificationPanel.$1Q(c);if(!SP.RequestExecutorUtility.$2(b)){var d=SP.RequestExecutorNotificationPanel.$1q(b);if(SP.RequestExecutorUtility.$2(d))SP.RequestExecutor.$1v(b);else{var a=b;a=SP.RequestExecutorUtility.$G(a);a=a+"SP.ReturnUrl="+SP.RequestExecutorHttpUtility.$R(d,false,false);window.top.location.href=a}}SP.RequestExecutorNotificationPanel.$1E(c)};SP.RequestExecutor.internalCancelButtonHandler=function(a){ULSgsX:;var b=SP.RequestExecutorNotificationPanel.$1Q(a);!SP.RequestExecutorUtility.$2(b)&&SP.RequestExecutor.$1F(b,"RE_CannotAccessSiteCancelled");SP.RequestExecutorNotificationPanel.$1E(a)};SP.RequestExecutor.$1=function(b){ULSgsX:;var a=new Date;window.console&&window.console.log&&window.console.log(a.toString()+":"+b);SP.RequestExecutor.logPanelEnabled&&SP.RequestExecutor.$1u(a.toString()+":"+b);SP.RequestExecutor.logCallback&&SP.RequestExecutor.logCallback(a.toString()+":"+b)};SP.RequestExecutor.$1u=function(b){ULSgsX:;var a=document.createElement("DIV");a.innerHTML=SP.RequestExecutorUtility.$i(b);SP.RequestExecutor.$1p().appendChild(a)};SP.RequestExecutor.$1p=function(){ULSgsX:;var a=document.getElementById("SP.RequestExecutor.Log");if(!a){a=document.createElement("DIV");a.id="SP.RequestExecutor.Log";a.style.display="none";document.body.appendChild(a)}return a};SP.RequestExecutor.prototype={$A_0:null,$v_0:null,$1A_0:null,$O_0:0,$7_0:null,get_formDigestHandlingEnabled:function(){ULSgsX:;return this.formDigestHandlingEnabled},set_formDigestHandlingEnabled:function(a){ULSgsX:;this.formDigestHandlingEnabled=a;return a},get_iFrameSourceUrl:function(){ULSgsX:;return this.iFrameSourceUrl},set_iFrameSourceUrl:function(a){ULSgsX:;this.iFrameSourceUrl=a;return a},get_$p_0:function(){ULSgsX:;var a=this.get_iFrameSourceUrl();if(!SP.RequestExecutorUtility.$2(this.$7_0.clientId)){a=SP.RequestExecutorUtility.$G(a);a+="client_id";a+="=";a+=encodeURIComponent(this.$7_0.clientId)}return SP.RequestExecutor.$b(this.$1A_0,a)},executeAsync:function(a){ULSgsX:;SP.RequestExecutor.$23(a);if(SP.RequestExecutorUtility.$1T(a.url)){if(SP.RequestExecutor.$U(a.url).toLowerCase()!==SP.RequestExecutor.$U(this.$A_0).toLowerCase())throw SP.RequestExecutorUtility.$J("requestInfo.url");}else a.url=SP.RequestExecutor.$b(this.$A_0,a.url);a.$o_0=this.$7_0.accessToken;if(!SP.RequestExecutorUtility.$2(this.$7_0.clientTag)){if(!a.headers)a.headers={};var b=SP.RequestExecutorUtility.$1R(a.headers,"x-clientservice-clienttag");if(SP.RequestExecutorUtility.$0(b))a.headers["x-clientservice-clienttag"]=this.$7_0.clientTag}(a.binaryStringRequestBody||a.binaryStringResponseBody)&&SP.RequestExecutor.$1g();if(this.$O_0===2){SP.RequestExecutor.$q();this.$13_0();if(SP.RequestExecutor.get_$y())this.$14_0(this.get_$p_0(),a);else SP.RequestExecutor.$x(this,a)}else if(this.$O_0===3)this.$1i_0(a);else{SP.RequestExecutor.$q();this.$1j_0(a)}},initializeAsync:function(b,c){ULSgsX:;SP.RequestExecutor.$q();var a=new SP.RequestInfo;a.$o_0=this.$7_0.accessToken;a.headers={};a.success=b;a.error=c;if(!SP.RequestExecutorUtility.$2(this.$7_0.clientTag))a.headers["x-clientservice-clienttag"]=this.$7_0.clientTag;if(this.$O_0===2){this.$13_0();if(SP.RequestExecutor.get_$y())this.$14_0(this.get_$p_0(),a);else SP.RequestExecutor.$x(this,a)}else if(b){var d=new SP.ResponseInfo;b(d)}},attemptLogin:function(f,b,c){ULSgsX:;SP.RequestExecutorUtility.$X(f,"returnUrl");SP.RequestExecutorUtility.$6(b,"success","function",true);SP.RequestExecutorUtility.$6(c,"error","function",false);if(this.$O_0===2){SP.RequestExecutor.$q();this.$13_0();var d=this.get_$p_0();SP.RequestExecutorNotificationPanel.$1I(d,f);var a=new SP.RequestInfo;a.$r_0=true;var g=this;a.success=function(a){ULSgsX:;SP.RequestExecutorNotificationPanel.$1I(d,null);b(a)};var h=this;a.error=function(a,b,e){ULSgsX:;SP.RequestExecutorNotificationPanel.$1I(d,null);c&&c(a,b,e)};if(SP.RequestExecutor.get_$y())this.$14_0(this.get_$p_0(),a);else SP.RequestExecutor.$x(this,a)}else{var e=new SP.ResponseInfo;e.responseAvailable=true;e.body="";b(e)}},$14_0:function(b,f){ULSgsX:;SP.RequestExecutor.$m++;var a=new SP.AppWebProxyRequestInfo;a.command="Query";a.postMessageId=SP.RequestExecutorInternalSharedUtility.$j+SP.RequestExecutor.$m.toString();a.appWebProxyUrl=b;a.requestInfo=f;if(!SP.RequestExecutor.$E)SP.RequestExecutor.$E={};if(!SP.RequestExecutor.$B)SP.RequestExecutor.$B={};if(!SP.RequestExecutor.$l)SP.RequestExecutor.$l={};if(!SP.RequestExecutor.$V)SP.RequestExecutor.$V={};if(!SP.RequestExecutor.$Q)SP.RequestExecutor.$Q={};if(!SP.RequestExecutor.$N)SP.RequestExecutor.$N={};if(!SP.RequestExecutor.$I)SP.RequestExecutor.$I={};if(!SP.RequestExecutor.$a)SP.RequestExecutor.$a={};if(!SP.RequestExecutor.$4)SP.RequestExecutor.$4={};if(!SP.RequestExecutor.$P)SP.RequestExecutor.$P={};if(!SP.RequestExecutor.$H)SP.RequestExecutor.$H={};var c=SP.RequestExecutor.$E[b];if(!c){c=[];SP.RequestExecutor.$E[b]=c}SP.RequestExecutor.$4[a.postMessageId]=a;if(a.requestInfo.timeout>0){var e=SP.RequestExecutorNative.getIFrameRequestTimeoutCallback(a.postMessageId);a.timeoutId=window.setTimeout(e,a.requestInfo.timeout)}var d=SP.RequestExecutor.$t(b);if(d)if(SP.RequestExecutor.$V[b]&&SP.RequestExecutor.$Q[b])if(a.requestInfo.$r_0)SP.RequestExecutor.$1K(a);else SP.RequestExecutor.$F(a);else{SP.RequestExecutor.$1("The frame element is not loaded. Put request in queue");c.push(a)}else{SP.RequestExecutor.$1("The frame element does not exist. Put request in queue");c.push(a);d=SP.RequestExecutor.$1h(b,this.$7_0.signInWebUrl,this.$7_0.clientTag)}},$1i_0:function(c){ULSgsX:;var a=SP.RequestExecutor.$b(this.$A_0,"_api/contextinfo");a=SP.RequestExecutor.$1S(this.$v_0,a);var b=this;SP.RequestExecutor.$1N(this.$A_0,a,this.get_formDigestHandlingEnabled(),c,function(a,c){ULSgsX:;b.$1O_0(a,c)})},$1O_0:function(j,a){ULSgsX:;var b=SP.RequestExecutor.$u(),e;if(this.$O_0===3)e=SP.RequestExecutor.$1S(this.$v_0,a.url);else e=SP.RequestExecutorUtility.$g(a.url);b.open(a.method,e);var h=false;if(a.headers){var f=a.headers;for(var g in f){var d={key:g,value:f[g]};if(!SP.RequestExecutorUtility.$2(d.key)){b.setRequestHeader(d.key,d.value);if(d.key.toLowerCase()==="x-requestdigest")h=true}}}!h&&!SP.RequestExecutorUtility.$2(j)&&b.setRequestHeader("X-RequestDigest",j);a.binaryStringResponseBody&&SP.RequestExecutorInternalSharedUtility.$1d(b);var i=0;if(a.timeout>0)i=window.setTimeout(SP.RequestExecutorNative.getXMLHttpRequestTimeoutCallback(b,a),a.timeout);b.onreadystatechange=SP.RequestExecutorNative.getXMLHttpRequestOnreadystatechangeCallback(b,a,i);var c=a.body;if(a.binaryStringRequestBody)c=SP.RequestExecutorInternalSharedUtility.$1M(a.body);if(SP.RequestExecutorUtility.$0(c))c="";b.send(c)},$1j_0:function(c){ULSgsX:;var a=SP.RequestExecutor.$b(this.$A_0,"_api/contextinfo");a=SP.RequestExecutorUtility.$g(a);var b=this;SP.RequestExecutor.$1N(this.$A_0,a,this.get_formDigestHandlingEnabled(),c,function(a,c){ULSgsX:;b.$1O_0(a,c)})},$13_0:function(){ULSgsX:;if(SP.RequestExecutor.$W)return;var a=SP.RequestExecutor.internalOnMessage;if(!SP.RequestExecutorUtility.$9(window.addEventListener)){window.addEventListener("message",a,false);SP.RequestExecutor.$W=true}else if(!SP.RequestExecutorUtility.$9(window.attachEvent)){window.attachEvent("onmessage",a);SP.RequestExecutor.$W=true}else throw SP.RequestExecutorUtility.$11();}};SP.RequestExecutorXHR=function(d,a){ULSgsX:;this.$D_0=new SP.RequestInfo;this.$D_0.headers={};var b=this;this.$D_0.success=function(a){ULSgsX:;b.$1W_0(a)};var c=this;this.$D_0.error=function(a,b,d){ULSgsX:;c.$1V_0(a,b,d)};this.readyState=0;this.status=0;this.statusText="";this.response="";this.responseText="";this.timeout=0;this.$1D_0=new SP.RequestExecutor(d,a)};SP.RequestExecutorXHR.prototype={$1D_0:null,$D_0:null,$w_0:null,open:function(a,b){ULSgsX:;this.$D_0.method=a;this.$D_0.url=b},setRequestHeader:function(a,b){ULSgsX:;if(SP.RequestExecutorUtility.$0(this.$D_0.headers[a]))this.$D_0.headers[a]=b;else this.$D_0.headers[a]+=" "+b},send:function(a){ULSgsX:;this.$D_0.body=a;if(this.timeout)this.$D_0.timeout=this.timeout;this.$1D_0.executeAsync(this.$D_0);this.readyState=1;this.$1J_0()},getResponseHeader:function(a){ULSgsX:;return!this.readyState||this.readyState===1?null:this.$w_0.headers[a.toUpperCase()].toString()},getAllResponseHeaders:function(){ULSgsX:;return!this.readyState||this.readyState===1?null:this.$w_0.allResponseHeaders},$1W_0:function(a){ULSgsX:;this.$1U_0(a)},$1V_0:function(a){ULSgsX:;this.$1U_0(a)},$1J_0:function(){ULSgsX:;this.onreadystatechange&&this.onreadystatechange()},$1U_0:function(a){ULSgsX:;this.status=a.statusCode;this.statusText=a.statusText;this.response=a.body;this.responseText=a.body;this.$w_0=a;this.readyState=4;this.$1J_0()},readyState:0,timeout:0,status:0,statusText:null,response:null,responseText:null,onreadystatechange:null};SP.RequestExecutorErrors=function(){};SP.RequestExecutorExceptions=function(){};SP.RequestExecutorInternalSharedUtility=function(){};SP.RequestExecutorInternalSharedUtility.$U=function(a){ULSgsX:;var b=a.indexOf("://");b=a.indexOf("/",b+3);if(b>0)a=a.substr(0,b);if(a.substr(0,8).toLowerCase()==="https://"&&a.substr(a.length-4,4)===":443")a=a.substr(0,a.length-4);else if(a.substr(0,7).toLowerCase()==="http://"&&a.substr(a.length-3,3)===":80")a=a.substr(0,a.length-3);return a};SP.RequestExecutorInternalSharedUtility.$1r=function(a){ULSgsX:;a=SP.RequestExecutorInternalSharedUtility.$U(a);if(a.substr(0,8).toLowerCase()==="https://")a=a.substr(8);else if(a.substr(0,7).toLowerCase()==="http://")a=a.substr(7);return a};SP.RequestExecutorInternalSharedUtility.$1M=function(b){ULSgsX:;var e=null;if(typeof b=="string"){for(var d=new ArrayBuffer(b.length),f=new Uint8Array(d),c=0;c<b.length;c++)f[c]=b.charCodeAt(c)&255;var a=null;if(window.BlobBuilder)a=new BlobBuilder;else if(window.MozBlobBuilder)a=new MozBlobBuilder;if(a){a.append(d);e=a.getBlob()}else e=d}return e};SP.RequestExecutorInternalSharedUtility.$1L=function(b){ULSgsX:;var a="";if(b)for(var d=new Uint8Array(b),c=0;c<b.byteLength;c++)a=a+String.fromCharCode(d[c]);return a};SP.RequestExecutorInternalSharedUtility.$1d=function(a){ULSgsX:;a.responseType="arraybuffer"};SP.RequestExecutorMessageProcessor=function(a,b){ULSgsX:;this.$K_0=a;this.$3_0=b;if(SP.RequestExecutorUtility.$2(this.$3_0.method))this.$3_0.method="GET";else this.$3_0.method=this.$3_0.method.toUpperCase();this.$L_0=0};SP.RequestExecutorMessageProcessor.$F=function(c,b){ULSgsX:;var a=JSON.stringify(c);SP.RequestExecutor.$1("RequestExecutorMessageProcessor.PostMessage.Message: "+a);SP.RequestExecutor.$1("RequestExecutorMessageProcessor.PostMessage.Target: "+b);window.parent.postMessage(a,b)};SP.RequestExecutorMessageProcessor.$1c=function(b,a){ULSgsX:;if(SP.RequestExecutorMessageProcessor.$C){if(SP.RequestExecutorMessageProcessor.$C.requestHeaders){var c=SP.RequestExecutorMessageProcessor.$C.requestHeaders;for(var d in c){var e={key:d,value:c[d]};b.setRequestHeader(e.key,e.value)}}if(SP.RequestExecutorMessageProcessor.$C.requireAccessToken){if(SP.RequestExecutorUtility.$0(a))a="";var f="Bearer "+a;b.setRequestHeader("Authorization",f);var g="access_token="+SP.RequestExecutorHttpUtility.$R(a,false,false);b.setRequestHeader("X-SP-Context",g)}}};SP.RequestExecutorMessageProcessor.$1n=function(b){ULSgsX:;if(!SP.RequestExecutorMessageProcessor.$Z)SP.RequestExecutorMessageProcessor.$Z={};b=SP.RequestExecutorMessageProcessor.$16(b);var a=SP.RequestExecutorMessageProcessor.$Z[b];if(!a)return null;var c=new Date;return a.expiration<c.getTime()?null:a.digestValue};SP.RequestExecutorMessageProcessor.$16=function(a){ULSgsX:;var d=a,b;b=a.indexOf("?");if(b>0)a=a.substr(0,b);b=a.indexOf("#");if(b>0)a=a.substr(0,b);a=a.toLowerCase();b=a.indexOf("/_layouts");if(b>0)a=a.substr(0,b);b=a.indexOf("/_vti_");if(b>0)a=a.substr(0,b);b=a.indexOf("/_api");if(b>0)a=a.substr(0,b);var c=d.substr(0,a.length);if(c.charAt(a.length-1)!=="/")c=c+"/";c+="_api/contextinfo";return c};SP.RequestExecutorMessageProcessor.init=function(a){ULSgsX:;SP.RequestExecutor.$1("RequestExecutorMessageProcessor.Init");if(!a)a=new SP.RequestExecutorMessageProcessorInitInfo;SP.RequestExecutorMessageProcessor.$C=a;if(SP.RequestExecutorUtility.$9(SP.RequestExecutorMessageProcessor.$C.formDigestHandlingEnabled))SP.RequestExecutorMessageProcessor.$C.formDigestHandlingEnabled=false;if(SP.RequestExecutorUtility.$9(SP.RequestExecutorMessageProcessor.$C.initErrorCode))SP.RequestExecutorMessageProcessor.$C.initErrorCode=0;if(SP.RequestExecutorUtility.$9(SP.RequestExecutorMessageProcessor.$C.initErrorMessage))SP.RequestExecutorMessageProcessor.$C.initErrorMessage="";if(!SP.RequestExecutorMessageProcessor.$W){var b=window.SP.RequestExecutorMessageProcessor.internalOnMessage;if(window.addEventListener){window.addEventListener("message",b,false);SP.RequestExecutorMessageProcessor.$W=true;SP.RequestExecutor.$1("RequestExecutorMessageProcessor.addEventListener")}else if(window.attachEvent){window.attachEvent("onmessage",b);SP.RequestExecutorMessageProcessor.$W=true;SP.RequestExecutor.$1("RequestExecutorMessageProcessor.attachEvent")}}};SP.RequestExecutorMessageProcessor.internalOnMessage=function(g){ULSgsX:;SP.RequestExecutor.$1("RequestExecutorMessageProcessor.OnMessage");if(SP.RequestExecutorUtility.$0(g)){SP.RequestExecutor.$1("RequestExecutorMessageProcessor.OnMessage: Message is null.");return}var a=SP.RequestExecutorMessageProcessor.$C;if(!a){SP.RequestExecutor.$1("RequestExecutorMessageProcessor.OnMessage: Setting is null.");return}var d=g.data,c=g.origin;SP.RequestExecutor.$1("RequestExecutorMessageProcessor.OnMessage: Message.data="+d);SP.RequestExecutor.$1("RequestExecutorMessageProcessor.OnMessage: Message.origin="+c);if(SP.RequestExecutorUtility.$2(c)){SP.RequestExecutor.$1("RequestExecutorMessageProcessor.OnMessage: Message.origin is null");return}if(SP.RequestExecutorUtility.$2(d)){SP.RequestExecutor.$1("RequestExecutorMessageProcessor.OnMessage: Message.data is null");return}var b=JSON.parse(d);if(SP.RequestExecutorUtility.$0(b)){SP.RequestExecutor.$1("RequestExecutorMessageProcessor.OnMessage: Unable to parse data:"+d);return}if(SP.RequestExecutorUtility.$2(b.postMessageId)){SP.RequestExecutor.$1("RequestExecutorMessageProcessor.OnMessage: There is no postMesageId property");return}if(b.postMessageId.substr(0,SP.RequestExecutorInternalSharedUtility.$j.length)!==SP.RequestExecutorInternalSharedUtility.$j){SP.RequestExecutor.$1("RequestExecutorMessageProcessor.OnMessage: Unknown postMessageId");return}if(SP.RequestExecutorUtility.$2(b.command)){SP.RequestExecutor.$1("RequestExecutorMessageProcessor.OnMessage: command property is null");return}if(b.command==="Ping"){SP.RequestExecutor.$1("RequestExecutorMessageProcessor.OnMessage: Processing ping command");SP.RequestExecutorMessageProcessor.$n(b,a.initErrorCode,a.initErrorMessage,c);return}if(b.command!=="Query"){SP.RequestExecutor.$1("RequestExecutorMessageProcessor.OnMessage: Unknown command");return}if(a.initErrorCode<0){SP.RequestExecutorMessageProcessor.$n(b,a.initErrorCode,a.initErrorMessage,c);return}if((!a.trustedOriginAuthorities||!a.trustedOriginAuthorities.length)&&!a.originAuthorityValidator){SP.RequestExecutorMessageProcessor.$n(b,SP.RequestExecutorErrors.noTrustedOrigins,SP.RequestExecutorResources.getString("RE_NoTrustedOrigins"),c);return}var e=false,h=SP.RequestExecutorInternalSharedUtility.$1r(c).toLowerCase();if(a.trustedOriginAuthorities)for(var f=0;f<a.trustedOriginAuthorities.length;f++){var k=a.trustedOriginAuthorities[f].toLowerCase();if(k===h){e=true;break}}if(!e&&a.originAuthorityValidator)e=a.originAuthorityValidator(h);if(!e){SP.RequestExecutorMessageProcessor.$n(b,SP.RequestExecutorErrors.domainDoesNotMatch,SP.RequestExecutorResources.getString("RE_DomainDoesNotMatch"),c);return}if(SP.RequestExecutorUtility.$17(b.url,b.method)){SP.RequestExecutor.$1("RequestExecutorMessageProcessor.OnMessage: Empty Url or Method");SP.RequestExecutorMessageProcessor.$n(b,a.initErrorCode,a.initErrorMessage,c);return}var i=new SP.RequestExecutorMessageProcessor(c,b),j=0;if(j>0)window.setTimeout(function(){ULSgsX:;i.$1Y_0()},j);else i.$1Y_0()};SP.RequestExecutorMessageProcessor.$n=function(b,c,d,e){ULSgsX:;var a=new SP.PostMessageResponseInfo;a.command=b.command;a.postMessageId=b.postMessageId;a.responseAvailable=false;a.errorCode=c;a.errorMessage=d;SP.RequestExecutorMessageProcessor.$F(a,e)};SP.RequestExecutorMessageProcessor.prototype={$K_0:null,$3_0:null,$L_0:0,$5_0:null,$1Y_0:function(){ULSgsX:;if(this.$3_0.method==="GET"||!SP.RequestExecutorMessageProcessor.$C.formDigestHandlingEnabled)this.$18_0(null);else{var a=SP.RequestExecutorMessageProcessor.$1n(this.$3_0.url);if(SP.RequestExecutorUtility.$2(a))this.$1k_0();else this.$18_0(a)}},$1k_0:function(){ULSgsX:;var c=SP.RequestExecutorMessageProcessor.$16(this.$3_0.url);c=SP.RequestExecutorUtility.$g(c);var a=SP.RequestExecutor.$u();a.open("POST",c);a.setRequestHeader("ACCEPT","application/json;odata=verbose");var e=SP.RequestExecutorUtility.$1R(this.$3_0.headers,"x-clientservice-clienttag");!SP.RequestExecutorUtility.$2(e)&&a.setRequestHeader("x-clientservice-clienttag",e);SP.RequestExecutorMessageProcessor.$1c(a,this.$3_0.accessToken);if(this.$3_0.timeout>0){var d=this;this.$L_0=window.setTimeout(function(){ULSgsX:;a.onreadystatechange=SP.RequestExecutorNative.emptyCallback;a.abort();var b=new SP.PostMessageResponseInfo;b.command="Query";b.errorCode=SP.RequestExecutorErrors.requestAbortedOrTimedout;b.errorMessage=SP.RequestExecutorResources.getString("RE_RequestAbortedOrTimedout");b.postMessageId=d.$3_0.postMessageId;b.responseAvailable=false;SP.RequestExecutorMessageProcessor.$F(b,d.$K_0)},this.$3_0.timeout)}var b=this;a.onreadystatechange=function(){ULSgsX:;if(a&&a.readyState===4){if(b.$L_0){window.clearTimeout(b.$L_0);b.$L_0=0}a.onreadystatechange=SP.RequestExecutorNative.emptyCallback;b.$1l_0(a)}};a.send("")},$1l_0:function(a){ULSgsX:;if(a.status!==200){var d=this.$h_0(a);d.errorCode=SP.RequestExecutorErrors.httpError;var l=SP.RequestExecutorResources.getString("RE_RequestUnexpectedResponseWithContentTypeAndStatus");d.errorMessage=SP.RequestExecutorUtility.$T(l,a.getResponseHeader("content-type"),a.status.toString());SP.RequestExecutorMessageProcessor.$F(d,this.$K_0);return}var i=a.getResponseHeader("content-type");if(SP.RequestExecutorUtility.$2(i)||i.toLowerCase().indexOf("json")<0){var e=this.$h_0(a);e.errorCode=SP.RequestExecutorErrors.unexpectedResponse;e.errorMessage=SP.RequestExecutorResources.getString("RE_RequestUnexpectedResponse");SP.RequestExecutorMessageProcessor.$F(e,this.$K_0);return}var j=a.getResponseHeader("SharePointError");if(!SP.RequestExecutorUtility.$2(j)){var f=this.$h_0(a);f.errorCode=SP.RequestExecutorErrors.unexpectedResponse;f.errorMessage=SP.RequestExecutorResources.getString("RE_RequestUnexpectedResponse");SP.RequestExecutorMessageProcessor.$F(f,this.$K_0);return}var c=JSON.parse(a.responseText);if(SP.RequestExecutorUtility.$0(c)){var g=this.$h_0(a);g.errorCode=SP.RequestExecutorErrors.unexpectedResponse;g.errorMessage=SP.RequestExecutorResources.getString("RE_RequestUnexpectedResponse");SP.RequestExecutorMessageProcessor.$F(g,this.$K_0);return}var b=new SP.RequestExecutorMessageProcessorFormDigestInfo;try{b.digestValue=c.d.GetContextWebInformation.FormDigestValue;var m=c.d.GetContextWebInformation.FormDigestTimeoutSeconds;b.expiration=+new Date+m*750}catch(n){var h=this.$h_0(a);h.errorCode=SP.RequestExecutorErrors.unexpectedResponse;h.errorMessage=SP.RequestExecutorResources.getString("RE_RequestUnexpectedResponse");SP.RequestExecutorMessageProcessor.$F(h,this.$K_0);return}if(!SP.RequestExecutorMessageProcessor.$Z)SP.RequestExecutorMessageProcessor.$Z={};var k=SP.RequestExecutorMessageProcessor.$16(this.$3_0.url);SP.RequestExecutorMessageProcessor.$Z[k]=b;this.$18_0(b.digestValue)},$h_0:function(b){ULSgsX:;var a=new SP.PostMessageResponseInfo;a.command="Query";a.errorCode=0;a.errorMessage=null;a.postMessageId=this.$3_0.postMessageId;a.responseAvailable=true;a.statusText=b.statusText;a.statusCode=b.status;a.contentType=b.getResponseHeader("content-type");a.allResponseHeaders=b.getAllResponseHeaders();a.responseText=b.responseText;return a},$18_0:function(g){ULSgsX:;this.$5_0=SP.RequestExecutor.$u();var b=this.$3_0.url;b=SP.RequestExecutorUtility.$g(b);this.$5_0.open(this.$3_0.method,b);var f=false;if(this.$3_0.headers){var d=this.$3_0.headers;for(var e in d){var c={key:e,value:d[e]};if(c.key.toLowerCase()==="x-requestdigest")f=true;this.$5_0.setRequestHeader(c.key,c.value)}}!f&&!SP.RequestExecutorUtility.$2(g)&&this.$5_0.setRequestHeader("X-RequestDigest",g);SP.RequestExecutorMessageProcessor.$1c(this.$5_0,this.$3_0.accessToken);this.$3_0.binaryStringResponseBody&&SP.RequestExecutorInternalSharedUtility.$1d(this.$5_0);if(this.$3_0.timeout>0){var h=this;this.$L_0=window.setTimeout(function(){ULSgsX:;h.$21_0()},this.$3_0.timeout)}var i=this;this.$5_0.onreadystatechange=function(){ULSgsX:;i.$20_0()};var a;if(this.$3_0.binaryStringRequestBody)a=SP.RequestExecutorInternalSharedUtility.$1M(this.$3_0.body);else a=this.$3_0.body;if(SP.RequestExecutorUtility.$0(a))a="";this.$5_0.send(a)},$21_0:function(){ULSgsX:;if(this.$5_0){this.$5_0.onreadystatechange=SP.RequestExecutorNative.emptyCallback;this.$5_0.abort();var a=new SP.PostMessageResponseInfo;a.command="Query";a.errorCode=SP.RequestExecutorErrors.requestAbortedOrTimedout;a.errorMessage=SP.RequestExecutorResources.getString("RE_RequestAbortedOrTimedout");a.postMessageId=this.$3_0.postMessageId;a.responseAvailable=false;SP.RequestExecutorMessageProcessor.$F(a,this.$K_0)}},$20_0:function(){ULSgsX:;if(this.$5_0&&this.$5_0.readyState===4){if(this.$L_0){window.clearTimeout(this.$L_0);this.$L_0=0}this.$5_0.onreadystatechange=SP.RequestExecutorNative.emptyCallback;var a=new SP.PostMessageResponseInfo;a.command="Query";a.errorCode=0;a.errorMessage=null;a.postMessageId=this.$3_0.postMessageId;a.responseAvailable=true;a.statusText=this.$5_0.statusText;a.statusCode=this.$5_0.status;a.contentType=this.$5_0.getResponseHeader("content-type");a.allResponseHeaders=this.$5_0.getAllResponseHeaders();a.binaryStringResponseBody=this.$3_0.binaryStringResponseBody;if(this.$3_0.binaryStringResponseBody)a.responseText=SP.RequestExecutorInternalSharedUtility.$1L(this.$5_0.response);else a.responseText=this.$5_0.responseText;SP.RequestExecutorMessageProcessor.$F(a,this.$K_0)}}};SP.RequestExecutorNotificationPanel=function(){};SP.RequestExecutorNotificationPanel.$22=function(e){ULSgsX:;if(!SP.RequestExecutorNotificationPanel.$M)SP.RequestExecutorNotificationPanel.$M={};if(SP.RequestExecutorUtility.$0(SP.RequestExecutorNotificationPanel.$M[e])){SP.RequestExecutorNotificationPanel.$M[e]=SP.RequestExecutorNotificationPanel.$1G;SP.RequestExecutorNotificationPanel.$1G++}var b=SP.RequestExecutorNotificationPanel.$M[e],a=document.getElementById("SP_RequestExecutor_NotificationPanel"+b.toString());if(a)return;a=document.createElement("DIV");a.id="SP_RequestExecutor_NotificationPanel"+b.toString();a.style.position="absolute";a.style.width="420px";a.style.borderStyle="solid";a.style.borderWidth="1px";a.style.padding="5px";a.className="ms-subtleEmphasis";var f=SP.RequestExecutorNotificationPanel.$1s()+30,c=SP.RequestExecutorNotificationPanel.$1o()+SP.RequestExecutorNotificationPanel.$1t()-420-50;if(c<0)c=0;a.style.left=c.toString()+"px";a.style.top=f.toString()+"px";var g=SP.RequestExecutorUtility.$i(SP.RequestExecutorResources.getString("RE_OpenWindowMessage")),h="<input type='button' onclick='SP.RequestExecutor.internalLoginButtonHandler("+b.toString()+");return false;' value='"+SP.RequestExecutorUtility.$i(SP.RequestExecutorResources.getString("RE_OpenWindowButtonText"))+"' />",i="<a href='#' onclick='SP.RequestExecutor.internalCancelButtonHandler("+b.toString()+");return false;'>"+SP.RequestExecutorUtility.$i(SP.RequestExecutorResources.getString("RE_DismissOpenWindowMessageLinkText"))+"</a>",d=SP.RequestExecutorUtility.$i(SP.RequestExecutorResources.getString("RE_FixitHelpMessage"));d=SP.RequestExecutorUtility.$T(d,"<a href='http://go.microsoft.com/fwlink/?LinkId=255261' target='_blank'>","</a>");a.innerHTML="<div class='ms-textXLarge ms-error'>"+g+"</div><div style='padding-top:5px'>"+h+"<span style='width:15px'>&#160;&#160;&#160;</span>"+i+"</div><div style='padding-top:5px'><span class='ms-metadata'>"+d+"</span></div>";document.body.appendChild(a);!SP.RequestExecutorNotificationPanel.$1a&&window.setTimeout(function(){ULSgsX:;SP.RequestExecutor.internalCancelButtonHandler(b)},12e4)};SP.RequestExecutorNotificationPanel.$1Q=function(d){ULSgsX:;if(SP.RequestExecutorNotificationPanel.$M){var a=SP.RequestExecutorNotificationPanel.$M;for(var b in a){var c={key:b,value:a[b]};if(c.value===d)return c.key}}return null};SP.RequestExecutorNotificationPanel.$1E=function(b){ULSgsX:;var a=document.getElementById("SP_RequestExecutor_NotificationPanel"+b.toString());a&&a.parentNode.removeChild(a)};SP.RequestExecutorNotificationPanel.$1y=function(b){ULSgsX:;if(SP.RequestExecutorNotificationPanel.$M){var a=SP.RequestExecutorNotificationPanel.$M[b];!SP.RequestExecutorUtility.$0(a)&&SP.RequestExecutorNotificationPanel.$1E(a)}};SP.RequestExecutorNotificationPanel.$1I=function(a,b){ULSgsX:;if(!SP.RequestExecutorNotificationPanel.$Y)SP.RequestExecutorNotificationPanel.$Y={};SP.RequestExecutorNotificationPanel.$Y[a]=b};SP.RequestExecutorNotificationPanel.$1q=function(a){ULSgsX:;if(!SP.RequestExecutorNotificationPanel.$Y)SP.RequestExecutorNotificationPanel.$Y={};return SP.RequestExecutorNotificationPanel.$Y[a]};SP.RequestExecutorNotificationPanel.$1t=function(){ULSgsX:;var a=window.innerWidth;if(SP.RequestExecutorUtility.$0(a))a=document.documentElement.clientWidth;if(SP.RequestExecutorUtility.$0(a))a=document.body.clientWidth;return a};SP.RequestExecutorNotificationPanel.$1o=function(){ULSgsX:;var a=window.pageXOffset;return!SP.RequestExecutorUtility.$0(a)?a:!SP.RequestExecutorUtility.$0(document.documentElement)&&!SP.RequestExecutorUtility.$0(document.documentElement.scrollLeft)?document.documentElement.scrollLeft:document.body.scrollLeft};SP.RequestExecutorNotificationPanel.$1s=function(){ULSgsX:;var a=window.pageYOffset;return!SP.RequestExecutorUtility.$0(a)?a:!SP.RequestExecutorUtility.$0(document.documentElement)&&!SP.RequestExecutorUtility.$0(document.documentElement.scrollTop)?document.documentElement.scrollTop:document.body.scrollTop};SP.RequestExecutorNative=function(){};SP.RequestExecutorNative.$$cctor=function(){ULSgsX:;SP.RequestExecutorNative.emptyCallback=function(){}};SP.RequestExecutorNative.getIFrameOnloadCallback=function(a){ULSgsX:;return function(){ULSgsX:;SP.RequestExecutor.internalProcessIFrameOnload(a)}};SP.RequestExecutorNative.getXMLHttpRequestOnreadystatechangeCallback=function(a,b,c){ULSgsX:;return function(){ULSgsX:;SP.RequestExecutor.internalProcessXMLHttpRequestOnreadystatechange(a,b,c)}};SP.RequestExecutorNative.getXMLHttpRequestTimeoutCallback=function(a,b){ULSgsX:;return function(){ULSgsX:;SP.RequestExecutor.internalProcessXMLHttpRequestTimeoutCallback(a,b)}};SP.RequestExecutorNative.getIFrameRequestTimeoutCallback=function(a){ULSgsX:;return function(){ULSgsX:;SP.RequestExecutor.internalProcessIFrameRequestTimeoutCallback(a)}};SP.RequestExecutorNative.getProxyWebRequestExecutorSuccessCallback=function(a){ULSgsX:;return function(b){ULSgsX:;SP.ProxyWebRequestExecutorInternal.processSuccessCallback(a,b)}};SP.RequestExecutorNative.getProxyWebRequestExecutorErrorCallback=function(a){ULSgsX:;return function(b,c,d){ULSgsX:;SP.ProxyWebRequestExecutorInternal.processErrorCallback(a,b,c,d)}};SP.RequestExecutorNative.trim=function(a){ULSgsX:;return a.replace(new RegExp("^\\s+|\\s+$","g"),"")};SP.RequestExecutorResources=function(){};SP.RequestExecutorResources.getString=function(b){ULSgsX:;var a=null,c=b.charAt(0).toString().toLowerCase()+b.substr(1),d=b.substr(0,2).toLowerCase()+b.substr(2);if(!SP.RequestExecutorUtility.$0(SP.Res)){a=SP.Res[c];if(SP.RequestExecutorUtility.$2(a))a=SP.Res[d]}if(SP.RequestExecutorUtility.$2(a)&&!SP.RequestExecutorUtility.$0(SP.RuntimeRes))a=SP.RuntimeRes[c];if(SP.RequestExecutorUtility.$2(a))a=SP.RequestExecutorRes[c];if(SP.RequestExecutorUtility.$2(a))a=b;return a};SP.RequestExecutorUtility=function(){};SP.RequestExecutorUtility.$2=function(a){ULSgsX:;var b=null;return a===b||typeof a==="undefined"||!a.length};SP.RequestExecutorUtility.$0=function(a){ULSgsX:;var b=null;return a===b||typeof a==="undefined"};SP.RequestExecutorUtility.$9=function(a){ULSgsX:;return typeof a==="undefined"};SP.RequestExecutorUtility.$T=function(d){ULSgsX:;for(var g=[],e=1;e<arguments.length;++e)g[e-1]=arguments[e];var a="",b=0;while(b<d.length){var c=SP.RequestExecutorUtility.$1P(d,b,"{");if(c<0){a=a+d.substr(b);break}else{var f=SP.RequestExecutorUtility.$1P(d,c,"}");if(f>c){a=a+d.substr(b,c-b);var h=d.substr(c+1,f-c-1),i=parseInt(h);a=a+g[i];b=f+1}else throw SP.RequestExecutorUtility.$11();}}return a};SP.RequestExecutorUtility.$1P=function(b,c,d){ULSgsX:;var a=b.indexOf(d,c);while(a>=0&&a<b.length-1&&b.charAt(a+1)===d){c=a+2;a=b.indexOf(d,c)}return a};SP.RequestExecutorUtility.$G=function(a){ULSgsX:;var b;b=a.indexOf("#");if(b>=0)throw SP.RequestExecutorUtility.$S(SP.RequestExecutorUtility.$T(SP.RequestExecutorResources.getString("RE_InvalidArgumentOrField"),"url"),SP.RequestExecutorExceptions.invalidArgumentOrField);b=a.indexOf("?");if(b<0)a=a+"?";else if(a.charAt(a.length-1)!=="&")a=a+"&";return a};SP.RequestExecutorUtility.$X=function(a,b){ULSgsX:;if(!SP.RequestExecutorUtility.$1T(a))throw SP.RequestExecutorUtility.$J(b);};SP.RequestExecutorUtility.$1T=function(a){ULSgsX:;return a.substr(0,8).toLowerCase()==="https://"||a.substr(0,7).toLowerCase()==="http://"};SP.RequestExecutorUtility.$6=function(a,b,c,d){ULSgsX:;if(d){if(SP.RequestExecutorUtility.$0(a)||typeof a!==c)throw SP.RequestExecutorUtility.$S(SP.RequestExecutorUtility.$T(SP.RequestExecutorResources.getString("RE_InvalidArgumentOrField"),b),SP.RequestExecutorExceptions.invalidArgumentOrField);}else if(!SP.RequestExecutorUtility.$0(a)&&typeof a!==c)throw SP.RequestExecutorUtility.$S(SP.RequestExecutorUtility.$T(SP.RequestExecutorResources.getString("RE_InvalidArgumentOrField"),b),SP.RequestExecutorExceptions.invalidArgumentOrField);};SP.RequestExecutorUtility.$S=function(b,c){ULSgsX:;var a=new Error(b);a.message=b;a.errorCode=c;return a};SP.RequestExecutorUtility.$J=function(b){ULSgsX:;var a=SP.RequestExecutorUtility.$T(SP.RequestExecutorResources.getString("RE_InvalidArgumentOrField"),b);return SP.RequestExecutorUtility.$S(a,SP.RequestExecutorExceptions.invalidArgumentOrField)};SP.RequestExecutorUtility.$11=function(){ULSgsX:;var a=SP.RequestExecutorResources.getString("RE_InvalidOperation");return SP.RequestExecutorUtility.$S(a,SP.RequestExecutorExceptions.invalidOperation)};SP.RequestExecutorUtility.$10=function(){ULSgsX:;var a=SP.RequestExecutorResources.getString("RE_BrowserNotSupported");return SP.RequestExecutorUtility.$S(a,SP.RequestExecutorExceptions.browserNotSupported)};SP.RequestExecutorUtility.$12=function(){ULSgsX:;var a=SP.RequestExecutorResources.getString("RE_BrowserBinaryDataNotSupported");return SP.RequestExecutorUtility.$S(a,SP.RequestExecutorExceptions.browserNotSupported)};SP.RequestExecutorUtility.$g=function(a){ULSgsX:;return SP.RequestExecutorHttpUtility.$R(a,true,true)};SP.RequestExecutorUtility.$i=function(a){ULSgsX:;a=a.replace(new RegExp("&","g"),"&amp;");a=a.replace(new RegExp('"',"g"),"&quot;");a=a.replace(new RegExp("'","g"),"&#39;");a=a.replace(new RegExp("<","g"),"&lt;");a=a.replace(new RegExp(">","g"),"&gt;");return a};SP.RequestExecutorUtility.$1R=function(e,a){ULSgsX:;if(!e)return null;if(!a)return null;a=a.toLowerCase();var c=e;for(var d in c){var b={key:d,value:c[d]};if(!SP.RequestExecutorUtility.$2(b.key)&&b.key.toLowerCase()===a)return b.value}return null};SP.RequestExecutorUtility.$17=function(a,b){ULSgsX:;return SP.RequestExecutorUtility.$2(a)&&SP.RequestExecutorUtility.$2(b)};SP.RequestExecutorRes=function(){};SP.RequestExecutorHttpUtility=function(){};SP.RequestExecutorHttpUtility.$R=function(e,j,k){ULSgsX:;var c="",b,d=0,g=" \"%<>'&",h=null;if(e===h||typeof e==="undefined"||!e.length)return"";for(d=0;d<e.length;d++){var a=e.charCodeAt(d),f=e.charAt(d);if(j&&(f==="#"||f==="?")){c+=e.substr(d);break}if(a<=127){if(k)c+=f;else if(a>=97&&a<=122||a>=65&&a<=90||a>=48&&a<=57||a>=32&&a<=95&&g.indexOf(f)<0)c+=f;else if(a<=15)c+="%0"+a.toString(16).toUpperCase();else if(a<=127)c+="%"+a.toString(16).toUpperCase()}else if(a<=2047){b=192|a>>6;c+="%"+b.toString(16).toUpperCase();b=128|a&63;c+="%"+b.toString(16).toUpperCase()}else if((a&64512)!==55296){b=224|a>>12;c+="%"+b.toString(16).toUpperCase();b=128|(a&4032)>>6;c+="%"+b.toString(16).toUpperCase();b=128|a&63;c+="%"+b.toString(16).toUpperCase()}else if(d<e.length-1){a=(a&1023)<<10;d++;var i=e.charCodeAt(d);a|=i&1023;a+=65536;b=240|a>>18;c+="%"+b.toString(16).toUpperCase();b=128|(a&258048)>>12;c+="%"+b.toString(16).toUpperCase();b=128|(a&4032)>>6;c+="%"+b.toString(16).toUpperCase();b=128|a&63;c+="%"+b.toString(16).toUpperCase()}}return c};SP.PostMessageRequestInfo.registerClass&&SP.PostMessageRequestInfo.registerClass("SP.PostMessageRequestInfo");SP.PostMessageResponseInfo.registerClass&&SP.PostMessageResponseInfo.registerClass("SP.PostMessageResponseInfo");SP.RequestInfo.registerClass&&SP.RequestInfo.registerClass("SP.RequestInfo");SP.AppWebProxyRequestInfo.registerClass&&SP.AppWebProxyRequestInfo.registerClass("SP.AppWebProxyRequestInfo");SP.ResponseInfo.registerClass&&SP.ResponseInfo.registerClass("SP.ResponseInfo");SP.RequestExecutorOptions.registerClass&&SP.RequestExecutorOptions.registerClass("SP.RequestExecutorOptions");SP.RequestExecutorMessageProcessorFormDigestInfo.registerClass&&SP.RequestExecutorMessageProcessorFormDigestInfo.registerClass("SP.RequestExecutorMessageProcessorFormDigestInfo");SP.RequestExecutorMessageProcessorInitInfo.registerClass&&SP.RequestExecutorMessageProcessorInitInfo.registerClass("SP.RequestExecutorMessageProcessorInitInfo");SP.PostMessageCommands.registerClass&&SP.PostMessageCommands.registerClass("SP.PostMessageCommands");SP.ProxyWebRequestExecutorInternal.registerClass&&SP.ProxyWebRequestExecutorInternal.registerClass("SP.ProxyWebRequestExecutorInternal");SP.ProxyWebRequestExecutor.registerClass&&SP.ProxyWebRequestExecutor.registerClass("SP.ProxyWebRequestExecutor",Sys.Net.WebRequestExecutor);SP.ProxyWebRequestExecutorFactory.registerClass&&SP.ProxyWebRequestExecutorFactory.registerClass("SP.ProxyWebRequestExecutorFactory");SP.RequestExecutor.registerClass&&SP.RequestExecutor.registerClass("SP.RequestExecutor");SP.RequestExecutorXHR.registerClass&&SP.RequestExecutorXHR.registerClass("SP.RequestExecutorXHR");SP.RequestExecutorErrors.registerClass&&SP.RequestExecutorErrors.registerClass("SP.RequestExecutorErrors");SP.RequestExecutorExceptions.registerClass&&SP.RequestExecutorExceptions.registerClass("SP.RequestExecutorExceptions");SP.RequestExecutorInternalSharedUtility.registerClass&&SP.RequestExecutorInternalSharedUtility.registerClass("SP.RequestExecutorInternalSharedUtility");SP.RequestExecutorMessageProcessor.registerClass&&SP.RequestExecutorMessageProcessor.registerClass("SP.RequestExecutorMessageProcessor");SP.RequestExecutorNotificationPanel.registerClass&&SP.RequestExecutorNotificationPanel.registerClass("SP.RequestExecutorNotificationPanel");SP.RequestExecutorNative.registerClass&&SP.RequestExecutorNative.registerClass("SP.RequestExecutorNative");SP.RequestExecutorResources.registerClass&&SP.RequestExecutorResources.registerClass("SP.RequestExecutorResources");SP.RequestExecutorUtility.registerClass&&SP.RequestExecutorUtility.registerClass("SP.RequestExecutorUtility");SP.RequestExecutorRes.registerClass&&SP.RequestExecutorRes.registerClass("SP.RequestExecutorRes");SP.RequestExecutorHttpUtility.registerClass&&SP.RequestExecutorHttpUtility.registerClass("SP.RequestExecutorHttpUtility");function sp_requestexecutor_initialize(){ULSgsX:;SP.PostMessageCommands.ping="Ping";SP.PostMessageCommands.query="Query";SP.RequestExecutor.$E=null;SP.RequestExecutor.$l=null;SP.RequestExecutor.$V=null;SP.RequestExecutor.$Q=null;SP.RequestExecutor.$N=null;SP.RequestExecutor.$I=null;SP.RequestExecutor.$B=null;SP.RequestExecutor.$a=null;SP.RequestExecutor.$P=null;SP.RequestExecutor.$H=null;SP.RequestExecutor.$4=null;SP.RequestExecutor.$m=0;SP.RequestExecutor.$W=false;SP.RequestExecutor.logCallback=null;SP.RequestExecutor.$k=null;SP.RequestExecutor.$d=null;SP.RequestExecutor.$1H=false;SP.RequestExecutor.$f=null;SP.RequestExecutor.$e=null;SP.RequestExecutorXHR.UNSENT=0;SP.RequestExecutorXHR.OPENED=1;SP.RequestExecutorXHR.DONE=4;SP.RequestExecutorErrors.requestAbortedOrTimedout=-1001;SP.RequestExecutorErrors.unexpectedResponse=-1002;SP.RequestExecutorErrors.httpError=-1002;SP.RequestExecutorErrors.noAppWeb=-1003;SP.RequestExecutorErrors.domainDoesNotMatch=-1004;SP.RequestExecutorErrors.noTrustedOrigins=-1005;SP.RequestExecutorErrors.iFrameLoadError=-1006;SP.RequestExecutorErrors.proxyPageLoadError=-1007;SP.RequestExecutorErrors.anonymousRequest=-1008;SP.RequestExecutorExceptions.invalidArgumentOrField=-2001;SP.RequestExecutorExceptions.invalidOperation=-2002;SP.RequestExecutorExceptions.browserNotSupported=-2003;SP.RequestExecutorInternalSharedUtility.$j="SP.RequestExecutor";SP.RequestExecutorMessageProcessor.$Z=null;SP.RequestExecutorMessageProcessor.$C=null;SP.RequestExecutorMessageProcessor.$W=false;SP.RequestExecutorNotificationPanel.$M=null;SP.RequestExecutorNotificationPanel.$1G=0;SP.RequestExecutorNotificationPanel.$Y=null;SP.RequestExecutorNotificationPanel.$1a=false;SP.RequestExecutorNative.emptyCallback=null;SP.RequestExecutorNative.$$cctor();SP.RequestExecutorRes.rE_NoTrustedOrigins="There is no trusted URLs configured for the app deployment.";SP.RequestExecutorRes.rE_InvalidOperation="Invalid operation.";SP.RequestExecutorRes.rE_CannotAccessSiteOpenWindowFailed='This page cannot open a window to access the web site "{0}" or it cannot reference the opened window. Please browse to that web site, and then browse to this page again.';SP.RequestExecutorRes.rE_OpenWindowButtonText="Fix It";SP.RequestExecutorRes.rE_BrowserNotSupported="The required functionalities are not supported by your browser. Please make sure you are using IE 8 or above, or other modern browser. Please make sure the 'X-UA-Compatible' meta tag is set to be 'IE=8' or above.";SP.RequestExecutorRes.rE_RequestUnexpectedResponseWithContentTypeAndStatus='Unexpected response from the server. The content type of the response is "{0}". The status code is "{1}".';SP.RequestExecutorRes.rE_InvalidArgumentOrField="Invalid field or parameter {0}.";SP.RequestExecutorRes.rE_OpenWindowMessage="Sorry, we had some trouble accessing your site.";SP.RequestExecutorRes.rE_CannotAccessSite='This page cannot access the web site "{0}". Please browse to that web site, and then browse to this page again.';SP.RequestExecutorRes.rE_RequestAbortedOrTimedout="The request was aborted or timed out.";SP.RequestExecutorRes.rE_DismissOpenWindowMessageLinkText="Dismiss";SP.RequestExecutorRes.rE_BrowserBinaryDataNotSupported="Your browser doesn't support some HTML5 features like the File API operations. Please use a browser that does support these features.";SP.RequestExecutorRes.rE_CannotAccessSiteCancelled='This page cannot access the web site "{0}". The login is cancelled or timed out. Please browse to that web site, and then browse to this page again.';SP.RequestExecutorRes.rE_FixitHelpMessage='If the "Fix it" button doesn\'t solve the issue, {0}click here for more information{1}.';SP.RequestExecutorRes.rE_RequestUnexpectedResponse="Unexpected response from server.";SP.RequestExecutorRes.rE_DomainDoesNotMatch="Your domain doesn't match the expected domain for this app deployment."}sp_requestexecutor_initialize();function sp_requestexecutor_attachloadevent(){ULSgsX:;if(window.document.addEventListener)window.addEventListener("load",SP.RequestExecutor.internalProcessWindowLoad,false);else window.document.attachEvent&&window.attachEvent("onload",SP.RequestExecutor.internalProcessWindowLoad)}sp_requestexecutor_attachloadevent();function sp_requestexecutor_initialize2(){ULSgsX:;sp_requestexecutor_initialize();sp_requestexecutor_attachloadevent()}typeof RegisterModuleInit=="function"&&RegisterModuleInit("sp.requestexecutor.js",sp_requestexecutor_initialize2);typeof Sys!="undefined"&&Sys&&Sys.Application&&Sys.Application.notifyScriptLoaded();typeof NotifyScriptLoadedAndExecuteWaitingJobs=="function"&&NotifyScriptLoadedAndExecuteWaitingJobs("sp.requestexecutor.js");typeof spWriteProfilerMark=="function"&&spWriteProfilerMark("perfMarkEnd_sp.requestexecutor.js");