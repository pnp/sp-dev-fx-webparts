{"version":3,"sources":["webpack:///../webpack/bootstrap acf93f1fccd12e588f91","webpack:///../webpack/bootstrap 795e6d067650f6b23263","webpack:///../webpack:///lib/local/bundles/index.js","webpack:///../webpack:///lib/local/bundles/platform-exports.js","webpack:///../webpack:///D:/agent/1/_work/24/s/common/~/@microsoft/loader-set-webpack-public-path/lib","webpack:///../webpack:///lib/local/framework/shell/ClientSideApplication.js","webpack:///../webpack:///lib/local/framework/shell/SuiteNavManagerConfiguration.js","webpack:///../webpack:///lib/local/common/suiteNav/models/SuiteNavLinkIds.js","webpack:///../webpack:///lib/local/framework/pageContext/AppPageContext.js","webpack:///../external \"@microsoft/sp-core-library\"","webpack:///../webpack:///lib/local/framework/pageContext/ApplicationContext.js","webpack:///../webpack:///lib/local/framework/pageContext/PageContextItem.js","webpack:///../webpack:///lib/local/framework/basicTypes/GuidHelpers.js","webpack:///../webpack:///lib/local/framework/pageContext/SPWeb.js","webpack:///../webpack:///lib/local/framework/basicTypes/url.js","webpack:///../webpack:///lib/local/framework/pageContext/SPSite.js","webpack:///../webpack:///lib/local/framework/pageContext/SPList.js","webpack:///../webpack:///lib/local/framework/pageContext/SPListItem.js","webpack:///../webpack:///lib/local/framework/pageContext/SPUser.js","webpack:///../webpack:///lib/local/framework/pageContext/SPNavigationNodeCollection.js","webpack:///../webpack:///lib/local/framework/pageContext/PageContextCore.js","webpack:///../external \"@microsoft/sp-page-context\"","webpack:///../webpack:///lib/local/framework/pageContext/SPNavigationNode.js","webpack:///../webpack:///lib/local/appBase/components/sp-canvas/canvas/canvas/Canvas.js","webpack:///../external \"react\"","webpack:///../external \"react-dom\"","webpack:///../webpack:///lib/local/appBase/components/sp-canvas/canvas/canvasComponent/CanvasComponent.js","webpack:///../external \"office-ui-fabric-react\"","webpack:///../webpack:///lib/local/appBase/components/sp-canvas/canvas/canvasControl/CanvasControlFactory.js","webpack:///../webpack:///lib/local/appBase/components/sp-canvas/canvas/canvasControl/CanvasControlType.js","webpack:///../webpack:///lib/local/appBase/components/sp-rte/rte/SPRte.js","webpack:///../webpack:///lib/local/appBase/components/sp-rte/ckeditor/CKTextEditor.js","webpack:///../external \"@ms/sp-telemetry\"","webpack:///../webpack:///lib/local/appBase/components/sp-rte/ckeditor/CKLoader.js","webpack:///../webpack:///D:/agent/1/_work/24/s/libraries/odsp-utilities-bundle/lib/index.js","webpack:///../webpack:///D:/agent/1/_work/24/s/libraries/sp-telemetry/lib/odsp-utilities/odsp-utilities-exporter.js","webpack:///../webpack:///D:/agent/1/_work/24/s/libraries/sp-telemetry/lib/odsp-utilities/odsp-utilities-telemetry.js","webpack:///../webpack:///D:/agent/1/_work/24/s/common/~/npmx-sp-pages/~/@ms/odsp-utilities/lib/logging/EventBase.js","webpack:///../webpack:///D:/agent/1/_work/24/s/common/~/npmx-sp-pages/~/@ms/odsp-utilities/lib/logging/Manager.js","webpack:///../webpack:///D:/agent/1/_work/24/s/common/~/npmx-sp-pages/~/@ms/odsp-utilities/lib/object/ObjectUtil.js","webpack:///../webpack:///D:/agent/1/_work/24/s/common/~/npmx-sp-pages/~/@ms/odsp-utilities/lib/encoding/UriEncoding.js","webpack:///../webpack:///D:/agent/1/_work/24/s/common/~/npmx-sp-pages/~/@ms/odsp-utilities/lib/logging/CorrelationVector.js","webpack:///../webpack:///D:/agent/1/_work/24/s/common/~/npmx-sp-pages/~/@ms/odsp-utilities/lib/guid/Guid.js","webpack:///../webpack:///D:/agent/1/_work/24/s/common/~/npmx-sp-pages/~/@ms/odsp-utilities/lib/logging/events/Engagement.event.js","webpack:///../webpack:///D:/agent/1/_work/24/s/common/~/npmx-sp-pages/~/@ms/odsp-utilities/lib/logging/SingleEventBase.js","webpack:///../webpack:///D:/agent/1/_work/24/s/common/~/npmx-sp-pages/~/@ms/odsp-utilities/lib/logging/events/Nav.event.js","webpack:///../webpack:///D:/agent/1/_work/24/s/common/~/npmx-sp-pages/~/@ms/odsp-utilities/lib/logging/events/PLTHttpRequest.event.js","webpack:///../webpack:///D:/agent/1/_work/24/s/common/~/npmx-sp-pages/~/@ms/odsp-utilities/lib/features/Features.js","webpack:///../webpack:///D:/agent/1/_work/24/s/common/~/npmx-sp-pages/~/@ms/odsp-utilities/lib/logging/events/Qos.event.js","webpack:///../webpack:///D:/agent/1/_work/24/s/common/~/npmx-sp-pages/~/@ms/odsp-utilities/lib/logging/PairedEventBase.js","webpack:///../webpack:///D:/agent/1/_work/24/s/common/~/npmx-sp-pages/~/@ms/odsp-utilities/lib/logging/events/ResultTypeEnum.js","webpack:///../webpack:///D:/agent/1/_work/24/s/common/~/npmx-sp-pages/~/@ms/odsp-utilities/lib/logging/ErrorHelper.js","webpack:///../webpack:///D:/agent/1/_work/24/s/common/~/npmx-sp-pages/~/@ms/odsp-utilities/lib/logging/events/CaughtError.event.js","webpack:///../webpack:///D:/agent/1/_work/24/s/common/~/npmx-sp-pages/~/@ms/odsp-utilities/lib/logging/events/QosError.event.js","webpack:///../webpack:///D:/agent/1/_work/24/s/common/~/npmx-sp-pages/~/@ms/odsp-utilities/lib/logging/events/Verbose.event.js","webpack:///../webpack:///D:/agent/1/_work/24/s/common/~/npmx-sp-pages/~/@ms/odsp-utilities/lib/store/CircularBuffer.js","webpack:///../webpack:///D:/agent/1/_work/24/s/common/~/npmx-sp-pages/~/@ms/odsp-utilities/lib/async/Async.js","webpack:///../webpack:///D:/agent/1/_work/24/s/common/~/npmx-sp-pages/~/@ms/odsp-utilities/lib/logging/rumone/APICallPerformanceData.js","webpack:///../webpack:///D:/agent/1/_work/24/s/common/~/npmx-sp-pages/~/@ms/odsp-utilities/lib/logging/rumone/RUMOneLogger.js","webpack:///../webpack:///D:/agent/1/_work/24/s/common/~/npmx-sp-pages/~/@ms/odsp-utilities/lib/logging/rumone/PageTransitionType.js","webpack:///../webpack:///D:/agent/1/_work/24/s/common/~/npmx-sp-pages/~/@ms/odsp-utilities/lib/logging/rumone/RUMOneSLAPI.js","webpack:///../webpack:///D:/agent/1/_work/24/s/common/~/npmx-sp-pages/~/@ms/odsp-utilities/lib/logging/rumone/RUMOneErrorsSLAPI.js","webpack:///../webpack:///D:/agent/1/_work/24/s/common/~/npmx-sp-pages/~/@ms/odsp-utilities/lib/logging/events/RUMOneDataUpload.event.js","webpack:///../webpack:///D:/agent/1/_work/24/s/common/~/npmx-sp-pages/~/@ms/odsp-utilities/lib/browser/PlatformDetection.js","webpack:///../webpack:///D:/agent/1/_work/24/s/common/~/npmx-sp-pages/~/@ms/odsp-utilities/lib/logging/odb/Beacon.js","webpack:///../webpack:///D:/agent/1/_work/24/s/common/~/npmx-sp-pages/~/@ms/odsp-utilities/lib/logging/BeaconBase.js","webpack:///../webpack:///D:/agent/1/_work/24/s/common/~/npmx-sp-pages/~/@ms/odsp-utilities/lib/logging/EventBatchCache.js","webpack:///../webpack:///D:/agent/1/_work/24/s/common/~/npmx-sp-pages/~/@ms/odsp-utilities/lib/logging/events/Beacon.event.js","webpack:///../webpack:///D:/agent/1/_work/24/s/common/~/npmx-sp-pages/~/@ms/odsp-utilities/lib/xhr/XHR.js","webpack:///../webpack:///D:/agent/1/_work/24/s/common/~/npmx-sp-pages/~/@ms/odsp-utilities/lib/logging/odb/BeaconCache.js","webpack:///../webpack:///D:/agent/1/_work/24/s/common/~/npmx-sp-pages/~/@ms/odsp-utilities/lib/models/store/BaseDataStore.js","webpack:///../webpack:///D:/agent/1/_work/24/s/common/~/npmx-sp-pages/~/@ms/odsp-utilities/lib/models/store/DataStoreCachingType.js","webpack:///../webpack:///D:/agent/1/_work/24/s/common/~/npmx-sp-pages/~/@ms/odsp-utilities/lib/logging/odb/LogProcessor.js","webpack:///../webpack:///D:/agent/1/_work/24/s/common/~/npmx-sp-pages/~/@ms/odsp-utilities/lib/logging/events/PLT.event.js","webpack:///../webpack:///D:/agent/1/_work/24/s/common/~/npmx-sp-pages/~/@ms/odsp-utilities/lib/logging/events/UnhandledError.event.js","webpack:///../webpack:///D:/agent/1/_work/24/s/common/~/npmx-sp-pages/~/@ms/odsp-utilities/lib/logging/events/RequireJSError.event.js","webpack:///../webpack:///D:/agent/1/_work/24/s/common/~/npmx-sp-pages/~/@ms/odsp-utilities/lib/logging/odb/DebugPriorityLevel.js","webpack:///../webpack:///D:/agent/1/_work/24/s/common/~/npmx-sp-pages/~/@ms/odsp-utilities/lib/logging/rumone/ControlPerformanceData.js","webpack:///../webpack:///D:/agent/1/_work/24/s/libraries/sp-telemetry/lib/odsp-utilities/odsp-utilities-extended.js","webpack:///../webpack:///D:/agent/1/_work/24/s/common/~/npmx-sp-pages/~/@ms/odsp-utilities/lib/dateTime/DateTime.js","webpack:///../webpack:///D:/agent/1/_work/24/s/common/~/npmx-sp-pages/~/@ms/odsp-utilities/lib/dateTime/DateTime.resx.js","webpack:///../webpack:///D:/agent/1/_work/24/s/common/~/npmx-sp-pages/~/@ms/odsp-utilities/lib/locale/Locale.js","webpack:///../webpack:///D:/agent/1/_work/24/s/common/~/npmx-sp-pages/~/@ms/odsp-utilities/lib/string/StringHelper.js","webpack:///../webpack:///D:/agent/1/_work/24/s/common/~/npmx-sp-pages/~/@ms/odsp-utilities/lib/logging/events/Api.event.js","webpack:///../webpack:///D:/agent/1/_work/24/s/common/~/npmx-sp-pages/~/@ms/odsp-utilities/lib/component/Component.js","webpack:///../webpack:///D:/agent/1/_work/24/s/common/~/npmx-sp-pages/~/@ms/odsp-utilities/lib/scope/Scope.js","webpack:///../webpack:///D:/agent/1/_work/24/s/common/~/npmx-sp-pages/~/@ms/odsp-utilities/lib/disposable/Disposable.js","webpack:///../webpack:///D:/agent/1/_work/24/s/common/~/npmx-sp-pages/~/@ms/odsp-utilities/lib/resources/Resources.js","webpack:///../webpack:///D:/agent/1/_work/24/s/common/~/npmx-sp-pages/~/@ms/odsp-utilities/lib/resources/ResourceScope.js","webpack:///../webpack:///D:/agent/1/_work/24/s/common/~/npmx-sp-pages/~/@ms/odsp-utilities/lib/async/Promise.js","webpack:///../webpack:///D:/agent/1/_work/24/s/common/~/npmx-sp-pages/~/@ms/odsp-utilities/lib/events/EventGroup.js","webpack:///../webpack:///D:/agent/1/_work/24/s/common/~/npmx-sp-pages/~/@ms/odsp-utilities/lib/theming/FabricTheming.js","webpack:///../webpack:///D:/agent/1/_work/24/s/common/~/npmx-sp-pages/~/@ms/odsp-utilities/lib/theming/HslColor.js","webpack:///../webpack:///D:/agent/1/_work/24/s/common/~/npmx-sp-pages/~/@ms/odsp-utilities/lib/theming/RgbaColor.js","webpack:///../webpack:///D:/agent/1/_work/24/s/common/~/npmx-sp-pages/~/@ms/odsp-utilities/lib/theming/Shades.js","webpack:///../webpack:///D:/agent/1/_work/24/s/common/~/npmx-sp-pages/~/@ms/odsp-utilities/lib/dataSources/group/GroupDataSource.js","webpack:///../webpack:///D:/agent/1/_work/24/s/common/~/npmx-sp-pages/~/@ms/odsp-utilities/lib/dataSources/group/MembersList.js","webpack:///../webpack:///D:/agent/1/_work/24/s/common/~/npmx-sp-pages/~/@ms/odsp-utilities/lib/encoding/HtmlEncoding.js","webpack:///../webpack:///D:/agent/1/_work/24/s/common/~/npmx-sp-pages/~/@ms/odsp-utilities/lib/performance/PerformanceCollection.js","webpack:///../webpack:///D:/agent/1/_work/24/s/common/~/npmx-sp-pages/~/@ms/odsp-utilities/lib/dataSources/acronym/SiteHeaderLogoAcronym.js","webpack:///../webpack:///D:/agent/1/_work/24/s/common/~/npmx-sp-pages/~/@ms/odsp-utilities/lib/theming/ThemeProvider.js","webpack:///../webpack:///D:/agent/1/_work/24/s/common/~/npmx-sp-pages/~/@ms/odsp-utilities/lib/theming/ThemeCache.js","webpack:///../webpack:///D:/agent/1/_work/24/s/common/~/npmx-sp-pages/~/@ms/odsp-utilities/lib/uri/Uri.js","webpack:///../webpack:///D:/agent/1/_work/24/s/common/~/npmx-sp-pages/~/@ms/odsp-utilities/lib/theming/WebTheme.js","webpack:///../webpack:///lib/local/appBase/components/sp-rte/ckeditor/CKTextEditor.scss.js","webpack:///../webpack:///lib/local/appBase/components/sp-rte/ckeditor/CKTextEditor.css?6d23","webpack:///../webpack:///lib/local/appBase/components/sp-rte/ckeditor/CKTextEditor.css","webpack:///../webpack:///D:/agent/1/_work/24/s/common/~/css-loader/lib/css-base.js","webpack:///../webpack:///src/index.ts","webpack:///../webpack:///lib/local/appBase/components/sp-rte/ckeditor/CKEditorFlights.js","webpack:///../webpack:///lib/local/appBase/components/sp-rte/quill/QuillEditor.js","webpack:///../webpack:///lib/local/appBase/components/sp-rte/quill/QuillLoader.js","webpack:///../webpack:///lib/local/appBase/components/sp-rte/quill/QuillEditor.scss.js","webpack:///../webpack:///lib/local/appBase/components/sp-rte/quill/QuillEditor.css?f85a","webpack:///../webpack:///lib/local/appBase/components/sp-rte/quill/QuillEditor.css","webpack:///../webpack:///lib/local/appBase/components/sp-rte/loc/RteStrings.resx.js","webpack:///../external \"resx-strings\"","webpack:///../webpack:///lib/local/appBase/components/sp-rte/rte/BaseRte.js","webpack:///../webpack:///lib/local/appBase/components/sp-rte/formattingbar/SPRteFormattingBar.js","webpack:///../webpack:///lib/local/appBase/components/sp-rte/formattingbar/SPRteFormattingBar.scss.js","webpack:///../webpack:///lib/local/appBase/components/sp-rte/formattingbar/SPRteFormattingBar.css?a2d4","webpack:///../webpack:///lib/local/appBase/components/sp-rte/formattingbar/SPRteFormattingBar.css","webpack:///../webpack:///lib/local/appBase/components/sp-rte/formattingbar/SPRteLinkDialog.js","webpack:///../webpack:///lib/local/appBase/components/sp-rte/a11y/RteA11y.js","webpack:///../webpack:///lib/local/appBase/components/sp-canvas/toolbar/toolbarButton/ToolbarButton.js","webpack:///../webpack:///lib/local/appBase/components/sp-canvas/toolbar/toolbarButton/ToolbarButton.scss.js","webpack:///../webpack:///lib/local/appBase/components/sp-canvas/toolbar/toolbarButton/ToolbarButton.css?b203","webpack:///../webpack:///lib/local/appBase/components/sp-canvas/toolbar/toolbarButton/ToolbarButton.css","webpack:///../webpack:///lib/local/appBase/components/sp-canvas/common/Utilities.js","webpack:///../webpack:///lib/local/appBase/components/sp-canvas/toolbar/toolbarSubMenu/ToolbarSubmenu.js","webpack:///../webpack:///lib/local/appBase/components/sp-canvas/a11y/CanvasA11y.js","webpack:///../webpack:///lib/local/appBase/components/sp-canvas/toolbar/toolbarSubMenu/ToolbarSubmenu.scss.js","webpack:///../webpack:///lib/local/appBase/components/sp-canvas/toolbar/toolbarSubMenu/ToolbarSubmenu.css?4220","webpack:///../webpack:///lib/local/appBase/components/sp-canvas/toolbar/toolbarSubMenu/ToolbarSubmenu.css","webpack:///../webpack:///lib/local/appBase/components/sp-rte/rte/BaseRte.scss.js","webpack:///../webpack:///lib/local/appBase/components/sp-rte/rte/BaseRte.css?5ba8","webpack:///../webpack:///lib/local/appBase/components/sp-rte/rte/BaseRte.css","webpack:///../webpack:///lib/local/appBase/components/sp-rte/rte/SPRteQuillConfiguration.js","webpack:///../webpack:///lib/local/appBase/components/sp-rte/rte/SPRteCKEditorConfiguration.js","webpack:///../webpack:///lib/local/appBase/components/sp-rte/rte/SPRteTouchDevice.js","webpack:///../webpack:///lib/local/appBase/components/sp-canvas/canvas/webPartZone/WebPartZone.js","webpack:///../external \"@microsoft/sp-webpart-base\"","webpack:///../webpack:///lib/local/appBase/components/sp-canvas/canvas/canvasComponent/CanvasStore.js","webpack:///../webpack:///lib/local/appBase/components/sp-canvas/canvas/canvasLayout/CanvasSectionPart.js","webpack:///../webpack:///lib/local/appBase/components/sp-canvas/canvas/canvasLayout/CanvasLayout.js","webpack:///../webpack:///lib/local/appBase/components/sp-canvas/canvas/canvasLayout/CanvasZonePart.js","webpack:///../webpack:///lib/local/appBase/components/sp-canvas/canvas/CanvasWebPartHost/CanvasWebPartHost.js","webpack:///../webpack:///lib/local/appBase/components/sp-canvas/loc/CanvasStrings.resx.js","webpack:///../webpack:///lib/local/appBase/components/sp-canvas/canvas/controlZone/ControlZone.js","webpack:///../external \"@microsoft/sp-client-base\"","webpack:///../webpack:///lib/local/appBase/components/sp-canvas/canvas/controlZone/LayoutControlZone.css?461c","webpack:///../webpack:///lib/local/appBase/components/sp-canvas/canvas/controlZone/LayoutControlZone.css","webpack:///../webpack:///lib/local/appBase/components/sp-canvas/canvas/controlZone/ControlZone.css?1bdd","webpack:///../webpack:///lib/local/appBase/components/sp-canvas/canvas/controlZone/ControlZone.css","webpack:///../webpack:///lib/local/appBase/components/sp-canvas/canvas/canvasToolboxHint/CanvasToolboxHint.js","webpack:///../webpack:///lib/local/appBase/components/sp-canvas/canvas/canvasToolboxHint/LayoutCanvasToolboxHint.css?533b","webpack:///../webpack:///lib/local/appBase/components/sp-canvas/canvas/canvasToolboxHint/LayoutCanvasToolboxHint.css","webpack:///../webpack:///lib/local/appBase/components/sp-canvas/canvas/canvasToolboxHint/CanvasToolboxHint.css?81ce","webpack:///../webpack:///lib/local/appBase/components/sp-canvas/canvas/canvasToolboxHint/CanvasToolboxHint.css","webpack:///../webpack:///lib/local/appBase/components/sp-canvas/canvas/confirmationDialog/ConfirmationDialog.js","webpack:///../webpack:///lib/local/appBase/components/sp-canvas/canvas/canvasZone/CanvasZone.js","webpack:///../webpack:///lib/local/appBase/components/sp-canvas/canvas/canvasSection/CanvasSection.js","webpack:///../webpack:///lib/local/appBase/components/sp-canvas/toolbar/toolbar/Toolbar.js","webpack:///../webpack:///lib/local/appBase/components/sp-canvas/toolbar/toolbar/Toolbar.scss.js","webpack:///../webpack:///lib/local/appBase/components/sp-canvas/toolbar/toolbar/Toolbar.css?d876","webpack:///../webpack:///lib/local/appBase/components/sp-canvas/toolbar/toolbar/Toolbar.css","webpack:///../webpack:///lib/local/appBase/components/sp-canvas/canvas/canvasSection/CanvasSection.scss.js","webpack:///../webpack:///lib/local/appBase/components/sp-canvas/canvas/canvasSection/CanvasSection.css?ffa6","webpack:///../webpack:///lib/local/appBase/components/sp-canvas/canvas/canvasSection/CanvasSection.css","webpack:///../webpack:///lib/local/appBase/components/sp-canvas/toolbox/toolbox/Toolbox.js","webpack:///../webpack:///lib/local/appBase/components/sp-canvas/toolbox/toolboxGroup/ToolboxGroup.js","webpack:///../webpack:///lib/local/appBase/components/sp-canvas/toolbox/toolboxGroup/ToolboxGroup.scss.js","webpack:///../webpack:///lib/local/appBase/components/sp-canvas/toolbox/toolboxGroup/ToolboxGroup.css?8910","webpack:///../webpack:///lib/local/appBase/components/sp-canvas/toolbox/toolboxGroup/ToolboxGroup.css","webpack:///../webpack:///lib/local/appBase/components/sp-canvas/toolbox/toolboxItem/ToolboxItem.js","webpack:///../webpack:///lib/local/appBase/components/sp-canvas/toolbox/toolboxItem/ToolboxItem.scss.js","webpack:///../webpack:///lib/local/appBase/components/sp-canvas/toolbox/toolboxItem/ToolboxItem.css?3a00","webpack:///../webpack:///lib/local/appBase/components/sp-canvas/toolbox/toolboxItem/ToolboxItem.css","webpack:///../webpack:///lib/local/appBase/components/sp-canvas/toolbox/toolboxItem/ToolBoxItemClassifier.js","webpack:///../webpack:///lib/local/appBase/components/sp-canvas/toolbox/toolbox/Toolbox.scss.js","webpack:///../webpack:///lib/local/appBase/components/sp-canvas/toolbox/toolbox/Toolbox.css?643c","webpack:///../webpack:///lib/local/appBase/components/sp-canvas/toolbox/toolbox/Toolbox.css","webpack:///../webpack:///lib/local/appBase/components/sp-canvas/canvas/canvas/Canvas.scss.js","webpack:///../webpack:///lib/local/appBase/components/sp-canvas/canvas/canvas/Canvas.css?1512","webpack:///../webpack:///lib/local/appBase/components/sp-canvas/canvas/canvas/Canvas.css","webpack:///../webpack:///lib/local/framework/shell/_spShell.js","webpack:///../webpack:///lib/local/framework/shell/Shell.js","webpack:///../external \"@microsoft/sp-http\"","webpack:///../webpack:///lib/local/common/suiteNav/SuiteNavManager.js","webpack:///../external \"@microsoft/sp-loader\"","webpack:///../webpack:///lib/local/common/suiteNav/dataAccess/ISuiteNavDataSource.js","webpack:///../webpack:///lib/local/common/suiteNav/dataAccess/SPOSuiteNavDataSource.js","webpack:///../webpack:///lib/local/common/suiteNav/dataAccess/OnPremSuiteNavDataSource.js","webpack:///../webpack:///lib/local/common/suiteNav/O365ShellWrapper.js","webpack:///../webpack:///lib/local/common/suiteNav/FlexPaneWrapper.js","webpack:///../webpack:///lib/local/common/suiteNav/NavigationWrapper.js","webpack:///../webpack:///lib/local/common/spPageChrome/SPPageChrome.js","webpack:///../webpack:///lib/local/common/spPageChrome/SPThemeProvider.js","webpack:///../webpack:///lib/local/common/spPageChrome/SPWebTemplateIds.js","webpack:///../webpack:///lib/local/common/spPageChrome/SPPageChrome.scss.js","webpack:///../webpack:///lib/local/common/spPageChrome/SPPageChrome.css?b146","webpack:///../webpack:///lib/local/common/spPageChrome/SPPageChrome.css","webpack:///../webpack:///lib/local/framework/shell/PreloadedDataReader.js","webpack:///../webpack:///lib/local/alternativeUrls/alternativeUrls.js","webpack:///../webpack:///lib/local/utilities/url/UrlUtilities.js","webpack:///../external \"@microsoft/sp-lodash-subset\"","webpack:///../webpack:///lib/local/appBase/components/sp-rte/rte/webPartRte/WebPartRte.js","webpack:///../webpack:///lib/local/appBase/components/sp-rte/rte/webPartRte/CKEditorForWebPartRte.js","webpack:///../../lib/resx-strings/en-us.js"],"names":[],"mappings":";AAAA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA,uBAAe;AACf;AACA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;;AAGA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;;;;;;;;ACtCA;AACA;AACA;AACA;AACA;AACA;AACA,iBAAQ,oBAAoB;AAC5B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA,wBAAe;AACf;AACA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,aAAI;AACJ;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA,yEAAgE,+DAA+D,6BAA6B,sDAAsD;AAClN;AACA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;;;;;;;ACzFA;AACA;AACA;AACA;AACA;;;;;;;ACJA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;;;;AClCA;AACA;AACA;;AAEA;AACA,mBAAiB,oBAAoB;AACrC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,G;;;;;;ACvBA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,WAAS;AACT;AACA;AACA,WAAS;AACT;AACA;AACA,OAAK;AACL;AACA;AACA;AACA,WAAS;AACT;AACA;AACA,WAAS;AACT;AACA;AACA,OAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAC;AACD,gDAA8C,cAAc;AAC5D;;;;;;;AC9CA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,WAAS;AACT;AACA;AACA,OAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA;AACA,WAAS;AACT;AACA;AACA,OAAK;AACL;AACA;AACA;AACA;AACA,WAAS;AACT;AACA;AACA,OAAK;AACL;AACA;AACA;AACA,WAAS;AACT;AACA;AACA,OAAK;AACL;AACA;AACA;AACA,WAAS;AACT;AACA;AACA,OAAK;AACL;AACA;AACA;AACA,WAAS;AACT;AACA;AACA,WAAS;AACT;AACA;AACA,OAAK;AACL;AACA;AACA;AACA,WAAS;AACT;AACA;AACA,WAAS;AACT;AACA;AACA,OAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAC;AACD,gDAA8C,cAAc;AAC5D;;;;;;;AChHA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,0D;AACA,+D;AACA,mE;AACA,mF;AACA,wE;AACA,qD;AACA,gD;AACA,iD;AACA,2E;AACA;AACA;AACA;AACA;AACA;AACA,yC;AACA;AACA;AACA,kD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,iD;AACA;AACA;AACA;AACA;AACA,GAAC;AACD,gDAA8C,cAAc;AAC5D;;;;;;;AC1CA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,WAAS;AACT;AACA;AACA,OAAK;AACL;AACA;AACA;AACA,WAAS;AACT;AACA;AACA,OAAK;AACL;AACA;AACA;AACA,WAAS;AACT;AACA;AACA,OAAK;AACL;AACA;AACA;AACA,WAAS;AACT;AACA;AACA,OAAK;AACL;AACA;AACA;AACA,WAAS;AACT;AACA;AACA,OAAK;AACL;AACA;AACA;AACA,WAAS;AACT;AACA;AACA,OAAK;AACL;AACA;AACA;AACA,WAAS;AACT;AACA;AACA,OAAK;AACL;AACA;AACA;AACA,WAAS;AACT;AACA;AACA,OAAK;AACL;AACA;AACA;AACA,WAAS;AACT;AACA;AACA,OAAK;AACL;AACA;AACA;AACA,WAAS;AACT;AACA;AACA,OAAK;AACL;AACA,GAAC;AACD,gDAA8C,cAAc;AAC5D;AACA;;;;;;;ACjGA,iD;;;;;;ACAA;AACA;AACA;AACA,qBAAmB,sBAAsB;AACzC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,WAAS;AACT;AACA;AACA,OAAK;AACL;AACA;AACA;AACA,WAAS;AACT;AACA;AACA,OAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAC;AACD,gDAA8C,cAAc;AAC5D;;;;;;;AC/CA;AACA;AACA;AACA;AACA;AACA,GAAC,oEAAoE;AACrE;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,WAAS;AACT;AACA;AACA,WAAS;AACT;AACA;AACA,OAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA,GAAC;AACD,gDAA8C,cAAc;AAC5D;;;;;;;ACjCA;AACA;AACA;AACA;AACA;AACA,4CAA0C,EAAE,aAAa,EAAE,EAAE,EAAE,UAAU,GAAG;AAC5E;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,WAAS;AACT;AACA;AACA,GAAC;AACD,gDAA8C,cAAc;AAC5D;;;;;;;ACrCA;AACA;AACA;AACA,qBAAmB,sBAAsB;AACzC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,WAAS;AACT;AACA;AACA,OAAK;AACL;AACA;AACA;AACA,WAAS;AACT;AACA;AACA,OAAK;AACL;AACA;AACA;AACA,WAAS;AACT;AACA;AACA,OAAK;AACL;AACA;AACA;AACA,WAAS;AACT;AACA;AACA,OAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAC;AACD,gDAA8C,cAAc;AAC5D;;;;;;;AC/DA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;;;;ACVA;AACA;AACA;AACA,qBAAmB,sBAAsB;AACzC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,WAAS;AACT;AACA;AACA,OAAK;AACL;AACA;AACA;AACA,WAAS;AACT;AACA;AACA,OAAK;AACL;AACA;AACA;AACA,WAAS;AACT;AACA;AACA,OAAK;AACL;AACA,GAAC;AACD,gDAA8C,cAAc;AAC5D;;;;;;;AClDA;AACA;AACA;AACA,qBAAmB,sBAAsB;AACzC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,WAAS;AACT;AACA;AACA,OAAK;AACL;AACA;AACA;AACA,WAAS;AACT;AACA;AACA,OAAK;AACL;AACA;AACA;AACA,WAAS;AACT;AACA;AACA,OAAK;AACL;AACA;AACA;AACA,WAAS;AACT;AACA;AACA,OAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAC;AACD,gDAA8C,cAAc;AAC5D;;;;;;;AC7DA;AACA;AACA;AACA,qBAAmB,sBAAsB;AACzC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,WAAS;AACT;AACA;AACA,OAAK;AACL;AACA;AACA;AACA,WAAS;AACT;AACA;AACA,OAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAC;AACD,gDAA8C,cAAc;AAC5D;;;;;;;AC1CA;AACA;AACA;AACA,qBAAmB,sBAAsB;AACzC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,WAAS;AACT;AACA;AACA,OAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAC;AACD,gDAA8C,cAAc;AAC5D;;;;;;;AClCA;AACA;AACA;AACA,qBAAmB,sBAAsB;AACzC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,WAAS;AACT;AACA;AACA,WAAS;AACT;AACA;AACA,OAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAC;AACD,gDAA8C,cAAc;AAC5D;;;;;;;AChCA;AACA;AACA;AACA,qBAAmB,sBAAsB;AACzC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,WAAS;AACT;AACA;AACA,OAAK;AACL;AACA;AACA;AACA,WAAS;AACT;AACA;AACA,OAAK;AACL;AACA;AACA;AACA,WAAS;AACT;AACA;AACA,OAAK;AACL;AACA;AACA;AACA,WAAS;AACT;AACA;AACA,OAAK;AACL;AACA;AACA;AACA,WAAS;AACT;AACA;AACA,OAAK;AACL;AACA;AACA;AACA,WAAS;AACT;AACA;AACA,OAAK;AACL;AACA;AACA;AACA,WAAS;AACT;AACA;AACA,OAAK;AACL;AACA;AACA;AACA,WAAS;AACT;AACA;AACA,OAAK;AACL;AACA;AACA;AACA,WAAS;AACT;AACA;AACA,OAAK;AACL;AACA;AACA;AACA,WAAS;AACT;AACA;AACA,OAAK;AACL;AACA;AACA;AACA,WAAS;AACT;AACA;AACA,OAAK;AACL;AACA;AACA;AACA,WAAS;AACT;AACA;AACA,OAAK;AACL;AACA;AACA;AACA,WAAS;AACT;AACA;AACA,OAAK;AACL;AACA;AACA;AACA,WAAS;AACT;AACA;AACA,OAAK;AACL;AACA;AACA;AACA,WAAS;AACT;AACA;AACA,OAAK;AACL;AACA;AACA;AACA,WAAS;AACT;AACA;AACA,OAAK;AACL;AACA;AACA;AACA,WAAS;AACT;AACA;AACA,OAAK;AACL;AACA;AACA;AACA,WAAS;AACT;AACA;AACA,OAAK;AACL;AACA;AACA;AACA,WAAS;AACT;AACA;AACA,OAAK;AACL;AACA;AACA;AACA,WAAS;AACT;AACA;AACA,OAAK;AACL;AACA;AACA;AACA,WAAS;AACT;AACA;AACA,OAAK;AACL;AACA;AACA;AACA,WAAS;AACT;AACA;AACA,OAAK;AACL;AACA;AACA;AACA,WAAS;AACT;AACA;AACA,OAAK;AACL;AACA;AACA;AACA,WAAS;AACT;AACA;AACA,OAAK;AACL;AACA;AACA;AACA,WAAS;AACT;AACA;AACA,OAAK;AACL;AACA;AACA;AACA,WAAS;AACT;AACA;AACA,OAAK;AACL;AACA;AACA;AACA,WAAS;AACT;AACA;AACA,OAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,WAAS;AACT;AACA;AACA,OAAK;AACL;AACA,GAAC;AACD,gDAA8C,cAAc;AAC5D;;;;;;;AC1PA,kD;;;;;;ACAA;AACA;AACA;AACA,qBAAmB,sBAAsB;AACzC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,WAAS;AACT;AACA;AACA,OAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAC;AACD,gDAA8C,cAAc;AAC5D;;;;;;;ACjCA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,WAAS;AACT;AACA;AACA,OAAK;AACL;AACA;AACA;AACA,WAAS;AACT;AACA;AACA,OAAK;AACL;AACA;AACA;AACA,WAAS;AACT;AACA;AACA,WAAS;AACT;AACA;AACA,OAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAC;AACD,gDAA8C,cAAc;AAC5D;;;;;;;AC7EA,kD;;;;;;ACAA,kD;;;;;;ACAA;AACA;AACA;AACA,qBAAmB,sBAAsB;AACzC;AACA;AACA;AACA,8CAA4C,OAAO;AACnD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,WAAS;AACT;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,6EAA2E,oEAAoE;AAC/I;AACA;AACA;AACA;AACA,oFAAkF,yMAAyM;AAC3R,WAAS;AACT;AACA;AACA;AACA,WAAS;AACT;AACA;AACA;AACA;AACA;AACA,8CAA4C,2GAA2G;AACvJ,gEAA8D,oIAAoI;AAClM;AACA,gEAA8D;AAC9D,iEAA+D,6QAA6Q;AAC5U;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,+DAA6D,6BAA6B;AAC1F;AACA;AACA;AACA;AACA;AACA;AACA,sFAAoF,8FAA8F;AAClL;AACA,4EAA0E,4FAA4F;AACtK;AACA,kEAAgE,uMAAuM;AACvQ;AACA,kFAAgF,mJAAmJ;AACnO;AACA;AACA;AACA;AACA;AACA;AACA,WAAS;AACT,8CAA4C,2GAA2G;AACvJ,gEAA8D,0KAA0K;AACxO;AACA,gEAA8D;AAC9D,iEAA+D,6QAA6Q;AAC5U;AACA;AACA;AACA;AACA;AACA,GAAC;AACD,gDAA8C,cAAc;AAC5D;;;;;;;AC3IA,kD;;;;;;ACAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAC;AACD,gDAA8C,cAAc;AAC5D;;;;;;;AChCA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAC,8CAA8C;AAC/C,gDAA8C,cAAc;AAC5D;;;;;;;ACVA;AACA;AACA;AACA,qBAAmB,sBAAsB;AACzC;AACA;AACA;AACA;AACA;AACA,8CAA4C,QAAQ;AACpD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,eAAa,gIAAgI;AAC7I,eAAa,6HAA6H;AAC1I;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,WAAS;AACT;AACA;AACA,OAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,eAAa;AACb,wHAAsH,qCAAqC;AAC3J,eAAa;AACb;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,0CAAwC,qBAAqB;AAC7D;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,eAAa;AACb;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,iCAA+B,wBAAwB;AACvD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,kBAAgB;AAChB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,WAAS;AACT;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAC;AACD,gDAA8C,cAAc;AAC5D;;;;;;;ACvPA;AACA;AACA;AACA;AACA,8CAA4C,QAAQ;AACpD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,2EAAyE,4BAA4B,EAAE;AACvG;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,4JAA0J,iBAAiB,EAAE;AAC7K,eAAa;AACb;AACA,eAAa;AACb,WAAS;AACT;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,WAAS;AACT;AACA;AACA,OAAK;AACL;AACA;AACA;AACA,4FAA0F;AAC1F,2DAAyD,GAAG,WAAW;AACvE;AACA;AACA;AACA,eAAa;AACb;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,6FAA2F;AAC3F,0EAAwE;AACxE;AACA;AACA;AACA;AACA;AACA;AACA,mBAAiB;AACjB;AACA;AACA;AACA,mBAAiB;AACjB;AACA;AACA;AACA,mBAAiB;AACjB;AACA;AACA;AACA,mBAAiB;AACjB;AACA;AACA,mBAAiB;AACjB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,mBAAiB;AACjB;AACA;AACA;AACA,WAAS;AACT;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,2CAAyC;AACzC,2BAAyB;AACzB;AACA;AACA;AACA;AACA,eAAa;AACb;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,WAAS;AACT;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,mCAAiC,qBAAqB;AACtD;AACA;AACA;AACA,2BAAyB;AACzB;AACA;AACA;AACA;AACA,0DAAwD,gBAAgB;AACxE;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,kBAAgB;AAChB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,eAAa;AACb;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,eAAa;AACb;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,iFAA+E,qCAAqC,EAAE;AACtH;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAC;AACD,gDAA8C,cAAc;AAC5D;;;;;;;AClZA,kD;;;;;;ACAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,uBAAqB;AACrB;AACA;AACA;AACA;AACA;AACA;AACA,uBAAqB;AACrB;AACA,eAAa;AACb;AACA;AACA,eAAa;AACb;AACA;AACA;AACA;AACA;AACA,GAAC;AACD,gDAA8C,cAAc;AAC5D;;;;;;;ACrCA;AACA;AACA;AACA;AACA;AACA;;;;;;;ACLA;AACA;AACA;AACA;AACA;AACA;;;;;;;ACLA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;;;;ACjCA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAC,0DAA0D;AAC3D;AACA;AACA;AACA,GAAC,kEAAkE;AACnE;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAC,kDAAkD;AACnD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,uBAAqB,OAAO;AAC5B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAC;AACD;;;;;;;AClFA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,yBAAuB,qBAAqB;AAC5C;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,WAAS;AACT;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,yBAAuB,qBAAqB;AAC5C;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAC;AACD;AACA,gDAA8C,cAAc;AAC5D;;;;;;;ACnGA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,mBAAiB;AACjB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,4EAA0E,kBAAkB;AAC5F;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,mBAAiB;AACjB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,eAAa;AACb;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,iBAAe,IAAI;AACnB,iBAAe,OAAO;AACtB,iBAAe,QAAQ;AACvB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,WAAS;AACT;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAC,gCAAgC;AACjC,gDAA8C,cAAc;AAC5D;;;;;;;ACvMA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,iBAAe,OAAO;AACtB,iBAAe,QAAQ;AACvB;AACA,iBAAe,QAAQ;AACvB,iBAAe,QAAQ;AACvB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,sBAAoB,UAAU;AAC9B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,8DAA4D;AAC5D;AACA,uDAAqD;AACrD;AACA;AACA;AACA,uDAAqD;AACrD;AACA;AACA,oDAAkD;AAClD;AACA;AACA;AACA,gEAA8D;AAC9D;AACA,8DAA4D;AAC5D;AACA,uDAAqD;AACrD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,8CAA4C;AAC5C;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAC;AACD,gDAA8C,cAAc;AAC5D;;;;;;;ACtIA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAC;AACD,gDAA8C,cAAc;AAC5D;;;;;;;ACzBA;AACA;AACA;AACA;AACA;AACA;AACA,wBAAsB;AACtB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,8BAA4B;AAC5B,8BAA4B;AAC5B;AACA;AACA;AACA;AACA;AACA;AACA;AACA,gEAA8D;AAC9D;AACA;AACA;AACA;AACA;AACA;AACA,gEAA8D;AAC9D;AACA;AACA;AACA;AACA;AACA,qCAAmC,MAAM;AACzC;AACA;AACA;AACA,qCAAmC,aAAa;AAChD;AACA;AACA;AACA,GAAC;AACD,gDAA8C,cAAc;AAC5D;;;;;;;AC3DA;AACA;AACA;AACA;AACA,qBAAmB,sBAAsB;AACzC;AACA;AACA;AACA;AACA;AACA;AACA;AACA,wBAAsB,OAAO;AAC7B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,sBAAoB;AACpB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,wBAAsB,OAAO;AAC7B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,WAAS;AACT;AACA;AACA;AACA;AACA;AACA;AACA,WAAS;AACT;AACA;AACA;AACA;AACA;AACA;AACA,WAAS;AACT;AACA;AACA;AACA;AACA;AACA;AACA,WAAS;AACT;AACA;AACA;AACA;AACA;AACA;AACA,WAAS;AACT;AACA;AACA;AACA;AACA;AACA;AACA,WAAS;AACT;AACA;AACA;AACA;AACA;AACA;AACA,WAAS;AACT;AACA;AACA;AACA;AACA;AACA;AACA,WAAS;AACT;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAC;AACD;AACA;AACA,gDAA8C,cAAc;AAC5D;;;;;;;ACrJA;AACA;AACA;AACA;AACA,qBAAmB,sBAAsB;AACzC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAC;AACD;;;;;;;ACxCA;AACA;AACA;AACA;AACA,qBAAmB,sBAAsB;AACzC;AACA;AACA;AACA;AACA;AACA;AACA;AACA,wBAAsB,OAAO;AAC7B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,sBAAoB;AACpB;AACA;AACA,wBAAsB,OAAO;AAC7B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,WAAS;AACT;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAC;AACD;AACA;AACA,gDAA8C,cAAc;AAC5D;;;;;;;ACvEA;AACA;AACA;AACA;AACA,qBAAmB,sBAAsB;AACzC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,wBAAsB,OAAO;AAC7B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,sBAAoB;AACpB;AACA;AACA;AACA,wBAAsB,OAAO;AAC7B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,WAAS;AACT;AACA;AACA;AACA;AACA;AACA;AACA,WAAS;AACT;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,wCAAsC;AACtC;AACA,GAAC;AACD;AACA;AACA,gDAA8C,cAAc;AAC5D;;;;;;;ACzFA;AACA;AACA;AACA;AACA;AACA,qCAAmC;AACnC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,8CAA4C;AAC5C;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,qBAAmB;AACnB;AACA,sBAAoB;AACpB;AACA,GAAC;AACD,gDAA8C,cAAc;AAC5D;;;;;;;AChEA;AACA;AACA;AACA;AACA,qBAAmB,sBAAsB;AACzC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,sBAAoB;AACpB;AACA;AACA;AACA;AACA;AACA;AACA,wBAAsB,OAAO;AAC7B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,sBAAoB;AACpB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,WAAS;AACT;AACA;AACA;AACA;AACA;AACA;AACA,WAAS;AACT;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,WAAS;AACT;AACA;AACA;AACA;AACA;AACA;AACA,WAAS;AACT;AACA;AACA;AACA;AACA;AACA;AACA,WAAS;AACT;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAC;AACD;AACA;AACA,gDAA8C,cAAc;AAC5D;;;;;;;AC5JA;AACA;AACA;AACA;AACA,qBAAmB,sBAAsB;AACzC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,WAAS;AACT;AACA;AACA,OAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAC;AACD;;;;;;;ACjKA;AACA;AACA;AACA;AACA;AACA,GAAC,wDAAwD;AACzD;;;;;;;ACNA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,WAAS;AACT;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,eAAa;AACb;AACA;AACA;AACA;AACA;AACA;AACA,eAAa;AACb;AACA;AACA;AACA,sCAAoC,uEAAuE;AAC3G;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAC;AACD,gDAA8C,cAAc;AAC5D;;;;;;;ACzEA;AACA;AACA;AACA;AACA,qBAAmB,sBAAsB;AACzC;AACA;AACA;AACA;AACA;AACA;AACA;AACA,wBAAsB,OAAO;AAC7B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,sBAAoB;AACpB;AACA;AACA;AACA,wBAAsB,OAAO;AAC7B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,WAAS;AACT;AACA;AACA;AACA;AACA;AACA;AACA,WAAS;AACT;AACA;AACA;AACA;AACA;AACA;AACA,WAAS;AACT;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAC;AACD;AACA;AACA,gDAA8C,cAAc;AAC5D;;;;;;;ACnGA;AACA;AACA;AACA;AACA,qBAAmB,sBAAsB;AACzC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,wBAAsB,OAAO;AAC7B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,sBAAoB;AACpB;AACA;AACA;AACA;AACA;AACA;AACA,wBAAsB,OAAO;AAC7B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,WAAS;AACT;AACA;AACA;AACA;AACA;AACA;AACA,WAAS;AACT;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,WAAS;AACT;AACA;AACA;AACA;AACA;AACA;AACA,WAAS;AACT;AACA;AACA;AACA;AACA;AACA;AACA,WAAS;AACT;AACA;AACA;AACA;AACA;AACA;AACA,WAAS;AACT;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAC;AACD;AACA;AACA,gDAA8C,cAAc;AAC5D;;;;;;;AClIA;AACA;AACA;AACA;AACA,qBAAmB,sBAAsB;AACzC;AACA;AACA;AACA;AACA;AACA;AACA;AACA,wBAAsB,OAAO;AAC7B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,sBAAoB;AACpB;AACA;AACA,wBAAsB,OAAO;AAC7B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,WAAS;AACT;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAC;AACD;AACA;AACA,gDAA8C,cAAc;AAC5D;;;;;;;AC9EA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAC;AACD,gDAA8C,cAAc;AAC5D;;;;;;;ACjCA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,kEAAgE,gBAAgB;AAChF;AACA;AACA;AACA;AACA;AACA;AACA;AACA,oEAAkE,gBAAgB;AAClF;AACA;AACA;AACA;AACA;AACA;AACA;AACA,mEAAiE,gBAAgB;AACjF;AACA;AACA;AACA;AACA;AACA;AACA;AACA,yEAAuE,gBAAgB;AACvF;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,eAAa;AACb;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,eAAa;AACb;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,8BAA4B,uBAAuB;AACnD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,8BAA4B,uBAAuB;AACnD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAC;AACD,gDAA8C,cAAc;AAC5D;;;;;;;ACtXA;AACA;AACA;AACA,gDAA8C,cAAc;AAC5D;;;;;;;ACJA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAC,oDAAoD;AACrD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAC;AACD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAC;AACD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,iEAA+D,qDAAqD;AACpH,WAAS;AACT;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,eAAa;AACb;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,qCAAmC,kCAAkC;AACrE;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,iCAA+B,wBAAwB;AACvD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,8DAA4D,8DAA8D,GAAG;AAC7H,uDAAqD,8FAA8F,GAAG;AACtJ,8DAA4D,4EAA4E,GAAG;AAC3I;AACA,kDAAgD,qCAAqC;AACrF,gDAA8C,8CAA8C;AAC5F,iDAA+C,gDAAgD;AAC/F,iDAA+C,2CAA2C;AAC1F;AACA,iCAA+B,wBAAwB;AACvD;AACA;AACA;AACA;AACA,mBAAiB;AACjB,yFAAuF;AACvF;AACA,yCAAuC,6BAA6B;AACpE;AACA;AACA;AACA;AACA,uBAAqB,UAAU;AAC/B;AACA;AACA;AACA;AACA,uBAAqB,yBAAyB;AAC9C;AACA,2BAAyB,2DAA2D,EAAE,6DAA6D;AACnJ;AACA;AACA;AACA;AACA;AACA,+BAA6B;AAC7B;AACA,+BAA6B;AAC7B;AACA;AACA;AACA,uBAAqB;AACrB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,eAAa;AACb;AACA;AACA,qEAAmE;AACnE;AACA,eAAa;AACb;AACA;AACA;AACA;AACA;AACA;AACA;AACA,eAAa;AACb;AACA,eAAa;AACb;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,6BAA2B,yBAAyB;AACpD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,yBAAuB,oCAAoC;AAC3D;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,mBAAiB;AACjB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,eAAa;AACb;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,6BAA2B,8BAA8B;AACzD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,6BAA2B,sCAAsC;AACjE;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,iCAA+B,0BAA0B;AACzD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,iCAA+B,8BAA8B;AAC7D;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,6BAA2B,0BAA0B;AACrD;AACA;AACA;AACA;AACA;AACA;AACA;AACA,yEAAuE,wBAAwB,EAAE;AACjG;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,6CAA2C;AAC3C;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,wCAAsC;AACtC,yCAAuC;AACvC,kCAAgC;AAChC;AACA;AACA,GAAC;AACD,gDAA8C,cAAc;AAC5D;;;;;;;ACpmBA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAC,gDAAgD;AACjD;AACA,gDAA8C,cAAc;AAC5D;;;;;;;ACVA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAC;AACD,gDAA8C,cAAc;AAC5D;;;;;;;ACtHA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAC;AACD,gDAA8C,cAAc;AAC5D;;;;;;;ACZA;AACA;AACA;AACA;AACA,qBAAmB,sBAAsB;AACzC;AACA;AACA;AACA;AACA;AACA;AACA;AACA,wBAAsB,OAAO;AAC7B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,sBAAoB;AACpB;AACA;AACA,wBAAsB,OAAO;AAC7B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,WAAS;AACT;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAC;AACD;AACA;AACA,gDAA8C,cAAc;AAC5D;;;;;;;ACrEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,6BAA2B;AAC3B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,6DAA2D;AAC3D;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAC;AACD,gDAA8C,cAAc;AAC5D;;;;;;;AChLA;AACA;AACA;AACA;AACA,qBAAmB,sBAAsB;AACzC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,0CAAwC;AACxC,+BAA6B;AAC7B;AACA,yDAAuD;AACvD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,+CAA6C;AAC7C;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,6BAA2B,eAAe;AAC1C;AACA;AACA;AACA;AACA,OAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,OAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,OAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,OAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,6BAA2B,mBAAmB;AAC9C;AACA;AACA;AACA;AACA;AACA,uBAAqB;AACrB;AACA;AACA,mBAAiB;AACjB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,eAAa;AACb;AACA;AACA,WAAS;AACT;AACA,OAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,6BAA2B,gBAAgB;AAC3C;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,sFAAoF;AACpF;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,yBAAuB,qBAAqB;AAC5C;AACA,gDAA8C;AAC9C;AACA,qDAAmD;AACnD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,kDAAgD;AAChD,oCAAkC;AAClC;AACA;AACA,GAAC,wBAAwB;AACzB,gDAA8C,cAAc;AAC5D;;;;;;;ACxZA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,WAAS;AACT;AACA;AACA,WAAS;AACT;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,WAAS;AACT;AACA;AACA;AACA,WAAS;AACT;AACA,+BAA6B,qCAAqC;AAClE;AACA;AACA;AACA;AACA,WAAS;AACT;AACA,+BAA6B,sCAAsC;AACnE;AACA;AACA;AACA;AACA;AACA,WAAS;AACT;AACA;AACA;AACA;AACA;AACA,WAAS;AACT;AACA,6BAA2B,2BAA2B;AACtD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAC;AACD,gDAA8C,cAAc;AAC5D;;;;;;;ACtFA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,mBAAiB;AACjB;AACA;AACA;AACA;AACA,mBAAiB;AACjB;AACA;AACA;AACA;AACA;AACA;AACA;AACA,uBAAqB;AACrB;AACA;AACA;AACA;AACA;AACA,mBAAiB;AACjB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAC;AACD,gDAA8C,cAAc;AAC5D;;;;;;;ACzGA;AACA;AACA;AACA;AACA,qBAAmB,sBAAsB;AACzC;AACA;AACA;AACA;AACA;AACA;AACA;AACA,sBAAoB;AACpB;AACA;AACA;AACA;AACA;AACA;AACA,wBAAsB,OAAO;AAC7B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,sBAAoB;AACpB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,WAAS;AACT;AACA;AACA;AACA;AACA;AACA;AACA,WAAS;AACT;AACA;AACA;AACA;AACA;AACA;AACA,WAAS;AACT;AACA;AACA;AACA;AACA;AACA;AACA,WAAS;AACT;AACA;AACA;AACA;AACA;AACA;AACA,WAAS;AACT;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAC;AACD;AACA;AACA,gDAA8C,cAAc;AAC5D;;;;;;;ACnJA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,eAAa;AACb;AACA;AACA;AACA;AACA,mCAAiC;AACjC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,eAAa;AACb;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,kDAAgD;AAChD,4CAA0C;AAC1C,2CAAyC;AACzC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAC;AACD,gDAA8C,cAAc;AAC5D;;;;;;;ACtKA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,eAAa;AACb;AACA,6BAA2B,2BAA2B;AACtD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,iEAA+D,0CAA0C;AACzG;AACA,uBAAqB;AACrB;AACA;AACA,mBAAiB;AACjB;AACA;AACA;AACA,OAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAC,kCAAkC;AACnC,gDAA8C,cAAc;AAC5D;;;;;;;ACjEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,8CAA4C,0DAA0D;AACtG;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,qBAAmB;AACnB;AACA;AACA;AACA,wCAAsC,qBAAqB;AAC3D;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,mBAAiB;AACjB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,wCAAsC,qBAAqB;AAC3D;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,wCAAsC,qBAAqB;AAC3D;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAC;AACD,gDAA8C,cAAc;AAC5D;;;;;;;ACjKA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAC,oDAAoD;AACrD,gDAA8C,cAAc;AAC5D;;;;;;;ACTA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,sDAAoD,+BAA+B;AACnF;AACA;AACA;AACA,mBAAiB;AACjB;AACA;AACA,2DAAyD,gBAAgB;AACzE;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,yDAAuD;AACvD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,sCAAoC;AACpC,wBAAsB;AACtB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,4BAA0B;AAC1B;AACA;AACA,8CAA4C;AAC5C;AACA,8CAA4C;AAC5C;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,mBAAiB;AACjB;AACA;AACA;AACA;AACA;AACA;AACA;AACA,eAAa;AACb;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,oCAAkC;AAClC;AACA;AACA;AACA;AACA;AACA;AACA,uBAAqB,EAAE;AACvB;AACA;AACA;AACA;AACA,4BAA0B;AAC1B;AACA;AACA;AACA;AACA;AACA;AACA,eAAa,EAAE;AACf;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,mBAAiB;AACjB;AACA;AACA;AACA;AACA,kDAAgD;AAChD;AACA;AACA,aAAW;AACX;AACA;AACA;AACA,kEAAgE;AAChE,yBAAuB,oBAAoB;AAC3C;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,oCAAkC;AAClC;AACA;AACA;AACA;AACA;AACA;AACA,uBAAqB,EAAE;AACvB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,mBAAiB;AACjB;AACA;AACA;AACA;AACA;AACA;AACA;AACA,eAAa;AACb;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAC,oCAAoC;AACrC,gDAA8C,cAAc;AAC5D;;;;;;;AC5bA;AACA;AACA;AACA;AACA,qBAAmB,sBAAsB;AACzC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,wBAAsB,OAAO;AAC7B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,sBAAoB;AACpB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,wBAAsB,OAAO;AAC7B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,WAAS;AACT;AACA;AACA;AACA;AACA;AACA;AACA,WAAS;AACT;AACA;AACA;AACA;AACA;AACA;AACA,WAAS;AACT;AACA;AACA;AACA;AACA;AACA;AACA,WAAS;AACT;AACA;AACA;AACA;AACA;AACA;AACA,WAAS;AACT;AACA;AACA;AACA;AACA;AACA;AACA,WAAS;AACT;AACA;AACA;AACA;AACA;AACA;AACA,WAAS;AACT;AACA;AACA;AACA;AACA;AACA;AACA,WAAS;AACT;AACA;AACA;AACA;AACA;AACA;AACA,WAAS;AACT;AACA;AACA;AACA;AACA;AACA;AACA,WAAS;AACT;AACA;AACA;AACA;AACA;AACA;AACA,WAAS;AACT;AACA;AACA;AACA;AACA;AACA;AACA,WAAS;AACT;AACA;AACA;AACA;AACA;AACA;AACA,WAAS;AACT;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,6BAA2B;AAC3B;AACA,GAAC;AACD;AACA;AACA,gDAA8C,cAAc;AAC5D;;;;;;;AC7LA;AACA;AACA;AACA;AACA,qBAAmB,sBAAsB;AACzC;AACA;AACA;AACA;AACA;AACA;AACA;AACA,wBAAsB,OAAO;AAC7B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,sBAAoB;AACpB;AACA;AACA;AACA;AACA;AACA;AACA,wBAAsB,OAAO;AAC7B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,WAAS;AACT;AACA;AACA;AACA;AACA;AACA;AACA,WAAS;AACT;AACA;AACA;AACA;AACA;AACA;AACA,WAAS;AACT;AACA;AACA;AACA;AACA;AACA;AACA,WAAS;AACT;AACA;AACA;AACA;AACA;AACA;AACA,WAAS;AACT;AACA;AACA;AACA;AACA;AACA;AACA,WAAS;AACT;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAC;AACD;AACA;AACA,gDAA8C,cAAc;AAC5D;;;;;;;AC5HA;AACA;AACA;AACA;AACA,qBAAmB,sBAAsB;AACzC;AACA;AACA;AACA;AACA;AACA;AACA;AACA,wBAAsB,OAAO;AAC7B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,sBAAoB;AACpB;AACA;AACA;AACA;AACA,wBAAsB,OAAO;AAC7B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,WAAS;AACT;AACA;AACA;AACA;AACA;AACA;AACA,WAAS;AACT;AACA;AACA;AACA;AACA;AACA;AACA,WAAS;AACT;AACA;AACA;AACA;AACA;AACA;AACA,WAAS;AACT;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAC;AACD;AACA;AACA,gDAA8C,cAAc;AAC5D;;;;;;;AC1GA;AACA;AACA;AACA;AACA;AACA;AACA,GAAC,gDAAgD;AACjD;AACA,gDAA8C,cAAc;AAC5D;;;;;;;ACTA;AACA;AACA;AACA,gDAA8C,cAAc;AAC5D;;;;;;;ACJA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;;;;ACpDA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,iBAAe;AACf;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,0CAAwC,4BAA4B;AACpE,qDAAmD;AACnD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,eAAa,EAAE;AACf;AACA,mLAAiL,EAAE;AACnL;AACA;AACA;AACA;AACA;AACA;AACA,eAAa,EAAE;AACf;AACA,6KAA2K,EAAE;AAC7K;AACA;AACA,4BAA0B,EAAE;AAC5B,0HAAwH,EAAE;AAC1H,+EAA6E,EAAE;AAC/E;AACA;AACA,eAAa,EAAE;AACf;AACA,0KAAwK,EAAE;AAC1K;AACA;AACA,oEAAkE;AAClE;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,qDAAmD;AACnD,wEAAsE;AACtE,yEAAuE,qCAAqC,EAAE;AAC9G;AACA;AACA;AACA;AACA,4BAA0B,EAAE;AAC5B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,0CAAwC,4BAA4B;AACpE;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,sCAAoC,EAAE;AACtC;AACA,kCAAgC,EAAE;AAClC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,sFAAoF;AACpF;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,6BAA2B;AAC3B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,uCAAqC,cAAc,EAAE;AACrD,2CAAyC,uBAAuB;AAChE;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,gCAA8B,oBAAoB;AAClD;AACA;AACA;AACA;AACA;AACA;AACA;AACA,uDAAqD,kBAAkB;AACvE;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;;;;ACrZA;AACA;AACA,qBAAmB,qPAAqP,EAAE,GAAG,EAAE,6kBAA6kB,EAAE,aAAa,EAAE,sEAAsE,EAAE,aAAa,EAAE,qnBAAqnB,EAAE,0EAA0E,EAAE,6BAA6B,EAAE,KAAK,EAAE,qDAAqD,EAAE,wEAAwE,EAAE,yCAAyC,EAAE,WAAW,EAAE,kEAAkE,EAAE,WAAW,EAAE,sCAAsC,EAAE,YAAY,EAAE,8IAA8I,EAAE,KAAK,EAAE,qCAAqC,EAAE,gBAAgB,EAAE,6CAA6C,EAAE,WAAW,EAAE,kOAAkO,EAAE,cAAc,EAAE,gCAAgC,EAAE,EAAE,EAAE;;;;;;;ACFnhF;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAC;AACD;AACA,gDAA8C,cAAc;AAC5D;;;;;;;AC3BA;AACA;AACA,uBAAqB,MAAM;AAC3B,8BAA4B,EAAE;AAC9B,uBAAqB,EAAE;AACvB,wBAAsB,KAAK;AAC3B;AACA;AACA,4BAA0B,EAAE;AAC5B;AACA,sBAAoB,EAAE,QAAQ,EAAE;AAChC;AACA;AACA;AACA;AACA,sBAAoB,uBAAuB;AAC3C;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,uBAAqB,kBAAkB;AACvC;AACA;AACA;AACA;AACA;AACA,gBAAc;AACd;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,aAAW,OAAO;AAClB;AACA,aAAW,OAAO;AAClB;AACA,aAAW,OAAO;AAClB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,4BAA0B;AAC1B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,uDAAqD,cAAc;AACnE;AACA;AACA;AACA;AACA;AACA,mEAAiE,iCAAiC;AAClG;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;;;;AC5PA;AACA;AACA;AACA;AACA,qBAAmB,sBAAsB;AACzC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,sBAAoB;AACpB;AACA;AACA;AACA;AACA;AACA;AACA;AACA,wBAAsB,OAAO;AAC7B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,sBAAoB;AACpB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,WAAS;AACT;AACA;AACA;AACA;AACA;AACA;AACA;AACA,WAAS;AACT;AACA;AACA;AACA;AACA;AACA;AACA,WAAS;AACT;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,WAAS;AACT;AACA;AACA;AACA;AACA;AACA;AACA,WAAS;AACT;AACA;AACA;AACA;AACA;AACA;AACA,WAAS;AACT;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,6BAA2B;AAC3B;AACA,GAAC;AACD;AACA;AACA,gDAA8C,cAAc;AAC5D;;;;;;;AChLA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,kBAAgB;AAChB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,WAAS;AACT;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,eAAa;AACb;AACA;AACA;AACA;AACA,eAAa;AACb;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,eAAa;AACb;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,iBAAe,iBAAiB,WAAW;AAC3C;AACA,iBAAe,uBAAuB,iBAAiB;AACvD;AACA;AACA;AACA;AACA,kCAAgC,aAAa;AAC7C,wCAAsC,mBAAmB;AACzD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,oBAAkB;AAClB;AACA;AACA;AACA,WAAS;AACT;AACA;AACA,OAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA,oBAAkB;AAClB;AACA;AACA;AACA,WAAS;AACT;AACA;AACA,OAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,iBAAe,EAAE;AACjB,mBAAiB;AACjB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,eAAa;AACb;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAC;AACD;AACA,gDAA8C,cAAc;AAC5D;;;;;;;ACnKA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,kBAAgB;AAChB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,iBAAe,EAAE;AACjB,mBAAiB,EAAE;AACnB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,WAAS;AACT;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,yDAAuD,gBAAgB;AACvE;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAC;AACD,gDAA8C,cAAc;AAC5D;;;;;;;AC5EA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAC;AACD;AACA;AACA;AACA;AACA;AACA,aAAW,kBAAkB;AAC7B,eAAa;AACb;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,WAAS;AACT;AACA;AACA;AACA;AACA;AACA;AACA;;;;;;;ACpDA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,6DAA2D,wBAAwB;AACnF;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,WAAS;AACT,mCAAiC,gBAAgB;AACjD;AACA;AACA;AACA,GAAC;AACD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,0CAAwC;AACxC;AACA;AACA;AACA;AACA;AACA;AACA,GAAC;AACD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAC;AACD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,WAAS;AACT;AACA;AACA,OAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAC;AACD;AACA;;;;;;;ACnFA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAC;AACD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,WAAS;AACT;AACA;AACA,OAAK;AACL;AACA,kBAAgB;AAChB;AACA;AACA,GAAC;AACD;AACA;AACA;AACA,GAAC;AACD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,0CAAwC,iBAAiB;AACzD;AACA;AACA;AACA;AACA;AACA;AACA;AACA,WAAS;AACT;AACA;AACA,GAAC;AACD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,mCAAiC;AACjC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,WAAS;AACT;AACA;AACA,OAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,WAAS;AACT;AACA;AACA;AACA;AACA;AACA;AACA;AACA,6DAA2D;AAC3D;AACA;AACA;AACA,WAAS,6BAA6B,EAAE;AACxC;AACA;AACA;AACA;AACA,0CAAwC,iBAAiB;AACzD;AACA;AACA;AACA;AACA;AACA,wCAAsC,eAAe;AACrD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,iEAA+D,sCAAsC,EAAE;AACvG;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAC;AACD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,yCAAuC,mBAAmB;AAC1D;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,mBAAiB;AACjB;AACA;AACA;AACA;AACA;AACA;AACA,eAAa,qBAAqB,4BAA4B,EAAE;AAChE;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAC;AACD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAC;AACD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,qBAAmB,YAAY;AAC/B,4BAA0B,QAAQ;AAClC;AACA;AACA;AACA;AACA;AACA;AACA,6EAA2E,wBAAwB;AACnG;AACA;AACA;AACA;AACA,qBAAmB,YAAY;AAC/B,4BAA0B,QAAQ;AAClC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,WAAS;AACT,2EAAyE,wBAAwB;AACjG,WAAS;AACT;AACA;AACA;AACA,8BAA4B,sBAAsB;AAClD;AACA;AACA;AACA;AACA;AACA;AACA;AACA,qBAAmB,YAAY;AAC/B;AACA;AACA;AACA;AACA;AACA,WAAS;AACT;AACA;AACA;AACA,qBAAmB,YAAY;AAC/B;AACA;AACA;AACA;AACA;AACA,WAAS;AACT;AACA;AACA;AACA,qBAAmB,YAAY;AAC/B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,WAAS;AACT;AACA;AACA;AACA;AACA,qBAAmB,YAAY;AAC/B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,qBAAmB,YAAY;AAC/B;AACA;AACA;AACA;AACA;AACA;AACA,qBAAmB,YAAY;AAC/B,kBAAgB;AAChB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,mCAAiC,cAAc;AAC/C;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,4FAA0F;AAC1F;AACA;AACA;AACA;AACA;AACA;AACA,8FAA4F,2CAA2C,EAAE;AACzI;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAC;AACD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,uDAAqD;AACrD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,uDAAqD;AACrD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,eAAa;AACb;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,gDAA8C,cAAc;AAC5D;;;;;;;ACzpBA;AACA;AACA;AACA;AACA;AACA;AACA,qBAAmB,sBAAsB;AACzC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,OAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,oBAAkB;AAClB,oBAAkB;AAClB,oBAAkB;AAClB,6BAA2B;AAC3B,qBAAmB;AACnB,sBAAoB;AACpB,2BAAyB;AACzB,oBAAkB;AAClB,yBAAuB;AACvB,kBAAgB;AAChB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,OAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,OAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,wCAAsC,mBAAmB;AACzD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,OAAK;AACL;AACA;AACA,OAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,OAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,OAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,OAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,OAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,OAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,OAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,OAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,6BAA2B,4BAA4B;AACvD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,wEAAsE,SAAS;AAC/E;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,wEAAsE,SAAS;AAC/E;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,6BAA2B,6CAA6C;AACxE;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,qCAAmC,6BAA6B;AAChE;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAC;AACD;AACA;AACA;AACA;AACA;AACA;AACA,GAAC;AACD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAC;AACD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,OAAK;AACL;AACA;AACA;AACA,OAAK;AACL;AACA;AACA;AACA,uCAAqC,kBAAkB;AACvD,uCAAqC,kBAAkB;AACvD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,WAAS;AACT;AACA;AACA,OAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,4DAA0D,WAAW,+BAA+B,EAAE,EAAE;AACxG;AACA;AACA;AACA;AACA;AACA;AACA,6BAA2B,+BAA+B;AAC1D,mBAAiB;AACjB,eAAa;AACb,WAAS;AACT;AACA;AACA;AACA;AACA;AACA;AACA,eAAa;AACb,WAAS;AACT;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,2BAAyB;AACzB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,4DAA0D,sBAAsB,cAAc,EAAE,oBAAoB,qBAAqB,cAAc,EAAE;AACzJ;AACA,eAAa;AACb;AACA;AACA;AACA;AACA;AACA,WAAS;AACT;AACA;AACA;AACA;AACA;AACA,eAAa;AACb,WAAS;AACT;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,WAAS;AACT;AACA;AACA;AACA;AACA;AACA,WAAS;AACT;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,0BAAwB;AACxB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAC;AACD,gDAA8C,cAAc;AAC5D;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAC;AACD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAC;AACD;;;;;;;ACx5BA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,6CAA2C,wDAAwD;AACnG;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,6BAA2B,mBAAmB;AAC9C;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,yEAAuE;AACvE;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,sCAAoC,uBAAuB;AAC3D;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,sCAAoC,uBAAuB;AAC3D;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,yBAAuB,+BAA+B;AACtD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,6BAA2B,kBAAkB;AAC7C;AACA;AACA;AACA;AACA;AACA;AACA,GAAC;AACD,gDAA8C,cAAc;AAC5D;;;;;;;AC/NA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,iBAAe,UAAU;AACzB,iBAAe,QAAQ;AACvB;AACA;AACA,oCAAkC,kBAAkB;AACpD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,2CAAyC;AACzC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,iBAAe,SAAS;AACxB,iBAAe,OAAO;AACtB,iBAAe,OAAO;AACtB,iBAAe,OAAO;AACtB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAC;AACD,gDAA8C,cAAc;AAC5D;;;;;;;ACtLA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,iBAAe,OAAO;AACtB,iBAAe,OAAO;AACtB,iBAAe,OAAO;AACtB,iBAAe,OAAO;AACtB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,iBAAe,UAAU;AACzB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,4DAA0D;AAC1D;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,iBAAe,OAAO;AACtB,iBAAe,OAAO;AACtB,iBAAe,OAAO;AACtB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,iBAAe,OAAO;AACtB;AACA;AACA;AACA;AACA;AACA;AACA;AACA,iBAAe,OAAO;AACtB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAC;AACD,gDAA8C,cAAc;AAC5D;;;;;;;ACpKA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,0CAAwC;AACxC;AACA;AACA;AACA,iBAAe,UAAU;AACzB;AACA;AACA;AACA;AACA;AACA;AACA,iBAAe,UAAU;AACzB,iBAAe,UAAU;AACzB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,iBAAe,OAAO;AACtB,iBAAe,OAAO;AACtB,iBAAe,OAAO;AACtB,iBAAe,OAAO;AACtB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,iBAAe,OAAO;AACtB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,iBAAe,UAAU;AACzB,iBAAe,QAAQ;AACvB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAC;AACD,gDAA8C,cAAc;AAC5D;;;;;;;ACvHA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAC,wCAAwC;AACzC;AACA;AACA;AACA,aAAW,OAAO;AAClB;AACA;AACA;AACA;AACA;AACA;AACA;AACA,aAAW,UAAU;AACrB,aAAW,OAAO;AAClB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;;;;ACxEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,iBAAe,OAAO;AACtB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,yBAAuB,gBAAgB;AACvC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,kEAAgE,EAAE;AAClE,gFAA8E,EAAE;AAChF,6EAA2E,EAAE,SAAS,EAAE;AACxF;AACA,GAAC;AACD,gDAA8C,cAAc;AAC5D;;;;;;;ACnOA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,iCAA+B;AAC/B,yBAAuB,yBAAyB;AAChD;AACA,oCAAkC;AAClC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAC;AACD,gDAA8C,cAAc;AAC5D;;;;;;;AClCA;AACA;AACA;AACA;AACA,gBAAc;AACd,gBAAc;AACd,iBAAe;AACf,kBAAgB;AAChB,kBAAgB;AAChB,kBAAgB;AAChB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,gFAA8E,sBAAsB,EAAE;AACtG;AACA;AACA,GAAC;AACD,gDAA8C,cAAc;AAC5D;;;;;;;AC3BA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,gFAA8E;AAC9E;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,yHAAuH;AACvH,iEAA+D;AAC/D,2GAAyG;AACzG;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,mLAAiL;AACjL,uLAAqL;AACrL;AACA;AACA,yEAAuE;AACvE,wFAAsF;AACtF;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,uEAAqE,gBAAgB;AACrF;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,0EAAwE;AACxE;AACA;AACA;AACA;AACA,mBAAiB;AACjB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,6BAA2B,kBAAkB;AAC7C;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,6BAA2B,oBAAoB;AAC/C;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,qCAAmC,cAAc;AACjD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,wCAAsC;AACtC,2CAAyC;AACzC;AACA,GAAC;AACD,gDAA8C,cAAc;AAC5D;;;;;;;AC5LA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,iBAAe,OAAO;AACtB,mBAAiB,QAAQ;AACzB;AACA;AACA,wGAAsG,sDAAsD;AAC5J;AACA;AACA;AACA,wBAAsB;AACtB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,iCAA+B,+BAA+B;AAC9D;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAC;AACD,gDAA8C,cAAc;AAC5D;;;;;;;ACjFA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,iBAAe,0BAA0B;AACzC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,iBAAe,OAAO;AACtB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,iBAAe,OAAO;AACtB;AACA;AACA,8BAA4B;AAC5B;AACA;AACA;AACA;AACA,eAAa;AACb;AACA;AACA;AACA;AACA;AACA;AACA,iBAAe,OAAO;AACtB,iBAAe,QAAQ;AACvB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,WAAS,oBAAoB,aAAa,EAAE,EAAE;AAC9C;AACA;AACA;AACA,iBAAe,OAAO;AACtB,iBAAe,QAAQ;AACvB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,2BAAyB,iCAAiC;AAC1D,yCAAuC;AACvC;AACA;AACA;AACA;AACA;AACA;AACA;AACA,yDAAuD,sCAAsC;AAC7F;AACA;AACA;AACA;AACA,6DAA2D,wCAAwC;AACnG;AACA,yDAAuD,uCAAuC;AAC9F;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,mBAAiB;AACjB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,mBAAiB;AACjB;AACA,WAAS,EAAE,EAAE;AACb;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,WAAS;AACT;AACA;AACA;AACA,GAAC;AACD,gDAA8C,cAAc;AAC5D;;;;;;;ACxJA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,iBAAe,OAAO;AACtB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,iBAAe,WAAW;AAC1B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAC;AACD,gDAA8C,cAAc;AAC5D;;;;;;;AClEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAC,gDAAgD;AACjD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,0BAAwB,uBAAuB;AAC/C;AACA;AACA;AACA,yBAAuB,qBAAqB;AAC5C;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,iDAA+C;AAC/C;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,yCAAuC;AACvC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,6CAA2C,kBAAkB;AAC7D,gDAA8C,kBAAkB;AAChE;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,6CAA2C,0BAA0B;AACrE;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,uEAAqE,EAAE,EAAE,EAAE,EAAE,EAAE;AAC/E,uEAAqE,EAAE,EAAE,EAAE,EAAE,EAAE;AAC/E;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,6CAA2C;AAC3C,gCAA8B,8BAA8B;AAC5D;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,+CAA6C;AAC7C;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,+EAA6E;AAC7E;AACA;AACA;AACA;AACA;AACA;AACA;AACA,gFAA8E;AAC9E;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,6DAA2D;AAC3D;AACA;AACA;AACA,+EAA6E;AAC7E;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,yBAAuB,gCAAgC;AACvD;AACA;AACA;AACA;AACA;AACA,yCAAuC;AACvC;AACA;AACA,uCAAqC;AACrC;AACA;AACA;AACA,yCAAuC,oBAAoB;AAC3D;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,yBAAuB;AACvB;AACA;AACA,GAAC;AACD,gDAA8C,cAAc;AAC5D;;;;;;;AC/fA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,iBAAe,gBAAgB;AAC/B,iBAAe,OAAO;AACtB,iBAAe,OAAO;AACtB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,iBAAe,gBAAgB;AAC/B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,iBAAe,cAAc;AAC7B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,yBAAuB;AACvB;AACA;AACA;AACA;AACA;AACA,iBAAe,IAAI;AACnB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAC;AACD,gDAA8C,cAAc;AAC5D;;;;;;;;;ACjIA;;;;;;;ACAA;AACA;;AAEA;;AAEA;AACA,iBAAe,oBAAoB;;AAEnC,qD;;;;;;ACRA;AACA;;;AAGA;AACA,0CAAwC,gBAAgB,wBAAwB,gBAAgB,wBAAwB,iBAAiB,sDAAsD,kBAAkB,sDAAsD,mBAAmB,mCAAmC,kBAAkB,mCAAmC,mBAAmB,mCAAmC,iBAAiB,mCAAmC,gBAAgB,mCAAmC,iBAAiB,mCAAmC,gBAAgB,iBAAiB,mBAAmB,oBAAoB,uBAAuB,uBAAuB,cAAc,8BAA8B,yCAAyC,mBAAmB,qBAAqB,uEAAuE,yEAAyE,yBAAyB,oBAAoB,gBAAgB,mBAAmB,0BAA0B,wEAAwE,yHAAyH,mCAAmC,eAAe,gBAAgB,mDAAmD,qBAAqB,gGAAgG,iBAAiB,gBAAgB,kBAAkB,2BAA2B,kBAAkB,2BAA2B,mBAAmB,2BAA2B,mBAAmB,2BAA2B,kBAAkB,2BAA2B,iBAAiB,2BAA2B,kBAAkB,2BAA2B,mBAAmB,2BAA2B,kBAAkB,4DAA4D,kBAAkB,4DAA4D,mBAAmB,4DAA4D,mBAAmB,4DAA4D,kBAAkB,0DAA0D,iBAAiB,0DAA0D,kBAAkB,0DAA0D,mBAAmB,0DAA0D,kBAAkB,2DAA2D,kBAAkB,2DAA2D,mBAAmB,2DAA2D,kBAAkB,2DAA2D,iBAAiB,4GAA4G,8BAA8B,yBAAyB,qCAAqC,kBAAkB,qCAAqC,mBAAmB,uCAAuC,kBAAkB,uCAAuC,mBAAmB,qCAAqC,kBAAkB,qCAAqC,mBAAmB,uCAAuC,kBAAkB,uCAAuC,mBAAmB,qCAAqC,mBAAmB,qCAAqC,oBAAoB,uCAAuC,mBAAmB,uCAAuC,oBAAoB,qCAAqC,mBAAmB,qCAAqC,oBAAoB,uCAAuC,mBAAmB,uCAAuC,oBAAoB,qCAAqC,mBAAmB,qCAAqC,oBAAoB,uCAAuC,mBAAmB,uCAAuC,oBAAoB,qCAAqC,mBAAmB,qCAAqC,oBAAoB,uCAAuC,mBAAmB,uCAAuC,oBAAoB,qCAAqC,mBAAmB,qCAAqC,oBAAoB,uCAAuC,mBAAmB,uCAAuC,oBAAoB,qCAAqC,mBAAmB,qCAAqC,oBAAoB,uCAAuC,mBAAmB,uCAAuC,oBAAoB,wCAAwC,iBAAiB,wCAAwC,gBAAgB,+BAA+B,kBAAkB,yCAAyC,sDAAsD,8BAA8B,qBAAqB,oBAAoB,0BAA0B,sFAAsF,0BAA0B;;AAEnrK;;;;;;;ACPA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,kBAAgB,iBAAiB;AACjC;AACA;AACA,0CAAwC,gBAAgB;AACxD,MAAI;AACJ;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA,kBAAgB,iBAAiB;AACjC;AACA;AACA;AACA;AACA,cAAY,oBAAoB;AAChC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,OAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;;;;ACjDA;;;KAGG;;AAsCH,+FAA6F;AAC7F,kGAAgG;AAChG,MAAI,wBAAiC,CAAC;AAEtC,8FAA4F;AAC5F,2CAAyC;AACzC,MAAM,KAAK,GAAQ,CAAC,OAAO,MAAM,KAAK,WAAW,CAAC,GAAG,MAAM,GAAG,MAAM,CAAC,CAAC,6BAA6B;AAEnG,MAAM,WAAW,GAAgB,KAAK,CAAC,cAAc,GAAG,KAAK,CAAC,cAAc,IAAI;MAC9E,KAAK,EAAE,SAAS;MAChB,gBAAgB,EAAE,SAAS;MAC3B,gBAAgB,EAAE,EAAE;GACrB,CAAC;AAEF;;KAEG;AACH,uCAAqC;AACrC,MAAM,gBAAgB,GAAW,gHAAgH,CAAC;AAClJ,sCAAoC;AAEpC,yEAAuE;AACvE,MAAM,sBAAsB,GAAW,KAAK,CAAC;AAE7C;;;;KAIG;AACH,sBAA2B,MAA8B;MACvD,IAAM,UAAU,GAAkB,KAAK,CAAC,OAAO,CAAC,MAAM,CAAC,GAAG,MAAM,GAAG,WAAW,CAAC,MAAM,CAAC,CAAC;MAEvF,EAAE,CAAC,CAAC,wBAAwB,KAAK,SAAS,CAAC,CAAC,CAAC;UAC3C,wBAAwB,GAAG,gBAAgB,EAAE,CAAC;MAChD,CAAC;MAED,mBAAmB,CAAC,UAAU,CAAC,CAAC;AAClC,GAAC;AARe,oBAAU,aAQzB;AAED;;;KAGG;AACH,+BAAoC,QAAkC;MACpE,WAAW,CAAC,UAAU,GAAG,QAAQ,CAAC;AACpC,GAAC;AAFe,6BAAmB,sBAElC;AAED;;;;;KAKG;AACH,+BAA6B,WAA0B,EAAE,WAA0B;MACjF,EAAE,CAAC,CAAC,WAAW,CAAC,UAAU,CAAC,CAAC,CAAC;UAC3B,IAAM,MAAM,GAAW,oBAAoB,CAAC,WAAW,CAAC,CAAC;UACzD,WAAW,CAAC,UAAU,CAAC,MAAM,CAAC,CAAC;MACjC,CAAC;MAAC,IAAI,CAAC,CAAC;UACN,wBAAwB;cACtB,gBAAgB,CAAC,WAAW,EAAE,WAAW,CAAC;cAC1C,cAAc,CAAC,WAAW,EAAE,WAAW,CAAC,CAAC;MAC7C,CAAC;AACH,GAAC;AAED;;;;KAIG;AACH,qBAA0B,KAAa;MACrC,WAAW,CAAC,KAAK,GAAG,KAAK,CAAC;MAE1B,iBAAiB;MACjB,YAAY,EAAE,CAAC;AACjB,GAAC;AALe,mBAAS,YAKxB;AAED;;KAEG;AACH;MACE,EAAE,CAAC,CAAC,WAAW,CAAC,KAAK,CAAC,CAAC,CAAC;UACtB,GAAG,CAAC,CAAsB,UAA4B,EAA5B,gBAAW,CAAC,gBAAgB,EAA5B,cAA4B,EAA5B,IAA4B,CAAC;cAAlD,IAAM,WAAW;cACpB,mBAAmB,CAAC,WAAW,CAAC,aAAa,EAAE,WAAW,CAAC,CAAC;WAC7D;MACH,CAAC;AACH,GAAC;AAED;;;KAGG;AACH,sBAA2B,MAAc;MACvC,EAAE,CAAC,CAAC,MAAM,CAAC,CAAC,CAAC;UACX,MAAM,GAAG,oBAAoB,CAAC,WAAW,CAAC,MAAM,CAAC,CAAC,CAAC;MACrD,CAAC;MAED,MAAM,CAAC,MAAM,CAAC;AAChB,GAAC;AANe,oBAAU,aAMzB;AAED;;;KAGG;AACH,gCAA8B,eAA8B;MAClD,6BAAK,CAA8B;MAC3C,IAAI,WAAmB,CAAC;MACxB,EAAE,CAAC,CAAC,eAAe,CAAC,CAAC,CAAC;UACpB,oEAAoE;UACpE,uDAAuD;UACvD,IAAM,aAAa,GAAa,eAAe,CAAC,GAAG,CAAC,UAAC,YAAiC;cACpF,IAAM,SAAS,GAAW,YAAY,CAAC,KAAK,CAAC;cAC7C,EAAE,CAAC,CAAC,SAAS,CAAC,CAAC,CAAC;kBACd,oCAAoC;kBACpC,IAAM,WAAW,GAAW,KAAK,GAAG,KAAK,CAAC,SAAS,CAAC,GAAG,SAAS,CAAC;kBACjE,IAAM,YAAY,GAAW,YAAY,CAAC,YAAY,CAAC;kBAEvD,6EAA6E;kBAC7E,iFAAiF;kBACjF,EAAE,CAAC,CAAC,KAAK,IAAI,CAAC,WAAW,IAAI,OAAO,IAAI,CAAC,CAAC,SAAS,IAAI,KAAK,CAAC,CAAC,CAAC,CAAC;sBAC9D,qCAAqC;sBACrC,OAAO,CAAC,IAAI,CAAC,sCAAmC,SAAS,+BAAuB,YAAY,IAAI,SAAS,SAAI,CAAC,CAAC;kBAEjH,CAAC;kBAED,MAAM,CAAC,WAAW,IAAI,YAAY,IAAI,SAAS,CAAC;cAClD,CAAC;cAAC,IAAI,CAAC,CAAC;kBACN,sCAAsC;kBACtC,MAAM,CAAC,YAAY,CAAC,SAAS,CAAC;cAChC,CAAC;UACH,CAAC,CAAC,CAAC;UAEH,WAAW,GAAG,aAAa,CAAC,IAAI,CAAC,EAAE,CAAC,CAAC;MACvC,CAAC;MAED,MAAM,CAAC,WAAW,CAAC;AACrB,GAAC;AAED;;;KAGG;AACH,uBAA4B,MAAc;MACxC,IAAM,MAAM,GAAkB,EAAE,CAAC;MACjC,EAAE,CAAC,CAAC,MAAM,CAAC,CAAC,CAAC;UACX,IAAI,GAAG,GAAW,CAAC,CAAC,CAAC,8BAA8B;UACnD,IAAI,UAAU,SAAiB,CAAC;UAChC,OAAO,UAAU,GAAG,gBAAgB,CAAC,IAAI,CAAC,MAAM,CAAC,EAAE,CAAC;cAClD,IAAM,UAAU,GAAW,UAAU,CAAC,KAAK,CAAC;cAC5C,EAAE,CAAC,CAAC,UAAU,GAAG,GAAG,CAAC,CAAC,CAAC;kBACrB,MAAM,CAAC,IAAI,CAAC;sBACV,SAAS,EAAE,MAAM,CAAC,SAAS,CAAC,GAAG,EAAE,UAAU,CAAC;mBAC7C,CAAC,CAAC;cACL,CAAC;cAED,MAAM,CAAC,IAAI,CAAC;kBACV,KAAK,EAAE,UAAU,CAAC,CAAC,CAAC;kBACpB,YAAY,EAAE,UAAU,CAAC,CAAC,CAAC,CAAC,mBAAmB;eAChD,CAAC,CAAC;cAEH,uDAAuD;cACvD,GAAG,GAAG,gBAAgB,CAAC,SAAS,CAAC;UACnC,CAAC;UAED,oDAAoD;UACpD,MAAM,CAAC,IAAI,CAAC;cACV,SAAS,EAAE,MAAM,CAAC,SAAS,CAAC,GAAG,CAAC;WACjC,CAAC,CAAC;MACL,CAAC;MAED,MAAM,CAAC,MAAM,CAAC;AAChB,GAAC;AA7Be,qBAAW,cA6B1B;AAED;;;;;KAKG;AACH,0BAAwB,UAAyB,EAAE,WAA0B;MAC3E,IAAM,IAAI,GAAoB,QAAQ,CAAC,oBAAoB,CAAC,MAAM,CAAC,CAAC,CAAC,CAAC,CAAC;MACvE,IAAM,YAAY,GAAqB,QAAQ,CAAC,aAAa,CAAC,OAAO,CAAC,CAAC;MAEvE,YAAY,CAAC,IAAI,GAAG,UAAU,CAAC;MAC/B,YAAY,CAAC,WAAW,CAAC,QAAQ,CAAC,cAAc,CAAC,oBAAoB,CAAC,UAAU,CAAC,CAAC,CAAC,CAAC;MAEpF,EAAE,CAAC,CAAC,WAAW,CAAC,CAAC,CAAC;UAChB,IAAI,CAAC,YAAY,CAAC,YAAY,EAAE,WAAW,CAAC,YAAY,CAAC,CAAC;UAC1D,WAAW,CAAC,YAAY,GAAG,YAAY,CAAC;MAC1C,CAAC;MAAC,IAAI,CAAC,CAAC;UACN,IAAI,CAAC,WAAW,CAAC,YAAY,CAAC,CAAC;MACjC,CAAC;MAED,EAAE,CAAC,CAAC,CAAC,WAAW,CAAC,CAAC,CAAC;UACjB,WAAW,CAAC,gBAAgB,CAAC,IAAI,CAAC;cAChC,YAAY,EAAE,YAAY;cAC1B,aAAa,EAAE,UAAU;WAC1B,CAAC,CAAC;MACL,CAAC;AACH,GAAC;AAED;;;;;KAKG;AACH,4BAA0B,UAAyB,EAAE,WAA0B;MAC7E,IAAM,IAAI,GAAoB,QAAQ,CAAC,oBAAoB,CAAC,MAAM,CAAC,CAAC,CAAC,CAAC,CAAC;MACjE,mDAAgB,EAAE,+CAAgB,CAA8B;MAEtE,IAAM,UAAU,GAAgB,gBAAgB,GAAG,gBAAgB,CAAC,UAAU,GAAG,SAAS,CAAC;MAC3F,IAAM,gBAAgB,GAAW,UAAU,GAAG,UAAU,CAAC,OAAO,GAAG,EAAE,CAAC;MACtE,IAAI,mBAAmB,GAAiB,gBAAgB,CAAC,gBAAgB,CAAC,MAAM,GAAG,CAAC,CAAC,CAAC;MACtF,IAAM,iBAAiB,GAAW,oBAAoB,CAAC,UAAU,CAAC,CAAC;MAEnE,EAAE,CAAC,CAAC,CAAC,gBAAgB,IAAI,CAAC,gBAAgB,CAAC,MAAM,GAAG,iBAAiB,CAAC,MAAM,CAAC,GAAG,sBAAsB,CAAC,CAAC,CAAC;UACvG,gBAAgB,GAAG,QAAQ,CAAC,aAAa,CAAC,OAAO,CAA8B,CAAC;UAChF,gBAAgB,CAAC,IAAI,GAAG,UAAU,CAAC;UAEnC,EAAE,CAAC,CAAC,WAAW,CAAC,CAAC,CAAC;cAChB,IAAI,CAAC,YAAY,CAAC,gBAAgB,EAAE,WAAW,CAAC,YAAY,CAAC,CAAC;cAC9D,WAAW,CAAC,YAAY,GAAG,gBAAgB,CAAC;UAC9C,CAAC;UAAC,IAAI,CAAC,CAAC;cACN,IAAI,CAAC,WAAW,CAAC,gBAAgB,CAAC,CAAC;UACrC,CAAC;UAED,EAAE,CAAC,CAAC,CAAC,WAAW,CAAC,CAAC,CAAC;cACjB,mBAAmB,GAAG;kBACpB,YAAY,EAAE,gBAAgB;kBAC9B,aAAa,EAAE,UAAU;eAC1B,CAAC;cACF,gBAAgB,CAAC,IAAI,CAAC,mBAAmB,CAAC,CAAC;UAC7C,CAAC;MACH,CAAC;MAED,gBAAgB,CAAC,UAAU,CAAC,OAAO,IAAI,UAAU,CAAC,iBAAiB,CAAC,CAAC;MACrE,KAAK,CAAC,SAAS,CAAC,IAAI,CAAC,KAAK,CAAC,mBAAmB,CAAC,aAAa,EAAE,UAAU,CAAC,CAAC,CAAC,kBAAkB;MAE7F,4BAA4B;MAC5B,WAAW,CAAC,gBAAgB,GAAG,gBAAgB,CAAC;AAClD,GAAC;AAED;;;KAGG;AACH;MACE,IAAI,UAAU,GAAY,KAAK,CAAC;MAEhC,EAAE,CAAC,CAAC,OAAO,QAAQ,KAAK,WAAW,CAAC,CAAC,CAAC;UACpC,IAAM,UAAU,GAA8B,QAAQ,CAAC,aAAa,CAAC,OAAO,CAA8B,CAAC;UAE3G,UAAU,CAAC,IAAI,GAAG,UAAU,CAAC;UAC7B,UAAU,GAAG,CAAC,CAAC,UAAU,CAAC,UAAU,CAAC;MACvC,CAAC;MAED,MAAM,CAAC,UAAU,CAAC;AACpB,GAAC;;;;;;;;;AC1SD;AACA;AACA;;;;;;;ACFA;AACA;AACA;AACA;AACA,8CAA4C,QAAQ;AACpD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,eAAa;AACb,WAAS;AACT;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,mEAAiE,gBAAgB;AACjF;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,iDAA+C,6CAA6C,EAAE;AAC9F;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,WAAS;AACT;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,WAAS;AACT;AACA;AACA;AACA;AACA;AACA;AACA,+FAA6F,mBAAmB;AAChH;AACA;AACA;AACA;AACA,WAAS;AACT;AACA;AACA;AACA;AACA;AACA,6CAA2C,8BAA8B,EAAE;AAC3E,0CAAwC,yBAAyB,EAAE;AACnE,6DAA2D,0CAA0C,EAAE,E;AACvG;AACA;AACA;AACA;AACA;AACA;AACA,eAAa;AACb;AACA;AACA;AACA,6BAA2B,iBAAiB;AAC5C;AACA;AACA;AACA;AACA;AACA,iCAA+B,0BAA0B;AACzD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,6BAA2B;AAC3B;AACA;AACA,iCAA+B,qBAAqB;AACpD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,uGAAqG,YAAY;AACjH;AACA;AACA;AACA;AACA,mBAAiB;AACjB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,4C;AACA;AACA;AACA;AACA;AACA;AACA;AACA,0FAAwF,iBAAiB;AACzG;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,iDAA+C;AAC/C;AACA;AACA;AACA;AACA,sCAAoC;AACpC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,mBAAiB;AACjB;AACA,WAAS;AACT;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAC;AACD,gDAA8C,cAAc;AAC5D;;;;;;;AClVA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,mBAAiB;AACjB,eAAa;AACb;AACA;AACA,eAAa;AACb;AACA;AACA;AACA;AACA;AACA,GAAC;AACD,gDAA8C,cAAc;AAC5D;;;;;;;;;;;;ACxBA;;;;;;;ACAA;AACA;;AAEA;;AAEA;AACA,iBAAe,oBAAoB;;AAEnC,qD;;;;;;ACRA;AACA;;;AAGA;AACA,6KAA2K,sBAAsB,uCAAuC,eAAe,YAAY,SAAS,kBAAkB,sCAAsC,kBAAkB,cAAc,eAAe,WAAW,kBAAkB,kBAAkB,QAAQ,gBAAgB,SAAS,UAAU,WAAW,sBAAsB,YAAY,iBAAiB,YAAY,UAAU,gBAAgB,kBAAkB,WAAW,gBAAgB,gBAAgB,qBAAqB,qBAAqB,kKAAkK,SAAS,UAAU,6EAA6E,4BAA4B,mBAAmB,kCAAkC,qBAAqB,yBAAyB,iBAAiB,sBAAsB,qBAAqB,kBAAkB,iBAAiB,mBAAmB,YAAY,6CAA6C,mBAAmB,kCAAkC,mBAAmB,iBAAiB,6EAA6E,2BAA2B,wBAAwB,uCAAuC,6BAA6B,yBAAyB,oCAAoC,yCAAyC,6BAA6B,sEAAsE,6BAA6B,yBAAyB,oCAAoC,yCAAyC,6BAA6B,+DAA+D,6BAA6B,yBAAyB,oCAAoC,qCAAqC,6BAA6B,wDAAwD,6BAA6B,yBAAyB,oCAAoC,yCAAyC,6BAA6B,iDAAiD,6BAA6B,yBAAyB,oCAAoC,yCAAyC,6BAA6B,0CAA0C,6BAA6B,yBAAyB,oCAAoC,qCAAqC,6BAA6B,mCAAmC,6BAA6B,yBAAyB,oCAAoC,yCAAyC,6BAA6B,4BAA4B,6BAA6B,yBAAyB,oCAAoC,yCAAyC,6BAA6B,qBAAqB,6BAA6B,yBAAyB,oCAAoC,qCAAqC,+CAA+C,iBAAiB,iDAAiD,mBAAmB,wDAAwD,kBAAkB,0DAA0D,oBAAoB,+CAA+C,iBAAiB,iDAAiD,mBAAmB,wDAAwD,kBAAkB,0DAA0D,oBAAoB,+CAA+C,iBAAiB,iDAAiD,oBAAoB,wDAAwD,kBAAkB,0DAA0D,qBAAqB,+CAA+C,kBAAkB,iDAAiD,oBAAoB,wDAAwD,mBAAmB,0DAA0D,qBAAqB,+CAA+C,kBAAkB,iDAAiD,oBAAoB,wDAAwD,mBAAmB,0DAA0D,qBAAqB,+CAA+C,kBAAkB,iDAAiD,oBAAoB,wDAAwD,mBAAmB,0DAA0D,qBAAqB,+CAA+C,kBAAkB,iDAAiD,oBAAoB,wDAAwD,mBAAmB,0DAA0D,qBAAqB,+CAA+C,kBAAkB,iDAAiD,oBAAoB,wDAAwD,mBAAmB,0DAA0D,qBAAqB,+CAA+C,kBAAkB,iDAAiD,oBAAoB,wDAAwD,mBAAmB,0DAA0D,qBAAqB,qBAAqB,cAAc,eAAe,qCAAqC,cAAc,oCAAoC,kBAAkB,wBAAwB,sBAAsB,sBAAsB,yBAAyB,yBAAyB,sBAAsB,yBAAyB,sBAAsB,wBAAwB,yBAAyB,uBAAuB,sBAAsB,yBAAyB,sBAAsB,2BAA2B,WAAW,yBAAyB,cAAc,4BAA4B,WAAW,4BAA4B,WAAW,2BAA2B,cAAc,0BAA0B,WAAW,4BAA4B,WAAW,0BAA0B,0CAA0C,8BAA8B,yCAAyC,0BAA0B,gBAAgB,0BAA0B,gBAAgB,yBAAyB,gBAAgB,6BAA6B,cAAc,mBAAmB,4BAA4B,kBAAkB,6BAA6B,mBAAmB,2BAA2B,iBAAiB,4BAA4B,qBAAqB,+BAA+B,kBAAkB,oBAAoB,kBAAkB,WAAW,gBAAgB,qBAAqB,gBAAgB,qBAAqB,iBAAiB,4BAA4B,2BAA2B,gDAAgD,kBAAkB,gDAAgD,mBAAmB,gCAAgC,kBAAkB,gCAAgC,mBAAmB,gCAAgC,iBAAiB,gCAAgC,gBAAgB,gCAAgC,iBAAiB,gCAAgC,gBAAgB,sDAAsD,kBAAkB,sDAAsD,mBAAmB,kCAAkC,kBAAkB,kCAAkC,mBAAmB,oCAAoC,kBAAkB,oCAAoC,mBAAmB,kCAAkC,kBAAkB,kCAAkC,mBAAmB,oCAAoC,kBAAkB,oCAAoC,mBAAmB,kCAAkC,mBAAmB,kCAAkC,oBAAoB,oCAAoC,mBAAmB,oCAAoC,oBAAoB,kCAAkC,mBAAmB,kCAAkC,oBAAoB,oCAAoC,mBAAmB,oCAAoC,oBAAoB,kCAAkC,mBAAmB,kCAAkC,oBAAoB,oCAAoC,mBAAmB,oCAAoC,oBAAoB,kCAAkC,mBAAmB,kCAAkC,oBAAoB,oCAAoC,mBAAmB,oCAAoC,oBAAoB,kCAAkC,mBAAmB,kCAAkC,oBAAoB,oCAAoC,mBAAmB,oCAAoC,oBAAoB,kCAAkC,mBAAmB,kCAAkC,oBAAoB,oCAAoC,mBAAmB,oCAAoC,oBAAoB,qCAAqC,iBAAiB,qCAAqC,gBAAgB;;AAErhT;;;;;;;ACPA;AACA;AACA;AACA;AACA,gDAA8C,cAAc;AAC5D,6DAA2D;;;;;;;ACL3D,mD;;;;;;ACAA;AACA;AACA;AACA,qBAAmB,sBAAsB;AACzC;AACA;AACA;AACA,8CAA4C,OAAO;AACnD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,8CAA4C,QAAQ;AACpD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,iFAA+E,sKAAsK;AACrP;AACA;AACA,0CAAwC,gJAAgJ,eAAe,4FAA4F;AACnS;AACA,8DAA4D,6UAA6U;AACzY;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,eAAa;AACb,sHAAoH,qCAAqC;AACzJ,eAAa;AACb;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,mBAAiB;AACjB,0HAAwH,qCAAqC;AAC7J,mBAAiB;AACjB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,eAAa;AACb;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,0CAAwC,qBAAqB;AAC7D;AACA;AACA;AACA,WAAS;AACT;AACA;AACA;AACA;AACA;AACA;AACA,WAAS;AACT;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,6BAA2B,gCAAgC;AAC3D;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,yBAAuB,gCAAgC;AACvD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,mBAAiB;AACjB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,iEAA+D,qIAAqI,4CAA4C,iBAAiB,+BAA+B,EAAE,EAAE,2EAA2E;AAC/W,0EAAwE;AACxE,0EAAwE;AACxE,0EAAwE;AACxE,iEAA+D,gIAAgI,4CAA4C,iBAAiB,kCAAkC,EAAE,EAAE,2EAA2E;AAC7W,0EAAwE;AACxE,0EAAwE;AACxE,iEAA+D,iHAAiH,4CAA4C,iBAAiB,6BAA6B,EAAE,EAAE,2EAA2E;AACzV,gEAA8D,4QAA4Q;AAC1U;AACA;AACA,WAAS;AACT;AACA;AACA,OAAK;AACL;AACA;AACA;AACA;AACA;AACA,oDAAkD,gBAAgB;AAClE;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,6FAA2F,4BAA4B,EAAE;AACzH;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,6FAA2F,gBAAgB;AAC3G;AACA;AACA;AACA;AACA;AACA;AACA,6FAA2F,4BAA4B,EAAE;AACzH,2DAAyD,2BAA2B;AACpF;AACA;AACA;AACA;AACA;AACA,oDAAkD,gBAAgB;AAClE;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,6FAA2F,0CAA0C;AACrI;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,uEAAqE,gBAAgB;AACrF;AACA;AACA;AACA,gGAA8F,uBAAuB,EAAE;AACvH,iEAA+D,8BAA8B;AAC7F;AACA;AACA;AACA;AACA;AACA;AACA,oEAAkE,gBAAgB;AAClF;AACA;AACA;AACA;AACA;AACA;AACA;AACA,uEAAqE,gBAAgB;AACrF;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAC;AACD;;;;;;;AC7qBA;AACA;AACA;AACA,qBAAmB,sBAAsB;AACzC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,eAAa;AACb;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,mBAAiB;AACjB,eAAa;AACb;AACA;AACA;AACA;AACA;AACA;AACA,WAAS;AACT,8CAA4C,oJAAoJ;AAChM,uEAAqE,gEAAgE;AACrI;AACA;AACA;AACA;AACA;AACA;AACA,GAAC;AACD,gDAA8C,cAAc;AAC5D;;;;;;;ACrDA;;;;;;;ACAA;AACA;;AAEA;;AAEA;AACA,iBAAe,oBAAoB;;AAEnC,qD;;;;;;ACRA;AACA;;;AAGA;AACA,+CAA6C,kBAAkB,UAAU,6BAA6B,UAAU,gGAAgG,yBAAyB,qCAAqC,aAAa,gBAAgB,2CAA2C,mBAAmB,8CAA8C,aAAa,cAAc,yBAAyB,oDAAoD,WAAW,yCAAyC,sBAAsB,qBAAqB,sCAAsC,wDAAwD,kBAAkB,6BAA6B,eAAe,UAAU,yBAAyB,mBAAmB,mBAAmB,oBAAoB,2BAA2B,2BAA2B,oBAAoB,8DAA8D,sDAAsD,8CAA8C,2FAA2F,WAAW,2FAA2F,YAAY,0BAA0B,aAAa,4BAA4B,WAAW,YAAY,eAAe,QAAQ,sEAAsE,uBAAuB,aAAa,eAAe,kBAAkB,gBAAgB,4BAA4B,yBAAyB,oIAAoI,0BAA0B,wCAAwC,YAAY,kBAAkB,iBAAiB,iBAAiB;;AAEv1D;;;;;;;ACPA;AACA;AACA;AACA,qBAAmB,sBAAsB;AACzC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,wEAAsE,mMAAmM;AACzQ,uEAAqE,yTAAyT,6BAA6B,EAAE,8CAA8C;AAC3c;AACA,wEAAsE,iOAAiO;AACvS,wEAAsE,yIAAyI;AAC/M;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,WAAS;AACT;AACA;AACA,OAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,WAAS;AACT;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAC;AACD,gDAA8C,cAAc;AAC5D;;;;;;;AC1FA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAC,4CAA4C;AAC7C;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,gCAA8B,kBAAkB;AAChD,iCAA+B,mBAAmB;AAClD,kCAAgC,oBAAoB;AACpD;AACA;AACA;AACA;AACA;AACA;AACA;AACA,sCAAoC,wBAAwB;AAC5D;AACA,0EAAwE,gBAAgB;AACxF;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,sCAAoC,wBAAwB;AAC5D;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,kCAAgC,4BAA4B;AAC5D;AACA;AACA;AACA,OAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,sCAAoC,wBAAwB;AAC5D;AACA,qBAAmB,kBAAkB;AACrC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,sCAAoC,wBAAwB;AAC5D;AACA;AACA,qBAAmB,kBAAkB;AACrC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,kCAAgC,4BAA4B;AAC5D;AACA;AACA;AACA,6CAA2C,wBAAwB;AACnE;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,kCAAgC,4BAA4B;AAC5D;AACA;AACA;AACA;AACA;AACA,kCAAgC,4BAA4B;AAC5D;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,kCAAgC,4BAA4B;AAC5D;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;;;;AC3MA;AACA;AACA;AACA,qBAAmB,sBAAsB;AACzC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAC,kDAAkD;AACnD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,WAAS;AACT;AACA;AACA;AACA;AACA;AACA,iDAA+C,qbAAqb;AACpe,wCAAsC,wBAAwB;AAC9D;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAC;AACD,gDAA8C,cAAc;AAC5D;;;;;;;AC/CA;;;;;;;ACAA;AACA;;AAEA;;AAEA;AACA,iBAAe,oBAAoB;;AAEnC,qD;;;;;;ACRA;AACA;;;AAGA;AACA,2CAAyC,8DAA8D,YAAY,YAAY,gBAAgB,cAAc,kBAAkB,kBAAkB,MAAM,2BAA2B,mBAAmB,mDAAmD,2CAA2C,eAAe,sDAAsD,gGAAgG,eAAe,wBAAwB,eAAe,gBAAgB,qBAAqB,mEAAmE,eAAe,qCAAqC,6DAA6D,uIAAuI,mDAAmD,sBAAsB,2DAA2D,oFAAoF,8DAA8D,qDAAqD,sGAAsG,qDAAqD,qBAAqB,+DAA+D,UAAU,6CAA6C,WAAW,kBAAkB,YAAY,OAAO,QAAQ,qEAAqE,mBAAmB,eAAe,oIAAoI,2BAA2B,kBAAkB;;AAE/0D;;;;;;;ACPA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAC;AACD,gDAA8C,cAAc;AAC5D;;;;;;;ACZA;AACA;AACA;AACA,qBAAmB,sBAAsB;AACzC;AACA;AACA;AACA,8CAA4C,OAAO;AACnD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,8CAA4C,QAAQ;AACpD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,6BAA2B,2BAA2B;AACtD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,mDAAiD,gBAAgB;AACjE;AACA;AACA;AACA;AACA;AACA,0FAAwF;AACxF;AACA,8CAA4C,mEAAmE;AAC/G,4DAA0D,0aAA0a;AACpe,wCAAsC,mEAAmE;AACzG,uEAAqE,2BAA2B;AAChG,8CAA4C,oLAAoL;AAChO;AACA;AACA;AACA,mDAAiD,gBAAgB;AACjE;AACA;AACA;AACA;AACA;AACA;AACA,mDAAiD,gBAAgB;AACjE;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,yBAAuB,eAAe;AACtC;AACA;AACA,yBAAuB,gBAAgB;AACvC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAC;AACD,gDAA8C,cAAc;AAC5D;;;;;;;ACtKA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAC,4CAA4C;AAC7C;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,gCAA8B,kBAAkB;AAChD,iCAA+B,mBAAmB;AAClD,kCAAgC,oBAAoB;AACpD;AACA;AACA;AACA;AACA;AACA;AACA;AACA,sCAAoC,wBAAwB;AAC5D;AACA,0EAAwE,gBAAgB;AACxF;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,sCAAoC,wBAAwB;AAC5D;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,kCAAgC,4BAA4B;AAC5D;AACA;AACA;AACA,OAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,sCAAoC,wBAAwB;AAC5D;AACA,qBAAmB,kBAAkB;AACrC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,sCAAoC,wBAAwB;AAC5D;AACA;AACA,qBAAmB,kBAAkB;AACrC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,kCAAgC,4BAA4B;AAC5D;AACA;AACA;AACA,6CAA2C,wBAAwB;AACnE;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,kCAAgC,4BAA4B;AAC5D;AACA;AACA;AACA;AACA;AACA,kCAAgC,4BAA4B;AAC5D;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,kCAAgC,4BAA4B;AAC5D;AACA;AACA;AACA;AACA;AACA;AACA,+CAA6C,4BAA4B;AACzE;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAC;AACD;;;;;;;ACjRA;;;;;;;ACAA;AACA;;AAEA;;AAEA;AACA,iBAAe,oBAAoB;;AAEnC,qD;;;;;;ACRA;AACA;;;AAGA;AACA,4CAA0C,WAAW,kBAAkB,+BAA+B,WAAW,8BAA8B,mBAAmB,sBAAsB,sDAAsD,cAAc,oBAAoB,kBAAkB,UAAU,QAAQ,mCAAmC,2BAA2B,UAAU,0BAA0B,aAAa,kBAAkB,SAAS,yCAAyC,mBAAmB,sBAAsB,sBAAsB,qCAAqC,WAAW,gBAAgB,kDAAkD,cAAc;;AAEtqB;;;;;;;ACPA;;;;;;;ACAA;AACA;;AAEA;;AAEA;AACA,iBAAe,oBAAoB;;AAEnC,qD;;;;;;ACRA;AACA;;;AAGA;AACA,qDAAmD,YAAY,SAAS,UAAU,gBAAgB,oBAAoB,qCAAqC,UAAU,qCAAqC,UAAU,kBAAkB,kBAAkB,oBAAoB,UAAU,WAAW,UAAU,YAAY,gBAAgB,SAAS,6CAA6C,aAAa,mUAAmU,mCAAmC,mDAAmD,gBAAgB,kBAAkB,UAAU,qBAAqB,2DAA2D,8DAA8D,+BAA+B,eAAe,gGAAgG,kBAAkB,kBAAkB,oBAAoB,8DAA8D,eAAe,gGAAgG,6FAA6F,gBAAgB,8IAA8I,+BAA+B,eAAe,+BAA+B,eAAe,+BAA+B,eAAe,gJAAgJ,8DAA8D,eAAe,gGAAgG,UAAU,0EAA0E,kBAAkB,+BAA+B,wBAAwB,+BAA+B,qBAAqB,sGAAsG,yEAAyE,sEAAsE,qEAAqE,kEAAkE,iBAAiB,kBAAkB,oIAAoI,eAAe,kBAAkB,cAAc,aAAa,kBAAkB,6BAA6B,0BAA0B,6BAA6B,kBAAkB,6BAA6B,0BAA0B,oCAAoC,+BAA+B,eAAe,+BAA+B,eAAe,+BAA+B,eAAe,sGAAsG,gBAAgB,qCAAqC,+BAA+B,eAAe,+BAA+B,eAAe,+BAA+B,eAAe,yHAAyH,eAAe,gJAAgJ,iBAAiB,8DAA8D,eAAe,gJAAgJ,iBAAiB,oIAAoI,eAAe,iGAAiG;;AAE/sI;;;;;;;ACPA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,eAAa;AACb;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,eAAa;AACb;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,eAAa;AACb;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,eAAa;AACb;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,eAAa;AACb;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,eAAa;AACb;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,eAAa;AACb;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,eAAa;AACb;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,eAAa;AACb;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,eAAa;AACb;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,eAAa;AACb;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,eAAa;AACb;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,eAAa;AACb;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,4DAA0D,gBAAgB;AAC1E;AACA;AACA;AACA,qFAAmF,uBAAuB,EAAE;AAC5G,6DAA2D,8BAA8B;AACzF;AACA,wDAAsD,gBAAgB;AACtE;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,WAAS;AACT;AACA;AACA,OAAK;AACL;AACA;AACA;AACA,WAAS;AACT;AACA;AACA,OAAK;AACL;AACA;AACA;AACA,WAAS;AACT;AACA;AACA,OAAK;AACL;AACA,GAAC;AACD,gDAA8C,cAAc;AAC5D;;;;;;;AC9OA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,eAAa;AACb;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,eAAa;AACb;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,eAAa;AACb;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,eAAa;AACb;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,eAAa;AACb;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,eAAa;AACb;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,eAAa;AACb;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,eAAa;AACb;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,eAAa;AACb;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,eAAa;AACb;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,eAAa;AACb;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,eAAa;AACb;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,4DAA0D,gBAAgB;AAC1E;AACA;AACA;AACA,qFAAmF,uBAAuB,EAAE;AAC5G,6DAA2D,8BAA8B;AACzF;AACA,wDAAsD,gBAAgB;AACtE;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,WAAS;AACT;AACA;AACA,OAAK;AACL;AACA;AACA;AACA,WAAS;AACT;AACA;AACA,OAAK;AACL;AACA;AACA;AACA,WAAS;AACT;AACA;AACA,OAAK;AACL;AACA,GAAC;AACD,gDAA8C,cAAc;AAC5D;;;;;;;AC/NA;AACA;AACA;AACA,qBAAmB,sBAAsB;AACzC;AACA;AACA;AACA;AACA;AACA,8CAA4C,QAAQ;AACpD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,iCAA+B,eAAe;AAC9C;AACA;AACA;AACA;AACA,kBAAgB;AAChB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,6BAA2B,gCAAgC;AAC3D;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAC;AACD,gDAA8C,cAAc;AAC5D;;;;;;;ACnEA;AACA;AACA;AACA,qBAAmB,sBAAsB;AACzC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,gEAA8D,gDAAgD;AAC9G;AACA,WAAS,oBAAoB,uDAAuD,gDAAgD,EAAE,EAAE;AACxI;AACA;AACA;AACA;AACA;AACA;AACA,8CAA4C,6BAA6B,wCAAwC,EAAE,UAAU,iBAAiB;AAC9I;AACA;AACA;AACA;AACA,WAAS;AACT;AACA;AACA,OAAK;AACL;AACA;AACA;AACA,WAAS;AACT;AACA;AACA,OAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,qDAAmD,8DAA8D,EAAE;AACnH;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,WAAS;AACT;AACA;AACA;AACA;AACA,WAAS,oBAAoB,uDAAuD,8BAA8B,EAAE,EAAE;AACtH;AACA;AACA;AACA;AACA;AACA;AACA,GAAC;AACD,gDAA8C,cAAc;AAC5D;;;;;;;AC9GA,mD;;;;;;ACAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,WAAS;AACT;AACA;AACA,OAAK;AACL;AACA;AACA;AACA,WAAS;AACT;AACA;AACA,OAAK;AACL;AACA;AACA;AACA,WAAS;AACT;AACA;AACA,OAAK;AACL;AACA;AACA;AACA,WAAS;AACT;AACA;AACA,WAAS;AACT;AACA;AACA,OAAK;AACL;AACA;AACA;AACA,WAAS;AACT;AACA;AACA,WAAS;AACT;AACA;AACA,OAAK;AACL;AACA;AACA;AACA,WAAS;AACT;AACA;AACA,OAAK;AACL;AACA;AACA;AACA,WAAS;AACT;AACA;AACA,OAAK;AACL;AACA;AACA;AACA,WAAS;AACT;AACA;AACA,WAAS;AACT;AACA;AACA,OAAK;AACL;AACA;AACA;AACA;AACA;AACA,WAAS;AACT;AACA;AACA;AACA;AACA,WAAS;AACT;AACA;AACA,OAAK;AACL;AACA;AACA;AACA,WAAS;AACT;AACA;AACA;AACA,6DAA2D,gBAAgB;AAC3E;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,WAAS;AACT;AACA;AACA,OAAK;AACL;AACA;AACA;AACA,WAAS;AACT;AACA;AACA,OAAK;AACL;AACA;AACA;AACA,WAAS;AACT;AACA;AACA,OAAK;AACL;AACA;AACA;AACA,WAAS;AACT;AACA;AACA,WAAS;AACT;AACA;AACA,OAAK;AACL;AACA;AACA;AACA,WAAS;AACT;AACA;AACA,OAAK;AACL;AACA;AACA;AACA;AACA;AACA,WAAS;AACT;AACA;AACA;AACA;AACA;AACA;AACA;AACA,WAAS;AACT;AACA;AACA,OAAK;AACL;AACA;AACA;AACA,WAAS;AACT;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,WAAS;AACT;AACA;AACA,OAAK;AACL;AACA;AACA;AACA,WAAS;AACT;AACA;AACA,OAAK;AACL;AACA;AACA;AACA,WAAS;AACT;AACA;AACA,OAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,uBAAqB;AACrB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,yCAAuC,eAAe;AACtD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,kCAAgC,YAAY;AAC5C;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,yDAAuD,gBAAgB;AACvE;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,WAAS;AACT;AACA;AACA,OAAK;AACL;AACA;AACA;AACA;AACA;AACA,WAAS;AACT;AACA;AACA;AACA;AACA;AACA;AACA;AACA,WAAS;AACT;AACA;AACA,OAAK;AACL;AACA;AACA;AACA;AACA;AACA,WAAS;AACT;AACA;AACA;AACA;AACA,WAAS;AACT;AACA;AACA,OAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,yDAAuD,gBAAgB;AACvE;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,yDAAuD,gBAAgB;AACvE;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,eAAa;AACb;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,eAAa;AACb;AACA;AACA,eAAa;AACb;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,sEAAoE,gBAAgB;AACpF;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,eAAa;AACb;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,mDAAiD,yBAAyB;AAC1E;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,gCAA8B,UAAU;AACxC;AACA;AACA;AACA;AACA;AACA;AACA;AACA,eAAa;AACb;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,wB;AACA;AACA,2BAAyB;AACzB;AACA;AACA;AACA;AACA,GAAC;AACD,gDAA8C,cAAc;AAC5D;;;;;;;AC5uBA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,WAAS;AACT;AACA;AACA,OAAK;AACL;AACA;AACA;AACA,WAAS;AACT;AACA;AACA,OAAK;AACL;AACA;AACA;AACA,WAAS;AACT;AACA;AACA,OAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA;AACA,eAAa;AACb;AACA;AACA,eAAa;AACb,WAAS;AACT;AACA;AACA,OAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,mBAAiB;AACjB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAC;AACD,gDAA8C,cAAc;AAC5D;;;;;;;AClHA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,WAAS;AACT;AACA,WAAS;AACT;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,eAAa;AACb;AACA;AACA,eAAa;AACb,WAAS;AACT;AACA;AACA,OAAK;AACL;AACA;AACA;AACA,WAAS;AACT;AACA;AACA,OAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,WAAS;AACT;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAC;AACD,gDAA8C,cAAc;AAC5D;;;;;;;AC7KA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,WAAS;AACT;AACA;AACA,OAAK;AACL;AACA;AACA;AACA;AACA;AACA,eAAa;AACb;AACA;AACA,eAAa;AACb,WAAS;AACT;AACA;AACA,OAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,yBAAuB,mBAAmB;AAC1C;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,gDAA8C,6BAA6B;AAC3E;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,WAAS;AACT;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,oDAAkD,8BAA8B;AAChF,sDAAoD,iCAAiC;AACrF,6DAA2D,8BAA8B;AACzF;AACA;AACA,GAAC;AACD,gDAA8C,cAAc;AAC5D;;;;;;;AClIA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,WAAS;AACT;AACA;AACA,OAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAC;AACD,gDAA8C,cAAc;AAC5D;;;;;;;AClCA;AACA;AACA;AACA;AACA,gDAA8C,cAAc;AAC5D,6DAA2D;;;;;;;ACL3D;AACA;AACA;AACA,qBAAmB,sBAAsB;AACzC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,WAAS;AACT;AACA,sCAAoC,kFAAkF,gCAAgC,EAAE,2IAA2I;AACnS;AACA,8CAA4C,sLAAsL,yCAAyC,GAAG;AAC9Q,8CAA4C,qBAAqB,oCAAoC,GAAG;AACxG,8CAA4C,oEAAoE;AAChH;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAC;AACD,gDAA8C,cAAc;AAC5D;;;;;;;ACtKA,mD;;;;;;ACAA;AACA;;AAEA;;AAEA;AACA,iBAAe,oBAAoB;;AAEnC,qD;;;;;;ACRA;AACA;;;AAGA;AACA,yCAAuC,YAAY,iCAAiC,SAAS,eAAe,OAAO,kBAAkB,QAAQ,MAAM,uCAAuC,UAAU,4DAA4D,WAAW,oBAAoB,+DAA+D,oDAAoD,SAAS,aAAa,OAAO,oBAAoB,kBAAkB,QAAQ,MAAM,gCAAgC,wBAAwB,uDAAuD,UAAU,gCAAgC,wBAAwB,+BAA+B,qBAAqB,UAAU,kBAAkB,qVAAqV,UAAU,0CAA0C,2DAA2D,gDAAgD,4DAA4D,UAAU,2CAA2C,kBAAkB,oBAAoB,UAAU,WAAW,UAAU,YAAY,gBAAgB,SAAS;;AAEn7C;;;;;;;ACPA;AACA;;AAEA;;AAEA;AACA,iBAAe,oBAAoB;;AAEnC,qD;;;;;;ACRA;AACA;;;AAGA;AACA,yCAAuC,YAAY,qBAAqB,UAAU,kBAAkB,iCAAiC,SAAS,eAAe,OAAO,kBAAkB,QAAQ,MAAM,uCAAuC,UAAU,4DAA4D,WAAW,oBAAoB,+DAA+D,oDAAoD,SAAS,aAAa,OAAO,oBAAoB,kBAAkB,QAAQ,MAAM,gCAAgC,wBAAwB,uDAAuD,UAAU,gCAAgC,wBAAwB,qVAAqV,UAAU,0CAA0C,2DAA2D,gDAAgD,4DAA4D,UAAU,2CAA2C,kBAAkB,oBAAoB,UAAU,WAAW,UAAU,YAAY,gBAAgB,SAAS;;AAEp5C;;;;;;;ACPA;AACA;AACA;AACA,qBAAmB,sBAAsB;AACzC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,WAAS;AACT,0HAAwH,gJAAgJ;AACxQ,0CAAwC,0CAA0C;AAClF,4CAA0C,kCAAkC;AAC5E;AACA;AACA;AACA;AACA;AACA,yCAAuC,+BAA+B,EAAE;AACxE;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAC;AACD,gDAA8C,cAAc;AAC5D;;;;;;;ACrEA;AACA;;AAEA;;AAEA;AACA,iBAAe,oBAAoB;;AAEnC,qD;;;;;;ACRA;AACA;;;AAGA;AACA,+CAA6C,eAAe,YAAY,eAAe,YAAY,UAAU,iBAAiB,UAAU,UAAU,UAAU,kBAAkB,WAAW,gCAAgC,wBAAwB,wBAAwB,oDAAoD,iDAAiD,+DAA+D,kBAAkB,0CAA0C,eAAe,YAAY,sBAAsB,iBAAiB,UAAU,kBAAkB,kBAAkB,MAAM,WAAW,UAAU,gCAAgC,wBAAwB,0DAA0D,kBAAkB,0BAA0B,mEAAmE,WAAW,WAAW,OAAO,kBAAkB,SAAS,WAAW,gCAAgC,wBAAwB,8BAA8B,UAAU,sDAAsD,aAAa,UAAU,kDAAkD,UAAU,8GAA8G,2DAA2D,gEAAgE,uDAAuD,wCAAwC,yBAAyB,UAAU,oCAAoC,iCAAiC,cAAc,6CAA6C,mBAAmB,eAAe,qDAAqD,mBAAmB,eAAe;;AAEruD;;;;;;;ACPA;AACA;;AAEA;;AAEA;AACA,iBAAe,oBAAoB;;AAEnC,qD;;;;;;ACRA;AACA;;;AAGA;AACA,+CAA6C,eAAe,YAAY,eAAe,YAAY,UAAU,iBAAiB,UAAU,UAAU,UAAU,kBAAkB,WAAW,gCAAgC,wBAAwB,wBAAwB,oDAAoD,iDAAiD,+DAA+D,kBAAkB,0CAA0C,eAAe,YAAY,sBAAsB,iBAAiB,UAAU,kBAAkB,kBAAkB,MAAM,WAAW,UAAU,gCAAgC,wBAAwB,0DAA0D,kBAAkB,0BAA0B,mEAAmE,WAAW,WAAW,OAAO,kBAAkB,SAAS,WAAW,gCAAgC,wBAAwB,8BAA8B,UAAU,sDAAsD,iBAAiB,UAAU,kDAAkD,UAAU,8GAA8G,2DAA2D,gEAAgE,uDAAuD,oCAAoC,iCAAiC,kBAAkB,6CAA6C,mBAAmB,eAAe,qDAAqD,mBAAmB,eAAe;;AAElqD;;;;;;;ACPA;AACA;AACA;AACA;AACA;AACA;AACA,oEAAkE,qEAAqE;AACvI;AACA,oEAAkE,uLAAuL;AACzP,oEAAkE,uHAAuH;AACzL;AACA;AACA,gDAA8C,cAAc;AAC5D;AACA;AACA;AACA;;;;;;;AChBA;AACA;AACA;AACA,qBAAmB,sBAAsB;AACzC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,mFAAiF,sGAAsG;AACvL,WAAS;AACT;AACA;AACA;AACA;AACA,WAAS;AACT,8CAA4C,qDAAqD,gCAAgC,EAAE,qCAAqC;AACxK;AACA;AACA;AACA;AACA;AACA,GAAC;AACD,gDAA8C,cAAc;AAC5D;;;;;;;ACvCA;AACA;AACA;AACA,qBAAmB,sBAAsB;AACzC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,iFAA+E,qIAAqI;AACpN;AACA,0DAAwD,gPAAgP;AACxS;AACA;AACA;AACA;AACA,uFAAqF,iJAAiJ;AACtO,WAAS;AACT;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,WAAS;AACT,8CAA4C,wDAAwD,gCAAgC,EAAE,wCAAwC;AAC9K,gEAA8D,qGAAqG;AACnK;AACA;AACA;AACA;AACA;AACA;AACA,GAAC;AACD,gDAA8C,cAAc;AAC5D;;;;;;;ACzEA;AACA;AACA;AACA,qBAAmB,sBAAsB;AACzC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,+EAA6E,oNAAoN;AACjS;AACA;AACA,uEAAqE,2BAA2B;AAChG,8CAA4C,mDAAmD;AAC/F;AACA,oEAAkE,kNAAkN;AACpR;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAC;AACD,gDAA8C,cAAc;AAC5D;;;;;;;ACzCA;;;;;;;ACAA;AACA;;AAEA;;AAEA;AACA,iBAAe,oBAAoB;;AAEnC,qD;;;;;;ACRA;AACA;;;AAGA;AACA,kDAAgD,kBAAkB,MAAM,WAAW,UAAU,gCAAgC,WAAW,gCAAgC,YAAY,gCAAgC,mBAAmB,gCAAgC,kBAAkB;;AAEzR;;;;;;;ACPA;;;;;;;ACAA;AACA;;AAEA;;AAEA;AACA,iBAAe,oBAAoB;;AAEnC,qD;;;;;;ACRA;AACA;;;AAGA;AACA,iDAA+C,qBAAqB,8BAA8B,6CAA6C,gEAAgE;;AAE/M;;;;;;;ACPA;AACA;AACA;AACA,qBAAmB,sBAAsB;AACzC;AACA;AACA;AACA,8CAA4C,OAAO;AACnD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,6BAA2B,uFAAuF;AAClH;AACA;AACA;AACA;AACA;AACA;AACA;AACA,4DAA0D,kCAAkC;AAC5F,yEAAuE,iDAAiD;AACxH;AACA;AACA;AACA;AACA;AACA,2DAAyD,iCAAiC;AAC1F;AACA;AACA;AACA;AACA;AACA,6DAA2D,4BAA4B;AACvF;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,mFAAiF,gJAAgJ,+GAA+G,wEAAwE;AACxZ;AACA;AACA,iGAA+F;AAC/F,eAAa;AACb,+EAA6E,8IAA8I;AAC3N;AACA;AACA;AACA,eAAa;AACb;AACA,oGAAkG;AAClG,eAAa;AACb,kFAAgF,qJAAqJ;AACrO,8EAA4E,+FAA+F;AAC3K,8DAA4D,+PAA+P;AAC3T,8DAA4D,qQAAqQ;AACjU,8DAA4D,4RAA4R;AACxV,yFAAuF,8FAA8F;AACrL;AACA;AACA;AACA;AACA;AACA,8CAA4C,kEAAkE,6BAA6B,EAAE;AAC7I;AACA;AACA;AACA;AACA,YAAU;AACV;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAC;AACD,gDAA8C,cAAc;AAC5D;;;;;;;AC3KA;AACA;AACA;AACA;AACA;AACA,yCAAuC,4CAA4C;AACnF,qCAAmC,6CAA6C;AAChF,8CAA4C,mFAAmF;AAC/H;AACA,sCAAoC,2CAA2C;AAC/E;AACA,gDAA8C,cAAc;AAC5D;;;;;;;ACZA;;;;;;;ACAA;AACA;;AAEA;;AAEA;AACA,iBAAe,oBAAoB;;AAEnC,qD;;;;;;ACRA;AACA;;;AAGA;AACA,qDAAmD,WAAW,gCAAgC,8DAA8D,mDAAmD,6IAA6I,eAAe,YAAY,mBAAmB,iBAAiB,eAAe,iCAAiC,SAAS,SAAS,gEAAgE,iDAAiD;;AAE9kB;;;;;;;ACPA;AACA;AACA;AACA;AACA,6CAA2C,gFAAgF,mEAAmE,EAAE,2CAA2C;AAC3O,uCAAqC,yEAAyE;AAC9G,uCAAqC,qCAAqC;AAC1E;AACA,gDAA8C,cAAc;AAC5D;;;;;;;ACTA;;;;;;;ACAA;AACA;;AAEA;;AAEA;AACA,iBAAe,oBAAoB;;AAEnC,qD;;;;;;ACRA;AACA;;;AAGA;AACA,+CAA6C,6BAA6B,6BAA6B,WAAW,YAAY,gBAAgB,UAAU,cAAc,kDAAkD,2DAA2D,eAAe,sMAAsM,gDAAgD,wBAAwB,mDAAmD,cAAc,eAAe,iBAAiB,yBAAyB,qDAAqD,cAAc,gGAAgG,eAAe,cAAc,kBAAkB,gBAAgB,uBAAuB,6CAA6C,kDAAkD,eAAe,qDAAqD,kDAAkD,eAAe;;AAEvoC;;;;;;;ACPA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,WAAS;AACT;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,eAAa;AACb;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAC;AACD,gDAA8C,cAAc;AAC5D;;;;;;;ACtDA;;;;;;;ACAA;AACA;;AAEA;;AAEA;AACA,iBAAe,oBAAoB;;AAEnC,qD;;;;;;ACRA;AACA;;;AAGA;AACA,2CAAyC,+CAA+C,yBAAyB,oCAAoC,sBAAsB,aAAa,gBAAgB,gBAAgB,kBAAkB,YAAY,WAAW,OAAO,iBAAiB,kBAAkB,oCAAoC,yBAAyB,6IAA6I,eAAe,mBAAmB,eAAe,qCAAqC,kBAAkB,iBAAiB;;AAE9mB;;;;;;;ACPA;;;;;;;ACAA;AACA;;AAEA;;AAEA;AACA,iBAAe,oBAAoB;;AAEnC,qD;;;;;;ACRA;AACA;;;AAGA;AACA,oCAAkC,eAAe,kBAAkB,oCAAoC,2BAA2B,iBAAiB,cAAc,iBAAiB,oBAAoB,wBAAwB,kBAAkB,wBAAwB,mBAAmB,wBAAwB,mBAAmB,wBAAwB,mBAAmB,yBAAyB,kBAAkB,oBAAoB,UAAU,WAAW,UAAU,YAAY,gBAAgB,SAAS;;AAEpf;;;;;;;ACPA;AACA;AACA;AACA,gDAA8C,cAAc;AAC5D;;;;;;;ACJA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,WAAS;AACT;AACA;AACA,OAAK;AACL;AACA;AACA;AACA,WAAS;AACT;AACA;AACA,OAAK;AACL;AACA;AACA;AACA,WAAS;AACT;AACA;AACA,OAAK;AACL;AACA;AACA;AACA,WAAS;AACT;AACA;AACA,OAAK;AACL;AACA;AACA;AACA,WAAS;AACT;AACA;AACA,OAAK;AACL;AACA;AACA;AACA,WAAS;AACT;AACA;AACA,OAAK;AACL;AACA;AACA;AACA,WAAS;AACT;AACA;AACA,OAAK;AACL;AACA;AACA;AACA,WAAS;AACT;AACA;AACA,OAAK;AACL;AACA;AACA;AACA,WAAS;AACT;AACA;AACA,OAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,WAAS;AACT;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAC;AACD,gDAA8C,cAAc;AAC5D;;;;;;;ACnJA,mD;;;;;;ACAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,WAAS;AACT;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,eAAa;AACb;AACA;AACA;AACA;AACA;AACA;AACA;AACA,kDAAgD,kDAAkD,EAAE;AACpG,kDAAgD,+CAA+C,EAAE;AACjG,qDAAmD,gDAAgD,EAAE;AACrG;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,WAAS;AACT;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,WAAS;AACT;AACA;AACA,WAAS;AACT;AACA;AACA;AACA,WAAS;AACT;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,6EAA2E,+BAA+B;AAC1G;AACA;AACA;AACA,eAAa;AACb,WAAS;AACT;AACA;AACA;AACA;AACA;AACA;AACA;AACA,WAAS;AACT;AACA,WAAS;AACT;AACA;AACA,WAAS;AACT;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,WAAS;AACT;AACA,WAAS;AACT;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAC;AACD,gDAA8C,cAAc;AAC5D;;;;;;;AClMA,mD;;;;;;ACAA;AACA;AACA;AACA;AACA,GAAC,wDAAwD;AACzD;;;;;;;ACLA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,yFAAuF;AACvF;AACA;AACA;AACA;AACA;AACA;AACA;AACA,eAAa;AACb,WAAS;AACT;AACA;AACA;AACA,GAAC;AACD,gDAA8C,cAAc;AAC5D;;;;;;;AC/BA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,oEAAkE;AAClE;AACA;AACA;AACA,eAAa;AACb,WAAS;AACT;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAC;AACD,gDAA8C,cAAc;AAC5D;;;;;;;AC5CA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,WAAS;AACT;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,uDAAqD,gDAAgD,EAAE;AACvG;AACA;AACA;AACA;AACA;AACA;AACA,GAAC;AACD,gDAA8C,cAAc;AAC5D;;;;;;;ACzCA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAC;AACD,gDAA8C,cAAc;AAC5D;;;;;;;AC5BA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAC;AACD,gDAA8C,cAAc;AAC5D;;;;;;;ACbA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,WAAS;AACT;AACA;AACA,OAAK;AACL;AACA,GAAC;AACD,gDAA8C,cAAc;AAC5D;;;;;;;ACzDA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,WAAS;AACT;AACA;AACA;AACA;AACA;AACA;AACA,WAAS;AACT;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,mCAAiC;AACjC;AACA;AACA;AACA;AACA;AACA,2BAAyB;AACzB,uBAAqB;AACrB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,8DAA4D;AAC5D;AACA;AACA;AACA,GAAC;AACD,gDAA8C,cAAc;AAC5D;;;;;;;ACxHA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAC;AACD,gDAA8C,cAAc;AAC5D;;;;;;;ACTA;;;;;;;ACAA;AACA;;AAEA;;AAEA;AACA,iBAAe,oBAAoB;;AAEnC,qD;;;;;;ACRA;AACA;;;AAGA;AACA,iCAA+B,gBAAgB,qBAAqB,sBAAsB,kBAAkB,WAAW,UAAU,kBAAkB,kBAAkB,QAAQ,SAAS,OAAO,iBAAiB,yBAAyB,SAAS,eAAe,aAAa,SAAS,YAAY,yBAAyB,gDAAgD,wDAAwD;;AAEla;;;;;;;ACPA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,6BAA2B,qBAAqB;AAChD;AACA;AACA,6BAA2B,iBAAiB;AAC5C;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,mBAAiB;AACjB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,eAAa;AACb;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,mBAAiB;AACjB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,mBAAiB;AACjB;AACA;AACA;AACA;AACA;AACA;AACA,mBAAiB;AACjB;AACA;AACA;AACA;AACA;AACA;AACA,mBAAiB;AACjB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,mBAAiB;AACjB;AACA;AACA;AACA;AACA;AACA;AACA;AACA,eAAa;AACb;AACA;AACA;AACA;AACA,eAAa;AACb;AACA;AACA;AACA;AACA;AACA,mBAAiB;AACjB;AACA;AACA;AACA,uBAAqB;AACrB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAC;AACD,gDAA8C,cAAc;AAC5D;;;;;;;AC9KA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAC,sDAAsD;AACvD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,6GAA2G,wBAAwB;AACnI;AACA;AACA;AACA,gDAA8C,8BAA8B;AAC5E;AACA;AACA;AACA;AACA;AACA;AACA;AACA,oCAAkC,+BAA+B;AACjE;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,WAAS;AACT;AACA;AACA;AACA;AACA,WAAS;AACT;AACA;AACA,OAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAC;AACD;;;;;;;AC7FA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,sBAAoB,uBAAuB;AAC3C;AACA;AACA;AACA,qBAAmB,gBAAgB;AACnC;AACA;AACA;AACA;AACA;;;;;;;ACvBA,mD;;;;;;ACAA;AACA;AACA;AACA,qBAAmB,sBAAsB;AACzC;AACA;AACA;AACA;AACA;AACA,8CAA4C,QAAQ;AACpD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,iCAA+B,eAAe;AAC9C;AACA;AACA;AACA;AACA,kBAAgB;AAChB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,WAAS;AACT;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAC;AACD,gDAA8C,cAAc;AAC5D;;;;;;;AC3GA;AACA;AACA;AACA,qBAAmB,sBAAsB;AACzC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,eAAa;AACb;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,qKAAmK,iBAAiB,EAAE;AACtL,eAAa;AACb;AACA,eAAa;AACb,WAAS;AACT;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAC;AACD,gDAA8C,cAAc;AAC5D;;;;;;;;;;;AlEvDA,gD;;;;;;ApIAA,gD;;;;;;AeAA,gD;;;;;;ACAA,gD;;;;;;AEAA,gD;;;;;;AKAA,gD;;;;;;iEgLAA;AACA;AACA;AACA,qCAAoC,EAAE;AACtC;AACA;AACA,sCAAqC,EAAE;AACvC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,uCAAsC,EAAE;AACxC,wBAAuB,EAAE,yBAAyB,EAAE,wBAAwB,EAAE;AAC9E;AACA;AACA;AACA;AACA;AACA,MAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA;AACA,8CAA6C,EAAE;AAC/C,yDAAwD,EAAE,8BAA8B,EAAE;AAC1F;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,yCAAwC,EAAE,EAAE,EAAE;AAC9C;AACA;AACA,4CAA2C,EAAE,EAAE,EAAE;AACjD;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA,EAAC,gJ;;;;;;A3LrED,gD;;;;;;AgIAA,gD;;;;;;AsCAA,iD;;;;;;AEAA,iD;;;;;;AgBAA,iD","file":"sp-client-preview_en-us.js","sourcesContent":[" \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId])\n \t\t\treturn installedModules[moduleId].exports;\n\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\texports: {},\n \t\t\tid: moduleId,\n \t\t\tloaded: false\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.loaded = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(0);\n\n\n\n// WEBPACK FOOTER //\n// webpack/bootstrap acf93f1fccd12e588f91"," \t// install a JSONP callback for chunk loading\n \tvar parentJsonpFunction = window[\"webpackJsonp4d5eb168_6729_49a8_aec7_0e397f486b6e\"];\n \twindow[\"webpackJsonp4d5eb168_6729_49a8_aec7_0e397f486b6e\"] = function webpackJsonpCallback(chunkIds, moreModules) {\n \t\t// add \"moreModules\" to the modules object,\n \t\t// then flag all \"chunkIds\" as loaded and fire callback\n \t\tvar moduleId, chunkId, i = 0, callbacks = [];\n \t\tfor(;i < chunkIds.length; i++) {\n \t\t\tchunkId = chunkIds[i];\n \t\t\tif(installedChunks[chunkId])\n \t\t\t\tcallbacks.push.apply(callbacks, installedChunks[chunkId]);\n \t\t\tinstalledChunks[chunkId] = 0;\n \t\t}\n \t\tfor(moduleId in moreModules) {\n \t\t\tmodules[moduleId] = moreModules[moduleId];\n \t\t}\n \t\tif(parentJsonpFunction) parentJsonpFunction(chunkIds, moreModules);\n \t\twhile(callbacks.length)\n \t\t\tcallbacks.shift().call(null, __webpack_require__);\n\n \t};\n\n \t// The module cache\n \tvar installedModules = {};\n\n \t// object to store loaded and loading chunks\n \t// \"0\" means \"already loaded\"\n \t// Array means \"loading\", array contains callbacks\n \tvar installedChunks = {\n \t\t0:0\n \t};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId])\n \t\t\treturn installedModules[moduleId].exports;\n\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\texports: {},\n \t\t\tid: moduleId,\n \t\t\tloaded: false\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.loaded = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n \t// This file contains only the entry chunk.\n \t// The chunk loading function for additional chunks\n \t__webpack_require__.e = function requireEnsure(chunkId, callback) {\n \t\t// \"0\" is the signal for \"already loaded\"\n \t\tif(installedChunks[chunkId] === 0)\n \t\t\treturn callback.call(null, __webpack_require__);\n\n \t\t// an array means \"currently loading\".\n \t\tif(installedChunks[chunkId] !== undefined) {\n \t\t\tinstalledChunks[chunkId].push(callback);\n \t\t} else {\n \t\t\t// start chunk loading\n \t\t\tinstalledChunks[chunkId] = [callback];\n \t\t\tvar head = document.getElementsByTagName('head')[0];\n \t\t\tvar script = document.createElement('script');\n \t\t\tscript.type = 'text/javascript';\n \t\t\tscript.charset = 'utf-8';\n \t\t\tscript.async = true;\n\n \t\t\tscript.src = __webpack_require__.p + \"\" + chunkId + \".\" + ({\"1\":\"sp-client-preview-ckeditor\",\"2\":\"sp-client-preview-quill\"}[chunkId]||chunkId) + \"_\" + {\"1\":\"4fa705a88e7c5a9e909d\",\"2\":\"64fe5b96dad24235c8c8\"}[chunkId] + \".js\";\n \t\t\thead.appendChild(script);\n \t\t}\n \t};\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(0);\n\n\n\n// WEBPACK FOOTER //\n// webpack/bootstrap 795e6d067650f6b23263\n\n\n// WEBPACK FOOTER //\n// webpack/bootstrap 795e6d067650f6b23263","\"use strict\";\nfunction __export(m) {\n    for (var p in m) if (!exports.hasOwnProperty(p)) exports[p] = m[p];\n}\n__export(require('./platform-exports'));\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./lib/local/bundles/index.js\n// module id = 0\n// module chunks = 0\n\n\n// WEBPACK FOOTER //\n// webpack:///lib/local/bundles/index.js","\"use strict\";\nrequire('set-webpack-public-path!');\nvar ClientSideApplication_1 = require('../framework/shell/ClientSideApplication');\nexports.ClientSideApplication = ClientSideApplication_1.default;\nvar AppPageContext_1 = require('../framework/pageContext/AppPageContext');\nexports.PageContext = AppPageContext_1.default;\nexports.pageContextServiceKey = AppPageContext_1.appPageContextServiceKey;\nvar SPSite_1 = require('../framework/pageContext/SPSite');\nexports.SPSite = SPSite_1.default;\nvar SPWeb_1 = require('../framework/pageContext/SPWeb');\nexports.SPWeb = SPWeb_1.default;\nvar SPList_1 = require('../framework/pageContext/SPList');\nexports.SPList = SPList_1.default;\nvar SPListItem_1 = require('../framework/pageContext/SPListItem');\nexports.SPListItem = SPListItem_1.default;\nvar SPNavigationNode_1 = require('../framework/pageContext/SPNavigationNode');\nexports.SPNavigationNode = SPNavigationNode_1.default;\nvar SPNavigationNodeCollection_1 = require('../framework/pageContext/SPNavigationNodeCollection');\nexports.SPNavigationNodeCollection = SPNavigationNodeCollection_1.default;\nvar SPUser_1 = require('../framework/pageContext/SPUser');\nexports.SPUser = SPUser_1.default;\nvar Canvas_1 = require('../appBase/components/sp-canvas/canvas/canvas/Canvas');\nexports.Canvas = Canvas_1.default;\nvar _spShell_1 = require('../framework/shell/_spShell');\nexports._spShell = _spShell_1.default;\nvar alternativeUrls_1 = require('../alternativeUrls/alternativeUrls');\nexports.AlternativeUrlMap = alternativeUrls_1.AlternativeUrlMap;\nexports.UserPhotoSize = alternativeUrls_1.UserPhotoSize;\nvar GuidHelpers_1 = require('../framework/basicTypes/GuidHelpers');\nexports.GuidHelpers = GuidHelpers_1.default;\nvar UrlUtilities_1 = require('../utilities/url/UrlUtilities');\nexports.getPathNameFromAbsoluteUrl = UrlUtilities_1.getPathNameFromAbsoluteUrl;\nexports.combineURLPaths = UrlUtilities_1.combineURLPaths;\nvar WebPartRte_1 = require('../appBase/components/sp-rte/rte/webPartRte/WebPartRte');\nexports.WebPartRte = WebPartRte_1.default;\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./lib/local/bundles/platform-exports.js\n// module id = 1\n// module chunks = 0\n\n\n// WEBPACK FOOTER //\n// webpack:///lib/local/bundles/platform-exports.js","var scripts = document.getElementsByTagName('script');\r\nvar regex = new RegExp('ScriptLoadName-DoNotChange', 'i');\r\nvar found = false;\r\n\r\nif (scripts && scripts.length) {\r\n  for (var i = 0; i < scripts.length; i++) {\r\n    if (!scripts[i]) continue;\r\n    var path = scripts[i].getAttribute('src');\r\n    if (path && path.match(regex)) {\r\n      __webpack_public_path__ = path.substring(0, path.lastIndexOf('/') + 1);\r\n      found = true;\r\n      break;\r\n    }\r\n  }\r\n}\r\n\r\nif (!found) {\r\n  for (var global in window.__setWebpackPublicPathLoaderSrcRegistry__) {\r\n    if (global && global.match(regex)) {\r\n      __webpack_public_path__ = global.substring(0, global.lastIndexOf('/') + 1);\r\n      break;\r\n    }\r\n  }\r\n}\n\n\n//////////////////\n// WEBPACK FOOTER\n// D:/agent/1/_work/24/s/common/~/@microsoft/loader-set-webpack-public-path/lib\n// module id = 2\n// module chunks = 0\n\n\n// WEBPACK FOOTER //\n// webpack:///D:/agent/1/_work/24/s/common/~/@microsoft/loader-set-webpack-public-path/lib","\"use strict\";\nvar SuiteNavManagerConfiguration_1 = require('./SuiteNavManagerConfiguration');\nvar ClientSideApplication = (function () {\n    function ClientSideApplication() {\n        this._shell = undefined;\n        this._domElement = undefined;\n        this['__type'] = 'ClientSideApplication';\n    }\n    Object.defineProperty(ClientSideApplication.prototype, \"shell\", {\n        get: function () {\n            return this._shell;\n        },\n        set: function (value) {\n            throw new Error('The property cannot be assigned because it is read-only');\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(ClientSideApplication.prototype, \"domElement\", {\n        get: function () {\n            return this._domElement;\n        },\n        set: function (value) {\n            throw new Error('The property cannot be assigned because it is read-only');\n        },\n        enumerable: true,\n        configurable: true\n    });\n    ClientSideApplication.prototype.load = function (shell) {\n        this._shell = shell;\n        this.onLoad();\n    };\n    ClientSideApplication.prototype.onLoad = function () {\n    };\n    ClientSideApplication.prototype.render = function (domElement) {\n        this._domElement = domElement;\n        this.onRender();\n    };\n    ClientSideApplication.prototype.onRender = function () {\n    };\n    ClientSideApplication.prototype.suiteNavConfiguration = function () {\n        return new SuiteNavManagerConfiguration_1.default(this._shell.appPageContext);\n    };\n    return ClientSideApplication;\n}());\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.default = ClientSideApplication;\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./lib/local/framework/shell/ClientSideApplication.js\n// module id = 3\n// module chunks = 0\n\n\n// WEBPACK FOOTER //\n// webpack:///lib/local/framework/shell/ClientSideApplication.js","\"use strict\";\nvar SuiteNavLinkIds_1 = require('../../common/suiteNav/models/SuiteNavLinkIds');\nvar SuiteNavManagerConfiguration = (function () {\n    function SuiteNavManagerConfiguration(pageContext) {\n        this._pageContext = pageContext;\n        this._currentUICultureName = this._pageContext.core.currentUICultureName;\n        this._webServerRelativeUrl = this._pageContext.core.webServerRelativeUrl;\n        this._o365ShellRenderSettings = {\n            disableDelayLoad: false,\n            disableShellPlus: false,\n            layout: 'Mouse',\n            top: undefined\n        };\n        this._hamburgerMenuCallback = undefined;\n        this._suiteNavPostRenderCallback = undefined;\n        this._systemUserKey = this._pageContext.core.systemUserKey;\n        this._siteClientTag = this._pageContext.core.siteClientTag;\n        this._isSuiteNavDisabled = this._shouldDisableSuiteNav();\n        if (this._pageContext.core.menuData) {\n            this._settingsLinks = this._pageContext.core.menuData['SettingsData'];\n            this._signoutUrl = this._pageContext.core.menuData['SignOutUrl'];\n        }\n    }\n    SuiteNavManagerConfiguration.prototype.isSuiteNavDisabled = function () {\n        return this._isSuiteNavDisabled;\n    };\n    SuiteNavManagerConfiguration.prototype.disableSuiteNav = function () {\n        this._isSuiteNavDisabled = true;\n    };\n    SuiteNavManagerConfiguration.prototype.modifySuiteNavData = function (suiteNavData) {\n        suiteNavData.CurrentMainLinkElementID = SuiteNavLinkIds_1.default.SITES;\n        suiteNavData.CurrentWorkloadSettingsSubLinks =\n            this._settingsLinks && this._settingsLinks.length > 0 ? this._settingsLinks : undefined;\n        suiteNavData.FeedbackLink = undefined;\n        if (suiteNavData.SignOutLink) {\n            suiteNavData.SignOutLink.Url = this._signoutUrl;\n        }\n        if (suiteNavData.HelpLink) {\n            suiteNavData.HelpLink.Url = 'https://go.microsoft.com/fwlink/p/?linkid=827181';\n        }\n        return suiteNavData;\n    };\n    ;\n    Object.defineProperty(SuiteNavManagerConfiguration.prototype, \"systemUserKey\", {\n        get: function () {\n            return this._systemUserKey || '';\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(SuiteNavManagerConfiguration.prototype, \"cacheToken\", {\n        get: function () {\n            var clientTag = this._siteClientTag;\n            if (clientTag !== undefined) {\n                return clientTag.substring(0, clientTag.indexOf('$$'));\n            }\n            return '';\n        },\n        enumerable: true,\n        configurable: true\n    });\n    ;\n    Object.defineProperty(SuiteNavManagerConfiguration.prototype, \"o365ShellRenderSettings\", {\n        get: function () {\n            return this._o365ShellRenderSettings;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(SuiteNavManagerConfiguration.prototype, \"currentUICultureName\", {\n        get: function () {\n            return this._currentUICultureName;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(SuiteNavManagerConfiguration.prototype, \"webServerRelativeUrl\", {\n        get: function () {\n            return this._webServerRelativeUrl;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(SuiteNavManagerConfiguration.prototype, \"hamburgerCallback\", {\n        get: function () {\n            return this._hamburgerMenuCallback;\n        },\n        set: function (hamburgerCallback) {\n            this._hamburgerMenuCallback = hamburgerCallback;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(SuiteNavManagerConfiguration.prototype, \"suiteNavPostRenderCallback\", {\n        get: function () {\n            return this._suiteNavPostRenderCallback;\n        },\n        set: function (suiteNavPostRenderCallback) {\n            this._suiteNavPostRenderCallback = suiteNavPostRenderCallback;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    SuiteNavManagerConfiguration.prototype._shouldDisableSuiteNav = function () {\n        return (window.location.hostname === 'localhost' ||\n            this._pageContext.urlQueryParameters.getValue('disableSuiteNav') === 'true') ?\n            true :\n            false;\n    };\n    return SuiteNavManagerConfiguration;\n}());\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.default = SuiteNavManagerConfiguration;\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./lib/local/framework/shell/SuiteNavManagerConfiguration.js\n// module id = 4\n// module chunks = 0\n\n\n// WEBPACK FOOTER //\n// webpack:///lib/local/framework/shell/SuiteNavManagerConfiguration.js","\"use strict\";\nvar SuiteNavLinkIds = (function () {\n    function SuiteNavLinkIds() {\n    }\n    SuiteNavLinkIds.CUSTOM_SETTINGS_1 = 'WorkloadSettingsSubLinks1';\n    SuiteNavLinkIds.CUSTOM_SETTINGS_2 = 'WorkloadSettingsSubLinks2';\n    SuiteNavLinkIds.CUSTOM_SETTINGS_3 = 'WorkloadSettingsSubLinks3';\n    SuiteNavLinkIds.FEEDBACK = 'ShellFeedback';\n    SuiteNavLinkIds.DIAGNOSTICS = 'Diagnostics';\n    SuiteNavLinkIds.O365_SETTINGS = 'ShellO365Settings'; \n    SuiteNavLinkIds.ADD_APP = 'SuiteMenu_zz5_MenuItemCreate'; \n    SuiteNavLinkIds.CREATE_PAGE = 'SuiteMenu_MenuItemCreatePage'; \n    SuiteNavLinkIds.SITE_CONTENTS = 'SuiteMenu_zz6_MenuItem_ViewAllSiteContents'; \n    SuiteNavLinkIds.SITE_SETTINGS = 'SuiteMenu_zz7_MenuItem_Settings'; \n    SuiteNavLinkIds.USER_ACTIVITY = 'UserActivity'; \n    SuiteNavLinkIds.ABOUT_ME = 'ShellAboutMe'; \n    SuiteNavLinkIds.SETTINGS = 'ShellSettings'; \n    SuiteNavLinkIds.MY_SETTINGS = 'SuiteMenu_zz2_ID_PersonalInformation'; \n    SuiteNavLinkIds.SIGN_OUT = 'ShellSignout';\n    SuiteNavLinkIds.HELP = 'HelpLink';\n    SuiteNavLinkIds.COMMUNITY = 'ShellCommunity';\n    SuiteNavLinkIds.PRIVACY = 'ShellPrivacy';\n    SuiteNavLinkIds.LEGAL = 'ShellLegal';\n    SuiteNavLinkIds.MAIL = 'ShellMail'; \n    SuiteNavLinkIds.CALENDAR = 'ShellCalendar';\n    SuiteNavLinkIds.PEOPLE = 'ShellPeople';\n    SuiteNavLinkIds.ONEDRIVE = 'ShellDocuments'; \n    SuiteNavLinkIds.WORD = 'ShellWordOnline';\n    SuiteNavLinkIds.EXCEL = 'ShellExcelOnline';\n    SuiteNavLinkIds.POWERPOINT = 'ShellPowerPointOnline';\n    SuiteNavLinkIds.ONENOTE = 'ShellOneNoteOnline';\n    SuiteNavLinkIds.SITES = 'ShellSites';\n    SuiteNavLinkIds.YAMMER = 'ShellYammer';\n    SuiteNavLinkIds.TASKS = 'ShellTasks';\n    SuiteNavLinkIds.POWER_BI = 'ShellPowerBI';\n    SuiteNavLinkIds.DELVE = 'ShellOfficeGraph'; \n    SuiteNavLinkIds.VIDEO = 'ShellVideo';\n    SuiteNavLinkIds.ALCHEMY = 'ShellAlchemy';\n    SuiteNavLinkIds.SMILE = 'ShellSendASmile';\n    return SuiteNavLinkIds;\n}());\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.default = SuiteNavLinkIds;\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./lib/local/common/suiteNav/models/SuiteNavLinkIds.js\n// module id = 5\n// module chunks = 0\n\n\n// WEBPACK FOOTER //\n// webpack:///lib/local/common/suiteNav/models/SuiteNavLinkIds.js","\"use strict\";\nvar sp_core_library_1 = require('@microsoft/sp-core-library');\nvar ApplicationContext_1 = require('./ApplicationContext');\nvar SPWeb_1 = require('./SPWeb');\nvar SPSite_1 = require('./SPSite');\nvar SPList_1 = require('./SPList');\nvar SPListItem_1 = require('./SPListItem');\nvar SPUser_1 = require('./SPUser');\nvar SPNavigationNodeCollection_1 = require('./SPNavigationNodeCollection');\nvar PageContextCore_1 = require('./PageContextCore');\nvar AppPageContext = (function () {\n    function AppPageContext(serviceScope) {\n        this._application = new ApplicationContext_1.default(this);\n        this._site = new SPSite_1.default(this);\n        this._web = new SPWeb_1.default(this);\n        this._list = new SPList_1.default(this);\n        this._listItem = new SPListItem_1.default(this);\n        this._quickLaunch = new SPNavigationNodeCollection_1.default(this);\n        this._topNav = new SPNavigationNodeCollection_1.default(this);\n        this._core = new PageContextCore_1.default(this);\n        this._user = new SPUser_1.default(this);\n        this._urlQueryParameters = new sp_core_library_1.UrlQueryParameterCollection(window.location.href);\n    }\n    Object.defineProperty(AppPageContext.prototype, \"application\", {\n        get: function () {\n            return this._application;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(AppPageContext.prototype, \"site\", {\n        get: function () {\n            return this._site;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(AppPageContext.prototype, \"web\", {\n        get: function () {\n            return this._web;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(AppPageContext.prototype, \"list\", {\n        get: function () {\n            return this._list;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(AppPageContext.prototype, \"listItem\", {\n        get: function () {\n            return this._listItem;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(AppPageContext.prototype, \"quickLaunch\", {\n        get: function () {\n            return this._quickLaunch;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(AppPageContext.prototype, \"topNav\", {\n        get: function () {\n            return this._topNav;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(AppPageContext.prototype, \"core\", {\n        get: function () {\n            return this._core;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(AppPageContext.prototype, \"user\", {\n        get: function () {\n            return this._user;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(AppPageContext.prototype, \"urlQueryParameters\", {\n        get: function () {\n            return this._urlQueryParameters;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    return AppPageContext;\n}());\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.default = AppPageContext;\nexports.appPageContextServiceKey = sp_core_library_1.ServiceKey.create('sp-client-preview:PageContext', AppPageContext);\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./lib/local/framework/pageContext/AppPageContext.js\n// module id = 6\n// module chunks = 0\n\n\n// WEBPACK FOOTER //\n// webpack:///lib/local/framework/pageContext/AppPageContext.js","module.exports = __WEBPACK_EXTERNAL_MODULE_2__;\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"@microsoft/sp-core-library\"\n// module id = 2\n// module chunks = 0","\"use strict\";\nvar __extends = (this && this.__extends) || function (d, b) {\n    for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p];\n    function __() { this.constructor = d; }\n    d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n};\nvar PageContextItem_1 = require('./PageContextItem');\nvar GuidHelpers_1 = require('../basicTypes/GuidHelpers');\nvar ApplicationContext = (function (_super) {\n    __extends(ApplicationContext, _super);\n    function ApplicationContext(pageContext) {\n        _super.call(this, pageContext);\n        this._clientSideApplicationId = undefined;\n        this._hostedByClassicPage = undefined;\n    }\n    ApplicationContext.prototype.load = function (args) {\n        this.validateLoad();\n        GuidHelpers_1.default.requireValid(args.clientSideApplicationId);\n        this._clientSideApplicationId = args.clientSideApplicationId;\n        this._hostedByClassicPage = args.hostedByClassicPage;\n        this.state = PageContextItem_1.PageContextItemState.Ready;\n    };\n    Object.defineProperty(ApplicationContext.prototype, \"clientSideApplicationId\", {\n        get: function () {\n            return this._clientSideApplicationId;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(ApplicationContext.prototype, \"hostedByClassicPage\", {\n        get: function () {\n            return this._hostedByClassicPage;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    ApplicationContext.prototype.getOdataObject = function () {\n        return this._hostedByClassicPage === false ? this._odataObject : undefined;\n    };\n    ApplicationContext.prototype.updateOdataObject = function (value) {\n        if (this._hostedByClassicPage === false) {\n            this._odataObject = value;\n        }\n    };\n    return ApplicationContext;\n}(PageContextItem_1.default));\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.default = ApplicationContext;\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./lib/local/framework/pageContext/ApplicationContext.js\n// module id = 8\n// module chunks = 0\n\n\n// WEBPACK FOOTER //\n// webpack:///lib/local/framework/pageContext/ApplicationContext.js","\"use strict\";\n(function (PageContextItemState) {\n    PageContextItemState[PageContextItemState[\"Uninitialized\"] = 0] = \"Uninitialized\";\n    PageContextItemState[PageContextItemState[\"Requested\"] = 1] = \"Requested\";\n    PageContextItemState[PageContextItemState[\"Ready\"] = 2] = \"Ready\";\n})(exports.PageContextItemState || (exports.PageContextItemState = {}));\nvar PageContextItemState = exports.PageContextItemState;\nvar PageContextItem = (function () {\n    function PageContextItem(pageContext) {\n        this._pageContext = pageContext;\n        this._state = PageContextItemState.Uninitialized;\n    }\n    PageContextItem.prototype.getPageContext = function () {\n        return this._pageContext;\n    };\n    Object.defineProperty(PageContextItem.prototype, \"state\", {\n        get: function () {\n            return this._state;\n        },\n        set: function (value) {\n            this._state = value;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    PageContextItem.prototype.validateLoad = function () {\n        if (this._state === PageContextItemState.Ready) {\n            throw new Error('The object has already been loaded');\n        }\n    };\n    return PageContextItem;\n}());\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.default = PageContextItem;\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./lib/local/framework/pageContext/PageContextItem.js\n// module id = 9\n// module chunks = 0\n\n\n// WEBPACK FOOTER //\n// webpack:///lib/local/framework/pageContext/PageContextItem.js","\"use strict\";\nvar GuidHelpers = (function () {\n    function GuidHelpers() {\n    }\n    GuidHelpers.isValid = function (guid) {\n        var regex = new RegExp('^[a-f0-9]{8}(?:-[a-f0-9]{4}){3}-[a-f0-9]{12}$', 'i');\n        return regex.test(guid);\n    };\n    GuidHelpers.requireValid = function (guid) {\n        if (!GuidHelpers.isValid(guid)) {\n            throw Error(\"Invalid GUID syntax \" + guid);\n        }\n    };\n    GuidHelpers.getNormalized = function (guid) {\n        var normalized = guid;\n        var regexp = new RegExp('^/Guid\\\\((.*)\\\\)/', 'i');\n        var result = regexp.exec(guid);\n        if (result) {\n            normalized = result[1];\n        }\n        if (normalized.length === 38) {\n            normalized = normalized.substr(1, 36);\n        }\n        GuidHelpers.requireValid(normalized);\n        return normalized.toLowerCase();\n    };\n    GuidHelpers.generateGuid = function () {\n        return 'AAAAAAAA-AAAA-4AAA-BAAA-AAAAAAAAAAAA'\n            .replace(/[AB]/g, function (character) {\n            var num = Math.random() * 16 | 0;\n            var masked = character === 'A' ? num : (num & 0x3 | 0x8);\n            return masked.toString(16);\n        });\n    };\n    return GuidHelpers;\n}());\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.default = GuidHelpers;\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./lib/local/framework/basicTypes/GuidHelpers.js\n// module id = 10\n// module chunks = 0\n\n\n// WEBPACK FOOTER //\n// webpack:///lib/local/framework/basicTypes/GuidHelpers.js","\"use strict\";\nvar __extends = (this && this.__extends) || function (d, b) {\n    for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p];\n    function __() { this.constructor = d; }\n    d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n};\nvar PageContextItem_1 = require('./PageContextItem');\nvar url_1 = require('../basicTypes/url');\nvar GuidHelpers_1 = require('../basicTypes/GuidHelpers');\nvar SPWeb = (function (_super) {\n    __extends(SPWeb, _super);\n    function SPWeb(pageContext) {\n        _super.call(this, pageContext);\n        this._id = undefined;\n        this._serverRelativeUrl = undefined;\n        this._title = undefined;\n    }\n    SPWeb.prototype.load = function (args) {\n        this.validateLoad();\n        GuidHelpers_1.default.requireValid(args.id);\n        this._id = args.id;\n        url_1.requireServerRelativeUrl(args.serverRelativeUrl);\n        this._serverRelativeUrl = args.serverRelativeUrl;\n        this._title = args.title;\n        this.state = PageContextItem_1.PageContextItemState.Ready;\n    };\n    Object.defineProperty(SPWeb.prototype, \"id\", {\n        get: function () {\n            return this._id;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(SPWeb.prototype, \"serverRelativeUrl\", {\n        get: function () {\n            return this._serverRelativeUrl;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(SPWeb.prototype, \"title\", {\n        get: function () {\n            return this._title;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(SPWeb.prototype, \"parentSite\", {\n        get: function () {\n            return this.getPageContext().site;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    SPWeb.prototype.getOdataObject = function () {\n        return this._odataObject;\n    };\n    SPWeb.prototype.updateOdataObject = function (value) {\n        this._odataObject = value;\n    };\n    return SPWeb;\n}(PageContextItem_1.default));\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.default = SPWeb;\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./lib/local/framework/pageContext/SPWeb.js\n// module id = 11\n// module chunks = 0\n\n\n// WEBPACK FOOTER //\n// webpack:///lib/local/framework/pageContext/SPWeb.js","\"use strict\";\nfunction isServerRelative(url) {\n    return url && url[0] === '/';\n}\nexports.isServerRelative = isServerRelative;\nfunction requireServerRelativeUrl(url) {\n    if (!isServerRelative(url)) {\n        throw Error('A server-relative URL is required');\n    }\n}\nexports.requireServerRelativeUrl = requireServerRelativeUrl;\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./lib/local/framework/basicTypes/url.js\n// module id = 12\n// module chunks = 0\n\n\n// WEBPACK FOOTER //\n// webpack:///lib/local/framework/basicTypes/url.js","\"use strict\";\nvar __extends = (this && this.__extends) || function (d, b) {\n    for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p];\n    function __() { this.constructor = d; }\n    d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n};\nvar PageContextItem_1 = require('./PageContextItem');\nvar GuidHelpers_1 = require('../basicTypes/GuidHelpers');\nvar url_1 = require('../basicTypes/url');\nvar SPSite = (function (_super) {\n    __extends(SPSite, _super);\n    function SPSite(pageContext) {\n        _super.call(this, pageContext);\n        this._id = undefined;\n        this._serverRelativeUrl = undefined;\n        this._title = undefined;\n    }\n    SPSite.prototype.load = function (args) {\n        this.validateLoad();\n        GuidHelpers_1.default.requireValid(args.id);\n        this._id = args.id;\n        url_1.requireServerRelativeUrl(args.serverRelativeUrl);\n        this._serverRelativeUrl = args.serverRelativeUrl;\n        this._title = args.title;\n        this.state = PageContextItem_1.PageContextItemState.Ready;\n    };\n    Object.defineProperty(SPSite.prototype, \"id\", {\n        get: function () {\n            return this._id;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(SPSite.prototype, \"serverRelativeUrl\", {\n        get: function () {\n            return this._serverRelativeUrl;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(SPSite.prototype, \"title\", {\n        get: function () {\n            return this._title;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    return SPSite;\n}(PageContextItem_1.default));\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.default = SPSite;\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./lib/local/framework/pageContext/SPSite.js\n// module id = 13\n// module chunks = 0\n\n\n// WEBPACK FOOTER //\n// webpack:///lib/local/framework/pageContext/SPSite.js","\"use strict\";\nvar __extends = (this && this.__extends) || function (d, b) {\n    for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p];\n    function __() { this.constructor = d; }\n    d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n};\nvar PageContextItem_1 = require('./PageContextItem');\nvar GuidHelpers_1 = require('../basicTypes/GuidHelpers');\nvar SPList = (function (_super) {\n    __extends(SPList, _super);\n    function SPList(pageContext) {\n        _super.call(this, pageContext);\n        this._id = undefined;\n        this._title = undefined;\n        this._description = undefined;\n    }\n    SPList.prototype.load = function (args) {\n        this.validateLoad();\n        GuidHelpers_1.default.requireValid(args.id);\n        this._id = args.id;\n        this._title = args.title;\n        this._description = args.description;\n        this.state = PageContextItem_1.PageContextItemState.Ready;\n    };\n    Object.defineProperty(SPList.prototype, \"id\", {\n        get: function () {\n            return this._id;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(SPList.prototype, \"title\", {\n        get: function () {\n            return this._title;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(SPList.prototype, \"description\", {\n        get: function () {\n            return this._description;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(SPList.prototype, \"parentWeb\", {\n        get: function () {\n            return this.getPageContext().web;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    SPList.prototype.getOdataObject = function () {\n        return this._odataObject;\n    };\n    SPList.prototype.updateOdataObject = function (value) {\n        this._odataObject = value;\n    };\n    return SPList;\n}(PageContextItem_1.default));\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.default = SPList;\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./lib/local/framework/pageContext/SPList.js\n// module id = 14\n// module chunks = 0\n\n\n// WEBPACK FOOTER //\n// webpack:///lib/local/framework/pageContext/SPList.js","\"use strict\";\nvar __extends = (this && this.__extends) || function (d, b) {\n    for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p];\n    function __() { this.constructor = d; }\n    d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n};\nvar PageContextItem_1 = require('./PageContextItem');\nvar SPListItem = (function (_super) {\n    __extends(SPListItem, _super);\n    function SPListItem(pageContext) {\n        _super.call(this, pageContext);\n        this._id = undefined;\n        this._list = undefined;\n    }\n    SPListItem.prototype.load = function (args) {\n        this.validateLoad();\n        this._id = args.id;\n        this.state = PageContextItem_1.PageContextItemState.Ready;\n    };\n    Object.defineProperty(SPListItem.prototype, \"id\", {\n        get: function () {\n            return this._id;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(SPListItem.prototype, \"parentList\", {\n        get: function () {\n            return this.getPageContext().list;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    SPListItem.prototype.getOdataObject = function () {\n        return this._odataObject;\n    };\n    SPListItem.prototype.updateOdataObject = function (value) {\n        this._odataObject = value;\n    };\n    return SPListItem;\n}(PageContextItem_1.default));\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.default = SPListItem;\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./lib/local/framework/pageContext/SPListItem.js\n// module id = 15\n// module chunks = 0\n\n\n// WEBPACK FOOTER //\n// webpack:///lib/local/framework/pageContext/SPListItem.js","\"use strict\";\nvar __extends = (this && this.__extends) || function (d, b) {\n    for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p];\n    function __() { this.constructor = d; }\n    d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n};\nvar PageContextItem_1 = require('./PageContextItem');\nvar SPUser = (function (_super) {\n    __extends(SPUser, _super);\n    function SPUser(pageContext) {\n        _super.call(this, pageContext);\n        this._id = undefined;\n    }\n    SPUser.prototype.load = function (args) {\n        this.validateLoad();\n        this._id = args.id;\n        this.state = PageContextItem_1.PageContextItemState.Ready;\n    };\n    Object.defineProperty(SPUser.prototype, \"id\", {\n        get: function () {\n            return this._id;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    SPUser.prototype.getOdataObject = function () {\n        return this._odataObject;\n    };\n    SPUser.prototype.updateOdataObject = function (value) {\n        this._odataObject = value;\n    };\n    return SPUser;\n}(PageContextItem_1.default));\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.default = SPUser;\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./lib/local/framework/pageContext/SPUser.js\n// module id = 16\n// module chunks = 0\n\n\n// WEBPACK FOOTER //\n// webpack:///lib/local/framework/pageContext/SPUser.js","\"use strict\";\nvar __extends = (this && this.__extends) || function (d, b) {\n    for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p];\n    function __() { this.constructor = d; }\n    d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n};\nvar PageContextItem_1 = require('./PageContextItem');\nvar SPNavigationNodeCollection = (function (_super) {\n    __extends(SPNavigationNodeCollection, _super);\n    function SPNavigationNodeCollection(pageContext) {\n        _super.call(this, pageContext);\n        this.state = PageContextItem_1.PageContextItemState.Ready;\n    }\n    Object.defineProperty(SPNavigationNodeCollection.prototype, \"items\", {\n        get: function () {\n            return this._items;\n        },\n        set: function (value) {\n            this._items = value;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    SPNavigationNodeCollection.prototype.getOdataObject = function () {\n        return this._odataObject;\n    };\n    SPNavigationNodeCollection.prototype.updateOdataObject = function (value) {\n        this._odataObject = value;\n    };\n    return SPNavigationNodeCollection;\n}(PageContextItem_1.default));\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.default = SPNavigationNodeCollection;\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./lib/local/framework/pageContext/SPNavigationNodeCollection.js\n// module id = 17\n// module chunks = 0\n\n\n// WEBPACK FOOTER //\n// webpack:///lib/local/framework/pageContext/SPNavigationNodeCollection.js","\"use strict\";\nvar __extends = (this && this.__extends) || function (d, b) {\n    for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p];\n    function __() { this.constructor = d; }\n    d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n};\nvar sp_page_context_1 = require('@microsoft/sp-page-context');\nvar PageContextItem_1 = require('./PageContextItem');\nvar PageContextCore = (function (_super) {\n    __extends(PageContextCore, _super);\n    function PageContextCore(pageContext) {\n        _super.call(this, pageContext);\n    }\n    PageContextCore.prototype.load = function (args) {\n        this.validateLoad();\n        this._menuData = args.MenuData;\n        this._currentCultureName = args.currentCultureName;\n        this._currentUICultureName = args.currentUICultureName;\n        this._initialCorrelationId = args.correlationId;\n        this._spoEnvironment = args.spoEnvironment;\n        this._farmLabel = args.farmLabel;\n        this._groupColor = args.groupColor;\n        this._hasManageWebPermission = args.hasManageWebPermission;\n        this._isWebWelcomePage = args.isWebWelcomePage;\n        this._listPermsMask = args.listPermsMask;\n        this._layoutsUrl = args.layoutsUrl;\n        this._siteAbsoluteUrl = args.siteAbsoluteUrl;\n        this._siteClientTag = args.siteClientTag;\n        this._siteServerRelativeUrl = args.siteServerRelativeUrl;\n        this._siteSubscriptionId = args.siteSubscriptionId;\n        this._siteId = args.siteId;\n        this._sitePagesEnabled = args.sitePagesEnabled;\n        this._systemUserKey = args.systemUserKey;\n        this._themedCssFolderUrl = args.themedCssFolderUrl;\n        this._userDisplayName = args.userDisplayName;\n        this._userLoginName = args.userLoginName;\n        this._webAbsoluteUrl = args.webAbsoluteUrl;\n        this._webId = args.webId;\n        this._webLogoUrl = args.webLogoUrl;\n        this._webServerRelativeUrl = args.webServerRelativeUrl;\n        this._webTitle = args.webTitle;\n        this._webTemplate = args.webTemplate;\n        this._webPermMasks = new sp_page_context_1.SPPermission(args.webPermMasks);\n        this.state = PageContextItem_1.PageContextItemState.Ready;\n    };\n    Object.defineProperty(PageContextCore.prototype, \"menuData\", {\n        get: function () {\n            return this._menuData;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(PageContextCore.prototype, \"currentCultureName\", {\n        get: function () {\n            return this._currentCultureName;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(PageContextCore.prototype, \"currentUICultureName\", {\n        get: function () {\n            return this._currentUICultureName;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(PageContextCore.prototype, \"initialCorrelationId\", {\n        get: function () {\n            return this._initialCorrelationId;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(PageContextCore.prototype, \"spoEnvironment\", {\n        get: function () {\n            return this._spoEnvironment;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(PageContextCore.prototype, \"farmLabel\", {\n        get: function () {\n            return this._farmLabel;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(PageContextCore.prototype, \"groupColor\", {\n        get: function () {\n            return this._groupColor;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(PageContextCore.prototype, \"layoutsUrl\", {\n        get: function () {\n            return this._layoutsUrl;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(PageContextCore.prototype, \"hasManageWebPermission\", {\n        get: function () {\n            return this._hasManageWebPermission;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(PageContextCore.prototype, \"isWebWelcomePage\", {\n        get: function () {\n            return this._isWebWelcomePage;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(PageContextCore.prototype, \"listPermsMask\", {\n        get: function () {\n            return this._listPermsMask;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(PageContextCore.prototype, \"siteAbsoluteUrl\", {\n        get: function () {\n            return this._siteAbsoluteUrl;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(PageContextCore.prototype, \"siteClientTag\", {\n        get: function () {\n            return this._siteClientTag;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(PageContextCore.prototype, \"siteId\", {\n        get: function () {\n            return this._siteId;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(PageContextCore.prototype, \"sitePagesEnabled\", {\n        get: function () {\n            return this._sitePagesEnabled;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(PageContextCore.prototype, \"siteServerRelativeUrl\", {\n        get: function () {\n            return this._siteServerRelativeUrl;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(PageContextCore.prototype, \"siteSubscriptionId\", {\n        get: function () {\n            return this._siteSubscriptionId;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(PageContextCore.prototype, \"systemUserKey\", {\n        get: function () {\n            return this._systemUserKey;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(PageContextCore.prototype, \"themedCssFolderUrl\", {\n        get: function () {\n            return this._themedCssFolderUrl;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(PageContextCore.prototype, \"userDisplayName\", {\n        get: function () {\n            return this._userDisplayName;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(PageContextCore.prototype, \"userLoginName\", {\n        get: function () {\n            return this._userLoginName;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(PageContextCore.prototype, \"webAbsoluteUrl\", {\n        get: function () {\n            return this._webAbsoluteUrl;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(PageContextCore.prototype, \"webId\", {\n        get: function () {\n            return this._webId;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(PageContextCore.prototype, \"webLogoUrl\", {\n        get: function () {\n            return this._webLogoUrl;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(PageContextCore.prototype, \"webServerRelativeUrl\", {\n        get: function () {\n            return this._webServerRelativeUrl;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(PageContextCore.prototype, \"webTitle\", {\n        get: function () {\n            return this._webTitle;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(PageContextCore.prototype, \"webTemplate\", {\n        get: function () {\n            return this._webTemplate;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    PageContextCore.prototype.getOdataObject = function () {\n        return this._odataObject;\n    };\n    PageContextCore.prototype.updateOdataObject = function (value) {\n        this._odataObject = value;\n    };\n    Object.defineProperty(PageContextCore.prototype, \"userPermissionsForWeb\", {\n        get: function () {\n            return this._webPermMasks;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    return PageContextCore;\n}(PageContextItem_1.default));\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.default = PageContextCore;\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./lib/local/framework/pageContext/PageContextCore.js\n// module id = 18\n// module chunks = 0\n\n\n// WEBPACK FOOTER //\n// webpack:///lib/local/framework/pageContext/PageContextCore.js","module.exports = __WEBPACK_EXTERNAL_MODULE_8__;\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"@microsoft/sp-page-context\"\n// module id = 8\n// module chunks = 0","\"use strict\";\nvar __extends = (this && this.__extends) || function (d, b) {\n    for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p];\n    function __() { this.constructor = d; }\n    d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n};\nvar PageContextItem_1 = require('./PageContextItem');\nvar SPNavigationNode = (function (_super) {\n    __extends(SPNavigationNode, _super);\n    function SPNavigationNode(pageContext) {\n        _super.call(this, pageContext);\n    }\n    SPNavigationNode.prototype.load = function (args) {\n        this.validateLoad();\n        this._id = args.id;\n        this.state = PageContextItem_1.PageContextItemState.Ready;\n    };\n    Object.defineProperty(SPNavigationNode.prototype, \"id\", {\n        get: function () {\n            return this._id;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    SPNavigationNode.prototype.getOdataObject = function () {\n        return this._odataObject;\n    };\n    SPNavigationNode.prototype.updateOdataObject = function (value) {\n        this._odataObject = value;\n    };\n    return SPNavigationNode;\n}(PageContextItem_1.default));\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.default = SPNavigationNode;\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./lib/local/framework/pageContext/SPNavigationNode.js\n// module id = 20\n// module chunks = 0\n\n\n// WEBPACK FOOTER //\n// webpack:///lib/local/framework/pageContext/SPNavigationNode.js","\"use strict\";\nvar React = require('react');\nvar reactDOM = require('react-dom');\nvar sp_core_library_1 = require('@microsoft/sp-core-library');\nvar CanvasComponent_1 = require('../canvasComponent/CanvasComponent');\nvar CanvasStore_1 = require('../canvasComponent/CanvasStore');\nrequire('./Canvas.scss');\nvar Canvas = (function () {\n    function Canvas(container, canvasOptions) {\n        this._render = this._render.bind(this);\n        this._container = container;\n        this._store = new CanvasStore_1.default(canvasOptions.serviceScope, this._render, canvasOptions.mode, canvasOptions.serializedCanvasContent, canvasOptions.handleCanvasChanged, canvasOptions.scrollThreshold);\n    }\n    Canvas.prototype.render = function (serializedCanvas) {\n        this.dispose();\n        this._store.webPartManager.dispose();\n        window.addEventListener('blur', this._store.handleWindowBlur, true);\n        this._store.deserialize(serializedCanvas);\n        this._render();\n    };\n    Object.defineProperty(Canvas.prototype, \"count\", {\n        get: function () {\n            return this._store.controlsProps.length;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(Canvas.prototype, \"previewImageUrl\", {\n        get: function () {\n            return this._store.tryGeneratePreviewImageUrl();\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(Canvas.prototype, \"displayMode\", {\n        get: function () {\n            return this._store.displayMode;\n        },\n        set: function (newMode) {\n            this._store.displayMode = newMode;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Canvas.prototype.dispose = function () {\n        window.removeEventListener('blur', this._store.handleWindowBlur, true);\n        reactDOM.unmountComponentAtNode(this._container);\n    };\n    Canvas.prototype.openToolbox = function (row) {\n        var didToolboxOpen = false;\n        if (this._store.displayMode === sp_core_library_1.DisplayMode.Edit &&\n            0 <= row &&\n            row <= this._store.controlsProps.length) {\n            var hint = document.querySelectorAll('.CanvasToolboxHint')[row];\n            if (CanvasStore_1.default.isLayoutSupported) {\n                this._store.openToolbox(CanvasComponent_1.default.createEmptyZoneLayout(row), hint.offsetTop);\n            }\n            else {\n                this._store.openToolbox(row, hint.offsetTop);\n            }\n            didToolboxOpen = true;\n        }\n        return didToolboxOpen;\n    };\n    Canvas.prototype.serialize = function () {\n        return this._store.serialize();\n    };\n    Canvas.prototype._render = function () {\n        var props = {\n            store: this._store\n        };\n        var coreElement = React.createElement(CanvasComponent_1.default, props);\n        this._coreComponent = reactDOM.render(coreElement, this._container);\n    };\n    return Canvas;\n}());\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.default = Canvas;\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./lib/local/appBase/components/sp-canvas/canvas/canvas/Canvas.js\n// module id = 21\n// module chunks = 0\n\n\n// WEBPACK FOOTER //\n// webpack:///lib/local/appBase/components/sp-canvas/canvas/canvas/Canvas.js","module.exports = __WEBPACK_EXTERNAL_MODULE_3__;\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"react\"\n// module id = 3\n// module chunks = 0","module.exports = __WEBPACK_EXTERNAL_MODULE_4__;\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"react-dom\"\n// module id = 4\n// module chunks = 0","\"use strict\";\nvar __extends = (this && this.__extends) || function (d, b) {\n    for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p];\n    function __() { this.constructor = d; }\n    d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n};\nvar __assign = (this && this.__assign) || Object.assign || function(t) {\n    for (var s, i = 1, n = arguments.length; i < n; i++) {\n        s = arguments[i];\n        for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p))\n            t[p] = s[p];\n    }\n    return t;\n};\nvar React = require('react');\nvar ReactDOM = require('react-dom');\nvar office_ui_fabric_react_1 = require('office-ui-fabric-react');\nvar sp_core_library_1 = require('@microsoft/sp-core-library');\nvar CanvasControlFactory_1 = require('../canvasControl/CanvasControlFactory');\nvar CanvasStore_1 = require('./CanvasStore');\nvar ControlZone_1 = require('../controlZone/ControlZone');\nvar CanvasA11y_1 = require('../../a11y/CanvasA11y');\nvar CanvasToolboxHint_1 = require('../canvasToolboxHint/CanvasToolboxHint');\nvar ConfirmationDialog_1 = require('../confirmationDialog/ConfirmationDialog');\nvar CanvasLayout_1 = require('../canvasLayout/CanvasLayout');\nvar CanvasZone_1 = require('../canvasZone/CanvasZone');\nvar Toolbar_1 = require('../../toolbar/toolbar/Toolbar');\nvar Toolbox_1 = require('../../toolbox/toolbox/Toolbox');\nvar CanvasStrings_resx_1 = require('../../loc/CanvasStrings.resx');\nvar CanvasComponent = (function (_super) {\n    __extends(CanvasComponent, _super);\n    function CanvasComponent(props, context) {\n        _super.call(this, props, context);\n    }\n    CanvasComponent.createEmptyZoneLayout = function (zoneIndex) {\n        return {\n            zoneIndex: zoneIndex,\n            sectionIndex: undefined,\n            controlIndex: undefined\n        };\n    };\n    CanvasComponent.prototype.getChildContext = function () {\n        return {\n            store: this.props.store\n        };\n    };\n    CanvasComponent.prototype.componentDidMount = function () {\n        var canvasElement = ReactDOM.findDOMNode(this);\n        this.props.store.canvasElement = canvasElement;\n        this.props.store.a11yManager = new CanvasA11y_1.CanvasA11yManager(canvasElement);\n        var canvasContainer = canvasElement;\n        var hasScrollbar = false;\n        do {\n            canvasContainer = canvasContainer.parentElement;\n            if (canvasContainer) {\n                var overflowY = window.getComputedStyle(canvasContainer)['overflow-y'];\n                hasScrollbar = (overflowY === 'scroll' || overflowY === 'auto');\n            }\n        } while (!hasScrollbar && canvasContainer && canvasContainer.tagName !== 'BODY');\n        this.props.store.scrollableParent = canvasContainer;\n    };\n    CanvasComponent.prototype.render = function () {\n        return CanvasStore_1.default.isLayoutSupported ? this._renderWithLayout() : this._renderWithoutLayout();\n    };\n    CanvasComponent.prototype._renderWithLayout = function () {\n        var store = this.props.store;\n        var displayMode = store.displayMode;\n        var toolboxProps = store.toolboxProps;\n        var deletedControlLayout = store.deletedControlLayout;\n        var canvasLayout = store.canvasLayout;\n        var selectedLayout = canvasLayout.fetchControlPositionById(store.selectedControlId);\n        var zoneComponents = [];\n        var zones = canvasLayout.zones;\n        var numZones = zones.length;\n        zones.forEach(function (curZone, curIdx) {\n            zoneComponents.push(React.createElement(CanvasZone_1.default, {zone: curZone, selectedPosition: selectedLayout, key: curZone.index}));\n            var nextZoneIndex = (curIdx + 1 === numZones) ?\n                curZone.index + 1 :\n                zones[curIdx + 1].index;\n            var nextZoneLayout = CanvasComponent.createEmptyZoneLayout(nextZoneIndex);\n            zoneComponents.push(React.createElement(CanvasToolboxHint_1.default, {ariaLabel: CanvasStrings_resx_1.default.ToolboxHintTitle, shouldFocus: deletedControlLayout.zoneIndex === nextZoneIndex, row: undefined, layout: nextZoneLayout, key: \"hint.\" + nextZoneLayout.zoneIndex}));\n        });\n        store.deletedControlLayout = CanvasLayout_1.default.undefinedControlPosition;\n        var className = office_ui_fabric_react_1.css('Canvas', 'ms-Grid', {\n            'Canvas--edit': displayMode === sp_core_library_1.DisplayMode.Edit\n        });\n        var firstZoneIdx = zones.length > 0 ?\n            zones[0].index :\n            CanvasLayout_1.default.firstLayoutIndex;\n        var firstZoneLayout = CanvasComponent.createEmptyZoneLayout(firstZoneIdx);\n        var toolBoxHintHasFocus = deletedControlLayout.zoneIndex === firstZoneLayout.zoneIndex;\n        return (React.createElement(\"div\", {className: className, role: displayMode === sp_core_library_1.DisplayMode.Edit ? 'application' : undefined}, \n            React.createElement(CanvasToolboxHint_1.default, {ariaLabel: CanvasStrings_resx_1.default.ToolboxHintTitle, shouldFocus: toolBoxHintHasFocus, row: undefined, layout: firstZoneLayout}), \n            zoneComponents, \n            React.createElement(Toolbox_1.default, __assign({}, toolboxProps)), \n            React.createElement(ConfirmationDialog_1.default, {isOpen: store.isDeleteDialogOpen, message: CanvasStrings_resx_1.default.DeleteConfirmationDialogMessage, onConfirmation: store.handleDeleteDialogConfirmation, onDismiss: store.handleDeleteDialogDismiss, title: CanvasStrings_resx_1.default.DeleteConfirmationDialogTitle})));\n    };\n    CanvasComponent.prototype._renderWithoutLayout = function () {\n        var store = this.props.store;\n        var controlsProps = store.controlsProps;\n        var deletedRow = store.deletedRow;\n        var displayMode = store.displayMode;\n        var toolboxProps = store.toolboxProps;\n        var rows = [];\n        var row = 0;\n        if (controlsProps) {\n            for (var _i = 0, controlsProps_1 = controlsProps; _i < controlsProps_1.length; _i++) {\n                var control = controlsProps_1[_i];\n                var newControl = CanvasControlFactory_1.default.CreateCanvasControl(control, store);\n                if (newControl) {\n                    var isSelected = store.selectedControlId === control.id;\n                    if (isSelected && row) {\n                        rows.pop();\n                        rows.push(React.createElement(CanvasToolboxHint_1.default, {ariaLabel: CanvasStrings_resx_1.default.ToolboxHintTitle, isVisible: true, key: row, row: row}));\n                    }\n                    rows.push(React.createElement(ControlZone_1.default, {displayMode: displayMode, id: control.id, isSelected: isSelected, key: control.id, row: row}, \n                        newControl, \n                        React.createElement(Toolbar_1.default, {controlType: control.controlType, displayMode: displayMode, id: control.id, row: row, onConfigureButtonClick: store.handleConfigureButtonClicked, onDeleteButtonClick: store.handleDeleteButtonClicked})));\n                    ++row;\n                    rows.push(React.createElement(CanvasToolboxHint_1.default, {ariaLabel: CanvasStrings_resx_1.default.ToolboxHintTitle, isVisible: toolboxProps.row === row, shouldFocus: deletedRow === row, key: row, row: row}));\n                }\n            }\n        }\n        store.deletedRow = undefined;\n        var className = office_ui_fabric_react_1.css('Canvas', {\n            'Canvas--edit': displayMode === sp_core_library_1.DisplayMode.Edit\n        });\n        return (React.createElement(\"div\", {className: className, role: displayMode === sp_core_library_1.DisplayMode.Edit ? 'application' : undefined}, \n            React.createElement(CanvasToolboxHint_1.default, {ariaLabel: CanvasStrings_resx_1.default.ToolboxHintTitle, shouldFocus: deletedRow === 0, isVisible: rows[0] && rows[0].props.isSelected || toolboxProps.row === 0, row: 0}), \n            rows, \n            React.createElement(Toolbox_1.default, __assign({}, toolboxProps)), \n            React.createElement(ConfirmationDialog_1.default, {isOpen: store.isDeleteDialogOpen, message: CanvasStrings_resx_1.default.DeleteConfirmationDialogMessage, onConfirmation: store.handleDeleteDialogConfirmation, onDismiss: store.handleDeleteDialogDismiss, title: CanvasStrings_resx_1.default.DeleteConfirmationDialogTitle})));\n    };\n    CanvasComponent.childContextTypes = {\n        store: React.PropTypes.object.isRequired\n    };\n    return CanvasComponent;\n}(React.Component));\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.default = CanvasComponent;\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./lib/local/appBase/components/sp-canvas/canvas/canvasComponent/CanvasComponent.js\n// module id = 24\n// module chunks = 0\n\n\n// WEBPACK FOOTER //\n// webpack:///lib/local/appBase/components/sp-canvas/canvas/canvasComponent/CanvasComponent.js","module.exports = __WEBPACK_EXTERNAL_MODULE_5__;\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"office-ui-fabric-react\"\n// module id = 5\n// module chunks = 0","\"use strict\";\nvar React = require('react');\nvar CanvasControlType_1 = require('./CanvasControlType');\nvar SPRte_1 = require('../../../sp-rte/rte/SPRte');\nvar SPRteTouchDevice_1 = require('../../../sp-rte/rte/SPRteTouchDevice');\nvar WebPartZone_1 = require('../webPartZone/WebPartZone');\nvar Utilities_1 = require('../../common/Utilities');\nvar CanvasControlFactory = (function () {\n    function CanvasControlFactory() {\n    }\n    CanvasControlFactory.CreateCanvasControl = function (props, store) {\n        props.onChange = store.notifyChanged;\n        props.ref = store.addReference;\n        var control;\n        switch (props.controlType) {\n            case CanvasControlType_1.default.RTE:\n                if (Utilities_1.default.isTouchEnabled()) {\n                    control = React.createElement(SPRteTouchDevice_1.default, props);\n                }\n                else {\n                    control = React.createElement(SPRte_1.default, props);\n                }\n                break;\n            case CanvasControlType_1.default.WebPartZone:\n                control = React.createElement(WebPartZone_1.default, props);\n                break;\n        }\n        return control;\n    };\n    return CanvasControlFactory;\n}());\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.default = CanvasControlFactory;\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./lib/local/appBase/components/sp-canvas/canvas/canvasControl/CanvasControlFactory.js\n// module id = 26\n// module chunks = 0\n\n\n// WEBPACK FOOTER //\n// webpack:///lib/local/appBase/components/sp-canvas/canvas/canvasControl/CanvasControlFactory.js","\"use strict\";\nvar CanvasControlType;\n(function (CanvasControlType) {\n    CanvasControlType[CanvasControlType[\"WebPartZone\"] = 3] = \"WebPartZone\";\n    CanvasControlType[CanvasControlType[\"RTE\"] = 4] = \"RTE\";\n    CanvasControlType[CanvasControlType[\"TwoColumns\"] = 5] = \"TwoColumns\";\n    CanvasControlType[CanvasControlType[\"ThreeColumns\"] = 6] = \"ThreeColumns\";\n    CanvasControlType[CanvasControlType[\"OneThirdColumnRight\"] = 7] = \"OneThirdColumnRight\";\n})(CanvasControlType || (CanvasControlType = {}));\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.default = CanvasControlType;\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./lib/local/appBase/components/sp-canvas/canvas/canvasControl/CanvasControlType.js\n// module id = 27\n// module chunks = 0\n\n\n// WEBPACK FOOTER //\n// webpack:///lib/local/appBase/components/sp-canvas/canvas/canvasControl/CanvasControlType.js","\"use strict\";\nvar __extends = (this && this.__extends) || function (d, b) {\n    for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p];\n    function __() { this.constructor = d; }\n    d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n};\nvar __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\n};\nvar React = require('react');\nvar CKTextEditor_1 = require('../ckeditor/CKTextEditor');\nvar QuillEditor_1 = require('../quill/QuillEditor');\nvar sp_core_library_1 = require('@microsoft/sp-core-library');\nvar sp_telemetry_1 = require('@ms/sp-telemetry');\nvar BaseRte_1 = require('./BaseRte');\nvar SPRteQuillConfiguration_1 = require('./SPRteQuillConfiguration');\nvar SPRteCKEditorConfiguration_1 = require('./SPRteCKEditorConfiguration');\nvar office_ui_fabric_react_1 = require('office-ui-fabric-react');\nvar CKEditorFlights_1 = require('../ckeditor/CKEditorFlights');\nvar SPRte = (function (_super) {\n    __extends(SPRte, _super);\n    function SPRte(props) {\n        _super.call(this, props, SPRte._IS_CKEDITOR_FLIGHTED ?\n            { editor: CKTextEditor_1.default, config: new SPRteCKEditorConfiguration_1.default, loader: CKTextEditor_1.default.moduleLoader } :\n            { editor: QuillEditor_1.default, config: new SPRteQuillConfiguration_1.default(), loader: QuillEditor_1.default.moduleLoader });\n        this.TAG_NAME = 'Canvas.';\n        this._restoreScrollTopOnNextFocus = false;\n        this._isPasting = false;\n        this._handleScroll = this._async.debounce(this._handleScroll, 100);\n    }\n    Object.defineProperty(SPRte, \"_IS_CKEDITOR_FLIGHTED\", {\n        get: function () {\n            return sp_core_library_1._SPFlight.isEnabled(CKEditorFlights_1.CKEDITOR_FLIGHT_ID);\n        },\n        enumerable: true,\n        configurable: true\n    });\n    SPRte.prototype.componentDidMount = function () {\n        var _this = this;\n        if (this.state.displayMode === sp_core_library_1.DisplayMode.Edit) {\n            if (!this._createNewEditorMonitor) {\n                this._createNewEditorMonitor = new sp_telemetry_1._QosMonitor(BaseRte_1.CREATE_EDITOR_MONITOR);\n            }\n            this._createNewEditor(this.props.innerHTML || '', true).then(function (editor) {\n                _this._afterEditorCreated(editor);\n                _this.context.store.webPartManager.setPropertyPaneState(undefined);\n                if (!_this.props.addedFromPersistedData) {\n                    _this.focus();\n                }\n                _this._createNewEditorMonitor.writeSuccess();\n            }, function (error) {\n                _this._createNewEditorMonitor.writeUnexpectedFailure(BaseRte_1.CREATE_EDITOR_MONITOR_FAILURE, error, { 'innerHTML': _this.props.innerHTML });\n            });\n        }\n    };\n    SPRte.prototype.componentDidUpdate = function (prevProps, prevState) {\n        _super.prototype.componentDidUpdate.call(this, prevProps, prevState);\n        if (this.state.displayMode === sp_core_library_1.DisplayMode.Edit && this.context.store && this.context.store.scrollableParent) {\n            this._formattingbar ?\n                this.context.store.scrollableParent.addEventListener('scroll', this._handleScroll) :\n                this.context.store.scrollableParent.removeEventListener('scroll', this._handleScroll);\n        }\n    };\n    SPRte.prototype._closeLinkDialog = function () {\n        this._restoreScrollTopOnNextFocus = true;\n        this.context.store.scrollableParent.scrollTop = this._currentScrollTop;\n        _super.prototype._closeLinkDialog.call(this);\n    };\n    SPRte.prototype._openLinkDialog = function (defaultAddress) {\n        if (defaultAddress === void 0) { defaultAddress = ''; }\n        _super.prototype._openLinkDialog.call(this, defaultAddress);\n        this._currentScrollTop = this.context.store.scrollableParent.scrollTop;\n    };\n    SPRte.prototype._restoreOnFocus = function () {\n        var restore = _super.prototype._restoreOnFocus.call(this);\n        if (this._restoreScrollTopOnNextFocus && this._currentScrollTop) {\n            this._restoreScrollTopOnNextFocus = false;\n            this.context.store.scrollableParent.scrollTop = this._currentScrollTop;\n            restore = true;\n        }\n        return restore;\n    };\n    SPRte.prototype._handleTextChange = function () {\n        _super.prototype._handleTextChange.call(this);\n        if (this._isPasting) {\n            this._onAfterPaste();\n        }\n        if (this.state.displayMode === sp_core_library_1.DisplayMode.Edit && this.props.onChange) {\n            this.props.onChange();\n        }\n    };\n    SPRte.prototype._updateFormattingBar = function (isHidden) {\n        if (!this._editorElement) {\n            return;\n        }\n        var updatePosition = true;\n        var newState = {\n            formattingBarPosition: {\n                left: SPRte._TOOLBAR_DEFAULT_POSITION.left,\n                top: SPRte._TOOLBAR_DEFAULT_POSITION.top,\n                position: SPRte._TOOLBAR_DEFAULT_POSITION.position,\n                right: SPRte._TOOLBAR_DEFAULT_POSITION.right\n            },\n            isFormattingBarHidden: isHidden\n        };\n        if (isHidden && this._formattingbarElement) {\n            if (this._editableDiv && document.activeElement && document.activeElement === this._editableDiv) {\n                isHidden = false;\n            }\n            else {\n                var buttonNodes = this._formattingbarElement.querySelectorAll('.ToolbarButton');\n                for (var i = 0; i < buttonNodes.length; i++) {\n                    if (this._isSelectionChangeFromToolbar || document.activeElement.isEqualNode(buttonNodes[i])) {\n                        this._isSelectionChangeFromToolbar = false;\n                        newState.isFormattingBarHidden = false;\n                        newState.formattingBarPosition = this.state.formattingBarPosition;\n                        isHidden = false;\n                        updatePosition = false;\n                        break;\n                    }\n                }\n            }\n            if (isHidden && !document.activeElement.isContentEditable) {\n                window.getSelection().removeAllRanges();\n            }\n        }\n        if (!isHidden) {\n            newState.isFormattingBarHidden = false;\n            if (updatePosition) {\n                newState.formattingBarPosition = this._getFormattingBarPosition();\n            }\n        }\n        this.setState(newState);\n    };\n    SPRte.prototype._onBeforePaste = function () {\n        this._currentScrollTop = this.context.store.scrollableParent.scrollTop;\n        this._isPasting = true;\n    };\n    SPRte.prototype._handleScroll = function () {\n        if (this.state.formattingBarPosition) {\n            var isSticky = this.state.formattingBarPosition.position === 'fixed';\n            if (this._shouldFormattingBarStick() ? !isSticky : isSticky) {\n                var newState = {\n                    formattingBarPosition: this._getFormattingBarPosition(),\n                    isLinkDialogOpen: false\n                };\n                this.setState(newState);\n            }\n        }\n    };\n    SPRte.prototype._getFormattingBarPosition = function () {\n        var left = this._isRtl ? undefined : SPRte._TOOLBAR_DEFAULT_POSITION.left;\n        var top = SPRte._TOOLBAR_DEFAULT_POSITION.top;\n        var right = this._isRtl ? 0 : SPRte._TOOLBAR_DEFAULT_POSITION.right;\n        var position = 'absolute';\n        var isFloating = false;\n        if (this._formattingbarElement) {\n            if (this._currentSelection && this._currentSelection.start !== this._currentSelection.end) {\n                var startBounds = this._editor.getBounds(this._currentSelection.start);\n                var endBounds = this._editor.getBounds(Math.max(0, this._currentSelection.end - 1));\n                if (startBounds.top === endBounds.top) {\n                    isFloating = true;\n                    endBounds.left = startBounds.left <= endBounds.left ? endBounds.left : this._editorElement.offsetWidth;\n                    var toolbarLeft = (startBounds.left + endBounds.left) / 2 - this._formattingbarWidth / 2;\n                    var controlZoneWidth = this._editorElement.offsetWidth + SPRte._CONTROLZONE_PADDING_HORIZONTAL * 2;\n                    left = toolbarLeft + this._formattingbarWidth <= controlZoneWidth ?\n                        Math.max(toolbarLeft, SPRte._TOOLBAR_DEFAULT_POSITION.left) :\n                        controlZoneWidth - this._formattingbarWidth;\n                    top = startBounds.top < SPRte._LINE_HEIGHT ?\n                        SPRte._TOOLBAR_DEFAULT_POSITION.top :\n                        startBounds.top + SPRte._TOOLBAR_DEFAULT_POSITION.top;\n                    position = 'absolute';\n                    if (this._isRtl && left === 0) {\n                        right = undefined;\n                    }\n                }\n            }\n            if (!isFloating && this._shouldFormattingBarStick()) {\n                if (this._isRtl) {\n                    right = right + window.innerWidth -\n                        this._editorElement.getBoundingClientRect().right - SPRte._CONTROLZONE_PADDING_HORIZONTAL;\n                }\n                else {\n                    left = SPRte._TOOLBAR_DEFAULT_POSITION.left +\n                        this._editorElement.getBoundingClientRect().left - SPRte._CONTROLZONE_PADDING_HORIZONTAL;\n                }\n                top = this.context.store.canvasElement.getBoundingClientRect().top +\n                    this.context.store.scrollableParent.scrollTop - this.context.store.scrollThreshold;\n                position = 'fixed';\n            }\n        }\n        return { left: left, top: top, position: position, right: right };\n    };\n    SPRte.prototype._onAfterPaste = function () {\n        var _this = this;\n        sp_telemetry_1._EngagementLogger.logEvent(this.TAG_NAME + 'CopyPaste');\n        this._isPasting = false;\n        this.context.store.scrollableParent.scrollTop = this._currentScrollTop;\n        window.setTimeout(function () {\n            _this.context.store.scrollableParent.scrollTop = _this._currentScrollTop;\n            var range = _this._editor.getSelection();\n            if (range) {\n                var viewportHeight = Math.max(document.documentElement.clientHeight, window.innerHeight || 0);\n                var cursorTop = _this._editor.getBounds(range.start).top;\n                var editorTop = _this._editableDiv.getBoundingClientRect().top;\n                if (editorTop + cursorTop > viewportHeight) {\n                    _this.context.store.scrollableParent.scrollTop =\n                        _this._currentScrollTop + editorTop + cursorTop - viewportHeight + SPRte._LINE_HEIGHT;\n                }\n            }\n        }, 10);\n    };\n    SPRte.prototype._shouldFormattingBarStick = function () {\n        if (this._editorElement && this.context.store.canvasElement) {\n            var editorRelativeTop = this._editorElement.getBoundingClientRect().top - this.context.store.canvasElement.getBoundingClientRect().top;\n            return this.context.store.scrollableParent.scrollTop >\n                this.context.store.scrollThreshold + SPRte._BASE_SCROLL_THRESHOLD +\n                    editorRelativeTop + SPRte._TOOLBAR_DEFAULT_POSITION.top;\n        }\n    };\n    SPRte.contextTypes = {\n        store: React.PropTypes.object.isRequired\n    };\n    SPRte._TOOLBAR_DEFAULT_POSITION = {\n        left: 0,\n        top: -36,\n        position: 'absolute',\n        right: undefined\n    };\n    SPRte._BASE_SCROLL_THRESHOLD = -10;\n    SPRte._CONTROLZONE_PADDING_HORIZONTAL = 8;\n    SPRte._LINE_HEIGHT = 23;\n    __decorate([\n        office_ui_fabric_react_1.autobind\n    ], SPRte.prototype, \"_onBeforePaste\", null);\n    __decorate([\n        office_ui_fabric_react_1.autobind\n    ], SPRte.prototype, \"_handleScroll\", null);\n    __decorate([\n        office_ui_fabric_react_1.autobind\n    ], SPRte.prototype, \"_onAfterPaste\", null);\n    return SPRte;\n}(BaseRte_1.BaseRte));\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.default = SPRte;\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./lib/local/appBase/components/sp-rte/rte/SPRte.js\n// module id = 28\n// module chunks = 0\n\n\n// WEBPACK FOOTER //\n// webpack:///lib/local/appBase/components/sp-rte/rte/SPRte.js","\"use strict\";\nvar __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\n};\nvar office_ui_fabric_react_1 = require('office-ui-fabric-react');\nvar sp_telemetry_1 = require('@ms/sp-telemetry');\nvar sp_core_library_1 = require('@microsoft/sp-core-library');\nvar CKLoader_1 = require('./CKLoader');\nrequire('./CKTextEditor.scss');\nvar CKEditorFlights_1 = require('./CKEditorFlights');\nvar CKTextEditor = (function () {\n    function CKTextEditor(config, currentHTML, editorElement, selectionChangeCallback, textChangeCallback, startUpFocus, onReadyCallback) {\n        this._config = config;\n        this._editorElement = editorElement;\n        this._handleSelectionChange = selectionChangeCallback;\n        this._handleTextChange = textChangeCallback;\n        this._onReadyCallback = onReadyCallback;\n        this._startupFocus = startUpFocus;\n        this._initialize(currentHTML);\n        this._blockStyles =\n            this._config.supportedFormatsArray.filter(function (format) { return format.isBlockStyle; });\n    }\n    CKTextEditor.preloadEditor = function (config) {\n        try {\n            CKTextEditor.moduleLoader.loadModule(config.editorSource);\n        }\n        catch (error) {\n            sp_telemetry_1._TraceLogger.logError(CKTextEditor.logSource, error);\n        }\n    };\n    CKTextEditor.createNewEditor = function (config, currentHTML, editorElement, selectionChangeCallback, textChangeCallback, startupFocus) {\n        return new Promise(function (resolve) {\n            CKTextEditor.moduleLoader.loadModule(config.editorSource).then(function () {\n                var editor = new CKTextEditor(config, currentHTML, editorElement, selectionChangeCallback, textChangeCallback, startupFocus, function () { resolve(editor); });\n            }).catch(function (error) {\n                sp_telemetry_1._TraceLogger.logError(CKTextEditor.logSource, error);\n            });\n        });\n    };\n    CKTextEditor._getSelectedLink = function (editor) {\n        var selection = editor.getSelection();\n        var selectedElement = selection.getSelectedElement();\n        if (!selectedElement || !selectedElement.is('a')) {\n            var ranges = selection.getRanges();\n            if (ranges && ranges.length) {\n                ranges[0].shrink(CKEDITOR.SHRINK_TEXT);\n                selectedElement = editor.elementPath(ranges[0].getCommonAncestor()).contains('a', true);\n            }\n        }\n        return selectedElement;\n    };\n    Object.defineProperty(CKTextEditor, \"_IS_CKEDITOR_TABLEPASTE_FLIGHTED\", {\n        get: function () {\n            return sp_core_library_1._SPFlight.isEnabled(CKEditorFlights_1.CKEDITOR_TABLEPASTE_FLIGHT_ID);\n        },\n        enumerable: true,\n        configurable: true\n    });\n    CKTextEditor.prototype._initialize = function (currentHTML) {\n        this._editorElement.contentEditable = 'true';\n        var config = {\n            allowedContent: 'strong b em i u h2 h3 h4 blockquote ul ol li a[href, target];\\\r\n        p h2 h3 h4 li(ql-align-*,ql-indent-*,quote-true); *{text-align}',\n            on: {\n                change: this._handleTextChange,\n                selectionChange: this._handleSelectionChangeConvert\n            },\n            removePlugins: 'toolbar,contextmenu,menubutton,scayt,liststyle,table,tabletools,magicline,link',\n            extraPlugins: 'justify',\n            removeButtons: '',\n            stylesSet: false,\n            toolbar: [],\n            startupFocus: this._startupFocus\n        };\n        if (CKTextEditor._IS_CKEDITOR_TABLEPASTE_FLIGHTED) {\n            var allowedStyles = 'width,border,line-height,padding,margin-bottom,margin-top;\\\r\n          ,margin-left,margin-right,font-size,border-bottom,border-left;\\\r\n          border-top,border-right,text-align';\n            config.extraAllowedContent = {\n                'tbody thead tfoot tr th td caption col colgroup footer': true,\n                'table': {\n                    attributes: 'width,border,cellpadding,cellspacing,align',\n                    styles: '*'\n                },\n                'tr': {\n                    attributes: 'height,rowspan,colspan,align',\n                    styles: allowedStyles\n                },\n                'td': {\n                    attributes: 'width,colspan,rowspan,align',\n                    styles: allowedStyles\n                },\n                'th': {\n                    attributes: 'align',\n                    styles: allowedStyles\n                },\n                'td p': {\n                    styles: allowedStyles\n                },\n                'td p span': {\n                    styles: allowedStyles\n                }\n            };\n            config.removePlugins = 'toolbar,contextmenu,menubutton,scayt,liststyle,magicline,link,tabletools';\n        }\n        config.disableNativeSpellChecker = false;\n        this._editor = CKEDITOR.inline(this._editorElement, config);\n        this._editor.setData(currentHTML);\n        this._addCustomToolbarCommands();\n    };\n    CKTextEditor.prototype._addCustomToolbarCommands = function () {\n        this._editor.addCommand('unlink', {\n            exec: function (editor) {\n                var linkStyle = new CKEDITOR.style({\n                    element: 'a',\n                    type: CKEDITOR.STYLE_INLINE,\n                    alwaysRemoveElement: 1\n                });\n                editor.removeStyle(linkStyle);\n                return true;\n            }\n        });\n        this._editor.addCommand('link', {\n            contextSensitive: true,\n            exec: function (editor, data) {\n                if (!data) {\n                    editor.execCommand('unlink');\n                }\n                else {\n                    var elem = CKTextEditor._getSelectedLink(editor);\n                    if (elem) {\n                        elem.setAttribute('href', data);\n                        elem.setAttribute('target', '_blank');\n                    }\n                    else {\n                        var linkStyle = new CKEDITOR.style({\n                            name: 'link',\n                            element: 'a',\n                            type: CKEDITOR.STYLE_INLINE,\n                            attributes: { 'href': data, 'target': '_blank' }\n                        });\n                        editor.applyStyle(linkStyle);\n                    }\n                }\n                return true;\n            },\n            refresh: function (editor, path) {\n                var element = path.lastElement && path.lastElement.getAscendant('a', true);\n                if (element && element.getName() === 'a' && element.getAttribute('href') && element.getChildCount()) {\n                    this.setState(CKEDITOR.TRISTATE_ON);\n                }\n                else {\n                    this.setState(CKEDITOR.TRISTATE_OFF);\n                }\n            }\n        });\n        this._editor.addCommand('heading2', this._getHeadingCommandDefinition('h2'));\n        this._editor.addCommand('heading3', this._getHeadingCommandDefinition('h3'));\n        this._editor.addCommand('heading4', this._getHeadingCommandDefinition('h4'));\n        this._editor.on('blur', this._handleSelectionChangeConvert);\n        this._editor.on('loaded', this._handlePluginsLoaded);\n        this._editor.on('instanceReady', this._handleInstanceReady);\n        this._editor.on('paste', this._handlePaste);\n    };\n    CKTextEditor.prototype.clearFormatting = function (start, end) {\n        this.format(start, end, { removeFormat: true });\n        var sel = this._editor.getSelection();\n        if (sel) {\n            var ckRange = sel.getRanges();\n            var range = { start: 0, end: 0 };\n            if (ckRange && ckRange.length > 0) {\n                range.start = ckRange[0].startOffset;\n                range.end = ckRange[0].endOffset;\n                var formatsToClear = {};\n                for (var _i = 0, _a = this._blockStyles; _i < _a.length; _i++) {\n                    var format = _a[_i];\n                    formatsToClear[format.editorKey] = false;\n                }\n                this.format(start, end, formatsToClear, true);\n            }\n        }\n    };\n    CKTextEditor.prototype.destroy = function () {\n        this._editorElement.removeEventListener('keyup', this._fakeSelectionChange);\n        this._editorElement.removeEventListener('mouseup', this._fakeSelectionChange);\n        var data = this._editor.getData();\n        this._editor.destroy();\n        return data;\n    };\n    CKTextEditor.prototype.focus = function () {\n        this._editor.focus();\n    };\n    CKTextEditor.prototype.format = function (start, end, formats, applyAllFormatsToLine) {\n        for (var formatKey in formats) {\n            var command = this._editor.getCommand(formatKey);\n            if (command) {\n                if (formats[formatKey] !== (command.state === CKEDITOR.TRISTATE_ON)) {\n                    command.exec(formats[formatKey]);\n                }\n            }\n        }\n    };\n    CKTextEditor.prototype.getBounds = function (position) {\n        var left = 0, top = 0;\n        var sel = this._editor.getSelection();\n        if (sel) {\n            var ranges = sel.getRanges();\n            if (ranges && ranges.length) {\n                var node = ranges[0].startContainer.$;\n                var docRange = document.createRange();\n                docRange.selectNodeContents(node);\n                var selectionRects = docRange.getClientRects();\n                if (selectionRects && selectionRects.length) {\n                    var editorRect = this._editor.element.$.getBoundingClientRect();\n                    left = selectionRects[0].left - editorRect.left;\n                    top = selectionRects[0].top - editorRect.top;\n                }\n            }\n        }\n        return { left: left, top: top };\n    };\n    CKTextEditor.prototype.getFormatValue = function (start, end, format) {\n        if (format.key === 'link') {\n            var selectedLink = CKTextEditor._getSelectedLink(this._editor);\n            return selectedLink ? selectedLink.getAttribute('href') : false;\n        }\n        return false;\n    };\n    CKTextEditor.prototype.getSelection = function () {\n        var sel = this._editor.getSelection();\n        if (sel) {\n            var ranges = sel ? sel.getRanges() : undefined;\n            if (ranges && ranges.length) {\n                if (this._editor.element.contains(ranges[0].getCommonAncestor())) {\n                    this._lastSelectedRanges = ranges;\n                }\n                return {\n                    start: ranges[0].startOffset,\n                    end: ranges[0].endOffset\n                };\n            }\n        }\n        return undefined;\n    };\n    CKTextEditor.prototype.getText = function (range) {\n        return this._editor.getData();\n    };\n    CKTextEditor.prototype.getHTML = function () {\n        return this._editor.getData();\n    };\n    CKTextEditor.prototype.getEditorType = function () {\n        return 'CKEditor';\n    };\n    CKTextEditor.prototype.isFormatAppliedToRange = function (start, end, format) {\n        var command = this._editor.getCommand(format.editorKey);\n        return command && (command.state === CKEDITOR.TRISTATE_ON);\n    };\n    CKTextEditor.prototype.onReady = function (callback) {\n        this._onReadyCallback = callback;\n    };\n    CKTextEditor.prototype.setSelection = function (range) {\n        this.focus();\n        var sel = this._editor.getSelection();\n        if (sel) {\n            if (this._lastSelectedRanges) {\n                sel.selectRanges(this._lastSelectedRanges);\n            }\n            else {\n                var ckRange = sel.getRanges();\n                if (ckRange && ckRange.length > 0 && range.start !== -1) {\n                    ckRange[0].startOffset = range.start;\n                    ckRange[0].endOffset = range.end;\n                    try {\n                        sel.selectRanges(ckRange);\n                    }\n                    catch (error) {\n                        sp_telemetry_1._TraceLogger.logError(CKTextEditor.logSource, error);\n                    }\n                }\n            }\n        }\n    };\n    CKTextEditor.prototype._handleSelectionChangeConvert = function (evt) {\n        var sel = this._editor.getSelection();\n        var newRange = undefined;\n        var forceUpdate = false;\n        if (evt) {\n            switch (evt.name) {\n                case 'selectionChange':\n                    sel = evt.data.selection;\n                    break;\n                case 'blur':\n                    sel = undefined;\n                    break;\n            }\n            var ranges = sel ? sel.getRanges() : undefined;\n            newRange = ranges && ranges.length ? {\n                start: ranges[0].startOffset,\n                end: ranges[0].endOffset\n            } : undefined;\n            forceUpdate = ranges && ranges.length &&\n                this._lastSelectedRanges && this._lastSelectedRanges.length &&\n                ranges[0].startContainer !== this._lastSelectedRanges[0].startContainer;\n        }\n        this._handleSelectionChange(newRange, forceUpdate);\n    };\n    CKTextEditor.prototype._isHeadingActive = function (tagName, path) {\n        path = path || this._editor.elementPath();\n        var element = path.lastElement && path.lastElement.getAscendant(tagName, true);\n        return (element && element.getName() === tagName);\n    };\n    CKTextEditor.prototype._getHeadingCommandDefinition = function (tagName) {\n        var isHeadingActive = this._isHeadingActive;\n        return {\n            contextSensitive: true,\n            exec: function (editor) {\n                var styleDef;\n                switch (tagName) {\n                    case 'h2':\n                        styleDef = editor.config.format_h2;\n                        break;\n                    case 'h3':\n                        styleDef = editor.config.format_h3;\n                        break;\n                    case 'h4':\n                        styleDef = editor.config.format_h4;\n                        break;\n                }\n                if (!styleDef) {\n                    return false;\n                }\n                var style = new CKEDITOR.style(styleDef);\n                if (isHeadingActive(tagName)) {\n                    editor.removeStyle(style);\n                }\n                else {\n                    editor.applyStyle(style);\n                }\n                return true;\n            },\n            refresh: function (editor, path) {\n                this.setState(isHeadingActive(tagName, path) ? CKEDITOR.TRISTATE_ON : CKEDITOR.TRISTATE_OFF);\n            }\n        };\n    };\n    CKTextEditor.prototype._fakeSelectionChange = function () {\n        this._handleSelectionChangeConvert();\n    };\n    CKTextEditor.prototype._handlePluginsLoaded = function (evt) {\n        var _loop_1 = function(command) {\n            if (this_1._config.supportedFormatsArray.filter(function (format) { return format.editorKey === command; }).length) {\n                this_1._editor.commands[command].on('state', this_1._handleSelectionChangeConvert);\n            }\n        };\n        var this_1 = this;\n        for (var command in this._editor.commands) {\n            _loop_1(command);\n        }\n        this._editorElement.addEventListener('keyup', this._fakeSelectionChange);\n        this._editorElement.addEventListener('mouseup', this._fakeSelectionChange);\n    };\n    CKTextEditor.prototype._handleInstanceReady = function () {\n        this._onReadyCallback();\n    };\n    CKTextEditor.prototype._handlePaste = function (evt) {\n        if (evt.data && evt.data.dataValue && evt.data.dataValue.indexOf('<table') !== -1) {\n            evt.data.dataValue += '<p></p>';\n            sp_telemetry_1._EngagementLogger.logEvent('Table.Paste');\n        }\n    };\n    CKTextEditor.moduleLoader = new CKLoader_1.default();\n    CKTextEditor.logSource = sp_telemetry_1._LogSource.create('SPRteCKTextEditor');\n    __decorate([\n        office_ui_fabric_react_1.autobind\n    ], CKTextEditor.prototype, \"_initialize\", null);\n    __decorate([\n        office_ui_fabric_react_1.autobind\n    ], CKTextEditor.prototype, \"_handleSelectionChangeConvert\", null);\n    __decorate([\n        office_ui_fabric_react_1.autobind\n    ], CKTextEditor.prototype, \"_isHeadingActive\", null);\n    __decorate([\n        office_ui_fabric_react_1.autobind\n    ], CKTextEditor.prototype, \"_getHeadingCommandDefinition\", null);\n    __decorate([\n        office_ui_fabric_react_1.autobind\n    ], CKTextEditor.prototype, \"_fakeSelectionChange\", null);\n    __decorate([\n        office_ui_fabric_react_1.autobind\n    ], CKTextEditor.prototype, \"_handlePluginsLoaded\", null);\n    __decorate([\n        office_ui_fabric_react_1.autobind\n    ], CKTextEditor.prototype, \"_handleInstanceReady\", null);\n    __decorate([\n        office_ui_fabric_react_1.autobind\n    ], CKTextEditor.prototype, \"_handlePaste\", null);\n    return CKTextEditor;\n}());\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.default = CKTextEditor;\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./lib/local/appBase/components/sp-rte/ckeditor/CKTextEditor.js\n// module id = 29\n// module chunks = 0\n\n\n// WEBPACK FOOTER //\n// webpack:///lib/local/appBase/components/sp-rte/ckeditor/CKTextEditor.js","module.exports = __WEBPACK_EXTERNAL_MODULE_6__;\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"@ms/sp-telemetry\"\n// module id = 6\n// module chunks = 0","\"use strict\";\nvar sp_telemetry_1 = require('@ms/sp-telemetry');\nvar odsp_utilities_bundle_1 = require('@ms/odsp-utilities-bundle');\nvar RESOURCES_PATH = __webpack_public_path__;\nvar CKEDITOR_PATH_KEY = 'CKEDITOR_BASEPATH';\nvar CKLoader = (function () {\n    function CKLoader() {\n    }\n    CKLoader.prototype.loadModule = function (editorSrc) {\n        if (!CKLoader._editorPromise) {\n            window[CKEDITOR_PATH_KEY] = editorSrc || odsp_utilities_bundle_1.Uri.concatenate(RESOURCES_PATH, '/ckeditor/');\n            CKLoader._editorPromise = new Promise(function (complete) {\n                if (editorSrc) {\n                    require.ensure(['ckeditor'], function (require) {\n                        var editor = require('ckeditor');\n                        CKLoader._editorModule = editor;\n                        complete(editor);\n                    }, 'sp-client-preview-ckeditor');\n                }\n                else {\n                    require.ensure(['./../../../../../../temporary-patches/ckeditor.js'], function (require) {\n                        var editor = require('./../../../../../../temporary-patches/ckeditor.js');\n                        CKLoader._editorModule = editor;\n                        complete(editor);\n                    }, 'sp-client-preview-ckeditor');\n                }\n            });\n            CKLoader._editorPromise.catch(function (error) {\n                sp_telemetry_1._TraceLogger.logError(CKLoader.logSource, error);\n            });\n        }\n        return CKLoader._editorPromise;\n    };\n    CKLoader.logSource = sp_telemetry_1._LogSource.create('SPRteCKLoader');\n    return CKLoader;\n}());\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.default = CKLoader;\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./lib/local/appBase/components/sp-rte/ckeditor/CKLoader.js\n// module id = 31\n// module chunks = 0\n\n\n// WEBPACK FOOTER //\n// webpack:///lib/local/appBase/components/sp-rte/ckeditor/CKLoader.js","\"use strict\";\nfunction __export(m) {\n    for (var p in m) if (!exports.hasOwnProperty(p)) exports[p] = m[p];\n}\nrequire('set-webpack-public-path!');\n__export(require('@ms/sp-telemetry/lib/odsp-utilities/odsp-utilities-exporter'));\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// D:/agent/1/_work/24/s/libraries/odsp-utilities-bundle/lib/index.js\n// module id = 32\n// module chunks = 0\n\n\n// WEBPACK FOOTER //\n// webpack:///D:/agent/1/_work/24/s/libraries/odsp-utilities-bundle/lib/index.js","\"use strict\";\nfunction __export(m) {\n    for (var p in m) if (!exports.hasOwnProperty(p)) exports[p] = m[p];\n}\n__export(require('./odsp-utilities-telemetry'));\n__export(require('./odsp-utilities-extended'));\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// D:/agent/1/_work/24/s/libraries/sp-telemetry/lib/odsp-utilities/odsp-utilities-exporter.js\n// module id = 33\n// module chunks = 0\n\n\n// WEBPACK FOOTER //\n// webpack:///D:/agent/1/_work/24/s/libraries/sp-telemetry/lib/odsp-utilities/odsp-utilities-exporter.js","\"use strict\";\nvar EventBase_1 = require('@ms/odsp-utilities/lib/logging/EventBase');\nexports.ClonedEventType = EventBase_1.ClonedEventType;\nexports.ValidationErrorType = EventBase_1.ValidationErrorType;\nexports.AccountType = EventBase_1.AccountType;\nexports.EventBase = EventBase_1.EventBase;\nvar Engagement_event_1 = require('@ms/odsp-utilities/lib/logging/events/Engagement.event');\nexports.Engagement = Engagement_event_1.Engagement;\nvar Nav_event_1 = require('@ms/odsp-utilities/lib/logging/events/Nav.event');\nexports.Nav = Nav_event_1.Nav;\nvar PLTHttpRequest_event_1 = require('@ms/odsp-utilities/lib/logging/events/PLTHttpRequest.event');\nexports.PLTHttpRequest = PLTHttpRequest_event_1.PLTHttpRequest;\nvar Qos_event_1 = require('@ms/odsp-utilities/lib/logging/events/Qos.event');\nexports.Qos = Qos_event_1.Qos;\nvar ResultTypeEnum_1 = require('@ms/odsp-utilities/lib/logging/events/ResultTypeEnum');\nexports.ResultTypeEnum = ResultTypeEnum_1.ResultTypeEnum;\nvar APICallPerformanceData_1 = require('@ms/odsp-utilities/lib/logging/rumone/APICallPerformanceData');\nexports.APICallPerformanceData = APICallPerformanceData_1.default;\nvar Beacon_1 = require('@ms/odsp-utilities/lib/logging/odb/Beacon');\nexports.Beacon = Beacon_1.default;\nvar BeaconCache_1 = require('@ms/odsp-utilities/lib/logging/odb/BeaconCache');\nexports.BeaconCache = BeaconCache_1.default;\nvar ControlPerformanceData_1 = require('@ms/odsp-utilities/lib/logging/rumone/ControlPerformanceData');\nexports.ControlPerformanceData = ControlPerformanceData_1.default;\nvar CorrelationVector_1 = require('@ms/odsp-utilities/lib/logging/CorrelationVector');\nexports.CorrelationVector = CorrelationVector_1.default;\nvar ErrorHelper_1 = require('@ms/odsp-utilities/lib/logging/ErrorHelper');\nexports.ErrorHelper = ErrorHelper_1.default;\nvar PageTransitionType_1 = require('@ms/odsp-utilities/lib/logging/rumone/PageTransitionType');\nexports.PageTransitionType = PageTransitionType_1.default;\nvar RUMOneLogger_1 = require('@ms/odsp-utilities/lib/logging/rumone/RUMOneLogger');\nexports.RumOneLogger = RUMOneLogger_1.default;\nvar RUMOneSLAPI_1 = require('@ms/odsp-utilities/lib/logging/rumone/RUMOneSLAPI');\nexports.RumOneSLAPI = RUMOneSLAPI_1.default;\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// D:/agent/1/_work/24/s/libraries/sp-telemetry/lib/odsp-utilities/odsp-utilities-telemetry.js\n// module id = 34\n// module chunks = 0\n\n\n// WEBPACK FOOTER //\n// webpack:///D:/agent/1/_work/24/s/libraries/sp-telemetry/lib/odsp-utilities/odsp-utilities-telemetry.js","// OneDrive:CoverageThreshold(96)\n\"use strict\";\nvar Manager_1 = require('./Manager');\nvar CorrelationVector_1 = require('./CorrelationVector');\nvar _id = 0;\n(function (ClonedEventType) {\n    ClonedEventType[ClonedEventType[\"Single\"] = 0] = \"Single\";\n    ClonedEventType[ClonedEventType[\"Start\"] = 1] = \"Start\";\n    ClonedEventType[ClonedEventType[\"End\"] = 2] = \"End\";\n})(exports.ClonedEventType || (exports.ClonedEventType = {}));\nvar ClonedEventType = exports.ClonedEventType;\n(function (ValidationErrorType) {\n    ValidationErrorType[ValidationErrorType[\"NoParent\"] = 1] = \"NoParent\";\n})(exports.ValidationErrorType || (exports.ValidationErrorType = {}));\nvar ValidationErrorType = exports.ValidationErrorType;\n(function (AccountType) {\n    AccountType[AccountType[\"Consumer\"] = 0] = \"Consumer\";\n    AccountType[AccountType[\"ConsumerAnonymous\"] = 1] = \"ConsumerAnonymous\";\n    AccountType[AccountType[\"Business\"] = 2] = \"Business\";\n    AccountType[AccountType[\"BusinessAnonymous\"] = 3] = \"BusinessAnonymous\";\n    AccountType[AccountType[\"Unknown\"] = 4] = \"Unknown\";\n})(exports.AccountType || (exports.AccountType = {}));\nvar AccountType = exports.AccountType;\nvar EventBase = (function () {\n    function EventBase(eventName, shortEventName, parent) {\n        this.eventName = eventName;\n        this.shortEventName = shortEventName;\n        this.validationErrors = 0;\n        this.id = _id++;\n        this.enabled = this.isEnabled();\n        this.critical = this.isCritical();\n        // Set the parent id if needed\n        if (parent) {\n            this.parentId = parent.id;\n        }\n        else if (this.requiresParent()) {\n            this.addValidationError(ValidationErrorType.NoParent);\n        }\n        // Set the start time\n        this.startTime = Manager_1.Manager.getTime();\n        if (parent) {\n            this.vector = new CorrelationVector_1.default(parent.vector);\n        }\n        else {\n            this.vector = new CorrelationVector_1.default(CorrelationVector_1.default.RootVector);\n        }\n    }\n    /**\n     * This will return true if the event is of this type\n     * @param event {IEvent} The event to compare\n     */\n    EventBase.isTypeOf = function (event) {\n        return event.eventName.indexOf(this.shortName + this.eventNameDelimeter) >= 0;\n    };\n    /** This is called on all string data to clean it */\n    EventBase.prototype.cleanString = function (str) {\n        return Manager_1.Manager.cleanString(str);\n    };\n    EventBase.prototype.isEnabled = function () {\n        // All events are enabled by default\n        return true;\n    };\n    EventBase.prototype.requiresParent = function () {\n        // All events require parents by default\n        return true;\n    };\n    EventBase.prototype.isCritical = function () {\n        // All events are not critical by default\n        return false;\n    };\n    EventBase.prototype._logEvent = function (eventType) {\n        Manager_1.Manager.logEvent(this, eventType);\n    };\n    EventBase.prototype.addValidationError = function (type) {\n        this.validationErrors = this.validationErrors | type;\n        Manager_1.Manager.logValidationError(this, type);\n    };\n    EventBase.eventNameDelimeter = ',';\n    EventBase.fullName = 'EventBase,';\n    EventBase.shortName = 'EventBase';\n    return EventBase;\n}());\nexports.EventBase = EventBase;\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// D:/agent/1/_work/24/s/common/~/npmx-sp-pages/~/@ms/odsp-utilities/lib/logging/EventBase.js\n// module id = 35\n// module chunks = 0\n\n\n// WEBPACK FOOTER //\n// webpack:///D:/agent/1/_work/24/s/common/~/npmx-sp-pages/~/@ms/odsp-utilities/lib/logging/EventBase.js","// OneDrive:CoverageThreshold(75)\n\"use strict\";\nvar ObjectUtil_1 = require(\"../object/ObjectUtil\");\nvar handlers = [];\nvar buffer = [];\nvar maxBufferSize = 100;\nfunction getStartDate() {\n    'use strict';\n    if (window.performance && window.performance.timing && window.performance.timing.navigationStart) {\n        return new Date(window.performance.timing.navigationStart);\n    }\n    else {\n        return new Date();\n    }\n}\nvar startDate = getStartDate();\nvar Manager = (function () {\n    function Manager() {\n    }\n    Manager.getTime = function () {\n        return (new Date()).getTime();\n    };\n    /** This is the overrideable clean string function */\n    Manager.cleanString = function (str) {\n        return str;\n    };\n    Manager.addLogHandler = function (handler) {\n        handlers.push(handler);\n        // Return the buffer so the handler can get missed events\n        return buffer;\n    };\n    Manager.removeLogHandler = function (handler) {\n        for (var x = 0; x < handlers.length; x++) {\n            if (handlers[x] === handler) {\n                // Remove the handler\n                handlers.splice(x, 1);\n                break;\n            }\n        }\n    };\n    Manager.logEvent = function (event, eventType) {\n        // Clone the object (do it natively because the browser can mark it as a type)\n        var clonedEvent = Object.freeze({\n            data: ObjectUtil_1.default.deepCopy(event.data),\n            id: event.id,\n            enabled: event.enabled,\n            critical: event.critical,\n            endTime: event.endTime,\n            eventName: event.eventName,\n            shortEventName: event.shortEventName,\n            parentId: event.parentId,\n            startTime: event.startTime,\n            eventType: eventType,\n            metadata: event.metadata,\n            vector: event.vector,\n            validationErrors: event.validationErrors\n        });\n        // Add to the buffer\n        buffer.push(clonedEvent);\n        if (buffer.length > maxBufferSize) {\n            buffer = buffer.slice(1);\n            // Make sure we have a handler before the buffer is overrun\n            if (handlers.length === 0) {\n                this.handleBaseLoggingError(new Error(\"Logging buffer overflow hit before any logging handler was registered\"));\n            }\n        }\n        // Let handlers know the log event has completed\n        for (var x = 0; x < handlers.length; x++) {\n            try {\n                handlers[x](clonedEvent);\n            }\n            catch (e) {\n                this.handleBaseLoggingError(e);\n            }\n        }\n    };\n    Manager.logValidationError = function (event, type) {\n        // Do nothing so that we can intialize around circular reference issue\n    };\n    Manager.getStack = function () {\n        var error;\n        try {\n            var w = window;\n            w[\"______ExpectedError______\"]();\n        }\n        catch (e) {\n            error = e;\n        }\n        return error.stack;\n    };\n    Manager.handleBaseLoggingError = function (error) {\n        // TODO: Log somewhere\n    };\n    Manager.startDate = startDate;\n    Manager.startTime = startDate.getTime();\n    return Manager;\n}());\nexports.Manager = Manager;\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.default = Manager;\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// D:/agent/1/_work/24/s/common/~/npmx-sp-pages/~/@ms/odsp-utilities/lib/logging/Manager.js\n// module id = 36\n// module chunks = 0\n\n\n// WEBPACK FOOTER //\n// webpack:///D:/agent/1/_work/24/s/common/~/npmx-sp-pages/~/@ms/odsp-utilities/lib/logging/Manager.js","\"use strict\";\nvar UriEncoding_1 = require('../encoding/UriEncoding');\nvar ObjectUtil;\n(function (ObjectUtil) {\n    \"use strict\";\n    ObjectUtil.DEFAULT_DELIMITER = '&';\n    ObjectUtil.KEYVALUE_DELIMITER = '=';\n    // Returns a copy of the specified object by deeply cloning all of its properties.\n    function deepCopy(object) {\n        var refsCopied = [];\n        var copyRecurse = function (obj) {\n            var result = null;\n            if (obj) {\n                if (Array.isArray(obj)) {\n                    result = [];\n                }\n                else {\n                    // create clone of the object with same prototype chain\n                    result = Object.create(Object.getPrototypeOf(obj));\n                }\n                // iterate over all the properties in the object\n                Object.keys(obj).forEach(function (key) {\n                    // recursively copy the object's properties if the property is an object\n                    var value = obj[key];\n                    if (typeof value === \"object\") {\n                        if (refsCopied.indexOf(value) !== -1) {\n                            throw new Error(\"Cannot perform DeepCopy() because a circular reference was encountered, object: \" + String(obj) + \", property: \" + String(key));\n                        }\n                        refsCopied.push(value);\n                        result[key] = copyRecurse(value);\n                        refsCopied.pop();\n                    }\n                    else {\n                        result[key] = value;\n                    }\n                });\n            }\n            return result;\n        };\n        return copyRecurse(object);\n    }\n    ObjectUtil.deepCopy = deepCopy;\n    // Deeply compares the objects by recursively comparing all their properties, objects with circular references are not supported, prototype members and functions are ignored\n    function deepCompare(objA, objB, equivalent) {\n        // keep track of references that have been compared to find circular references while walking down either object\n        var refsComparedA = [];\n        var refsComparedB = [];\n        var compare = Boolean(equivalent) ? equivalent : function (a, b) { return (a === b); };\n        var equals = function (a, b) {\n            // try a simple equality test first\n            if (a === b) {\n                return true;\n            }\n            if ((a === null) || (b === null)) {\n                return false;\n            }\n            // if both are objects, then further comparison is required\n            if ((typeof (a) === \"object\") && (typeof (b) === \"object\")) {\n                // perform deep comparison over object's properties\n                var aKeys = Object.keys(a).sort();\n                var bKeys_1 = Object.keys(b).sort();\n                // does one object have a different number of properties?\n                if (aKeys.length !== bKeys_1.length) {\n                    return false;\n                }\n                var keysMatch = aKeys.every(function (key, index) {\n                    // key names should match\n                    if (key !== bKeys_1[index]) {\n                        return false;\n                    }\n                    else if (typeof (a[key]) === 'function' || typeof (b[key]) === 'function') {\n                        //skip comparison of function properties\n                        return true;\n                    }\n                    else if (!compare(a[key], b[key])) {\n                        // if this is an Object then recursive testing is needed on its properties\n                        if (typeof a[key] === \"object\") {\n                            // if this property was encountered before then we're going in circles, give up\n                            if (refsComparedA.indexOf(a[key]) !== -1) {\n                                throw new Error(\"Cannot perform DeepCompare() because a circular reference was encountered, object: \" + String(a) + \", property: \" + key);\n                            }\n                            refsComparedA.push(a[key]);\n                            if (refsComparedB.indexOf(b[key]) !== -1) {\n                                throw new Error(\"Cannot perform DeepCompare() because a circular reference was encountered, object: \" + String(b) + \", property: \" + key);\n                            }\n                            refsComparedB.push(b[key]);\n                            // recursive compare object's properties\n                            if (!equals(a[key], b[key])) {\n                                return false;\n                            }\n                            refsComparedA.pop();\n                            refsComparedB.pop();\n                            return true;\n                        }\n                        else {\n                            // properties don't match\n                            return false;\n                        }\n                    }\n                    else {\n                        return true;\n                    }\n                });\n                if (!keysMatch) {\n                    return false;\n                }\n            }\n            else {\n                // parameters aren't equal, and at least one is not an Object\n                return false;\n            }\n            // everything is equal\n            return true;\n        };\n        return equals(objA, objB);\n    }\n    ObjectUtil.deepCompare = deepCompare;\n    /**\n     * This is a function you can call to safely serialize anything to JSON.\n     * The built-in JSON.stringify() throws an exception for circular references and can't handle\n     * many built-ins such as HTMLElements and the global window object.\n     */\n    function safeSerialize(obj) {\n        var str;\n        try {\n            var seenObjects_1 = [];\n            str = JSON.stringify(obj, function (key, value) {\n                if (value === window) {\n                    return \"[window]\";\n                }\n                else if (value instanceof HTMLElement) {\n                    return \"[HTMLElement]\";\n                }\n                else if (typeof value === \"function\") {\n                    return \"[function]\";\n                }\n                else if (typeof value === \"object\") {\n                    if (value === null) {\n                        return value;\n                    }\n                    else if (seenObjects_1.indexOf(value) === -1) {\n                        seenObjects_1.push(value);\n                        return value;\n                    }\n                    else {\n                        return \"[circular]\";\n                    }\n                }\n                else {\n                    return value;\n                }\n            });\n        }\n        catch (err) {\n            // Note: we make this be a JSON string, so that consumers\n            // can always call JSON.parse.\n            str = JSON.stringify(\"[object]\");\n        }\n        return str;\n    }\n    ObjectUtil.safeSerialize = safeSerialize;\n    /**\n     * Serializes the object Name Values Pairs (Depth of 1).\n     * Used for Query Strings and Cookie Values\n     * @param {any} obj Object with name value pairs\n     * @param {string} delimeter  Delimiter seperates the pairs\n     * @param {boolean} skipEncoding True to skip encoding\n     */\n    function serialize(obj, delimiter, skipEncoding) {\n        delimiter = delimiter || ObjectUtil.DEFAULT_DELIMITER;\n        var values = Object.keys(obj).map(function (name) {\n            // Get the value and convert it to a string\n            var value = obj[name];\n            value = value ? value.toString() : \"\";\n            if (!skipEncoding) {\n                value = UriEncoding_1.default.encodeURIComponent(value);\n            }\n            // Add the encoded value to the array\n            return name + ObjectUtil.KEYVALUE_DELIMITER + value;\n        });\n        return values.join(delimiter);\n    }\n    ObjectUtil.serialize = serialize;\n    /**\n     * Copy the values of all enumerable own properties from one or more source objects to a target object.\n     */\n    function extend(target, source) {\n        if (source) {\n            for (var prop in source) {\n                if (source.hasOwnProperty(prop)) {\n                    target[prop] = source[prop];\n                }\n            }\n        }\n        return target;\n    }\n    ObjectUtil.extend = extend;\n})(ObjectUtil || (ObjectUtil = {}));\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.default = ObjectUtil;\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// D:/agent/1/_work/24/s/common/~/npmx-sp-pages/~/@ms/odsp-utilities/lib/object/ObjectUtil.js\n// module id = 37\n// module chunks = 0\n\n\n// WEBPACK FOOTER //\n// webpack:///D:/agent/1/_work/24/s/common/~/npmx-sp-pages/~/@ms/odsp-utilities/lib/object/ObjectUtil.js","// OneDrive:IgnoreCodeCoverage\n\"use strict\";\nvar UriEncoding = (function () {\n    function UriEncoding() {\n    }\n    /////////////////////////////\n    // This file is more clean of all unneeded pollutants. It only contains the minimum amount of code required for someone to use the URI class.\n    // You should think twice before adding anything else into this file because you will be causing unneeded bloat from someone else.\n    /////////////////////////////\n    /**\n     * This function performs an aggressive unicode URL-encoding.\n     * Convert non alphanum character into UTF-8 code string in format %XX%XX%XX.\n     *\n     * Escape unsafe characters\n     *   CTL | SP | <\"> | \"#\" | \"%\" | \"<\" | \">\" | \"'\" | \"&\"\n     * in the URL path (before \"?\", \"#\")\n     * No encoding on query string.\n     *\n     * @param {string} str - String to encode\n     * @param {boolean} bAsUrl - Encode in the same way as the code in unmanaged (Url::UrlEncode) code and\n     *                           SP OM (SPHttpUtility.UrlKeyValueEncode and SPHttpUtility.UrlPathEncode).\n     * @param {boolean} bForFilterQuery\n     * @param {boolean} bForCallback - Only escape the characters after 0x7F to workaround bug O12: 452191\n     */\n    UriEncoding.encodeURIComponent = function (str, bAsUrl, bForFilterQuery, bForCallback) {\n        var strOut = \"\";\n        var strByte;\n        var ix = 0;\n        var strEscaped = \" \\\"%<>\\'&\";\n        if (!str) {\n            return \"\";\n        }\n        var len = str.length;\n        for (ix = 0; ix < len; ix++) {\n            var charCode = str.charCodeAt(ix);\n            var curChar = str.charAt(ix);\n            if (bAsUrl && (curChar === '#' || curChar === '?')) {\n                strOut += str.substr(ix);\n                break;\n            }\n            if (bForFilterQuery && curChar === '&') {\n                strOut += curChar;\n                continue;\n            }\n            if (charCode <= 0x7f) {\n                if (bForCallback) {\n                    strOut += curChar;\n                }\n                else {\n                    if ((charCode >= 97 && charCode <= 122) ||\n                        (charCode >= 65 && charCode <= 90) ||\n                        (charCode >= 48 && charCode <= 57) ||\n                        (bAsUrl && (charCode >= 32 && charCode <= 95) && strEscaped.indexOf(curChar) < 0)) {\n                        strOut += curChar;\n                    }\n                    else if (charCode <= 0x0f) {\n                        strOut += \"%0\" + charCode.toString(16).toUpperCase();\n                    }\n                    else if (charCode <= 0x7f) {\n                        strOut += \"%\" + charCode.toString(16).toUpperCase();\n                    }\n                }\n            }\n            else if (charCode <= 0x07ff) {\n                strByte = 0xc0 | (charCode >> 6);\n                strOut += \"%\" + strByte.toString(16).toUpperCase();\n                strByte = 0x80 | (charCode & 0x003f);\n                strOut += \"%\" + strByte.toString(16).toUpperCase();\n            }\n            else if ((charCode & 0xFC00) !== 0xD800) {\n                strByte = 0xe0 | (charCode >> 12);\n                strOut += \"%\" + strByte.toString(16).toUpperCase();\n                strByte = 0x80 | ((charCode & 0x0fc0) >> 6); // middle 6 bits\n                strOut += \"%\" + strByte.toString(16).toUpperCase();\n                strByte = 0x80 | (charCode & 0x003f); // lower 6 bits\n                strOut += \"%\" + strByte.toString(16).toUpperCase();\n            }\n            else if (ix < str.length - 1) {\n                charCode = (charCode & 0x03FF) << 10; // lower 10 bits of first char\n                ix++;\n                var nextCharCode = str.charCodeAt(ix);\n                charCode |= nextCharCode & 0x03FF; // lower 10 bits of second char\n                charCode += 0x10000;\n                strByte = 0xf0 | (charCode >> 18);\n                strOut += \"%\" + strByte.toString(16).toUpperCase();\n                strByte = 0x80 | ((charCode & 0x3f000) >> 12); // upper 6 bits\n                strOut += \"%\" + strByte.toString(16).toUpperCase();\n                strByte = 0x80 | ((charCode & 0x0fc0) >> 6); // middle 6 bits\n                strOut += \"%\" + strByte.toString(16).toUpperCase();\n                strByte = 0x80 | (charCode & 0x003f); // lower 6 bits\n                strOut += \"%\" + strByte.toString(16).toUpperCase();\n            }\n        }\n        return strOut;\n    };\n    /**\n     * Callbacks do not work if a #bookmark is in the URL. If there is a bookmark then we need to remove it. We also need to\n     * deal with the scenario where there is not a bookmark but there is an unencoded # as a part of a name/value after the '?'.\n     * This is how things should work here:\n     * .../foo.aspx -> .../foo.aspx (unchanged)\n     * .../foo.aspx#bookmark -> .../foo.aspx (bookmark is removed)\n     * .../foo.aspx#bookmark?name=value -> .../foo.aspx?name=value (bookmark is removed)\n     * .../foo.aspx#bookmark?name1=value#extra1&name2=value2 -> .../foo.aspx?name1=value#extra1&name2=value2 (only the bookmark # is removed)\n     * .../foo.aspx?name1=value#extra1&name2=value2 -> .../foo.aspx?name1=value#extra1&name2=value2 (unchanged)\n     */\n    UriEncoding.escapeUrlForCallback = function (str) {\n        var iPound = str.indexOf(\"#\");\n        var iQues = str.indexOf(\"?\");\n        if ((iPound > 0) && ((iQues === -1) || (iPound < iQues))) {\n            var strNew = str.substr(0, iPound);\n            if (iQues > 0) {\n                strNew += str.substr(iQues); // Need to include the '?' along with the \"name=value\" pairs.\n            }\n            str = strNew;\n        }\n        return UriEncoding.encodeURIComponent(str, true, false, true);\n    };\n    /**\n     * SharePoint REST processor expect single quote ' to be escaped to '' in tokens (this applies to %27 too).\n     * See example for usage.\n     * @example\n     * \"getFolderByServerRelativeUrl('\"+encodeRestUriStringToken(\"don't know.txt\")+\"')\" should became \"getFolderByServerRelativeUrl('don''t know.txt')\"\"\n     */\n    UriEncoding.encodeRestUriStringToken = function (stringToken) {\n        if (stringToken) {\n            stringToken = stringToken.replace(/'/g, \"''\");\n            stringToken = stringToken.replace(/%27/g, \"%27%27\");\n            stringToken = UriEncoding.encodeURIComponent(stringToken);\n        }\n        return stringToken;\n    };\n    return UriEncoding;\n}());\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.default = UriEncoding;\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// D:/agent/1/_work/24/s/common/~/npmx-sp-pages/~/@ms/odsp-utilities/lib/encoding/UriEncoding.js\n// module id = 38\n// module chunks = 0\n\n\n// WEBPACK FOOTER //\n// webpack:///D:/agent/1/_work/24/s/common/~/npmx-sp-pages/~/@ms/odsp-utilities/lib/encoding/UriEncoding.js","\"use strict\";\nvar Guid_1 = require('../guid/Guid');\nvar CorrelationVector = (function () {\n    function CorrelationVector(parent, current) {\n        if (parent) {\n            this.root = parent.root;\n            this.parent = parent.current;\n        }\n        else {\n            this.root = this.parent = Guid_1.default.Empty;\n        }\n        if (current) {\n            this.current = current;\n        }\n        else {\n            this.current = Guid_1.default.generate();\n        }\n    }\n    CorrelationVector.prototype.toString = function () {\n        return this.root + \"#\" + this.parent + \"#\" + this.current;\n    };\n    CorrelationVector.RootVector = window['rootVector'] || new CorrelationVector();\n    return CorrelationVector;\n}());\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.default = CorrelationVector;\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// D:/agent/1/_work/24/s/common/~/npmx-sp-pages/~/@ms/odsp-utilities/lib/logging/CorrelationVector.js\n// module id = 39\n// module chunks = 0\n\n\n// WEBPACK FOOTER //\n// webpack:///D:/agent/1/_work/24/s/common/~/npmx-sp-pages/~/@ms/odsp-utilities/lib/logging/CorrelationVector.js","\"use strict\";\nfunction generateUuidPart(length) {\n    \"use strict\";\n    var str = '';\n    while (str.length < length) {\n        var num = Math.random() * 16;\n        num = num | 0; // clear decimal\n        str += num.toString(16);\n    }\n    return str;\n}\nvar Guid = (function () {\n    function Guid() {\n    }\n    /**\n     * Return a v4 UUID as specified by RFC 4122 http://tools.ietf.org/html/rfc4122\n     */\n    Guid.generate = function () {\n        var parts = [];\n        parts.push(generateUuidPart(8));\n        parts.push(generateUuidPart(4));\n        // first digit must be 4 since we are using pseudorandom numbers\n        var timeHighAndVersion = '4' + generateUuidPart(3);\n        parts.push(timeHighAndVersion);\n        // first digit must have first two bits set to 10\n        var clockSeqHiAndReserved = generateUuidPart(4);\n        var intVal = parseInt(clockSeqHiAndReserved[0], 10);\n        intVal = intVal & 3; // clear out first two bits\n        intVal = intVal | 8; // set first bit to 1\n        clockSeqHiAndReserved = intVal.toString(16) + clockSeqHiAndReserved.substr(1);\n        parts.push(clockSeqHiAndReserved);\n        parts.push(generateUuidPart(12));\n        return parts.join('-');\n    };\n    /**\n     * Normalizes a GUID to lowercase. Returns '' if guid is not given.\n     * @param includeBrackets - if true, add or keep brackets; if false, strip brackets\n     */\n    Guid.normalizeLower = function (guid, includeBrackets) {\n        return guid ? Guid._normalizeBrackets(guid.toLowerCase(), includeBrackets) : '';\n    };\n    /**\n     * Normalizes a GUID to uppercase. Returns '' if guid is not given.\n     * @param includeBrackets - if true, add or keep brackets; if false, strip brackets\n     */\n    Guid.normalizeUpper = function (guid, includeBrackets) {\n        return guid ? Guid._normalizeBrackets(guid.toUpperCase(), includeBrackets) : '';\n    };\n    Guid._normalizeBrackets = function (guid, includeBrackets) {\n        var match = guid.match(/^\\{(.*)\\}$/);\n        if (match) {\n            return includeBrackets ? match[0] : match[1];\n        }\n        return includeBrackets ? '{' + guid + '}' : guid;\n    };\n    Guid.Empty = \"00000000-0000-0000-0000-000000000000\";\n    return Guid;\n}());\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.default = Guid;\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// D:/agent/1/_work/24/s/common/~/npmx-sp-pages/~/@ms/odsp-utilities/lib/guid/Guid.js\n// module id = 40\n// module chunks = 0\n\n\n// WEBPACK FOOTER //\n// webpack:///D:/agent/1/_work/24/s/common/~/npmx-sp-pages/~/@ms/odsp-utilities/lib/guid/Guid.js","// OneDrive:IgnoreCodeCoverage\n\"use strict\";\nvar __extends = (this && this.__extends) || function (d, b) {\n    for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p];\n    function __() { this.constructor = d; }\n    d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n};\nvar SingleEventBase_1 = require('../SingleEventBase');\nvar Engagement = (function (_super) {\n    __extends(Engagement, _super);\n    /**\n     * The Engagement event constructor\n     * @param parent {IEvent} The optional parent for this event\n     */\n    function Engagement(parent) {\n        _super.call(this, 'Engagement,', 'Engagement', parent);\n    }\n    /**\n     * This is true if the Engagement event is enabled\n     */\n    Engagement.enabled = function () {\n        return true;\n    };\n    /**\n     * This will create a single Engagement event\n     * @param data {IEngagementSingleSchema}\n     * -required name - This is the name of the engagement event\n     * -optional isIntentional - This indicates whether it is an intentional action by the user\n     * -optional scenario - This is the name of the scenario\n     * -optional location - This is the location from where the event took place\n     * -optional usageType - This is what tells if it were a click, tap or a keyboard event\n     * -optional currentPage - Page where the event took place\n     * -optional previousPage - Previous Page\n     * -optional experiment - ABExperiment object used by experiments\n     * -optional extraData - This is the random extra data for the engagement event\n     * @param parent {IEvent} The optional parent for this event\n     */\n    Engagement.logData = function (data, parent) {\n        return SingleEventBase_1.SingleEventBase._logData(Engagement, data, parent);\n    };\n    Engagement.prototype.setSingleData = function (data) {\n        this.data.name = this.cleanString(data.name);\n        if (typeof data.isIntentional !== \"undefined\") {\n            this.data.isIntentional = data.isIntentional;\n        }\n        if (typeof data.scenario !== \"undefined\") {\n            this.data.scenario = this.cleanString(data.scenario);\n        }\n        if (typeof data.location !== \"undefined\") {\n            this.data.location = this.cleanString(data.location);\n        }\n        if (typeof data.usageType !== \"undefined\") {\n            this.data.usageType = this.cleanString(data.usageType);\n        }\n        if (typeof data.currentPage !== \"undefined\") {\n            this.data.currentPage = this.cleanString(data.currentPage);\n        }\n        if (typeof data.previousPage !== \"undefined\") {\n            this.data.previousPage = this.cleanString(data.previousPage);\n        }\n        if (typeof data.experiment !== \"undefined\") {\n            this.data.experiment = data.experiment;\n        }\n        if (typeof data.extraData !== \"undefined\") {\n            this.data.extraData = data.extraData;\n        }\n    };\n    /**\n     * The name of the Engagement event\n     */\n    Engagement.fullName = 'Engagement,';\n    /**\n     * The short name of the Engagement event\n     */\n    Engagement.shortName = 'Engagement';\n    /**\n     * This is true if the Engagement event is enabled\n     */\n    Engagement.metadata = {\n        name: {\n            type: \"String\",\n            definedInName: \"Engagement\",\n            definedInFullName: \"Engagement,\",\n            isKey: true,\n            isPrefixingDisabled: true,\n            isMetric: false\n        },\n        isIntentional: {\n            type: \"Boolean\",\n            definedInName: \"Engagement\",\n            definedInFullName: \"Engagement,\",\n            isPrefixingDisabled: true,\n            isMetric: false\n        },\n        scenario: {\n            type: \"String\",\n            definedInName: \"Engagement\",\n            definedInFullName: \"Engagement,\",\n            isPrefixingDisabled: true,\n            isMetric: false\n        },\n        location: {\n            type: \"String\",\n            definedInName: \"Engagement\",\n            definedInFullName: \"Engagement,\",\n            isPrefixingDisabled: true,\n            isMetric: false\n        },\n        usageType: {\n            type: \"String\",\n            definedInName: \"Engagement\",\n            definedInFullName: \"Engagement,\",\n            isPrefixingDisabled: true,\n            isMetric: false\n        },\n        currentPage: {\n            type: \"String\",\n            definedInName: \"Engagement\",\n            definedInFullName: \"Engagement,\",\n            isPrefixingDisabled: true,\n            isMetric: false\n        },\n        previousPage: {\n            type: \"String\",\n            definedInName: \"Engagement\",\n            definedInFullName: \"Engagement,\",\n            isPrefixingDisabled: true,\n            isMetric: false\n        },\n        experiment: {\n            type: \"Object\",\n            definedInName: \"Engagement\",\n            definedInFullName: \"Engagement,\",\n            isPrefixingDisabled: true,\n            isMetric: false\n        },\n        extraData: {\n            type: \"Object\",\n            definedInName: \"Engagement\",\n            definedInFullName: \"Engagement,\",\n            isPrefixingDisabled: false,\n            isMetric: false\n        }\n    };\n    return Engagement;\n}(SingleEventBase_1.SingleEventBase));\nexports.Engagement = Engagement;\nEngagement.prototype.metadata = Engagement.metadata;\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.default = Engagement;\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// D:/agent/1/_work/24/s/common/~/npmx-sp-pages/~/@ms/odsp-utilities/lib/logging/events/Engagement.event.js\n// module id = 41\n// module chunks = 0\n\n\n// WEBPACK FOOTER //\n// webpack:///D:/agent/1/_work/24/s/common/~/npmx-sp-pages/~/@ms/odsp-utilities/lib/logging/events/Engagement.event.js","// OneDrive:CoverageThreshold(80)\n\"use strict\";\nvar __extends = (this && this.__extends) || function (d, b) {\n    for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p];\n    function __() { this.constructor = d; }\n    d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n};\nvar EventBase_1 = require('./EventBase');\nvar callingFromInside = false;\nvar SingleEventBase = (function (_super) {\n    __extends(SingleEventBase, _super);\n    function SingleEventBase(eventName, shortEventName, parent) {\n        if (!callingFromInside) {\n            throw \"Use logData method for single events\";\n        }\n        _super.call(this, eventName, shortEventName, parent);\n        // Make sure data has a value\n        if (!this.data) {\n            this.data = {};\n        }\n    }\n    SingleEventBase._logData = function (eventConstructor, data, parent) {\n        callingFromInside = true;\n        try {\n            var event = new eventConstructor(parent);\n            event.setSingleData(data);\n            event._logEvent(EventBase_1.ClonedEventType.Single);\n        }\n        finally {\n            callingFromInside = false;\n        }\n        return event;\n    };\n    SingleEventBase.prototype.setSingleData = function (data) {\n        // The single event to copy data that will be overridden\n    };\n    SingleEventBase.fullName = 'SingleEventBase,';\n    SingleEventBase.shortName = 'SingleEventBase';\n    return SingleEventBase;\n}(EventBase_1.EventBase));\nexports.SingleEventBase = SingleEventBase;\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// D:/agent/1/_work/24/s/common/~/npmx-sp-pages/~/@ms/odsp-utilities/lib/logging/SingleEventBase.js\n// module id = 42\n// module chunks = 0\n\n\n// WEBPACK FOOTER //\n// webpack:///D:/agent/1/_work/24/s/common/~/npmx-sp-pages/~/@ms/odsp-utilities/lib/logging/SingleEventBase.js","// OneDrive:IgnoreCodeCoverage\n\"use strict\";\nvar __extends = (this && this.__extends) || function (d, b) {\n    for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p];\n    function __() { this.constructor = d; }\n    d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n};\nvar SingleEventBase_1 = require('../SingleEventBase');\nvar Nav = (function (_super) {\n    __extends(Nav, _super);\n    /**\n     * The Nav event constructor\n     * @param parent {IEvent} The optional parent for this event\n     */\n    function Nav(parent) {\n        _super.call(this, 'Nav,', 'Nav', parent);\n    }\n    /**\n     * This is true if the Nav event is enabled\n     */\n    Nav.enabled = function () {\n        return true;\n    };\n    /**\n     * This will create a single Nav event\n     * @param data {INavSingleSchema}\n     * -required viewParams - The view params associated with the navigation\n     * -optional url - The url associated with the navigation. This is not sanitized (i.e. could contain authkeys)\n     * @param parent {IEvent} The optional parent for this event\n     */\n    Nav.logData = function (data, parent) {\n        return SingleEventBase_1.SingleEventBase._logData(Nav, data, parent);\n    };\n    Nav.prototype.setSingleData = function (data) {\n        this.data.viewParams = data.viewParams;\n        if (typeof data.url !== \"undefined\") {\n            this.data.url = this.cleanString(data.url);\n        }\n    };\n    /**\n     * The name of the Nav event\n     */\n    Nav.fullName = 'Nav,';\n    /**\n     * The short name of the Nav event\n     */\n    Nav.shortName = 'Nav';\n    /**\n     * This is true if the Nav event is enabled\n     */\n    Nav.metadata = {\n        viewParams: {\n            type: \"Object\",\n            definedInName: \"Nav\",\n            definedInFullName: \"Nav,\",\n            isPrefixingDisabled: false,\n            isMetric: false\n        },\n        url: {\n            type: \"String\",\n            definedInName: \"Nav\",\n            definedInFullName: \"Nav,\",\n            isPrefixingDisabled: false,\n            isMetric: false\n        }\n    };\n    return Nav;\n}(SingleEventBase_1.SingleEventBase));\nexports.Nav = Nav;\nNav.prototype.metadata = Nav.metadata;\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.default = Nav;\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// D:/agent/1/_work/24/s/common/~/npmx-sp-pages/~/@ms/odsp-utilities/lib/logging/events/Nav.event.js\n// module id = 43\n// module chunks = 0\n\n\n// WEBPACK FOOTER //\n// webpack:///D:/agent/1/_work/24/s/common/~/npmx-sp-pages/~/@ms/odsp-utilities/lib/logging/events/Nav.event.js","// OneDrive:IgnoreCodeCoverage\n\"use strict\";\nvar __extends = (this && this.__extends) || function (d, b) {\n    for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p];\n    function __() { this.constructor = d; }\n    d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n};\nvar SingleEventBase_1 = require('../SingleEventBase');\nvar Features_1 = require('../../features/Features');\nvar PLTHttpRequest = (function (_super) {\n    __extends(PLTHttpRequest, _super);\n    /**\n     * The PLTHttpRequest event constructor\n     * @param parent {IEvent} The optional parent for this event\n     */\n    function PLTHttpRequest(parent) {\n        _super.call(this, 'PLTHttpRequest,', 'PLTHttpRequest', parent);\n    }\n    /**\n     * This is true if the PLTHttpRequest event is enabled\n     */\n    PLTHttpRequest.enabled = function () {\n        return Features_1.default.isFeatureEnabled(PLTHttpRequest.samplingFeature);\n    };\n    /**\n     * This will create a single PLTHttpRequest event\n     * @param data {IPLTHttpRequestSingleSchema}\n     * -required startTime - The start time of the request\n     * -required url - The url for the request\n     * -required duration - Time it takes for the request to complete\n     * @param parent {IEvent} The optional parent for this event\n     */\n    PLTHttpRequest.logData = function (data, parent) {\n        return SingleEventBase_1.SingleEventBase._logData(PLTHttpRequest, data, parent);\n    };\n    /**\n     * This is true when PLTHttpRequest event is enabled\n     */\n    PLTHttpRequest.prototype.isEnabled = function () {\n        return Features_1.default.isFeatureEnabled(PLTHttpRequest.samplingFeature);\n    };\n    PLTHttpRequest.prototype.setSingleData = function (data) {\n        this.data.startTime = data.startTime;\n        this.data.url = this.cleanString(data.url);\n        this.data.duration = data.duration;\n    };\n    /**\n     * The name of the PLTHttpRequest event\n     */\n    PLTHttpRequest.fullName = 'PLTHttpRequest,';\n    /**\n     * The short name of the PLTHttpRequest event\n     */\n    PLTHttpRequest.shortName = 'PLTHttpRequest';\n    /**\n     * This is true if the PLTHttpRequest event is enabled\n     */\n    PLTHttpRequest.metadata = {\n        startTime: {\n            type: \"Number\",\n            definedInName: \"PLTHttpRequest\",\n            definedInFullName: \"PLTHttpRequest,\",\n            isPrefixingDisabled: false,\n            isMetric: true\n        },\n        url: {\n            type: \"String\",\n            definedInName: \"PLTHttpRequest\",\n            definedInFullName: \"PLTHttpRequest,\",\n            isPrefixingDisabled: false,\n            isMetric: false\n        },\n        duration: {\n            type: \"Number\",\n            definedInName: \"PLTHttpRequest\",\n            definedInFullName: \"PLTHttpRequest,\",\n            isPrefixingDisabled: false,\n            isMetric: true\n        }\n    };\n    /**\n     * The sampling feature for the PLTHttpRequest event\n     */\n    PLTHttpRequest.samplingFeature = { ODB: true, ODC: 'PLTHttpRequestSampling', Fallback: false };\n    return PLTHttpRequest;\n}(SingleEventBase_1.SingleEventBase));\nexports.PLTHttpRequest = PLTHttpRequest;\nPLTHttpRequest.prototype.metadata = PLTHttpRequest.metadata;\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.default = PLTHttpRequest;\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// D:/agent/1/_work/24/s/common/~/npmx-sp-pages/~/@ms/odsp-utilities/lib/logging/events/PLTHttpRequest.event.js\n// module id = 44\n// module chunks = 0\n\n\n// WEBPACK FOOTER //\n// webpack:///D:/agent/1/_work/24/s/common/~/npmx-sp-pages/~/@ms/odsp-utilities/lib/logging/events/PLTHttpRequest.event.js","// OneDrive:IgnoreCodeCoverage\n\"use strict\";\n/**\n * This file contains the known list of features (a.k.a. flights or ramps).\n * The signature of one entry is:\n *  static FeatureName: IFlight = { ODB: 100, ODC: \"foo\", Fallback: true };\n * ODB            Is the numerical value of the flight from the ExpFeature enumeration.\n *                Use -1 if the flight does not have a correspondent in ODB.\n * ODC            Is the string identifier in ODC.\n *                Use null if the flight does not have a correspondent ramp in ODC.\n * Fallback       The state of the flight, true = on false = off.\n *                The fallback is used only when the ODB or ODC flight is not applicable.\n *                For example: The Flight is an ODB flight with no ODC counterpart and the app runs in ODC mode.\n *                The fallback also allows declaring app only switches that are not known to the backend.\n */\nvar Features = (function () {\n    function Features() {\n    }\n    //You should not add features here but in your own file\n    /**\n     * This function will return true when the feature is enabled and\n     * will check the proper config for ODB and ODC to determine this\n     */\n    Features.isFeatureEnabled = function (feature) {\n        var result = feature.Fallback;\n        var _spPageContextInfo = window['_spPageContextInfo'];\n        var _odcFlightInfo = window['Flight'];\n        var _odcConfig = window['FilesConfig'];\n        var Flighting = window['Flighting']; // Old SharePoint pages use this.\n        if (Boolean(_spPageContextInfo)) {\n            if (!Boolean(_spPageContextInfo.ExpFeatures) &&\n                Boolean(Flighting) && Boolean(Flighting.ExpFeatures)) {\n                _spPageContextInfo.ExpFeatures = Flighting.ExpFeatures;\n            }\n            if (typeof feature.ODB === 'boolean') {\n                result = feature.ODB;\n            }\n            else if (Boolean(_spPageContextInfo.ExpFeatures) && feature.ODB > 0) {\n                var elem = Math.floor(feature.ODB / 32);\n                var mask = 1 << (feature.ODB % 32);\n                result = (elem < _spPageContextInfo.ExpFeatures.length) &&\n                    (_spPageContextInfo.ExpFeatures[elem] & mask) !== 0;\n            }\n        }\n        if (feature.ODC !== null && !!_odcConfig) {\n            if (typeof feature.ODC === 'boolean') {\n                result = feature.ODC;\n            }\n            else if (_odcFlightInfo && _odcFlightInfo.Ramps && _odcFlightInfo.Ramps[feature.ODC]) {\n                result = true;\n            }\n            else if (_odcConfig && _odcConfig[feature.ODC]) {\n                result = true;\n            }\n        }\n        return result;\n    };\n    /* This feature is always on */\n    Features.On = { ODB: -1, ODC: null, Fallback: true };\n    /* This feature is always off */\n    Features.Off = { ODB: -1, ODC: null, Fallback: false };\n    return Features;\n}());\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.default = Features;\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// D:/agent/1/_work/24/s/common/~/npmx-sp-pages/~/@ms/odsp-utilities/lib/features/Features.js\n// module id = 45\n// module chunks = 0\n\n\n// WEBPACK FOOTER //\n// webpack:///D:/agent/1/_work/24/s/common/~/npmx-sp-pages/~/@ms/odsp-utilities/lib/features/Features.js","// OneDrive:IgnoreCodeCoverage\n\"use strict\";\nvar __extends = (this && this.__extends) || function (d, b) {\n    for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p];\n    function __() { this.constructor = d; }\n    d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n};\nvar PairedEventBase_1 = require('../PairedEventBase');\nvar ResultTypeEnum_1 = require('./ResultTypeEnum');\nvar ResultTypeEnum_2 = require('./ResultTypeEnum');\nexports.ResultTypeEnum = ResultTypeEnum_2.ResultTypeEnum;\nvar Qos = (function (_super) {\n    __extends(Qos, _super);\n    /**\n     * The Qos event constructor\n     * @param data {IQosStartSchema}\n     * -required name - This is the name of the qos event\n     * -optional resultCode - This is result code for the qos event\n     * -optional resultType - This is the result type enum\n     * -optional error - This is the error message to be logged with failed result\n     * -optional extraData - This is the random extra data for the qos event\n     * -optional extraMetrics - Extra data for the qos event that should be logged as aggregatable metrics\n     * @param parent {IEvent} The optional parent for this event\n     */\n    function Qos(data, parent) {\n        _super.call(this, 'Qos,', 'Qos', data, parent);\n    }\n    /**\n     * This is true if the Qos event is enabled\n     */\n    Qos.enabled = function () {\n        return true;\n    };\n    Qos.instrumentPromise = function (startSchema, createPromise, getCompleteSchema, getErrorSchema, timeoutMs, timeoutSchema, parent) {\n        return PairedEventBase_1.PairedEventBase._instrumentPromise(Qos, startSchema, createPromise, getCompleteSchema, getErrorSchema, timeoutMs, timeoutSchema, parent);\n    };\n    /**\n     * This will end the Qos event\n     * @param data {IQosEndSchema}\n     * -optional resultCode - This is result code for the qos event\n     * -required resultType - This is the result type enum\n     * -optional error - This is the error message to be logged with failed result\n     * -optional extraData - This is the random extra data for the qos event\n     * -optional extraMetrics - Extra data for the qos event that should be logged as aggregatable metrics\n     */\n    Qos.prototype.end = function (data) {\n        return this._end(data);\n    };\n    /**\n     * This writes verbose logs to memory to be uploaded if event ends with failure\n     */\n    Qos.prototype.verbose = function (message) {\n        return this._verbose(message);\n    };\n    /**\n     * Sets a time limit for the scenario. A timeout result will be logged if no end happens in desired timeframe\n     */\n    Qos.prototype.setTimeout = function (ms, data) {\n        return this._setTimeout(ms, data);\n    };\n    Qos.prototype.setStartData = function (data) {\n        this.data.name = this.cleanString(data.name);\n        if (typeof data.resultCode !== \"undefined\") {\n            this.data.resultCode = this.cleanString(data.resultCode);\n        }\n        if (typeof data.resultType !== \"undefined\") {\n            this.data.resultType = data.resultType;\n        }\n        if (typeof data.error !== \"undefined\") {\n            this.data.error = this.cleanString(data.error);\n        }\n        if (typeof data.extraData !== \"undefined\") {\n            this.data.extraData = data.extraData;\n        }\n        if (typeof data.extraMetrics !== \"undefined\") {\n            this.data.extraMetrics = data.extraMetrics;\n        }\n    };\n    Qos.prototype.setEndData = function (data) {\n        if (typeof data.resultCode !== \"undefined\") {\n            this.data.resultCode = this.cleanString(data.resultCode);\n        }\n        this.data.resultType = data.resultType;\n        if (typeof data.error !== \"undefined\") {\n            this.data.error = this.cleanString(data.error);\n        }\n        if (typeof data.extraData !== \"undefined\") {\n            this.data.extraData = data.extraData;\n        }\n        if (typeof data.extraMetrics !== \"undefined\") {\n            this.data.extraMetrics = data.extraMetrics;\n        }\n    };\n    /**\n     * The name of the Qos event\n     */\n    Qos.fullName = 'Qos,';\n    /**\n     * The short name of the Qos event\n     */\n    Qos.shortName = 'Qos';\n    /**\n     * This is true if the Qos event is enabled\n     */\n    Qos.metadata = {\n        name: {\n            type: \"String\",\n            definedInName: \"Qos\",\n            definedInFullName: \"Qos,\",\n            isKey: true,\n            isPrefixingDisabled: true,\n            isMetric: false\n        },\n        resultCode: {\n            type: \"String\",\n            definedInName: \"Qos\",\n            definedInFullName: \"Qos,\",\n            isPrefixingDisabled: true,\n            isMetric: false\n        },\n        resultType: {\n            type: \"ResultTypeEnum\",\n            definedInName: \"Qos\",\n            definedInFullName: \"Qos,\",\n            baseType: \"Enum\",\n            typeRef: ResultTypeEnum_1.ResultTypeEnum,\n            isPrefixingDisabled: true,\n            isMetric: false\n        },\n        error: {\n            type: \"String\",\n            definedInName: \"Qos\",\n            definedInFullName: \"Qos,\",\n            isPrefixingDisabled: true,\n            isMetric: false\n        },\n        extraData: {\n            type: \"Object\",\n            definedInName: \"Qos\",\n            definedInFullName: \"Qos,\",\n            isPrefixingDisabled: false,\n            isMetric: false\n        },\n        extraMetrics: {\n            type: \"Object\",\n            definedInName: \"Qos\",\n            definedInFullName: \"Qos,\",\n            isPrefixingDisabled: true,\n            isMetric: false\n        }\n    };\n    return Qos;\n}(PairedEventBase_1.PairedEventBase));\nexports.Qos = Qos;\nQos.prototype.metadata = Qos.metadata;\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.default = Qos;\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// D:/agent/1/_work/24/s/common/~/npmx-sp-pages/~/@ms/odsp-utilities/lib/logging/events/Qos.event.js\n// module id = 46\n// module chunks = 0\n\n\n// WEBPACK FOOTER //\n// webpack:///D:/agent/1/_work/24/s/common/~/npmx-sp-pages/~/@ms/odsp-utilities/lib/logging/events/Qos.event.js","// OneDrive:CoverageThreshold(75)\n\"use strict\";\nvar __extends = (this && this.__extends) || function (d, b) {\n    for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p];\n    function __() { this.constructor = d; }\n    d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n};\nvar EventBase_1 = require('./EventBase');\nvar Manager_1 = require(\"./Manager\");\nvar ResultTypeEnum_1 = require('./events/ResultTypeEnum');\nvar ErrorHelper_1 = require(\"./ErrorHelper\");\nvar Async_1 = require(\"../async/Async\");\nvar ObjectUtil_1 = require(\"../object/ObjectUtil\");\nvar PairedEventBase = (function (_super) {\n    __extends(PairedEventBase, _super);\n    function PairedEventBase(eventName, shortEventName, data, parent) {\n        _super.call(this, eventName, shortEventName, parent);\n        // Make sure data has a value\n        if (!this.data) {\n            this.data = {};\n        }\n        // Set the data if we have it\n        if (data) {\n            this.setStartData(data);\n        }\n        // Send the start event\n        this._logEvent(EventBase_1.ClonedEventType.Start);\n    }\n    PairedEventBase._instrumentPromise = function (eventConstructor, startSchema, createPromise, getCompleteSchema, getErrorSchema, timeoutMs, timeoutSchema, parent) {\n        var _this = this;\n        var _promise;\n        var _event = new eventConstructor(startSchema, parent);\n        if (timeoutMs) {\n            _event._setTimeout(timeoutMs, timeoutSchema);\n        }\n        var _onComplete = function (result) {\n            var schema;\n            if (getCompleteSchema) {\n                try {\n                    schema = getCompleteSchema(result);\n                }\n                catch (e) {\n                    schema = _event._generateQosResult(ResultTypeEnum_1.ResultTypeEnum.Failure, _this.schemaExceptionErrorCode, e.toString());\n                }\n            }\n            else {\n                schema = _event._generateQosResult(ResultTypeEnum_1.ResultTypeEnum.Success);\n            }\n            _event._end(schema);\n        };\n        var _onError = function (errorArgs) {\n            var schema;\n            if (getErrorSchema) {\n                try {\n                    schema = getErrorSchema(errorArgs);\n                }\n                catch (e) {\n                    schema = _event._generateQosResult(ResultTypeEnum_1.ResultTypeEnum.Failure, _this.schemaExceptionErrorCode, e.toString());\n                }\n            }\n            else {\n                if (errorArgs) {\n                    var failureResultType = (errorArgs instanceof Error && errorArgs.name === \"Canceled\") ?\n                        ResultTypeEnum_1.ResultTypeEnum.ExpectedFailure : ResultTypeEnum_1.ResultTypeEnum.Failure;\n                    schema = _event._generateQosResult(failureResultType, null, ObjectUtil_1.default.safeSerialize(errorArgs));\n                }\n                else {\n                    schema = _event._generateQosResult(ResultTypeEnum_1.ResultTypeEnum.Failure);\n                }\n            }\n            _event._end(schema);\n        };\n        try {\n            _promise = createPromise();\n        }\n        catch (e) {\n            _event._end(_event._generateQosResult(ResultTypeEnum_1.ResultTypeEnum.Failure, this.promiseCreationFailureErrorCode, e.toString()));\n            throw e;\n        }\n        _promise.then(_onComplete, _onError);\n        return _promise;\n    };\n    PairedEventBase.prototype.setStartData = function (data) {\n        // The start event to copy data that will be overridden\n    };\n    PairedEventBase.prototype.setEndData = function (data) {\n        // The end event to copy data that will be overridden\n    };\n    PairedEventBase.prototype._setTimeout = function (ms, data) {\n        if (!this.async) {\n            this.async = new Async_1.default(this);\n        }\n        this._clearTimeout();\n        if (!data) {\n            data = this._generateQosResult(ResultTypeEnum_1.ResultTypeEnum.Failure, PairedEventBase.timeoutErrorCode);\n        }\n        this.async.setTimeout(this._end.bind(this, data), ms);\n    };\n    PairedEventBase.prototype._verbose = function (message) {\n        if (this.endTime) {\n            // event already ended, no need to log anymore\n            return;\n        }\n        if (this._isQosEvent) {\n            var qosSchema = this.data;\n            ErrorHelper_1.default.verbose(message, qosSchema.name);\n        }\n    };\n    PairedEventBase.prototype._end = function (data) {\n        // Make sure end can only be called once\n        if (!this.endTime) {\n            if (data) {\n                this.setEndData(data);\n            }\n            // Set the end time\n            this.endTime = Manager_1.Manager.getTime();\n            // Log the event end\n            this._logEvent(EventBase_1.ClonedEventType.End);\n            // If this is a QOS event log and contains an error message trigger the upload of logs by calling\n            // the ErrorHelper\n            if (this._isQosEvent) {\n                var qosSchema = this.data;\n                if (qosSchema.error) {\n                    ErrorHelper_1.default.log(qosSchema.error, qosSchema.name, qosSchema.resultCode, qosSchema.resultType);\n                }\n            }\n            this._clearTimeout();\n        }\n    };\n    PairedEventBase.prototype._clearTimeout = function () {\n        if (this.async && this.timeoutId) {\n            this.async.clearTimeout(this.timeoutId);\n            this.timeoutId = null;\n        }\n    };\n    Object.defineProperty(PairedEventBase.prototype, \"_isQosEvent\", {\n        get: function () {\n            return this.eventName.indexOf('Qos,') >= 0;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    PairedEventBase.prototype._generateQosResult = function (resultType, resultCode, error) {\n        var schema = {\n            resultType: resultType\n        };\n        if (resultCode) {\n            schema.resultCode = resultCode;\n        }\n        if (error) {\n            schema.error = error;\n        }\n        return schema;\n    };\n    PairedEventBase.fullName = 'PairedEventBase,';\n    PairedEventBase.shortName = 'PairedEventBase';\n    PairedEventBase.schemaExceptionErrorCode = 'GetSchemaException';\n    PairedEventBase.promiseCreationFailureErrorCode = 'PromiseCreationFailed';\n    PairedEventBase.timeoutErrorCode = 'Timeout';\n    return PairedEventBase;\n}(EventBase_1.EventBase));\nexports.PairedEventBase = PairedEventBase;\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// D:/agent/1/_work/24/s/common/~/npmx-sp-pages/~/@ms/odsp-utilities/lib/logging/PairedEventBase.js\n// module id = 47\n// module chunks = 0\n\n\n// WEBPACK FOOTER //\n// webpack:///D:/agent/1/_work/24/s/common/~/npmx-sp-pages/~/@ms/odsp-utilities/lib/logging/PairedEventBase.js","\"use strict\";\n(function (ResultTypeEnum) {\n    ResultTypeEnum[ResultTypeEnum[\"Success\"] = 0] = \"Success\";\n    ResultTypeEnum[ResultTypeEnum[\"Failure\"] = 1] = \"Failure\";\n    ResultTypeEnum[ResultTypeEnum[\"ExpectedFailure\"] = 2] = \"ExpectedFailure\";\n})(exports.ResultTypeEnum || (exports.ResultTypeEnum = {}));\nvar ResultTypeEnum = exports.ResultTypeEnum;\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// D:/agent/1/_work/24/s/common/~/npmx-sp-pages/~/@ms/odsp-utilities/lib/logging/events/ResultTypeEnum.js\n// module id = 48\n// module chunks = 0\n\n\n// WEBPACK FOOTER //\n// webpack:///D:/agent/1/_work/24/s/common/~/npmx-sp-pages/~/@ms/odsp-utilities/lib/logging/events/ResultTypeEnum.js","// OneDrive:IgnoreCodeCoverage\n\"use strict\";\nvar CaughtError_event_1 = require(\"./events/CaughtError.event\");\nvar QosError_event_1 = require(\"./events/QosError.event\");\nvar Verbose_event_1 = require(\"./events/Verbose.event\");\nvar CircularBuffer_1 = require(\"../store/CircularBuffer\");\nvar ObjectUtil_1 = require('../object/ObjectUtil');\nvar MAX_VERBOSE_LOGS = 50;\nvar ErrorHelper = (function () {\n    function ErrorHelper() {\n    }\n    ErrorHelper.verbose = function (message, eventName) {\n        ErrorHelper._verboseLogs.push({\n            name: eventName,\n            message: message\n        });\n    };\n    ErrorHelper.logError = function (error, extraData, qosData) {\n        if (!error || error._handled) {\n            return;\n        }\n        var message = this.getErrorMessage(error);\n        var stack = error && error.stack ? error.stack : \"\";\n        var schema;\n        while (Boolean(schema = ErrorHelper._verboseLogs.popOldest())) {\n            Verbose_event_1.Verbose.logData(schema);\n        }\n        if (qosData && qosData.eventName) {\n            QosError_event_1.QosError.logData({\n                name: qosData.eventName,\n                resultCode: qosData.resultCode,\n                resultType: qosData.resultType,\n                extraData: extraData || undefined,\n                message: message,\n                stack: stack\n            });\n        }\n        else {\n            CaughtError_event_1.CaughtError.logData({\n                extraData: extraData || undefined,\n                message: message,\n                stack: stack\n            });\n        }\n    };\n    ErrorHelper.log = function (error, eventName, resultCode, resultType) {\n        this.logError(error, null, { eventName: eventName, resultCode: resultCode, resultType: resultType });\n    };\n    /**\n     * Extract the error message from the error\n     */\n    ErrorHelper.getErrorMessage = function (error) {\n        var message = '';\n        if (error) {\n            if (error.message) {\n                message = error.message;\n            }\n            else if (error.description) {\n                message = error.description;\n            }\n            else if (typeof (error) === 'object') {\n                message = ObjectUtil_1.default.safeSerialize(error);\n            }\n            else if (error.toString) {\n                message = error.toString();\n            }\n        }\n        return message;\n    };\n    ErrorHelper._verboseLogs = new CircularBuffer_1.default(MAX_VERBOSE_LOGS);\n    return ErrorHelper;\n}());\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.default = ErrorHelper;\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// D:/agent/1/_work/24/s/common/~/npmx-sp-pages/~/@ms/odsp-utilities/lib/logging/ErrorHelper.js\n// module id = 49\n// module chunks = 0\n\n\n// WEBPACK FOOTER //\n// webpack:///D:/agent/1/_work/24/s/common/~/npmx-sp-pages/~/@ms/odsp-utilities/lib/logging/ErrorHelper.js","// OneDrive:IgnoreCodeCoverage\n\"use strict\";\nvar __extends = (this && this.__extends) || function (d, b) {\n    for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p];\n    function __() { this.constructor = d; }\n    d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n};\nvar SingleEventBase_1 = require('../SingleEventBase');\nvar CaughtError = (function (_super) {\n    __extends(CaughtError, _super);\n    /**\n     * The CaughtError event constructor\n     * @param parent {IEvent} The optional parent for this event\n     */\n    function CaughtError(parent) {\n        _super.call(this, 'CaughtError,', 'CaughtError', parent);\n    }\n    /**\n     * This is true if the CaughtError event is enabled\n     */\n    CaughtError.enabled = function () {\n        return true;\n    };\n    /**\n     * This will create a single CaughtError event\n     * @param data {ICaughtErrorSingleSchema}\n     * -required message - This is the error message returned during the window.onerror handler\n     * -required stack - This is the stack trace of the error returned during the window.onerror handler\n     * -optional extraData - This is the random extra data for the error event\n     * @param parent {IEvent} The optional parent for this event\n     */\n    CaughtError.logData = function (data, parent) {\n        return SingleEventBase_1.SingleEventBase._logData(CaughtError, data, parent);\n    };\n    /**\n     * This is false when CaughtError event does not require a parent event\n     */\n    CaughtError.prototype.requiresParent = function () {\n        return false;\n    };\n    /**\n     * This is true when CaughtError event is a critical event\n     */\n    CaughtError.prototype.isCritical = function () {\n        return true;\n    };\n    CaughtError.prototype.setSingleData = function (data) {\n        this.data.message = this.cleanString(data.message);\n        this.data.stack = this.cleanString(data.stack);\n        if (typeof data.extraData !== \"undefined\") {\n            this.data.extraData = data.extraData;\n        }\n    };\n    /**\n     * The name of the CaughtError event\n     */\n    CaughtError.fullName = 'CaughtError,';\n    /**\n     * The short name of the CaughtError event\n     */\n    CaughtError.shortName = 'CaughtError';\n    /**\n     * This is true if the CaughtError event is enabled\n     */\n    CaughtError.metadata = {\n        message: {\n            type: \"String\",\n            definedInName: \"CaughtError\",\n            definedInFullName: \"CaughtError,\",\n            isPrefixingDisabled: false,\n            isMetric: false\n        },\n        stack: {\n            type: \"String\",\n            definedInName: \"CaughtError\",\n            definedInFullName: \"CaughtError,\",\n            isPrefixingDisabled: false,\n            isMetric: false\n        },\n        unMinStack: {\n            type: \"Object\",\n            definedInName: \"CaughtError\",\n            definedInFullName: \"CaughtError,\",\n            isPrefixingDisabled: false,\n            isMetric: false\n        },\n        extraData: {\n            type: \"Object\",\n            definedInName: \"CaughtError\",\n            definedInFullName: \"CaughtError,\",\n            isPrefixingDisabled: false,\n            isMetric: false\n        }\n    };\n    return CaughtError;\n}(SingleEventBase_1.SingleEventBase));\nexports.CaughtError = CaughtError;\nCaughtError.prototype.metadata = CaughtError.metadata;\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.default = CaughtError;\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// D:/agent/1/_work/24/s/common/~/npmx-sp-pages/~/@ms/odsp-utilities/lib/logging/events/CaughtError.event.js\n// module id = 50\n// module chunks = 0\n\n\n// WEBPACK FOOTER //\n// webpack:///D:/agent/1/_work/24/s/common/~/npmx-sp-pages/~/@ms/odsp-utilities/lib/logging/events/CaughtError.event.js","// OneDrive:IgnoreCodeCoverage\n\"use strict\";\nvar __extends = (this && this.__extends) || function (d, b) {\n    for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p];\n    function __() { this.constructor = d; }\n    d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n};\nvar SingleEventBase_1 = require('../SingleEventBase');\nvar ResultTypeEnum_1 = require('./ResultTypeEnum');\nvar ResultTypeEnum_2 = require('./ResultTypeEnum');\nexports.ResultTypeEnum = ResultTypeEnum_2.ResultTypeEnum;\nvar QosError = (function (_super) {\n    __extends(QosError, _super);\n    /**\n     * The QosError event constructor\n     * @param parent {IEvent} The optional parent for this event\n     */\n    function QosError(parent) {\n        _super.call(this, 'QosError,CaughtError,', 'QosError', parent);\n    }\n    /**\n     * This is true if the QosError event is enabled\n     */\n    QosError.enabled = function () {\n        return true;\n    };\n    /**\n     * This will create a single QosError event\n     * @param data {IQosErrorSingleSchema}\n     * -required name - Qos event name\n     * -optional resultCode - Qos event result code\n     * -optional resultType - This is the result type enum\n     * -required message - This is the error message returned during the window.onerror handler\n     * -required stack - This is the stack trace of the error returned during the window.onerror handler\n     * -optional extraData - This is the random extra data for the error event\n     * @param parent {IEvent} The optional parent for this event\n     */\n    QosError.logData = function (data, parent) {\n        return SingleEventBase_1.SingleEventBase._logData(QosError, data, parent);\n    };\n    /**\n     * This is true when QosError event is a critical event\n     */\n    QosError.prototype.isCritical = function () {\n        return true;\n    };\n    QosError.prototype.setSingleData = function (data) {\n        this.data.name = this.cleanString(data.name);\n        if (typeof data.resultCode !== \"undefined\") {\n            this.data.resultCode = this.cleanString(data.resultCode);\n        }\n        if (typeof data.resultType !== \"undefined\") {\n            this.data.resultType = data.resultType;\n        }\n        this.data.message = this.cleanString(data.message);\n        this.data.stack = this.cleanString(data.stack);\n        if (typeof data.extraData !== \"undefined\") {\n            this.data.extraData = data.extraData;\n        }\n    };\n    /**\n     * The name of the QosError event\n     */\n    QosError.fullName = 'QosError,CaughtError,';\n    /**\n     * The short name of the QosError event\n     */\n    QosError.shortName = 'QosError';\n    /**\n     * This is true if the QosError event is enabled\n     */\n    QosError.metadata = {\n        name: {\n            type: \"String\",\n            definedInName: \"QosError\",\n            definedInFullName: \"QosError,\",\n            isKey: true,\n            isPrefixingDisabled: false,\n            isMetric: false\n        },\n        resultCode: {\n            type: \"String\",\n            definedInName: \"QosError\",\n            definedInFullName: \"QosError,\",\n            isPrefixingDisabled: false,\n            isMetric: false\n        },\n        resultType: {\n            type: \"ResultTypeEnum\",\n            definedInName: \"QosError\",\n            definedInFullName: \"QosError,\",\n            baseType: \"Enum\",\n            typeRef: ResultTypeEnum_1.ResultTypeEnum,\n            isPrefixingDisabled: false,\n            isMetric: false\n        },\n        message: {\n            type: \"String\",\n            definedInName: \"CaughtError\",\n            definedInFullName: \"CaughtError,\",\n            isPrefixingDisabled: false,\n            isMetric: false\n        },\n        stack: {\n            type: \"String\",\n            definedInName: \"CaughtError\",\n            definedInFullName: \"CaughtError,\",\n            isPrefixingDisabled: false,\n            isMetric: false\n        },\n        unMinStack: {\n            type: \"Object\",\n            definedInName: \"CaughtError\",\n            definedInFullName: \"CaughtError,\",\n            isPrefixingDisabled: false,\n            isMetric: false\n        },\n        extraData: {\n            type: \"Object\",\n            definedInName: \"CaughtError\",\n            definedInFullName: \"CaughtError,\",\n            isPrefixingDisabled: false,\n            isMetric: false\n        }\n    };\n    return QosError;\n}(SingleEventBase_1.SingleEventBase));\nexports.QosError = QosError;\nQosError.prototype.metadata = QosError.metadata;\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.default = QosError;\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// D:/agent/1/_work/24/s/common/~/npmx-sp-pages/~/@ms/odsp-utilities/lib/logging/events/QosError.event.js\n// module id = 51\n// module chunks = 0\n\n\n// WEBPACK FOOTER //\n// webpack:///D:/agent/1/_work/24/s/common/~/npmx-sp-pages/~/@ms/odsp-utilities/lib/logging/events/QosError.event.js","// OneDrive:IgnoreCodeCoverage\n\"use strict\";\nvar __extends = (this && this.__extends) || function (d, b) {\n    for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p];\n    function __() { this.constructor = d; }\n    d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n};\nvar SingleEventBase_1 = require('../SingleEventBase');\nvar Verbose = (function (_super) {\n    __extends(Verbose, _super);\n    /**\n     * The Verbose event constructor\n     * @param parent {IEvent} The optional parent for this event\n     */\n    function Verbose(parent) {\n        _super.call(this, 'Verbose,', 'Verbose', parent);\n    }\n    /**\n     * This is true if the Verbose event is enabled\n     */\n    Verbose.enabled = function () {\n        return true;\n    };\n    /**\n     * This will create a single Verbose event\n     * @param data {IVerboseSingleSchema}\n     * -optional name - This is the name of the qos event this verbose log correlates with\n     * -required message - This is the verbose message\n     * @param parent {IEvent} The optional parent for this event\n     */\n    Verbose.logData = function (data, parent) {\n        return SingleEventBase_1.SingleEventBase._logData(Verbose, data, parent);\n    };\n    /**\n     * This is false when Verbose event does not require a parent event\n     */\n    Verbose.prototype.requiresParent = function () {\n        return false;\n    };\n    Verbose.prototype.setSingleData = function (data) {\n        if (typeof data.name !== \"undefined\") {\n            this.data.name = this.cleanString(data.name);\n        }\n        this.data.message = this.cleanString(data.message);\n    };\n    /**\n     * The name of the Verbose event\n     */\n    Verbose.fullName = 'Verbose,';\n    /**\n     * The short name of the Verbose event\n     */\n    Verbose.shortName = 'Verbose';\n    /**\n     * This is true if the Verbose event is enabled\n     */\n    Verbose.metadata = {\n        name: {\n            type: \"String\",\n            definedInName: \"Verbose\",\n            definedInFullName: \"Verbose,\",\n            isKey: true,\n            isPrefixingDisabled: false,\n            isMetric: false\n        },\n        message: {\n            type: \"String\",\n            definedInName: \"Verbose\",\n            definedInFullName: \"Verbose,\",\n            isPrefixingDisabled: false,\n            isMetric: false\n        }\n    };\n    return Verbose;\n}(SingleEventBase_1.SingleEventBase));\nexports.Verbose = Verbose;\nVerbose.prototype.metadata = Verbose.metadata;\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.default = Verbose;\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// D:/agent/1/_work/24/s/common/~/npmx-sp-pages/~/@ms/odsp-utilities/lib/logging/events/Verbose.event.js\n// module id = 52\n// module chunks = 0\n\n\n// WEBPACK FOOTER //\n// webpack:///D:/agent/1/_work/24/s/common/~/npmx-sp-pages/~/@ms/odsp-utilities/lib/logging/events/Verbose.event.js","// OneDrive:CoverageThreshold(100)\n\"use strict\";\nvar CircularBuffer = (function () {\n    function CircularBuffer(size) {\n        this._length = 0;\n        this._head = -1;\n        if (size <= 0) {\n            throw new Error(\"Size must be positive\");\n        }\n        this._size = size;\n        this._buffer = new Array(size);\n    }\n    CircularBuffer.prototype.push = function (item) {\n        if (this._length < this._size) {\n            this._length++;\n        }\n        this._head++;\n        if (this._head === this._size) {\n            this._head = 0;\n        }\n        this._buffer[this._head] = item;\n    };\n    CircularBuffer.prototype.popOldest = function () {\n        if (this._length === 0) {\n            return null;\n        }\n        var tail = (this._head - this._length + 1 + this._size) % this._size;\n        this._length--;\n        return this._buffer[tail];\n    };\n    return CircularBuffer;\n}());\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.default = CircularBuffer;\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// D:/agent/1/_work/24/s/common/~/npmx-sp-pages/~/@ms/odsp-utilities/lib/store/CircularBuffer.js\n// module id = 53\n// module chunks = 0\n\n\n// WEBPACK FOOTER //\n// webpack:///D:/agent/1/_work/24/s/common/~/npmx-sp-pages/~/@ms/odsp-utilities/lib/store/CircularBuffer.js","/**\n * Bugs often appear in async code when stuff gets disposed, but async operations don't get canceled.\n * This Async helper class solves these issues by tying async code to the lifetime of a disposable object.\n *\n * Usage: Anything class extending from BaseModel can access this helper via this.async. Otherwise create a\n * new instance of the class and remember to call dispose() during your code's dispose handler.\n */\n\"use strict\";\nfunction noop() {\n    'use strict';\n    // Do nothing.\n}\nvar Async = (function () {\n    function Async(parent, onError) {\n        this._isDisposed = false;\n        this._parent = parent || null;\n        this._onErrorHandler = onError;\n        this._timeoutIds = null;\n        this._immediateIds = null;\n        this._animationFrameIds = null;\n        this._intervalIds = null;\n    }\n    /**\n     * Dispose function, clears all async operations.\n     */\n    Async.prototype.dispose = function () {\n        if (this._isDisposed) {\n            return;\n        }\n        this._isDisposed = true;\n        this._parent = null;\n        // Clear timeouts.\n        if (this._timeoutIds) {\n            for (var _i = 0, _a = Object.keys(this._timeoutIds); _i < _a.length; _i++) {\n                var id = _a[_i];\n                this.clearTimeout(Number(id));\n            }\n            this._timeoutIds = null;\n        }\n        // Clear immediates.\n        if (this._immediateIds) {\n            for (var _b = 0, _c = Object.keys(this._immediateIds); _b < _c.length; _b++) {\n                var id = _c[_b];\n                this.clearImmediate(Number(id));\n            }\n            this._immediateIds = null;\n        }\n        // Clear intervals.\n        if (this._intervalIds) {\n            for (var _d = 0, _e = Object.keys(this._intervalIds); _d < _e.length; _d++) {\n                var id = _e[_d];\n                this.clearInterval(Number(id));\n            }\n            this._intervalIds = null;\n        }\n        // Clear animation frames.\n        if (this._animationFrameIds) {\n            for (var _f = 0, _g = Object.keys(this._animationFrameIds); _f < _g.length; _f++) {\n                var id = _g[_f];\n                this.cancelAnimationFrame(Number(id));\n            }\n            this._animationFrameIds = null;\n        }\n    };\n    /**\n     * SetTimeout override, which will auto cancel the timeout during dispose.\n     * @param callback Callback to execute.\n     * @param duration Duration in milliseconds.\n     * @return The setTimeout id.\n     */\n    Async.prototype.setTimeout = function (callback, duration) {\n        var _this = this;\n        var timeoutId = 0;\n        if (!this._isDisposed) {\n            if (!this._timeoutIds) {\n                this._timeoutIds = {};\n            }\n            /* tslint:disable:ban-native-functions */\n            timeoutId = setTimeout(function () {\n                // Time to execute the timeout, enqueue it as a foreground task to be executed.\n                try {\n                    // Now delete the record and call the callback.\n                    delete _this._timeoutIds[timeoutId];\n                    callback.apply(_this._parent);\n                }\n                catch (e) {\n                    if (_this._onErrorHandler) {\n                        _this._onErrorHandler(e);\n                    }\n                }\n            }, duration);\n            /* tslint:enable:ban-native-functions */\n            this._timeoutIds[timeoutId] = true;\n        }\n        return timeoutId;\n    };\n    /**\n     * Clears the timeout.\n     * @param id Id to cancel.\n     */\n    Async.prototype.clearTimeout = function (id) {\n        if (this._timeoutIds && this._timeoutIds[id]) {\n            /* tslint:disable:ban-native-functions */\n            clearTimeout(id);\n            delete this._timeoutIds[id];\n        }\n    };\n    /**\n     * SetImmediate override, which will auto cancel the immediate during dispose.\n     * @param callback Callback to execute.\n     * @return The setTimeout id.\n     */\n    Async.prototype.setImmediate = function (callback) {\n        var _this = this;\n        var immediateId = 0;\n        if (!this._isDisposed) {\n            if (!this._immediateIds) {\n                this._immediateIds = {};\n            }\n            /* tslint:disable:ban-native-functions */\n            var setImmediateCallback = function () {\n                // Time to execute the timeout, enqueue it as a foreground task to be executed.\n                try {\n                    // Now delete the record and call the callback.\n                    delete _this._immediateIds[immediateId];\n                    callback.apply(_this._parent);\n                }\n                catch (e) {\n                    _this._logError(e);\n                }\n            };\n            immediateId = window.setImmediate ? window.setImmediate(setImmediateCallback) : window.setTimeout(setImmediateCallback, 0);\n            /* tslint:enable:ban-native-functions */\n            this._immediateIds[immediateId] = true;\n        }\n        return immediateId;\n    };\n    /**\n     * Clears the immediate.\n     * @param id Id to cancel.\n     */\n    Async.prototype.clearImmediate = function (id) {\n        if (this._immediateIds && this._immediateIds[id]) {\n            /* tslint:disable:ban-native-functions */\n            window.clearImmediate ? window.clearImmediate(id) : window.clearTimeout(id);\n            delete this._immediateIds[id];\n        }\n    };\n    /**\n     * SetInterval override, which will auto cancel the timeout during dispose.\n     * @param callback Callback to execute.\n     * @param duration Duration in milliseconds.\n     * @return The setTimeout id.\n     */\n    Async.prototype.setInterval = function (callback, duration) {\n        var _this = this;\n        var intervalId = 0;\n        if (!this._isDisposed) {\n            if (!this._intervalIds) {\n                this._intervalIds = {};\n            }\n            /* tslint:disable:ban-native-functions */\n            intervalId = setInterval(function () {\n                // Time to execute the interval callback, enqueue it as a foreground task to be executed.\n                try {\n                    callback.apply(_this._parent);\n                }\n                catch (e) {\n                    _this._logError(e);\n                }\n            }, duration);\n            /* tslint:enable:ban-native-functions */\n            this._intervalIds[intervalId] = true;\n        }\n        return intervalId;\n    };\n    /**\n     * Clears the interval.\n     * @param id Id to cancel.\n     */\n    Async.prototype.clearInterval = function (id) {\n        if (this._intervalIds && this._intervalIds[id]) {\n            /* tslint:disable:ban-native-functions */\n            clearInterval(id);\n            delete this._intervalIds[id];\n        }\n    };\n    /**\n     * Creates a function that, when executed, will only call the func function at most once per\n     * every wait milliseconds. Provide an options object to indicate that func should be invoked\n     * on the leading and/or trailing edge of the wait timeout. Subsequent calls to the throttled\n     * function will return the result of the last func call.\n     *\n     * Note: If leading and trailing options are true func will be called on the trailing edge of\n     * the timeout only if the the throttled function is invoked more than once during the wait timeout.\n     *\n     * @param func The function to throttle.\n     * @param wait The number of milliseconds to throttle executions to. Defaults to 0.\n     * @param options The options object.\n     * @param options.leading Specify execution on the leading edge of the timeout.\n     * @param options.trailing Specify execution on the trailing edge of the timeout.\n     * @return The new throttled function.\n     */\n    Async.prototype.throttle = function (func, wait, options) {\n        var _this = this;\n        if (this._isDisposed) {\n            return noop;\n        }\n        var waitMS = wait || 0;\n        var leading = true;\n        var trailing = true;\n        var lastExecuteTime = 0;\n        var lastResult;\n        var lastArgs;\n        var timeoutId = null;\n        if (options && typeof (options.leading) === 'boolean') {\n            leading = options.leading;\n        }\n        if (options && typeof (options.trailing) === 'boolean') {\n            trailing = options.trailing;\n        }\n        var callback = function (userCall) {\n            var now = (new Date()).getTime();\n            var delta = now - lastExecuteTime;\n            var waitLength = leading ? waitMS - delta : waitMS;\n            if (delta >= waitMS && (!userCall || leading)) {\n                lastExecuteTime = now;\n                if (timeoutId) {\n                    _this.clearTimeout(timeoutId);\n                    timeoutId = null;\n                }\n                lastResult = func.apply(_this._parent, lastArgs);\n            }\n            else if (timeoutId === null && trailing) {\n                timeoutId = _this.setTimeout(callback, waitLength);\n            }\n            return lastResult;\n        };\n        var resultFunction = function () {\n            var args = [];\n            for (var _i = 0; _i < arguments.length; _i++) {\n                args[_i - 0] = arguments[_i];\n            }\n            lastArgs = args;\n            return callback(true);\n        };\n        return resultFunction;\n    };\n    /**\n     * Creates a function that will delay the execution of func until after wait milliseconds have\n     * elapsed since the last time it was invoked. Provide an options object to indicate that func\n     * should be invoked on the leading and/or trailing edge of the wait timeout. Subsequent calls\n     * to the debounced function will return the result of the last func call.\n     *\n     * Note: If leading and trailing options are true func will be called on the trailing edge of\n     * the timeout only if the the debounced function is invoked more than once during the wait\n     * timeout.\n     *\n     * @param func The function to debounce.\n     * @param wait The number of milliseconds to delay.\n     * @param options The options object.\n     * @param options.leading Specify execution on the leading edge of the timeout.\n     * @param options.maxWait The maximum time func is allowed to be delayed before it's called.\n     * @param options.trailing Specify execution on the trailing edge of the timeout.\n     * @return The new debounced function.\n     */\n    Async.prototype.debounce = function (func, wait, options) {\n        var _this = this;\n        if (this._isDisposed) {\n            return noop;\n        }\n        var waitMS = wait || 0;\n        var leading = false;\n        var trailing = true;\n        var maxWait = null;\n        var lastCallTime = 0;\n        var lastExecuteTime = (new Date()).getTime();\n        var lastResult;\n        var lastArgs;\n        var timeoutId = null;\n        if (options && typeof (options.leading) === 'boolean') {\n            leading = options.leading;\n        }\n        if (options && typeof (options.trailing) === 'boolean') {\n            trailing = options.trailing;\n        }\n        if (options && typeof (options.maxWait) === 'number' && !isNaN(options.maxWait)) {\n            maxWait = options.maxWait;\n        }\n        var callback = function (userCall) {\n            var now = (new Date()).getTime();\n            var executeImmediately = false;\n            if (userCall) {\n                if (leading && now - lastCallTime >= waitMS) {\n                    executeImmediately = true;\n                }\n                lastCallTime = now;\n            }\n            var delta = now - lastCallTime;\n            var waitLength = waitMS - delta;\n            var maxWaitDelta = now - lastExecuteTime;\n            var maxWaitExpired = false;\n            if (maxWait !== null) {\n                // maxWait only matters when there is a pending callback\n                if (maxWaitDelta >= maxWait && timeoutId) {\n                    maxWaitExpired = true;\n                }\n                else {\n                    waitLength = Math.min(waitLength, maxWait - maxWaitDelta);\n                }\n            }\n            if (delta >= waitMS || maxWaitExpired || executeImmediately) {\n                if (timeoutId) {\n                    _this.clearTimeout(timeoutId);\n                    timeoutId = null;\n                }\n                lastExecuteTime = now;\n                lastResult = func.apply(_this._parent, lastArgs);\n            }\n            else if ((timeoutId === null || !userCall) && trailing) {\n                timeoutId = _this.setTimeout(callback, waitLength);\n            }\n            return lastResult;\n        };\n        var resultFunction = function () {\n            var args = [];\n            for (var _i = 0; _i < arguments.length; _i++) {\n                args[_i - 0] = arguments[_i];\n            }\n            lastArgs = args;\n            return callback(true);\n        };\n        return resultFunction;\n    };\n    Async.prototype.requestAnimationFrame = function (callback) {\n        var _this = this;\n        var animationFrameId = 0;\n        if (!this._isDisposed) {\n            if (!this._animationFrameIds) {\n                this._animationFrameIds = {};\n            }\n            /* tslint:disable:ban-native-functions */\n            var animationFrameCallback = function () {\n                try {\n                    // Now delete the record and call the callback.\n                    delete _this._animationFrameIds[animationFrameId];\n                    callback.apply(_this._parent);\n                }\n                catch (e) {\n                    _this._logError(e);\n                }\n            };\n            animationFrameId = window.requestAnimationFrame ? window.requestAnimationFrame(animationFrameCallback) : window.setTimeout(animationFrameCallback, 0);\n            /* tslint:enable:ban-native-functions */\n            this._animationFrameIds[animationFrameId] = true;\n        }\n        return animationFrameId;\n    };\n    Async.prototype.cancelAnimationFrame = function (id) {\n        if (this._animationFrameIds && this._animationFrameIds[id]) {\n            /* tslint:disable:ban-native-functions */\n            window.cancelAnimationFrame ? window.cancelAnimationFrame(id) : window.clearTimeout(id);\n            /* tslint:enable:ban-native-functions */\n            delete this._animationFrameIds[id];\n        }\n    };\n    Async.prototype._logError = function (e) {\n        if (this._onErrorHandler) {\n            this._onErrorHandler(e);\n        }\n    };\n    return Async;\n}());\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.default = Async;\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// D:/agent/1/_work/24/s/common/~/npmx-sp-pages/~/@ms/odsp-utilities/lib/async/Async.js\n// module id = 54\n// module chunks = 0\n\n\n// WEBPACK FOOTER //\n// webpack:///D:/agent/1/_work/24/s/common/~/npmx-sp-pages/~/@ms/odsp-utilities/lib/async/Async.js","// OneDrive:IgnoreCodeCoverage\n\"use strict\";\nvar RUMOneLogger_1 = require('./RUMOneLogger');\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.default = RUMOneLogger_1.APICallPerformanceData;\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// D:/agent/1/_work/24/s/common/~/npmx-sp-pages/~/@ms/odsp-utilities/lib/logging/rumone/APICallPerformanceData.js\n// module id = 55\n// module chunks = 0\n\n\n// WEBPACK FOOTER //\n// webpack:///D:/agent/1/_work/24/s/common/~/npmx-sp-pages/~/@ms/odsp-utilities/lib/logging/rumone/APICallPerformanceData.js","\"use strict\";\n// OneDrive:IgnoreCodeCoverage\nvar Async_1 = require('../../async/Async');\nvar PageTransitionType_1 = require('./PageTransitionType');\nvar RUMOneSLAPI_1 = require('./RUMOneSLAPI');\nvar RUMOneErrorsSLAPI_1 = require('./RUMOneErrorsSLAPI');\nvar RUMOneDataUpload_event_1 = require('../events/RUMOneDataUpload.event');\nvar PlatformDetection_1 = require('../../browser/PlatformDetection');\nvar PerformanceDataState;\n(function (PerformanceDataState) {\n    PerformanceDataState[PerformanceDataState[\"Incomplete\"] = 1] = \"Incomplete\";\n    PerformanceDataState[PerformanceDataState[\"ReadyToUpload\"] = 2] = \"ReadyToUpload\";\n    PerformanceDataState[PerformanceDataState[\"Uploaded\"] = 3] = \"Uploaded\";\n    PerformanceDataState[PerformanceDataState[\"TimeOut\"] = 4] = \"TimeOut\";\n})(PerformanceDataState || (PerformanceDataState = {}));\nvar MARKER_PREFIX = \"EUPL.\";\nvar APICallPerformanceData = (function () {\n    function APICallPerformanceData(url, duration, correlationid, status, startTime, endTime, name) {\n        this.url = url;\n        this.duration = duration;\n        this.correlationId = correlationid;\n        this.status = status;\n        this.startTime = startTime;\n        this.endTime = endTime;\n        this.name = name;\n    }\n    return APICallPerformanceData;\n}());\nexports.APICallPerformanceData = APICallPerformanceData;\nvar ControlPerformanceData = (function () {\n    function ControlPerformanceData(controlId, startTime, endTime, renderTimeCalculator, renderTimeRequiredDataChecker) {\n        this.controlId = controlId;\n        this.startTime = startTime;\n        this.endTime = endTime;\n        this.renderTimeCalculator = renderTimeCalculator;\n        this.renderTimeRequiredDataChecker = renderTimeRequiredDataChecker;\n    }\n    return ControlPerformanceData;\n}());\nexports.ControlPerformanceData = ControlPerformanceData;\n/**\n * It is a new client side perf instrumentation, it logs more metrics, like scenario, api data, server request id, duration, etc in 1 single schema.\n * It has server side usage DB and cosmos supports.\n */\nvar RUMOneLogger = (function () {\n    function RUMOneLogger(logFunc) {\n        this.async = new Async_1.default(this);\n        this.dataStartTime = Number((new Date()).getTime());\n        this.performanceData = null;\n        this.dataState = PerformanceDataState.Incomplete;\n        this.controls = [];\n        this.apis = [];\n        this.perfDataTimer = null;\n        this.expectedControls = [];\n        this.euplBreakDown = {};\n        this.serverMetrics = {};\n        this.isW3cTimingCollected = false;\n        this.isW3cResourceTimingCollected = false;\n        this.tempData = {};\n        this.markerIndex = 0;\n        this.performanceData = null;\n        this.loggingFunc = logFunc;\n        this.getPerformanceData();\n        this.setPerfDataTimer();\n        this._platformDetection = new PlatformDetection_1.default();\n    }\n    RUMOneLogger.isNullOrUndefined = function (item) {\n        return item === null || item === undefined;\n    };\n    /**\n     * RUMOneLogger.getRUMOneLogger: Use this method to get a singleton reference of RUMOneLogger\n     * with default parameters.\n     */\n    RUMOneLogger.getRUMOneLogger = function (logFunc) {\n        var loggingFunc = logFunc || (function (streamName, dictProperties) {\n            RUMOneDataUpload_event_1.RUMOneDataUpload.logData({ streamName: streamName, dictionary: dictProperties });\n        });\n        if (!RUMOneLogger.rumOneLogger) {\n            try {\n                RUMOneLogger.rumOneLogger = new RUMOneLogger(loggingFunc);\n            }\n            catch (e) {\n                // If RUMOneLogger fails, don't block UX\n                RUMOneLogger.rumOneLogger = null;\n            }\n        }\n        return RUMOneLogger.rumOneLogger;\n    };\n    RUMOneLogger.prototype.getPerformanceData = function () {\n        if (!this.performanceData) {\n            this.performanceData = new RUMOneSLAPI_1.default();\n            this.logMessageInConsole(\"RUMOne object initiated!\");\n        }\n        return this.performanceData;\n    };\n    RUMOneLogger.prototype.resetLogger = function () {\n        this.dataStartTime = (new Date()).getTime();\n        this.dataState = PerformanceDataState.Incomplete;\n        this.isW3cTimingCollected = false;\n        this.isW3cResourceTimingCollected = false;\n        this.expectedControls = [];\n        this.controls = [];\n        this.apis = [];\n        this.tempData = {};\n        this.performanceData = null;\n        this.getPerformanceData();\n        this.clearPerfDataTimer();\n        this.setPerfDataTimer();\n        this.euplBreakDown = {};\n        this.serverMetrics = {};\n        this.logMessageInConsole(\"Reset performance Logger Done\");\n        this.clearResourceTimings();\n        this.clearMarks();\n    };\n    RUMOneLogger.prototype.logPerformanceData = function (key, value) {\n        if (!key || !this.performanceData || !this.verifyPropertyMatchingSchema(key)) {\n            return;\n        }\n        this.getPerformanceData();\n        this.performanceData[key] = value;\n    };\n    RUMOneLogger.prototype.getPerformanceDataPropertyValue = function (key) {\n        if (!this.performanceData || !key || !this.verifyPropertyMatchingSchema(key)) {\n            return null;\n        }\n        return this.performanceData[key];\n    };\n    RUMOneLogger.prototype.verifyPropertyMatchingSchema = function (propertyName) {\n        var properties = this.getRUMOnePropertyNames(this.performanceData);\n        return properties.join().indexOf(propertyName) !== -1;\n    };\n    RUMOneLogger.prototype.addExpectedControl = function (control) {\n        if (this.expectedControls.indexOf(control) === -1) {\n            this.expectedControls.push(control);\n        }\n    };\n    RUMOneLogger.prototype.expectingControl = function (control) {\n        return this.expectedControls.indexOf(control) >= 0;\n    };\n    RUMOneLogger.prototype.writeServerCorrelationId = function (correlationId) {\n        if (!this.isCollected('ServerCorrelationId')) {\n            this.logPerformanceData('ServerCorrelationId', correlationId);\n        }\n    };\n    RUMOneLogger.prototype.writeServerUrl = function (url) {\n        if (!this.isCollected('ServerUrl')) {\n            var serverUrl = url || window.location.href;\n            this.logPerformanceData('ServerUrl', serverUrl);\n        }\n    };\n    RUMOneLogger.prototype.writeServerSideLatency = function (duration, iisLatency) {\n        if (!this.isCollected('ServerRequestDuration')) {\n            this.logPerformanceData('ServerRequestDuration', duration);\n            this.logPerformanceData('IISLatency', iisLatency);\n        }\n    };\n    RUMOneLogger.prototype.writeControlPerformanceData = function (controlData) {\n        if (controlData) {\n            var foundControl = this.controls.filter(function (control) {\n                return control.controlId === controlData.controlId;\n            });\n            if (foundControl.length === 0) {\n                this.controls.push(controlData);\n            }\n        }\n    };\n    RUMOneLogger.prototype.writeAPICallPerformanceData = function (apiData) {\n        if (apiData) {\n            this.apis.push(apiData);\n        }\n    };\n    RUMOneLogger.prototype.readAPICallPerformanceData = function () {\n        return this.apis;\n    };\n    RUMOneLogger.prototype.writeAppCache = function (appCache) {\n        if (!this.isCollected('AppCache')) {\n            this.logPerformanceData('AppCache', appCache);\n        }\n    };\n    RUMOneLogger.prototype.writePageTransitionType = function (pageTransitionType, overwrite) {\n        if ((!this.isCollected('PageTransitionType') || overwrite) &&\n            !RUMOneLogger.isNullOrUndefined(pageTransitionType) &&\n            (pageTransitionType === PageTransitionType_1.default.fullPageLoad || pageTransitionType === PageTransitionType_1.default.none || pageTransitionType === PageTransitionType_1.default.onePageAppNavigation)) {\n            this.logPerformanceData('PageTransitionType', pageTransitionType);\n        }\n    };\n    RUMOneLogger.prototype.writeScenarioId = function (scenarioId, overwrite) {\n        if (!this.isCollected('ScenarioId') || overwrite) {\n            this.logPerformanceData('ScenarioId', scenarioId);\n        }\n    };\n    RUMOneLogger.prototype.collectW3CPerfTimings = function () {\n        if (!this.isW3cTimingCollected) {\n            var w3cTimeStampNames = ['navigationStart', 'unloadEventStart', 'unloadEventEnd', 'fetchStart', 'redirectStart', 'redirectEnd', 'domainLookupStart', 'domainLookupEnd', 'connectStart', 'secureConnectionStart', 'connectEnd', 'requestStart', 'responseStart', 'responseEnd', 'domLoading', 'domComplete', 'loadEventStart', 'loadEventEnd'];\n            var perfTimingObject = this.getWindowPerfTimingObject();\n            if (perfTimingObject) {\n                for (var index = 0; index < w3cTimeStampNames.length; index++) {\n                    var w3cObject = perfTimingObject[w3cTimeStampNames[index]];\n                    if (w3cObject) {\n                        this.logPerformanceData(this.getW3cTimingName(w3cTimeStampNames[index]), Number(w3cObject));\n                    }\n                }\n                this.isW3cTimingCollected = true;\n            }\n        }\n    };\n    RUMOneLogger.prototype.collectW3cResourceTimings = function () {\n        if (!this.isW3cResourceTimingCollected && window.performance && window.performance.getEntriesByType) {\n            var allRequests = performance.getEntriesByType(\"resource\");\n            var iFrames = document.getElementsByTagName(\"iframe\");\n            for (var index = 0; index < iFrames.length; index++) {\n                var iFramePerformance = null;\n                try {\n                    iFramePerformance = iFrames[index].contentWindow.performance;\n                }\n                catch (e) {\n                }\n                if (iFramePerformance && iFramePerformance.getEntriesByType) {\n                    allRequests.concat(iFramePerformance.getEntriesByType(\"resource\"));\n                }\n            }\n            var fromSources = {};\n            fromSources[\"SharePoint\"] = function (element) { return /\\.sharepoint\\.com|\\.spoppe\\.com/i.test(element.name); }; //matching sharepoint.com or spoppe.com\n            fromSources[\"CDN\"] = function (element) { return /(cdn(ppe)?|static(ppe)?)\\.sharepointonline\\.com|\\.akamaihd\\.net/i.test(element.name); }; //matching cdn(ppe)sharepointonline.com or adamaihd.net\n            fromSources[\"ThirdParty\"] = function (element) { return !fromSources[\"SharePoint\"](element) && !fromSources[\"CDN\"](element); }; // all requests other than sharepoint requests or cdn requests\n            var types = {};\n            types[\"ASPX\"] = function (element) { return /\\.aspx/i.test(element.name); };\n            types[\"JS\"] = function (element) { return /script/i.test(element.initiatorType); };\n            types[\"CSS\"] = function (element) { return /link|css/i.test(element.initiatorType); };\n            types[\"IMG\"] = function (element) { return /img/i.test(element.initiatorType); };\n            var sources = Object.keys(fromSources);\n            for (var index = 0; index < sources.length; index++) {\n                var source = sources[index];\n                var requests = this.categorizeResourceRequests(allRequests, {\n                    from: fromSources[source],\n                    requestType: null //match any type to get total request count for this source\n                });\n                this.logPerformanceData(source + \"RequestCountTotal\", requests.length); //SharePoint|CDN|ThirdParty resource request count\n                var typeKeys = Object.keys(types);\n                for (var typeIndex = 0; typeIndex < typeKeys.length; typeIndex++) {\n                    var type = typeKeys[typeIndex];\n                    this.logPerformanceData(source + \"RequestCount\" + type, this.categorizeResourceRequests(requests, {\n                        from: null,\n                        requestType: types[type]\n                    }).length); //SharePoint|CDN|ThirdParty ASPX resource request count\n                }\n                if (requests.length > 0) {\n                    this.logPerformanceData(source + \"RequestDownloadTime\", Math.round(requests.reduce(function (sum, currentVal) {\n                        return sum + currentVal.duration;\n                    }, 0) / requests.length)); //SharePoint|CDN|ThirdParty resource request average duration\n                    // log the file names of all resource requests in a JSON string. The output after processing will looks like:\n                    // [{name: \"require-db6c47e2.js\", startTime: 500, duration: 100},{name: \"RenderListDataAsStream\", startTime: 200, duration: 10}]\n                    // The raw resource name before this processing is \"https://msft.spoppe.com/teams/SPGroups/_api/web/GetList(@listUrl)/RenderListDataAsStream?Paged=TRUE&p_FileLeafRef=test%2eurl&p_ID=213&PageFirstRow=121&View=6eab4254-2f2f-4086-91c0-549ae900cc93&@listUrl=%27%2Fteams%2FSPGroups%2FVNextDocLib%27\"\n                    var files = JSON.stringify(requests.map(function (timing) {\n                        return {\n                            name: timing.name.split(\"/\").map(function (urlToken) {\n                                return urlToken.split(\"?\")[0];\n                            }).filter(function (urlToken) {\n                                return urlToken && urlToken.length > 0;\n                            }).slice(-1)[0].replace(/\\(.*?\\)/g, '()'),\n                            startTime: Math.round(timing.startTime),\n                            duration: Math.round(timing.duration)\n                        };\n                    }));\n                    this.logPerformanceData(source + \"RequestNames\", files);\n                }\n            }\n            this.isW3cResourceTimingCollected = true;\n        }\n    };\n    RUMOneLogger.prototype.saveTempData = function (key, value) {\n        this.tempData[key] = value;\n    };\n    RUMOneLogger.prototype.readTempData = function (key) {\n        return this.tempData[key];\n    };\n    RUMOneLogger.prototype.writeRenderTime = function (renderTime, overwrite) {\n        if (!this.isCollected('RenderTime') || overwrite) {\n            this.logPerformanceData('RenderTime', renderTime);\n        }\n    };\n    RUMOneLogger.prototype.writePreRenderTime = function (preRender) {\n        if (!this.isCollected('PreRender')) {\n            this.logPerformanceData('PreRender', preRender);\n        }\n    };\n    RUMOneLogger.prototype.writePostRenderTime = function (postRender) {\n        if (!this.isCollected('PostRender')) {\n            this.logPerformanceData('PostRender', postRender);\n        }\n    };\n    RUMOneLogger.prototype.writeDataFetchTime = function (dataFetch, overwrite) {\n        if (!this.isCollected('DataFetch') || overwrite) {\n            this.logPerformanceData('DataFetch', dataFetch);\n        }\n    };\n    RUMOneLogger.prototype.isRunning = function () {\n        return !(this.dataState === PerformanceDataState.Uploaded || this.dataState === PerformanceDataState.TimeOut);\n    };\n    RUMOneLogger.prototype.writeEUPLBreakdown = function (euplBreakdown, overwrite) {\n        if (euplBreakdown) {\n            try {\n                var breakdown = JSON.parse(euplBreakdown);\n                for (var key in breakdown) {\n                    if (!breakdown.hasOwnProperty(key)) {\n                        continue;\n                    }\n                    this.addEUPLBreakdown(key, breakdown[key], overwrite);\n                }\n            }\n            catch (e) {\n                // in case the euplBreakdown is invalid JSON\n                this.logMessageInConsole(\"Failed to write EUPL breakdown data:\" + e.toString());\n            }\n        }\n    };\n    RUMOneLogger.prototype.addEUPLBreakdown = function (name, value, overwrite) {\n        if (name && !RUMOneLogger.isNullOrUndefined(value)) {\n            if (RUMOneLogger.isNullOrUndefined(this.euplBreakDown[name]) || overwrite) {\n                this.euplBreakDown[name] = value;\n            }\n        }\n    };\n    RUMOneLogger.prototype.addServerMetrics = function (metric, overwrite) {\n        if (metric) {\n            for (var key in metric) {\n                if (key && !RUMOneLogger.isNullOrUndefined(metric[key]) &&\n                    (RUMOneLogger.isNullOrUndefined(this.serverMetrics[key]) || overwrite)) {\n                    this.serverMetrics[key] = metric[key];\n                }\n            }\n        }\n    };\n    RUMOneLogger.prototype.readControlPerformanceData = function () {\n        return this.controls;\n    };\n    RUMOneLogger.prototype.mark = function (name) {\n        if (window.performance && window.performance.mark) {\n            window.performance.mark(MARKER_PREFIX + name);\n        }\n    };\n    RUMOneLogger.prototype.clearResourceTimings = function () {\n        var perfObject = window.self[\"performance\"];\n        if (perfObject && perfObject.clearResourceTimings) {\n            perfObject.clearResourceTimings();\n        }\n    };\n    RUMOneLogger.prototype.collectMarks = function () {\n        var _this = this;\n        if (window.performance && window.performance.getEntriesByType) {\n            var marks_1 = {};\n            window.performance.getEntriesByType(\"mark\").filter(function (mark) {\n                return mark.name.lastIndexOf(MARKER_PREFIX, 0) === 0;\n            }).forEach(function (mark) {\n                if (_this.markerIndex < RUMOneLogger.MAX_MARKS) {\n                    var markName = mark.name.substr(MARKER_PREFIX.length) + (\".mark\" + _this.markerIndex++);\n                    marks_1[markName] = Math.round(mark.startTime); // covert to rumone collected marks to object and merge to EUPL Breakdown\n                }\n            });\n            this.writeEUPLBreakdown(JSON.stringify(marks_1));\n        }\n    };\n    RUMOneLogger.prototype.clearMarks = function () {\n        if (window.performance && window.performance.getEntriesByType && window.performance.clearMarks) {\n            window.performance.getEntriesByType(\"mark\").filter(function (mark) {\n                return mark.name.lastIndexOf(MARKER_PREFIX, 0) === 0;\n            }).forEach(function (mark) {\n                window.performance.clearMarks(mark.name);\n            });\n        }\n        this.markerIndex = 0;\n    };\n    RUMOneLogger.prototype.logMessageInConsole = function (message) {\n        try {\n            if ('sessionStorage' in window && window.sessionStorage) {\n                var debugStr = window.sessionStorage[\"enableRUMOneDebugging\"];\n                var debug = debugStr && debugStr.toLowerCase() === \"true\";\n            }\n        }\n        catch (e) {\n        }\n        if (debug && typeof console !== \"undefined\" && console) {\n            console.log(message);\n        }\n    };\n    RUMOneLogger.prototype.logObjectForDebugging = function (propertyName, dictProperties) {\n        var logMessageText = propertyName + \" : \" + JSON.stringify(dictProperties);\n        this.logMessageInConsole(logMessageText);\n    };\n    RUMOneLogger.prototype.isCollected = function (name) {\n        return !RUMOneLogger.isNullOrUndefined(this.getPerformanceDataPropertyValue(name));\n    };\n    RUMOneLogger.prototype.getRUMOnePropertyNames = function (obj) {\n        var names = [];\n        var index = 0;\n        if (!RUMOneLogger.isNullOrUndefined(obj)) {\n            for (var property in obj) {\n                if (obj.hasOwnProperty(property)) {\n                    names[index++] = property;\n                }\n            }\n        }\n        return names;\n    };\n    RUMOneLogger.prototype.setPerfDataTimer = function () {\n        this.perfDataTimer = this.async.setTimeout(this.loopForDataCompleteness, RUMOneLogger.CHECK_INTERVAL);\n    };\n    RUMOneLogger.prototype.clearPerfDataTimer = function () {\n        if (!RUMOneLogger.isNullOrUndefined(this.perfDataTimer)) {\n            this.async.clearTimeout(this.perfDataTimer);\n            this.perfDataTimer = null;\n        }\n    };\n    RUMOneLogger.prototype.categorizeResourceRequests = function (requests, categorizer) {\n        var ret = [];\n        for (var index = 0; index < requests.length; index++) {\n            var request = requests[index];\n            if ((!categorizer.from || categorizer.from(request)) && (!categorizer.requestType || categorizer.requestType(request))) {\n                ret.push(request);\n            }\n        }\n        return ret;\n    };\n    RUMOneLogger.prototype.collectSupplementaryData = function () {\n        this.setAPIDataToRUMOne();\n        this.collectMarks();\n        this.writeServerUrl(null);\n        this.setBrowseInfo();\n        this.setReferrer();\n        this.logPerformanceData('ServerMetrics', JSON.stringify(this.serverMetrics));\n        this.logPerformanceData('EUPLBreakdown', JSON.stringify(this.euplBreakDown));\n    };\n    RUMOneLogger.prototype.loopForDataCompleteness = function () {\n        this.clearPerfDataTimer();\n        this.logObjectForDebugging(\"RUMONE: \", this.performanceData);\n        this.logObjectForDebugging(\"RUMOne DataState: \", String(this.getReadableDataState(this.dataState)));\n        this.logObjectForDebugging(\"Control Performance Data: \", this.controls);\n        this.logObjectForDebugging(\"API Performance Data: \", this.apis);\n        this.logObjectForDebugging(\"Temp Data: \", this.tempData);\n        this.logObjectForDebugging(\"EUPLBreakdown: \", this.euplBreakDown);\n        this.logObjectForDebugging(\"ServerMetrics: \", this.serverMetrics);\n        this.logMessageInConsole(\"====================================================================\");\n        if (!this.isRunning()) {\n            return;\n        }\n        var collected = true;\n        var missedKeyMetrics = [];\n        for (var i = 0; i < RUMOneLogger.KeyMetrics.length; i++) {\n            var keyMetricValue = this.getPerformanceDataPropertyValue(RUMOneLogger.KeyMetrics[i]);\n            if (RUMOneLogger.isNullOrUndefined(keyMetricValue)) {\n                collected = false;\n                missedKeyMetrics.push(RUMOneLogger.KeyMetrics[i]);\n            }\n        }\n        this.dataState = collected ? PerformanceDataState.ReadyToUpload : PerformanceDataState.Incomplete;\n        if (this.dataState === PerformanceDataState.Incomplete) {\n            if (Number((new Date()).getTime()) - Number(this.dataStartTime) > RUMOneLogger.ERROR_TIMEOUT) {\n                this.dataState = PerformanceDataState.TimeOut;\n                this.collectSupplementaryData();\n                this.uploadPerfData();\n                this.reportErrors('TimeOut', 'Did not get key perf metrics in ' + String(RUMOneLogger.ERROR_TIMEOUT) + ' milliseconds. Missed metrics: ' + missedKeyMetrics.join() + '.');\n            }\n            else {\n                this.processControlPerfData();\n                if (this.readyToComputeEUPL()) {\n                    this.setEUPL();\n                }\n            }\n        }\n        else {\n            this.collectSupplementaryData();\n            try {\n                this.uploadPerfData();\n            }\n            catch (e) {\n                (function (errorText) {\n                    if (typeof console !== \"undefined\" && Boolean(console)) {\n                        console.error(errorText);\n                    }\n                })(\"PerformanceLogger error writing RUMOne data: \" + String(e));\n            }\n            this.dataState = PerformanceDataState.Uploaded;\n        }\n        this.setPerfDataTimer();\n    };\n    RUMOneLogger.prototype.getReadableDataState = function (_dataState) {\n        for (var key in PerformanceDataState) {\n            if (_dataState === Number(PerformanceDataState[key])) {\n                return key;\n            }\n        }\n        return 'NaN';\n    };\n    RUMOneLogger.prototype.writeControlDataToRUMOne = function (controlData) {\n        var _this = this;\n        if (controlData) {\n            var indexes = [1, 2, 3, 4, 5, 6, 7, 8, 9, 10].filter(function (index) {\n                return !_this.isCollected(\"Control\" + index + \"Id\");\n            });\n            var index = indexes.length > 0 ? indexes[0] : -1;\n            if (index > 0) {\n                this.logPerformanceData(\"Control\" + index + \"Id\", controlData.controlId);\n                this.logPerformanceData(\"Control\" + index + \"RenderTime\", controlData.renderTime);\n            }\n        }\n    };\n    RUMOneLogger.prototype.processControlPerfData = function () {\n        for (var index = 0; index < this.controls.length; index++) {\n            var control = this.controls[index];\n            if (!Boolean(control.renderTime) && control.renderTimeRequiredDataChecker(this, control)) {\n                control.renderTime = control.renderTimeCalculator(this, control);\n                this.writeControlDataToRUMOne(control);\n            }\n        }\n    };\n    RUMOneLogger.prototype.readyToComputeEUPL = function () {\n        var readyControls = 0;\n        for (var index = 0; index < this.expectedControls.length; index++) {\n            var keyControl = this.lookUpControls(this.expectedControls[index], this.controls);\n            if (keyControl && Boolean(keyControl.renderTime)) {\n                readyControls++;\n            }\n        }\n        return this.expectedControls.length > 0 && this.expectedControls.length === readyControls;\n    };\n    RUMOneLogger.prototype.lookUpControls = function (_controlId, _controls) {\n        if (_controls) {\n            for (var index = 0; index < _controls.length; index++) {\n                if (_controlId === _controls[index].controlId) {\n                    return _controls[index];\n                }\n            }\n        }\n        return null;\n    };\n    RUMOneLogger.prototype.setEUPL = function () {\n        if (!this.isCollected('EUPL')) {\n            var eupl = 0;\n            for (var index = 0; index < this.controls.length; index++) {\n                var controlData = this.controls[index];\n                if (Boolean(controlData.renderTime) && eupl < controlData.renderTime) {\n                    eupl = controlData.renderTime;\n                }\n            }\n            this.logPerformanceData('EUPL', eupl);\n        }\n    };\n    RUMOneLogger.prototype.setBrowseInfo = function () {\n        this.logPerformanceData('Browser', this._platformDetection.browserName + this._platformDetection.browserMajor);\n        this.logPerformanceData('BrowserIsMobile', this._platformDetection.isMobile);\n    };\n    RUMOneLogger.prototype.setAPIDataToRUMOne = function () {\n        var calls = 0;\n        var durationSum = 0;\n        for (var index = 0; index < this.apis.length; index++) {\n            var apiData = this.apis[index];\n            if (apiData) {\n                calls++;\n                durationSum += apiData.duration;\n                // only take the function part of the API url to avoid cosmos data scrubber\n                // url before processing: /teams/SPGroups/_api/web/GetList(@listUrl)/RenderListDataAsStream?Paged=TRUE&p_FileLeafRef=test%2eurl&p_ID=213&PageFirstRow=121&View=6eab4254-2f2f-4086-91c0-549ae900cc93&@listUrl=%27%2Fteams%2FSPGroups%2FVNextDocLib%27\"\n                // url after processing: RenderListDataAsStream\n                apiData.url = apiData.url.split(\"/\").map(function (s) { return s.split(\"?\")[0]; }).slice(-1)[0].replace(/\\(.*?\\)/g, '()');\n            }\n        }\n        this.logPerformanceData('APICallCount', calls);\n        this.logPerformanceData('APICallDurationSum', durationSum);\n        this.logPerformanceData('APICalls', JSON.stringify(this.apis));\n    };\n    RUMOneLogger.prototype.setReferrer = function () {\n        if (!this.isCollected('Referrer')) {\n            this.logPerformanceData('Referrer', document.referrer);\n        }\n    };\n    RUMOneLogger.prototype.getW3cTimingName = function (timingName) {\n        if (timingName !== 'secureConnectionStart') {\n            return 'W3c' + timingName.charAt(0).toUpperCase() + timingName.slice(1);\n        }\n        else {\n            return 'W3cSecureConnectStart'; // to workaround a RUMOne schema issue W3cSecureConnectStart should be W3cSecureConnectionStart\n        }\n    };\n    RUMOneLogger.prototype.getWindowPerfTimingObject = function () {\n        var perfObject = window.self[\"performance\"];\n        if (!RUMOneLogger.isNullOrUndefined(perfObject) && !RUMOneLogger.isNullOrUndefined(perfObject.timing)) {\n            return perfObject.timing;\n        }\n        return null;\n    };\n    RUMOneLogger.prototype.uploadPerfData = function () {\n        if (this.performanceData && this.loggingFunc &&\n            (this.dataState === PerformanceDataState.ReadyToUpload ||\n                this.dataState === PerformanceDataState.TimeOut)) {\n            this.loggingFunc(\"RUMOne\", this.getPerformanceData());\n        }\n    };\n    RUMOneLogger.prototype.reportErrors = function (reason, message) {\n        var errorObj = new RUMOneErrorsSLAPI_1.default();\n        errorObj.Reason = reason;\n        errorObj.Message = message;\n        if (this.loggingFunc) {\n            this.loggingFunc(\"RUMOneErrors\", errorObj);\n        }\n    };\n    RUMOneLogger.rumOneLogger = null;\n    RUMOneLogger.CHECK_INTERVAL = 100; // in milliseconds\n    RUMOneLogger.ERROR_TIMEOUT = 30000; // in milliseconds\n    RUMOneLogger.MAX_MARKS = 50; // suppport maximum 50 perf markers\n    RUMOneLogger.KeyMetrics = ['EUPL', 'ScenarioId'];\n    return RUMOneLogger;\n}());\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.default = RUMOneLogger;\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// D:/agent/1/_work/24/s/common/~/npmx-sp-pages/~/@ms/odsp-utilities/lib/logging/rumone/RUMOneLogger.js\n// module id = 56\n// module chunks = 0\n\n\n// WEBPACK FOOTER //\n// webpack:///D:/agent/1/_work/24/s/common/~/npmx-sp-pages/~/@ms/odsp-utilities/lib/logging/rumone/RUMOneLogger.js","\"use strict\";\n// OneDrive:IgnoreCodeCoverage\nvar PageTransitionType;\n(function (PageTransitionType) {\n    PageTransitionType[PageTransitionType[\"none\"] = 0] = \"none\";\n    PageTransitionType[PageTransitionType[\"fullPageLoad\"] = 4] = \"fullPageLoad\";\n    PageTransitionType[PageTransitionType[\"onePageAppNavigation\"] = 5] = \"onePageAppNavigation\";\n})(PageTransitionType || (PageTransitionType = {}));\n;\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.default = PageTransitionType;\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// D:/agent/1/_work/24/s/common/~/npmx-sp-pages/~/@ms/odsp-utilities/lib/logging/rumone/PageTransitionType.js\n// module id = 57\n// module chunks = 0\n\n\n// WEBPACK FOOTER //\n// webpack:///D:/agent/1/_work/24/s/common/~/npmx-sp-pages/~/@ms/odsp-utilities/lib/logging/rumone/PageTransitionType.js","// OneDrive:IgnoreCodeCoverage\n\"use strict\";\n//Intentionally Override the normal camel casing style to title casing style because the schema has to match exactly the server side schema which is Title casing.\n//Please do not change back to camel casing.\nvar RUMOneSLAPI = (function () {\n    function RUMOneSLAPI() {\n        this.ServerCorrelationId = null;\n        this.ScenarioId = null;\n        this.EUPL = undefined;\n        this.ServerUrl = null;\n        this.Browser = null;\n        this.ClientIP = null;\n        this.UserAgent = null;\n        this.Flights = null;\n        this.PageTransitionType = undefined;\n        this.AppCache = undefined;\n        this.FolderNav = undefined;\n        this.InitiationTimeOffset = undefined;\n        this.ServerRequestDuration = undefined;\n        this.IISLatency = undefined;\n        this.TTFB = undefined;\n        this.TTLB = undefined;\n        this.ParseTime = undefined;\n        this.RenderTime = undefined;\n        this.Control1Id = null;\n        this.Control1RenderTime = undefined;\n        this.Control2Id = null;\n        this.Control2RenderTime = undefined;\n        this.Control3Id = null;\n        this.Control3RenderTime = undefined;\n        this.Control4Id = null;\n        this.Control4RenderTime = undefined;\n        this.SharePointRequestCountTotal = undefined;\n        this.SharePointRequestCountASPX = undefined;\n        this.SharePointRequestCountJS = undefined;\n        this.SharePointRequestCountCSS = undefined;\n        this.SharePointRequestCountIMG = undefined;\n        this.SharePointRequestCountNoneCached = undefined;\n        this.SharePointRequestBytes = undefined;\n        this.SharePointRequestDownloadTime = undefined;\n        this.CDNRequestCountTotal = undefined;\n        this.CDNRequestCountASPX = undefined;\n        this.CDNRequestCountJS = undefined;\n        this.CDNRequestCountCSS = undefined;\n        this.CDNRequestCountIMG = undefined;\n        this.CDNRequestCountNoneCached = undefined;\n        this.CDNRequestBytes = undefined;\n        this.CDNRequestDownloadTime = undefined;\n        this.ThirdPartyRequestCountTotal = undefined;\n        this.ThirdPartyRequestCountASPX = undefined;\n        this.ThirdPartyRequestCountJS = undefined;\n        this.ThirdPartyRequestCountCSS = undefined;\n        this.ThirdPartyRequestCountIMG = undefined;\n        this.ThirdPartyRequestCountNoneCached = undefined;\n        this.ThirdPartyRequestBytes = undefined;\n        this.ThirdPartyRequestDownloadTime = undefined;\n        this.FromEdge = undefined;\n        this.APICallCount = undefined;\n        this.APICallDurationSum = undefined;\n        this.PreRender = undefined;\n        this.DataFetch = undefined;\n        this.PostRender = undefined;\n        this.W3cNavigationStart = undefined;\n        this.W3cUnloadEventStart = undefined;\n        this.W3cUnloadEventEnd = undefined;\n        this.W3cFetchStart = undefined;\n        this.W3cRedirectStart = undefined;\n        this.W3cRedirectEnd = undefined;\n        this.W3cDomainLookupStart = undefined;\n        this.W3cDomainLookupEnd = undefined;\n        this.W3cConnectStart = undefined;\n        this.W3cSecureConnectStart = undefined;\n        this.W3cConnectEnd = undefined;\n        this.W3cRequestStart = undefined;\n        this.W3cResponseStart = undefined;\n        this.W3cResponseEnd = undefined;\n        this.W3cDomLoading = undefined;\n        this.W3cDomLoadEnd = undefined;\n        this.W3cLoadEventStart = undefined;\n        this.W3cLoadEventEnd = undefined;\n        this.MDSDownloadStart = undefined;\n        this.MDSParseDeltaStart = undefined;\n        this.MDSParseDeltaEnd = undefined;\n        this.MDSGCStart = undefined;\n        this.MDSGCEnd = undefined;\n        this.MDSCSSStart = undefined;\n        this.MDSCSSEnd = undefined;\n        this.MDSInnerHTMLStart = undefined;\n        this.MDSScriptLoaderStart = undefined;\n        this.MDSScriptLoaderEnd = undefined;\n        this.MDSAnimationStart = undefined;\n        this.MDSAnimationEnd = undefined;\n        this.MDSParallelDownloadStart = undefined;\n        this.MDSParallelDownloadEnd = undefined;\n        this.APICalls = undefined;\n        this.SharePointRequestNames = undefined;\n        this.CDNRequestNames = undefined;\n        this.ThirdPartyRequestNames = undefined;\n        this.EUPLBreakdown = undefined;\n        this.Control5Id = null;\n        this.Control5RenderTime = undefined;\n        this.Control6Id = null;\n        this.Control6RenderTime = undefined;\n        this.Control7Id = null;\n        this.Control7RenderTime = undefined;\n        this.Control8Id = null;\n        this.Control8RenderTime = undefined;\n        this.Control9Id = null;\n        this.Control9RenderTime = undefined;\n        this.Control10Id = null;\n        this.Control10RenderTime = undefined;\n        this.ServerMetrics = null;\n        this.Referrer = null;\n        this.BrowserIsMobile = undefined;\n    }\n    return RUMOneSLAPI;\n}());\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.default = RUMOneSLAPI;\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// D:/agent/1/_work/24/s/common/~/npmx-sp-pages/~/@ms/odsp-utilities/lib/logging/rumone/RUMOneSLAPI.js\n// module id = 58\n// module chunks = 0\n\n\n// WEBPACK FOOTER //\n// webpack:///D:/agent/1/_work/24/s/common/~/npmx-sp-pages/~/@ms/odsp-utilities/lib/logging/rumone/RUMOneSLAPI.js","// OneDrive:IgnoreCodeCoverage\n//Intentionally Override the normal camel casing style to title casing style because the schema has to match exactly the server side schema which is Title casing.\n//Please do not change back to camel casing.\n\"use strict\";\nvar RUMOneErrorsSLAPI = (function () {\n    function RUMOneErrorsSLAPI() {\n        this.Reason = null;\n        this.Message = null;\n    }\n    return RUMOneErrorsSLAPI;\n}());\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.default = RUMOneErrorsSLAPI;\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// D:/agent/1/_work/24/s/common/~/npmx-sp-pages/~/@ms/odsp-utilities/lib/logging/rumone/RUMOneErrorsSLAPI.js\n// module id = 59\n// module chunks = 0\n\n\n// WEBPACK FOOTER //\n// webpack:///D:/agent/1/_work/24/s/common/~/npmx-sp-pages/~/@ms/odsp-utilities/lib/logging/rumone/RUMOneErrorsSLAPI.js","// OneDrive:IgnoreCodeCoverage\n\"use strict\";\nvar __extends = (this && this.__extends) || function (d, b) {\n    for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p];\n    function __() { this.constructor = d; }\n    d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n};\nvar SingleEventBase_1 = require('../SingleEventBase');\nvar RUMOneDataUpload = (function (_super) {\n    __extends(RUMOneDataUpload, _super);\n    /**\n     * The RUMOneDataUpload event constructor\n     * @param parent {IEvent} The optional parent for this event\n     */\n    function RUMOneDataUpload(parent) {\n        _super.call(this, 'RUMOneDataUpload,', 'RUMOneDataUpload', parent);\n    }\n    /**\n     * This is true if the RUMOneDataUpload event is enabled\n     */\n    RUMOneDataUpload.enabled = function () {\n        return true;\n    };\n    /**\n     * This will create a single RUMOneDataUpload event\n     * @param data {IRUMOneDataUploadSingleSchema}\n     * -required streamName - SLAPI stream name the data will be logged to, must be either RUMOne or RUMOneErrors\n     * -required dictionary - Data of the RUMOne or RUMOneErrors\n     * @param parent {IEvent} The optional parent for this event\n     */\n    RUMOneDataUpload.logData = function (data, parent) {\n        return SingleEventBase_1.SingleEventBase._logData(RUMOneDataUpload, data, parent);\n    };\n    RUMOneDataUpload.prototype.setSingleData = function (data) {\n        this.data.streamName = this.cleanString(data.streamName);\n        this.data.dictionary = data.dictionary;\n    };\n    /**\n     * The name of the RUMOneDataUpload event\n     */\n    RUMOneDataUpload.fullName = 'RUMOneDataUpload,';\n    /**\n     * The short name of the RUMOneDataUpload event\n     */\n    RUMOneDataUpload.shortName = 'RUMOneDataUpload';\n    /**\n     * This is true if the RUMOneDataUpload event is enabled\n     */\n    RUMOneDataUpload.metadata = {\n        streamName: {\n            type: \"String\",\n            definedInName: \"RUMOneDataUpload\",\n            definedInFullName: \"RUMOneDataUpload,\",\n            isPrefixingDisabled: false,\n            isMetric: false\n        },\n        dictionary: {\n            type: \"Object\",\n            definedInName: \"RUMOneDataUpload\",\n            definedInFullName: \"RUMOneDataUpload,\",\n            isPrefixingDisabled: false,\n            isMetric: false\n        }\n    };\n    return RUMOneDataUpload;\n}(SingleEventBase_1.SingleEventBase));\nexports.RUMOneDataUpload = RUMOneDataUpload;\nRUMOneDataUpload.prototype.metadata = RUMOneDataUpload.metadata;\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.default = RUMOneDataUpload;\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// D:/agent/1/_work/24/s/common/~/npmx-sp-pages/~/@ms/odsp-utilities/lib/logging/events/RUMOneDataUpload.event.js\n// module id = 60\n// module chunks = 0\n\n\n// WEBPACK FOOTER //\n// webpack:///D:/agent/1/_work/24/s/common/~/npmx-sp-pages/~/@ms/odsp-utilities/lib/logging/events/RUMOneDataUpload.event.js","// OneDrive:IgnoreCodeCoverage\n\"use strict\";\n/**\n * Use PlatformDetection to evaluate which user experience makes sense for the user's\n * platform. NOTE: This class is NOT COMPLETE! Meaning not all values are parsed out of\n * the user agent. If something is missing that you need, add it and add unit tests.\n * WARNING: Avoid using browser checks when you can use detection techniques for caps checking.\n */\nvar PlatformDetection = (function () {\n    function PlatformDetection(agent) {\n        // OS checks\n        this.isWindows = false;\n        this.isWinPhone = false;\n        this.isMac = false;\n        this.isIOS = false;\n        this.isAndroid = false;\n        this.isWindows10 = false;\n        this.isWindows81 = false;\n        this.isWindows7 = false;\n        // Check to see if we are definitely on a mobile device.\n        this.isMobile = false;\n        // Browser boolean checks\n        this.isChrome = false;\n        this.isIE = false;\n        this.isIE9 = false;\n        this.isEdge = false;\n        this.isFirefox = false;\n        this.isSafari = false;\n        // Device information\n        this.isIPad = false;\n        this.browserMinor = '0';\n        this.browserMajor = 0;\n        this.areCSS3TransitionsSupported = true;\n        this.isHtml5FileUploadSupported = false;\n        this.isFolderUploadSupported = false;\n        this.isRetinaSupported = false;\n        this.isUnlimitedStyleSheetsSupported = false;\n        this.areTouchEventsSupported = false;\n        this.isWebDavSupported = false;\n        agent = agent || (window && window.navigator && navigator.userAgent) || '';\n        this.userAgent = agent;\n        agent = agent.toLowerCase();\n        // We want to figure out which ONE browser the user is most likely on.\n        // The order of the checks is important so we're not deceived by (for example)\n        // Chrome saying that it's Safari.\n        // (Each regular expression captures the version number so we can parse it later.)\n        var match;\n        if (match = /msie (\\d+)([\\d.]*)/.exec(agent)) {\n            // IE <= 10 has something like \"MSIE 9\" in the user agent.\n            // This is also what newer versions do in compatibility mode.\n            this.isIE = true;\n            if (/msie 9/.exec(agent)) {\n                this.isIE9 = true;\n            }\n        }\n        else if (match = /trident.*rv:(\\d+)([\\d.]*)/.exec(agent)) {\n            // This is IE 11. Sample user agent contains:\n            // Trident/7.0; other stuff... rv:11.0\n            this.isIE = true;\n        }\n        else if (match = /edge\\/(\\d+)([\\d.]*)/.exec(agent)) {\n            // This is Edge (it pretends to be Chrome and Safari).\n            this.isEdge = true;\n        }\n        else if (match = /firefox\\/(\\d+)([\\d.]*)|fxios/.exec(agent)) {\n            this.isFirefox = true;\n        }\n        else if (match = /(?:chrome|crios)\\/(\\d+)([\\d.]*)/.exec(agent)) {\n            // Note: lots of random browsers say they're Chrome and will end up in this bucket\n            this.isChrome = true;\n        }\n        else if (match = /safari\\/(\\d+)/.exec(agent)) {\n            this.isSafari = true;\n            match = /version\\/(\\d+)([\\d.]*)/.exec(agent);\n        }\n        // Some other browser categories:\n        //   IE Mobile: /iemobile\\/(\\d+)/\n        //   IE Mobile in desktop mode: contains WPDesktop; get version from Trident version\n        //   Opera (currently goes into Chrome bucket): /opr\\/(\\d+)/\n        // Parse the captured version number for user's browser.\n        if (match) {\n            this.browserMajor = parseInt(match[1], 10) || 0;\n            var browserMinorVersion = match[2];\n            if (browserMinorVersion) {\n                var minorStart = browserMinorVersion.indexOf('.');\n                if (minorStart >= 0 && minorStart < browserMinorVersion.length - 1) {\n                    this.browserMinor = browserMinorVersion.substr(minorStart + 1);\n                }\n            }\n        }\n        // Parse device which gives hints about os / mobile state.\n        // Windows Phone IE sometimes pretends to be Android, so explicitly check for Windows Phone first.\n        // (wpdesktop is used by Windows Phone in desktop mode.)\n        var deviceMatch = agent.match(/windows phone|wpdesktop/) || agent.match(/ipad|iphone|ipod|android/);\n        if (deviceMatch) {\n            var device = deviceMatch[0];\n            this.isWinPhone = device === 'windows phone' || device === 'wpdesktop';\n            this.isAndroid = device === 'android';\n            this.isIOS = device === 'ipad' || device === 'ipod' || device === 'iphone';\n            this.isIPad = device === 'ipad';\n            this.isMobile = this.isWinPhone || this.isAndroid || this.isIOS;\n        }\n        else {\n            this.isMac = agent.indexOf('macintosh') !== -1;\n            this.isWindows = agent.indexOf('windows nt') !== -1;\n            this.isWindows81 = /(windows 8\\.1|windows nt 6\\.3)/.test(agent) && !this.isWinPhone;\n            this.isWindows10 = agent.indexOf('windows nt 10') !== -1 && !this.isWinPhone;\n            this.isWindows7 = agent.indexOf('windows nt 6.1') !== -1 && !this.isWinPhone;\n        }\n        // Other operating systems:\n        //   Chrome OS: /cros/\n        //   Linux: /linux/ (Android can also say it's Linux, so check for Android first)\n        // WARNING: Avoid using browser checks when you can use detection techniques for caps checking.\n        this.isRetinaSupported = !!(window['devicePixelRatio'] && window.devicePixelRatio > 1);\n        var input = document.createElement(\"input\");\n        input.type = \"file\";\n        this.isFolderUploadSupported = \"webkitdirectory\" in input;\n        this.isHtml5FileUploadSupported = !!(window['File'] && (window['File'].prototype.slice || window['File'].prototype.mozSlice || window['File'].prototype.webkitSlice));\n        this.isUnlimitedStyleSheetsSupported = !this._shouldUseCssText();\n        this.areTouchEventsSupported = 'ontouchstart' in window;\n        this.isWebDavSupported = 'addBehavior' in document.createElement('div');\n        if (this.isIE && this.browserMajor <= 9) {\n            this.areCSS3TransitionsSupported = false;\n        }\n        var osVersionMatch = /[\\s\\(](os|os x|windows phone|windows nt|android) ([\\d._]+)/.exec(agent);\n        this.osVersion = osVersionMatch ? osVersionMatch[2] : \"NA\";\n        // Set browser name\n        if (this.isIE) {\n            this.browserName = \"IE\";\n        }\n        else if (this.isEdge) {\n            this.browserName = \"Edge\";\n        }\n        else if (this.isChrome) {\n            this.browserName = \"Chrome\";\n        }\n        else if (this.isFirefox) {\n            this.browserName = \"Firefox\";\n        }\n        else if (this.isSafari) {\n            this.browserName = \"Safari\";\n        }\n        else {\n            this.browserName = \"NA\";\n        }\n        if (this.isWindows) {\n            this.osName = \"Windows\";\n        }\n        else if (this.isWinPhone) {\n            this.osName = \"Windows Phone\";\n        }\n        else if (this.isMac) {\n            this.osName = \"OSX\";\n        }\n        else if (this.isIOS) {\n            this.osName = \"IOS\";\n        }\n        else if (this.isAndroid) {\n            this.osName = \"Android\";\n        }\n        else {\n            this.osName = \"NA\";\n        }\n    }\n    /**\n     * Checks to see if styleSheet exists as a property off of a style element.\n     * This will determine if style registration should be done via cssText (<= IE9) or not\n     */\n    PlatformDetection.prototype._shouldUseCssText = function () {\n        var emptyStyle = document.createElement(\"style\");\n        emptyStyle.type = \"text/css\";\n        return !!emptyStyle[\"styleSheet\"];\n    };\n    return PlatformDetection;\n}());\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.default = PlatformDetection;\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// D:/agent/1/_work/24/s/common/~/npmx-sp-pages/~/@ms/odsp-utilities/lib/browser/PlatformDetection.js\n// module id = 61\n// module chunks = 0\n\n\n// WEBPACK FOOTER //\n// webpack:///D:/agent/1/_work/24/s/common/~/npmx-sp-pages/~/@ms/odsp-utilities/lib/browser/PlatformDetection.js","// OneDrive:IgnoreCodeCoverage\n\"use strict\";\nvar __extends = (this && this.__extends) || function (d, b) {\n    for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p];\n    function __() { this.constructor = d; }\n    d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n};\nvar ErrorHelper_1 = require(\"../ErrorHelper\");\nvar BeaconBase_1 = require(\"../BeaconBase\");\nvar BeaconCache_1 = require(\"./BeaconCache\");\nvar BaseDataStore_1 = require(\"../../models/store/BaseDataStore\");\nvar DataStoreCachingType_1 = require(\"../../models/store/DataStoreCachingType\");\nvar LogProcessor_1 = require(\"./LogProcessor\");\nvar Beacon;\n(function (Beacon) {\n    \"use strict\";\n    var LOGGING_REQUEST_TIMEOUT = 10000; // 10 seconds\n    var FLUSH_TIMEOUT = 5000; // 5 seconds\n    var BEACON_BATCH_SIZE = 100;\n    var BEACON_MAX_CRITICAL_FLUSH_INTERVAL_SIZE = 5000; // 5 seconds\n    // SLAPI\n    var SLAPI_STREAM_ID = 1234;\n    var SLAPI_JSON_VERSION = \"V1\";\n    var SLAPI_IDX_VERSION = 0;\n    var SLAPI_IDX_EVENTNAME = 1;\n    var SLAPI_IDX_PROPERTY_START = 2;\n    // BSQM Constants\n    var SLAPI_MAX_DATA_SIZE = 64 * 1024;\n    var SLAPI_MAX_ROWS_IN_STREAM = 1000;\n    var SLAPI_SIZE_DWORD = 4;\n    var SLAPI_SIZE_DATAPOINT_ENTRY = 3 * 4;\n    var SLAPI_SIZE_STREAM_ENTRY = 3 * 4;\n    var SLAPI_MS_BTN_EPOCHS = 11644473600000; // Milliseconds between 1/1/1070 and 1/1/1601\n    var SLAPI_MAX_INT32 = 0xFFFFFFFF;\n    var SLAPI_MAX_SQM_DATAID = 0x7FFFFFFF;\n    var SLAPI_DATAKEY_SESSION_NORMAL = 0;\n    var SLAPI_DATAKEY_SESSION_CONTINUATION = 1;\n    var SLAPI_FLAG_BSQM_ENABLED = 0x00000010;\n    // const SLAPI_FLAG_QOS_ENABLED = 0x00000020;\n    // SQM Datapoints\n    var SLAPI_DATAID_BSQM_MAXSTREAMROWSSTREAMID = 8048;\n    var SLAPI_DATAID_BSQM_MAXSTREAMROWS = 7993;\n    var SLAPI_DATAID_SESSION_TYPE = 60;\n    var WSAStreamRow = (function () {\n        function WSAStreamRow(values) {\n            this.Tic = 0;\n            this.Vals = null;\n            var _this = this;\n            _this.Tic = _getTicks32();\n            var numValues = values.length;\n            _this.Vals = new Array(numValues);\n            for (var i = 0; i < numValues; i++) {\n                _this.Vals[i] = values[i];\n            }\n        }\n        return WSAStreamRow;\n    }());\n    var WSADatapoint = (function () {\n        function WSADatapoint(id, value) {\n            var _this = this;\n            _this.Id = id;\n            _this.Val = value;\n            _this.Tic = _getTicks32();\n        }\n        return WSADatapoint;\n    }());\n    var WSAStream = (function () {\n        function WSAStream(id, width) {\n            var _this = this;\n            _this.Id = id;\n            _this.Width = width;\n            _this.Rows = new Array(0);\n        }\n        return WSAStream;\n    }());\n    var WSAData = (function () {\n        function WSAData() {\n            this.StartTime = null;\n            this.EndTime = null;\n            this.Flags = 0;\n            this.wsaDatapoints = null;\n            this.wsaStreams = null;\n            var _this = this;\n            _this.StartTime = _getTicks64();\n            _this.EndTime = null;\n            _this.CorrelationId = null;\n            _this.Flags = SLAPI_FLAG_BSQM_ENABLED;\n            _this.wsaDatapoints = new Array(0);\n            _this.wsaStreams = new Array(0);\n        }\n        return WSAData;\n    }());\n    var _startTicks = 0;\n    var _wsaData = null;\n    var _numDatapoints = 0;\n    var _numStreams = 0;\n    var _numStreamBytes = 0;\n    var _dictStreams = null;\n    var _dictDatapoints = null;\n    var _streamRowCount = 0;\n    var _isDataAvailableForUpload = false;\n    var _isContinuation = false;\n    var _isInitialized = false;\n    var _emptyCorrelationId = '00000000-0000-0000-0000-000000000000';\n    var _eventNamePrefix = \"\";\n    var _store = null;\n    var _storeSize = null;\n    var _instance = null;\n    var _handlers = null;\n    if (DEBUG) {\n        try {\n            console.log(\"Beacon: To disable logging to the console set \\\"window.disableBeaconLogToConsole = true\\\" in the debug window\");\n        }\n        catch (error) {\n        }\n    }\n    var OdbBeacon = (function (_super) {\n        __extends(OdbBeacon, _super);\n        function OdbBeacon(eventNamePrefix, handlers, cacheEnabled, correlationId) {\n            _super.call(this, '/_layouts/15/WsaUpload.ashx', BEACON_BATCH_SIZE, [FLUSH_TIMEOUT], true, /* useSlidingWindow */ BEACON_MAX_CRITICAL_FLUSH_INTERVAL_SIZE, BeaconBase_1.default.DEFAULT_TOTAL_RETRIES, BeaconBase_1.default.DEFAULT_RESET_TOTAL_RETRIES_AFTER, cacheEnabled /* ignorePreviousEvents */);\n            _eventNamePrefix = eventNamePrefix;\n            _handlers = handlers;\n            _store = new BaseDataStore_1.default(LogProcessor_1.default.STORE_KEY, DEBUG ? DataStoreCachingType_1.default.sharedMemory : DataStoreCachingType_1.default.session);\n            _storeSize = _store.getValue(LogProcessor_1.default.STORE_SIZE_KEY);\n            if (!_storeSize) {\n                _storeSize = 0;\n            }\n            if (correlationId) {\n                this._cid = correlationId;\n            }\n        }\n        OdbBeacon.prototype.beacon = function () {\n            if (!DEBUG && location.hostname !== \"localhost\") {\n                var json = _getUploadData();\n                if (json != null && json.length > 0) {\n                    var headers = {};\n                    headers[\"Content-Type\"] = \"application/json\";\n                    this.sendBeacon(json, headers, LOGGING_REQUEST_TIMEOUT);\n                }\n            }\n            else if (!window[\"disableBeaconLogToConsole\"]) {\n                try {\n                    console.log(\"Beacon: Uploaded to COSMOS (To disable logging to the console set \\\"window.disableBeaconLogToConsole = true\\\" in the debug window)\");\n                }\n                catch (error) {\n                }\n            }\n            // Set session storage size to zero instead of clearing\n            _storeSize = 0;\n            _store.setValue(LogProcessor_1.default.STORE_SIZE_KEY, _storeSize);\n        };\n        OdbBeacon.prototype._createBeaconRequest = function (events) {\n            _SetCorrelationId(this._correlationId);\n            // Converts to SP logging format\n            for (var x = 0; x < events.length; x++) {\n                var event = events[x];\n                LogProcessor_1.default.processAndLogEvent({\n                    event: event,\n                    logFunc: function (streamName, dictProperties) {\n                        _WriteLog(streamName, dictProperties);\n                    },\n                    eventNamePrefix: _eventNamePrefix,\n                    handlers: _handlers\n                });\n            }\n            this.beacon();\n        };\n        OdbBeacon.prototype._onNewEvent = function (event) {\n            // BeaconCache puts every new event to the session storage so that Sharepoint can upload it for us\n            // if user navigates away before Beacon event. So we do nothing here.\n        };\n        Object.defineProperty(OdbBeacon.prototype, \"_correlationId\", {\n            get: function () {\n                // Avoid reading from the global variable if correlationId has been passed in.\n                // The _spPageContextInfo may not always exist.\n                if (this._cid) {\n                    return this._cid;\n                }\n                var spPageContextInfo = window['_spPageContextInfo'];\n                if (spPageContextInfo) {\n                    return spPageContextInfo.CorrelationId;\n                }\n                return _emptyCorrelationId;\n            },\n            enumerable: true,\n            configurable: true\n        });\n        return OdbBeacon;\n    }(BeaconBase_1.default));\n    function addToLoggingManager(eventNamePrefix, handlers, correlationId) {\n        if (!_instance) {\n            var cacheEnabled = false;\n            if (BeaconCache_1.default.instance) {\n                eventNamePrefix = BeaconCache_1.default.eventNamePrefix;\n                handlers = BeaconCache_1.default.handlers;\n                cacheEnabled = true;\n            }\n            if (!eventNamePrefix || !handlers) {\n                throw new Error(\"You have to pass in eventNamePrefix and IBeaconHandlers object if no BeaconCache present.\");\n            }\n            _instance = new OdbBeacon(eventNamePrefix, handlers, cacheEnabled, correlationId);\n            // read any events Sharepoint (or BeaconCache) put into session storage but haven't uploaded\n            for (var i = 0; i < _storeSize; i++) {\n                var item = _store.getValue(i.toString());\n                if (!item || !item['name'] || !item['props']) {\n                    continue;\n                }\n                _WriteLog(item['name'], item['props']);\n            }\n        }\n        else {\n            throw new Error(\"The beacon has already been added to the logging manager with event name prefix \" + _eventNamePrefix + \".\");\n        }\n    }\n    Beacon.addToLoggingManager = addToLoggingManager;\n    function _initialize() {\n        if (_isInitialized) {\n            return;\n        }\n        _wsaData = new WSAData();\n        _dictStreams = new Array(0);\n        _dictDatapoints = new Array(0);\n        _createStream(SLAPI_STREAM_ID, 1);\n        _isInitialized = true;\n    }\n    function _createStream(streamId, width) {\n        if (!Boolean(_dictStreams[streamId])) {\n            var wsaStream = new WSAStream(streamId, width);\n            var idxStream = _numStreams;\n            _wsaData.wsaStreams[idxStream] = wsaStream;\n            _numStreams++;\n            _numStreamBytes += SLAPI_SIZE_STREAM_ENTRY;\n            _dictStreams[streamId] = idxStream;\n        }\n    }\n    function _addToStream(streamId, dictValues) {\n        try {\n            var wsaStreamRow = new WSAStreamRow(dictValues);\n            if (_isMaxSizeReachedCheck()) {\n                return;\n            }\n            _isDataAvailableForUpload = true;\n            _setDatapoint(SLAPI_DATAID_BSQM_MAXSTREAMROWSSTREAMID, streamId);\n            var wsaStream = _wsaData.wsaStreams[_dictStreams[streamId]];\n            if (Boolean(wsaStream)) {\n                if (_streamRowCount < SLAPI_MAX_ROWS_IN_STREAM) {\n                    wsaStream.Rows[_streamRowCount++] = wsaStreamRow;\n                    _numStreamBytes += _getTotalBytesForRow(wsaStreamRow);\n                    _setDatapoint(SLAPI_DATAID_BSQM_MAXSTREAMROWS, _streamRowCount); // update row count datapoint\n                }\n                else {\n                    throw (\"Beacon: MAX_ROWS_IN_STREAM exceeded for stream ID \" + String(streamId));\n                }\n            }\n        }\n        catch (e) {\n            ErrorHelper_1.default.log(e);\n        }\n    }\n    function _getTotalBytesForRow(row) {\n        var numTotalBytes = SLAPI_SIZE_DWORD;\n        for (var i = 0; i < row.Vals.length; i++) {\n            var value = String(row.Vals[i]);\n            numTotalBytes += value.length * 2; // A JavaScript char is 16 bit 2 byte\n        }\n        numTotalBytes += (row.Vals.length - 1) * 6; // plus the commas and quotes when serialized\n        return numTotalBytes;\n    }\n    function _setDatapoint(datapointId, datapointValue) {\n        if (datapointId < 1 || datapointId > SLAPI_MAX_SQM_DATAID) {\n            return;\n        }\n        if (datapointValue < 0 || datapointValue > SLAPI_MAX_INT32) {\n            return;\n        }\n        var savedDatapoint = null;\n        var idxDP = _dictDatapoints[datapointId];\n        if (Boolean(idxDP)) {\n            savedDatapoint = _wsaData.wsaDatapoints[idxDP];\n        }\n        if (savedDatapoint == null) {\n            var datapoint = new WSADatapoint(datapointId, datapointValue);\n            var idxDatapoint = _numDatapoints;\n            _wsaData.wsaDatapoints[idxDatapoint] = datapoint;\n            _dictDatapoints[datapointId] = idxDatapoint;\n            _numDatapoints++;\n        }\n        else {\n            savedDatapoint.Val = datapointValue;\n        }\n    }\n    function _uploadData() {\n        if (_wsaData == null) {\n            return \"\";\n        }\n        try {\n            if (_isDataAvailableForUpload) {\n                // Add final datapoints\n                if (Boolean(_isContinuation)) {\n                    _setDatapoint(SLAPI_DATAID_SESSION_TYPE, SLAPI_DATAKEY_SESSION_CONTINUATION);\n                }\n                else {\n                    _setDatapoint(SLAPI_DATAID_SESSION_TYPE, SLAPI_DATAKEY_SESSION_NORMAL);\n                    _isContinuation = true;\n                }\n                _wsaData.EndTime = _getTicks64();\n                var jsonString = null;\n                try {\n                    jsonString = JSON.stringify(_wsaData);\n                }\n                catch (e) {\n                    ErrorHelper_1.default.log(e);\n                }\n                // Initialize the session data for continuation session\n                _initContinuationSession();\n                return jsonString;\n            }\n        }\n        catch (e) {\n            ErrorHelper_1.default.log(e);\n            return \"\";\n        }\n    }\n    function _initContinuationSession() {\n        _dictStreams = new Array(0);\n        _dictDatapoints = new Array(0);\n        _numDatapoints = 0;\n        _numStreams = 0;\n        _streamRowCount = 0;\n        _numStreamBytes = 0;\n        _numDatapoints = 0;\n        var sessID = _wsaData.CorrelationId;\n        _wsaData = new WSAData();\n        _wsaData.CorrelationId = sessID;\n        _createStream(SLAPI_STREAM_ID, 1);\n        _isDataAvailableForUpload = false;\n    }\n    function _isMaxSizeReachedCheck() {\n        var size = _numDatapoints * SLAPI_SIZE_DATAPOINT_ENTRY + _numStreamBytes;\n        if (size >= SLAPI_MAX_DATA_SIZE) {\n            _instance.beacon();\n            size = _numDatapoints * SLAPI_SIZE_DATAPOINT_ENTRY + _numStreamBytes;\n            return size >= SLAPI_MAX_DATA_SIZE;\n        }\n        return false;\n    }\n    function _SetCorrelationId(correlationId) {\n        _initialize();\n        if (Boolean(_wsaData)) {\n            if (correlationId !== null && correlationId !== undefined) {\n                _wsaData.CorrelationId = correlationId;\n            }\n            else {\n                _wsaData.CorrelationId = _emptyCorrelationId;\n            }\n        }\n    }\n    function _WriteLog(eventName, dictProperties) {\n        _initialize();\n        if ((!Boolean(eventName)) || (!Boolean(dictProperties))) {\n            return;\n        }\n        if (!DEBUG) {\n            var values = new Array(SLAPI_IDX_PROPERTY_START + 1);\n            values[SLAPI_IDX_VERSION] = SLAPI_JSON_VERSION;\n            values[SLAPI_IDX_EVENTNAME] = eventName;\n            var index = SLAPI_IDX_PROPERTY_START;\n            for (var key in dictProperties) {\n                var propVal = dictProperties[key];\n                if (propVal !== undefined && propVal !== null) {\n                    if (propVal instanceof Date) {\n                        propVal = propVal.getTime();\n                    }\n                    values[index++] = key;\n                    values[index++] = propVal;\n                }\n            }\n            _addToStream(SLAPI_STREAM_ID, values);\n        }\n        else if (!window[\"disableBeaconLogToConsole\"]) {\n            try {\n                console.log(\"Beacon: Logged to \" + eventName + \" with properties: \" + JSON.stringify(dictProperties));\n            }\n            catch (error) {\n            }\n        }\n    }\n    function _getUploadData() {\n        _initialize();\n        return _uploadData();\n    }\n    function _getTicks32() {\n        var timeNow = new Date();\n        var ticks64 = timeNow.getTime();\n        if (_startTicks === 0) {\n            _startTicks = ticks64;\n        }\n        return ((1 + ticks64 - _startTicks) & 0x7FFFFFFF);\n    }\n    function _getTicks64() {\n        var timeNow = new Date();\n        var ticks64 = timeNow.getTime();\n        ticks64 = ticks64 + SLAPI_MS_BTN_EPOCHS; // Epoch change from 1/1/1070 to 1/1/1601\n        ticks64 = ticks64 * 10000; // 1ms to 100ns resolution\n        return ticks64;\n    }\n})(Beacon || (Beacon = {}));\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.default = Beacon;\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// D:/agent/1/_work/24/s/common/~/npmx-sp-pages/~/@ms/odsp-utilities/lib/logging/odb/Beacon.js\n// module id = 62\n// module chunks = 0\n\n\n// WEBPACK FOOTER //\n// webpack:///D:/agent/1/_work/24/s/common/~/npmx-sp-pages/~/@ms/odsp-utilities/lib/logging/odb/Beacon.js","// OneDrive:IgnoreCodeCoverage\n\"use strict\";\nvar Manager_1 = require(\"../logging/Manager\");\nvar EventBatchCache_1 = require(\"./EventBatchCache\");\nvar XHR_1 = require(\"../xhr/XHR\");\nvar Beacon_event_1 = require(\"./events/Beacon.event\");\nvar BeaconBase = (function () {\n    function BeaconBase(endPointUrl, batchSize, flushTimeouts, useSlidingWindow, maxCriticalFlushInterval, totalRetries, resetTotalRetriesAfter, ignorePreviousEvents) {\n        var _this = this;\n        this._lastSendBeacon = 0;\n        this._endPointUrl = endPointUrl;\n        this._maxCriticalFlushInterval = maxCriticalFlushInterval;\n        this._totalRetries = totalRetries === undefined ? BeaconBase.DEFAULT_TOTAL_RETRIES : totalRetries;\n        this._totalRetriesStartValue = this._totalRetries;\n        this._resetTotalRetriesAfter = resetTotalRetriesAfter === undefined ? BeaconBase.DEFAULT_RESET_TOTAL_RETRIES_AFTER : resetTotalRetriesAfter;\n        this._ignorePreviousEvents = ignorePreviousEvents === undefined ? false : ignorePreviousEvents;\n        this._eventBatchCache = new EventBatchCache_1.default(batchSize, flushTimeouts, function (event) {\n            if (_this._onNewEvent) {\n                _this._onNewEvent(event);\n            }\n        }, function (events) {\n            // Create the beacon request\n            _this._createBeaconRequest(events);\n        }, useSlidingWindow);\n        this.init();\n    }\n    BeaconBase.prototype.sendBeacon = function (json, headers, requestTimeoutInMS) {\n        this._sendBeacon(json, headers, requestTimeoutInMS, 0);\n    };\n    BeaconBase.prototype._sendBeacon = function (json, headers, requestTimeoutInMS, retryCount) {\n        var _this = this;\n        if (retryCount === 0) {\n            this._lastSendBeacon = Manager_1.Manager.getTime();\n        }\n        var xhr = new XHR_1.default({\n            url: this._endPointUrl,\n            json: json,\n            headers: headers,\n            requestTimeoutInMS: requestTimeoutInMS\n        });\n        var beaconEvent = new Beacon_event_1.Beacon({\n            retryCount: retryCount,\n            totalRetries: this._totalRetries\n        });\n        xhr.start(function (xhr, status) {\n            beaconEvent.end({ status: status + '', success: true });\n            if (++_this._successfulLogRequests >= _this._resetTotalRetriesAfter) {\n                _this._successfulLogRequests = _this._resetTotalRetriesAfter;\n                _this._totalRetries = _this._totalRetriesStartValue;\n            }\n        }, function (xhr, status, timeout) {\n            _this._successfulLogRequests = 0;\n            beaconEvent.end({ status: status + '', success: false });\n            // Retry if we timed out since we failed\n            if (status === XHR_1.default.TIMEOUT_STATUS && _this._totalRetries > 0) {\n                _this._totalRetries--;\n                _this._sendBeacon(json, headers, requestTimeoutInMS, retryCount + 1);\n            }\n        });\n    };\n    BeaconBase.prototype.init = function () {\n        var _this = this;\n        var bufferedEvents = Manager_1.Manager.addLogHandler(function (event) {\n            _this.addEvent(event);\n        });\n        if (!this._ignorePreviousEvents) {\n            for (var x = 0; x < bufferedEvents.length; x++) {\n                this.addEvent(bufferedEvents[x]);\n            }\n        }\n    };\n    BeaconBase.prototype.addEvent = function (event) {\n        if (event.enabled) {\n            this._eventBatchCache.addEvent(event);\n            if (event.critical &&\n                (!this._lastSendBeacon ||\n                    Manager_1.Manager.getTime() - this._lastSendBeacon > this._maxCriticalFlushInterval)) {\n                this._eventBatchCache.flush();\n            }\n        }\n    };\n    BeaconBase.DEFAULT_TOTAL_RETRIES = 3;\n    BeaconBase.DEFAULT_RESET_TOTAL_RETRIES_AFTER = 3;\n    return BeaconBase;\n}());\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.default = BeaconBase;\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// D:/agent/1/_work/24/s/common/~/npmx-sp-pages/~/@ms/odsp-utilities/lib/logging/BeaconBase.js\n// module id = 63\n// module chunks = 0\n\n\n// WEBPACK FOOTER //\n// webpack:///D:/agent/1/_work/24/s/common/~/npmx-sp-pages/~/@ms/odsp-utilities/lib/logging/BeaconBase.js","// OneDrive:IgnoreCodeCoverage\n\"use strict\";\nvar Async_1 = require(\"../async/Async\");\nvar Beacon_event_1 = require(\"./events/Beacon.event\");\nvar ErrorHelper_1 = require(\"../logging/ErrorHelper\");\nvar EventBatchCache = (function () {\n    function EventBatchCache(maxSize, maxFlushTimes, newEventHandler, flushHandler, useSlidingWindow) {\n        this._events = [];\n        this._flushCount = 0;\n        this._async = new Async_1.default(this);\n        this._maxSize = maxSize;\n        this._newEventHandler = newEventHandler;\n        this._flushHandler = flushHandler;\n        this._maxFlushTimes = maxFlushTimes;\n        this._useSlidingWindow = useSlidingWindow;\n    }\n    EventBatchCache.prototype.addEvent = function (event) {\n        this._events.push(event);\n        if (this._newEventHandler) {\n            try {\n                this._newEventHandler(event);\n            }\n            catch (e) {\n                ErrorHelper_1.default.log(e);\n            }\n        }\n        // Dont create a timer for events that are of type beacon\n        if (Beacon_event_1.Beacon.isTypeOf(event)) {\n            return;\n        }\n        if (this._events.length >= this._maxSize) {\n            this.flush();\n        }\n        else {\n            this._setFlushTimeout(false);\n        }\n    };\n    EventBatchCache.prototype.flush = function () {\n        this._setFlushTimeout(true);\n    };\n    EventBatchCache.prototype._handleFlush = function () {\n        this._clearFlushTimeout();\n        if (this._events.length) {\n            this._flushHandler(this._events);\n            // Reset the events array\n            this._events = [];\n        }\n    };\n    EventBatchCache.prototype._clearFlushTimeout = function () {\n        if (this._flushTimeoutId) {\n            this._async.clearTimeout(this._flushTimeoutId);\n            this._flushTimeoutId = null;\n        }\n        if (this._immediateflushTimeoutId) {\n            this._async.clearTimeout(this._immediateflushTimeoutId);\n            this._immediateflushTimeoutId = null;\n        }\n    };\n    EventBatchCache.prototype._setFlushTimeout = function (immediate) {\n        var _this = this;\n        // if another immediate flush is already queued, disregard\n        if (!!this._immediateflushTimeoutId) {\n            return;\n        }\n        if (this._useSlidingWindow) {\n            this._clearFlushTimeout();\n            if (immediate) {\n                this._immediateflushTimeoutId = this._async.setTimeout(function () {\n                    _this._handleFlush();\n                }, 0);\n            }\n            else {\n                this._flushTimeoutId = this._async.setTimeout(function () {\n                    _this._handleFlush();\n                }, this._getFlushTime());\n            }\n        }\n        else {\n            if (immediate) {\n                if (!this._immediateflushTimeoutId) {\n                    this._immediateflushTimeoutId = this._async.setTimeout(function () {\n                        _this._handleFlush();\n                    }, 0);\n                }\n            }\n            else if (!this._flushTimeoutId) {\n                this._flushTimeoutId = this._async.setTimeout(function () {\n                    _this._handleFlush();\n                }, this._getFlushTime());\n            }\n        }\n    };\n    EventBatchCache.prototype._getFlushTime = function () {\n        if (this._flushCount < this._maxFlushTimes.length) {\n            var flushCount = this._flushCount;\n            this._flushCount++;\n            return this._maxFlushTimes[flushCount];\n        }\n        else {\n            return this._maxFlushTimes[this._maxFlushTimes.length - 1];\n        }\n    };\n    return EventBatchCache;\n}());\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.default = EventBatchCache;\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// D:/agent/1/_work/24/s/common/~/npmx-sp-pages/~/@ms/odsp-utilities/lib/logging/EventBatchCache.js\n// module id = 64\n// module chunks = 0\n\n\n// WEBPACK FOOTER //\n// webpack:///D:/agent/1/_work/24/s/common/~/npmx-sp-pages/~/@ms/odsp-utilities/lib/logging/EventBatchCache.js","// OneDrive:IgnoreCodeCoverage\n\"use strict\";\nvar __extends = (this && this.__extends) || function (d, b) {\n    for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p];\n    function __() { this.constructor = d; }\n    d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n};\nvar PairedEventBase_1 = require('../PairedEventBase');\nvar Beacon = (function (_super) {\n    __extends(Beacon, _super);\n    /**\n     * The Beacon event constructor\n     * @param data {IBeaconStartSchema}\n     * -optional name - This is the status code returned\n     * -optional status - This is the status code returned\n     * -optional success - This is if the request was successful or not\n     * -required retryCount - This is the retry count for this request\n     * -required totalRetries - This is the number of total retries left\n     * -optional eventCount - This is the number of total events sent\n     * @param parent {IEvent} The optional parent for this event\n     */\n    function Beacon(data, parent) {\n        _super.call(this, 'Beacon,', 'Beacon', data, parent);\n    }\n    /**\n     * This is true if the Beacon event is enabled\n     */\n    Beacon.enabled = function () {\n        return true;\n    };\n    /**\n     * This will end the Beacon event\n     * @param data {IBeaconEndSchema}\n     * -optional name - This is the status code returned\n     * -optional status - This is the status code returned\n     * -required success - This is if the request was successful or not\n     * -optional eventCount - This is the number of total events sent\n     */\n    Beacon.prototype.end = function (data) {\n        return this._end(data);\n    };\n    /**\n     * This writes verbose logs to memory to be uploaded if event ends with failure\n     */\n    Beacon.prototype.verbose = function (message) {\n        return this._verbose(message);\n    };\n    /**\n     * Sets a time limit for the scenario. A timeout result will be logged if no end happens in desired timeframe\n     */\n    Beacon.prototype.setTimeout = function (ms, data) {\n        return this._setTimeout(ms, data);\n    };\n    /**\n     * This is false when Beacon event does not require a parent event\n     */\n    Beacon.prototype.requiresParent = function () {\n        return false;\n    };\n    Beacon.prototype.setStartData = function (data) {\n        if (typeof data.name !== \"undefined\") {\n            this.data.name = this.cleanString(data.name);\n        }\n        if (typeof data.status !== \"undefined\") {\n            this.data.status = this.cleanString(data.status);\n        }\n        if (typeof data.success !== \"undefined\") {\n            this.data.success = data.success;\n        }\n        this.data.retryCount = data.retryCount;\n        this.data.totalRetries = data.totalRetries;\n        if (typeof data.eventCount !== \"undefined\") {\n            this.data.eventCount = data.eventCount;\n        }\n    };\n    Beacon.prototype.setEndData = function (data) {\n        if (typeof data.name !== \"undefined\") {\n            this.data.name = this.cleanString(data.name);\n        }\n        if (typeof data.status !== \"undefined\") {\n            this.data.status = this.cleanString(data.status);\n        }\n        this.data.success = data.success;\n        if (typeof data.eventCount !== \"undefined\") {\n            this.data.eventCount = data.eventCount;\n        }\n    };\n    /**\n     * The name of the Beacon event\n     */\n    Beacon.fullName = 'Beacon,';\n    /**\n     * The short name of the Beacon event\n     */\n    Beacon.shortName = 'Beacon';\n    /**\n     * This is true if the Beacon event is enabled\n     */\n    Beacon.metadata = {\n        name: {\n            type: \"String\",\n            definedInName: \"Beacon\",\n            definedInFullName: \"Beacon,\",\n            isPrefixingDisabled: false,\n            isMetric: false\n        },\n        status: {\n            type: \"String\",\n            definedInName: \"Beacon\",\n            definedInFullName: \"Beacon,\",\n            isPrefixingDisabled: false,\n            isMetric: false\n        },\n        success: {\n            type: \"Boolean\",\n            definedInName: \"Beacon\",\n            definedInFullName: \"Beacon,\",\n            isPrefixingDisabled: false,\n            isMetric: false\n        },\n        retryCount: {\n            type: \"Number\",\n            definedInName: \"Beacon\",\n            definedInFullName: \"Beacon,\",\n            isPrefixingDisabled: false,\n            isMetric: true\n        },\n        totalRetries: {\n            type: \"Number\",\n            definedInName: \"Beacon\",\n            definedInFullName: \"Beacon,\",\n            isPrefixingDisabled: false,\n            isMetric: true\n        },\n        eventCount: {\n            type: \"Number\",\n            definedInName: \"Beacon\",\n            definedInFullName: \"Beacon,\",\n            isPrefixingDisabled: false,\n            isMetric: true\n        }\n    };\n    return Beacon;\n}(PairedEventBase_1.PairedEventBase));\nexports.Beacon = Beacon;\nBeacon.prototype.metadata = Beacon.metadata;\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.default = Beacon;\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// D:/agent/1/_work/24/s/common/~/npmx-sp-pages/~/@ms/odsp-utilities/lib/logging/events/Beacon.event.js\n// module id = 65\n// module chunks = 0\n\n\n// WEBPACK FOOTER //\n// webpack:///D:/agent/1/_work/24/s/common/~/npmx-sp-pages/~/@ms/odsp-utilities/lib/logging/events/Beacon.event.js","\"use strict\";\nvar Async_1 = require('../async/Async');\nvar ErrorHelper_1 = require('../logging/ErrorHelper');\nvar ObjectUtil_1 = require('../object/ObjectUtil');\nvar XHR = (function () {\n    function XHR(options) {\n        this._async = new Async_1.default(this);\n        this._url = options.url;\n        this._requestTimeoutInMS = options.requestTimeoutInMS || XHR.DEFAULT_TIMEOUT_MS;\n        this._json = options.json;\n        this._headers = options.headers || {};\n        this._method = options.method;\n        this._withCredentials = options.withCredentials || false;\n        this._needsCors = options.needsCors;\n    }\n    XHR.prototype.abort = function (isCancelled) {\n        var aborted = this._abortRequest();\n        if (aborted && !isCancelled) {\n            this._callFailureCallback(this._request, XHR.ABORT_STATUS, false);\n        }\n    };\n    XHR.prototype.start = function (successCallback, failureCallback) {\n        var _this = this;\n        try {\n            this._successCallback = successCallback;\n            this._failureCallback = failureCallback;\n            this._request = this._getRequest();\n            this._async.setTimeout(function () {\n                // Check if we havent logged this event already\n                if (!_this._completed) {\n                    _this._timeoutCallback();\n                }\n            }, this._requestTimeoutInMS);\n            // Report Qos on the actual qos calls\n            this._request.onreadystatechange = function () {\n                // Check if we havent logged this event in a timeout\n                if (!_this._completed) {\n                    var DONE = 4; // Default done readystate\n                    try {\n                        DONE = _this._request.DONE || 4;\n                    }\n                    catch (e) {\n                    }\n                    if (_this._request.readyState === DONE) {\n                        _this._requestEndCallback();\n                    }\n                }\n            };\n            if (!this._method) {\n                this._method = this._json ? 'POST' : 'GET';\n            }\n            this._request.open(this._method, this._url, true);\n            if (\"withCredentials\" in this._request) {\n                this._request.withCredentials = this._withCredentials;\n            }\n            // Headers have to be set after open is called\n            for (var x in this._headers) {\n                this._request.setRequestHeader(x, this._headers[x]);\n            }\n            this._request.send(this._json);\n        }\n        catch (e) {\n            ErrorHelper_1.default.logError(e, {\n                origin: location ? location.origin : 'unknown',\n                withCredentials: this._withCredentials,\n                requestUrl: this._url,\n                headers: ObjectUtil_1.default.safeSerialize(this._headers),\n                method: this._method\n            });\n            // abort the request and set the exception status code\n            this._abortRequest();\n            this._callFailureCallback(this._request, XHR.EXCEPTION_STATUS, false);\n        }\n    };\n    XHR.prototype._getRequest = function () {\n        var _this = this;\n        if (!this._needsCors || !window['XDomainRequest']) {\n            return new XMLHttpRequest();\n        }\n        // This is only needed for IE 9 to support CORS requests\n        // Note: we can not set headers on XDomainRequest\n        var request = new XDomainRequest();\n        request.setRequestHeader = function () { };\n        request.onprogress = function () { };\n        request.ontimeout = function () { };\n        request.onload = function () {\n            _this._requestEndCallback();\n        };\n        return request;\n    };\n    XHR.prototype._abortRequest = function () {\n        var actuallyAborted = false;\n        if (!this._completed) {\n            this._completed = true;\n            // Clear the timeout for the request\n            this._async.dispose();\n            // Cancel the request\n            try {\n                if (this._request) {\n                    this._request.abort();\n                }\n            }\n            catch (e) {\n            }\n            actuallyAborted = true;\n        }\n        return actuallyAborted;\n    };\n    XHR.prototype._timeoutCallback = function () {\n        if (!this._completed) {\n            this._abortRequest();\n            this._callFailureCallback(this._request, XHR.TIMEOUT_STATUS, true);\n        }\n    };\n    XHR.prototype._callSuccessCallback = function (xhr, statusCode) {\n        try {\n            if (this._successCallback) {\n                this._successCallback(xhr, statusCode);\n            }\n        }\n        catch (e) {\n            ErrorHelper_1.default.log(e);\n        }\n    };\n    XHR.prototype._callFailureCallback = function (xhr, statusCode, timeout) {\n        try {\n            if (this._failureCallback) {\n                this._failureCallback(xhr, statusCode, timeout);\n            }\n        }\n        catch (e) {\n            ErrorHelper_1.default.log(e);\n        }\n    };\n    XHR.prototype._requestEndCallback = function () {\n        if (!this._completed) {\n            this._completed = true;\n            var status = XHR.EXCEPTION_STATUS;\n            try {\n                // Clear the timeout for the request\n                this._async.dispose();\n                try {\n                    status = this._request.status;\n                }\n                catch (e) {\n                }\n            }\n            catch (e) {\n                status = XHR.EXCEPTION_STATUS;\n                ErrorHelper_1.default.log(e);\n            }\n            if (status < 400 && status > 0) {\n                this._callSuccessCallback(this._request, status);\n            }\n            else {\n                this._callFailureCallback(this._request, status, false);\n            }\n        }\n    };\n    XHR.EXCEPTION_STATUS = -1;\n    XHR.TIMEOUT_STATUS = -2;\n    XHR.ABORT_STATUS = -3;\n    XHR.DEFAULT_TIMEOUT_MS = 30000;\n    return XHR;\n}());\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.default = XHR;\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// D:/agent/1/_work/24/s/common/~/npmx-sp-pages/~/@ms/odsp-utilities/lib/xhr/XHR.js\n// module id = 66\n// module chunks = 0\n\n\n// WEBPACK FOOTER //\n// webpack:///D:/agent/1/_work/24/s/common/~/npmx-sp-pages/~/@ms/odsp-utilities/lib/xhr/XHR.js","// OneDrive:IgnoreCodeCoverage\n\"use strict\";\nvar BaseDataStore_1 = require(\"../../models/store/BaseDataStore\");\nvar DataStoreCachingType_1 = require(\"../../models/store/DataStoreCachingType\");\nvar Manager_1 = require(\"../Manager\");\nvar LogProcessor_1 = require(\"./LogProcessor\");\nvar BeaconCache;\n(function (BeaconCache) {\n    \"use strict\";\n    var _store = new BaseDataStore_1.default(LogProcessor_1.default.STORE_KEY, DEBUG ? DataStoreCachingType_1.default.sharedMemory : DataStoreCachingType_1.default.session);\n    BeaconCache.eventNamePrefix = \"\";\n    BeaconCache.instance = null;\n    BeaconCache.handlers = null;\n    if (DEBUG) {\n        try {\n            console.log(\"Beacon: To disable logging to the console set \\\"window.disableBeaconLogToConsole = true\\\" in the debug window\");\n        }\n        catch (error) {\n        }\n    }\n    var OdbBeaconCache = (function () {\n        function OdbBeaconCache(eventNamePrefix, handlers) {\n            var _this = this;\n            BeaconCache.eventNamePrefix = eventNamePrefix;\n            BeaconCache.handlers = handlers;\n            var bufferedEvents = Manager_1.Manager.addLogHandler(function (event) {\n                _this.addEvent(event);\n            });\n            // Add bufferred events to local store\n            for (var x = 0; x < bufferedEvents.length; x++) {\n                this.addEvent(bufferedEvents[x]);\n            }\n        }\n        OdbBeaconCache.prototype.addEvent = function (event) {\n            if (event.enabled) {\n                // put every new event to the session storage so that Sharepoint can upload it for us\n                // if user navigates away before Beacon event\n                LogProcessor_1.default.processAndLogEvent({\n                    event: event,\n                    logFunc: function (streamName, dictProperties) {\n                        var storeSize = _store.getValue(LogProcessor_1.default.STORE_SIZE_KEY);\n                        if (!storeSize) {\n                            storeSize = 0;\n                        }\n                        _store.setValue(storeSize.toString(), { name: streamName, props: dictProperties });\n                        _store.setValue(LogProcessor_1.default.STORE_SIZE_KEY, ++storeSize);\n                    },\n                    eventNamePrefix: BeaconCache.eventNamePrefix,\n                    handlers: BeaconCache.handlers\n                });\n            }\n        };\n        return OdbBeaconCache;\n    }());\n    function addToLoggingManager(eventNamePrefix, handlers) {\n        if (!BeaconCache.instance) {\n            BeaconCache.instance = new OdbBeaconCache(eventNamePrefix, handlers);\n        }\n        else {\n            throw new Error(\"The beaconCache has already been added to the logging manager with event name prefix \" + eventNamePrefix + \".\");\n        }\n    }\n    BeaconCache.addToLoggingManager = addToLoggingManager;\n})(BeaconCache || (BeaconCache = {}));\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.default = BeaconCache;\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// D:/agent/1/_work/24/s/common/~/npmx-sp-pages/~/@ms/odsp-utilities/lib/logging/odb/BeaconCache.js\n// module id = 67\n// module chunks = 0\n\n\n// WEBPACK FOOTER //\n// webpack:///D:/agent/1/_work/24/s/common/~/npmx-sp-pages/~/@ms/odsp-utilities/lib/logging/odb/BeaconCache.js","\"use strict\";\nvar DataStoreCachingType_1 = require('./DataStoreCachingType');\n// DataStore class is used for transparent caching of data in memory and/or browser storage\n// - Parameter defaultCachingType defines whether you want to use browser storage for all operations\n// and which type of storage - session or local\n// - Parameter dataStoreKey is used to prefix every key in browser storage. Actual key for browser storage\n// will be dataStoreKey + key used in setValue method.\n// - If DataStore is instantiated with some type of browser caching enabled - it will test if browser storage\n// is available and use it. If it's not it will fall back to in-memory cache.\n// - If DataStore is instantiated from two different places with same dataStoreKey and some type of\n// browser storage caching, the memory storage will be shared as well as browser storage.\nvar DataStore = (function () {\n    function DataStore(dataStoreKey, defaultCachingType) {\n        if (defaultCachingType === void 0) { defaultCachingType = DataStoreCachingType_1.default.none; }\n        DataStore.init();\n        this.dataStoreKey = dataStoreKey;\n        this.defaultCachingType = defaultCachingType;\n        if (defaultCachingType === DataStoreCachingType_1.default.none) {\n            this.dataStore = {};\n        }\n        else {\n            var store = DataStore._dataStore[this.dataStoreKey];\n            if (store === undefined) {\n                DataStore._dataStore[this.dataStoreKey] = {};\n            }\n            this.dataStore = DataStore._dataStore[this.dataStoreKey];\n        }\n    }\n    DataStore.hasStorageType = function (storageType) {\n        DataStore.init();\n        switch (storageType) {\n            case DataStoreCachingType_1.default.none: return true;\n            case DataStoreCachingType_1.default.sharedMemory: return true;\n            case DataStoreCachingType_1.default.session: return !!DataStore._sessionStorage;\n            case DataStoreCachingType_1.default.local: return !!DataStore._localStorage;\n        }\n        return false;\n    };\n    DataStore.init = function () {\n        if (DataStore._initialized) {\n            return;\n        }\n        // Need a try/catch since window.localStorage can throw.\n        try {\n            if ('localStorage' in window && window.localStorage && DataStore.testStorage(window.localStorage)) {\n                DataStore._localStorage = window.localStorage;\n            }\n        }\n        catch (exUsingLocalStorage) {\n        }\n        try {\n            if ('sessionStorage' in window && window.sessionStorage && DataStore.testStorage(window.sessionStorage)) {\n                DataStore._sessionStorage = window.sessionStorage;\n            }\n        }\n        catch (exUsingSessionStorage) {\n        }\n        // Fallback logic\n        if (DataStore._localStorage == null) {\n            DataStore._localStorage = DataStore._sessionStorage;\n        }\n        DataStore._initialized = true;\n    };\n    /** Need to check whether the value in localStorage is of the correct type.\n     * In Private Browsing in Safari, for example, localStorage is accessible,\n     * but all of the non-built-in properties return undefined, and setting\n     * such a property causes an exception.\n     */\n    DataStore.testStorage = function (storage) {\n        var _testKey = \"BrowserStorageTest\";\n        var _testValue = \"1\";\n        var result = false;\n        try {\n            storage.setItem(_testKey, _testValue);\n            if (storage.getItem(_testKey) === _testValue) {\n                result = true;\n            }\n            storage.removeItem(_testKey);\n        }\n        catch (e) { }\n        return result;\n    };\n    DataStore.prototype.setValue = function (key, value, cachingTypeOverride, normalizeKey) {\n        if (normalizeKey === void 0) { normalizeKey = true; }\n        key = normalizeKey ? this.normalizeKey(key) : key;\n        this.dataStore[key] = value;\n        var storage = this.getStorage(cachingTypeOverride);\n        if (storage) {\n            try {\n                var objectsFound = [];\n                var s = JSON.stringify(value, function (key, value) {\n                    if (typeof value === 'object' && value !== null) {\n                        if (objectsFound.indexOf(value) !== -1) {\n                            // discard the key if circular dependency was found\n                            return;\n                        }\n                        // Otherwise store value in the cache\n                        objectsFound.push(value);\n                    }\n                    return value;\n                });\n                // empty cache\n                objectsFound = null;\n                storage.setItem(this.dataStoreKey + key, s);\n            }\n            catch (e) {\n            }\n        }\n    };\n    DataStore.prototype.getValue = function (key, cachingTypeOverride, normalizeKey) {\n        if (normalizeKey === void 0) { normalizeKey = true; }\n        key = normalizeKey ? this.normalizeKey(key) : key;\n        var value = this.dataStore[key];\n        var storage = this.getStorage(cachingTypeOverride);\n        if (value === undefined && storage) {\n            var s = storage.getItem(this.dataStoreKey + key);\n            if (s) {\n                try {\n                    value = JSON.parse(s);\n                    this.dataStore[key] = value;\n                }\n                catch (e) {\n                    value = undefined;\n                }\n            }\n        }\n        return value;\n    };\n    DataStore.prototype.remove = function (key, cachingTypeOverride, normalizeKey) {\n        if (normalizeKey === void 0) { normalizeKey = true; }\n        key = normalizeKey ? this.normalizeKey(key) : key;\n        var storage = this.getStorage(cachingTypeOverride);\n        if (storage) {\n            storage.removeItem(this.dataStoreKey + key);\n        }\n        delete this.dataStore[key];\n    };\n    DataStore.prototype.getStorage = function (cachingTypeOverride) {\n        var cachingType = cachingTypeOverride ? cachingTypeOverride : this.defaultCachingType;\n        switch (cachingType) {\n            case DataStoreCachingType_1.default.none:\n                return null;\n            case DataStoreCachingType_1.default.sharedMemory:\n                return null;\n            case DataStoreCachingType_1.default.session:\n                return DataStore._sessionStorage;\n            case DataStoreCachingType_1.default.local:\n                return DataStore._localStorage;\n        }\n        return null;\n    };\n    DataStore.prototype.normalizeKey = function (key) {\n        return key && key.toLowerCase() || '';\n    };\n    DataStore._sessionStorage = null;\n    DataStore._localStorage = null;\n    DataStore._dataStore = {};\n    DataStore._initialized = false;\n    return DataStore;\n}());\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.default = DataStore;\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// D:/agent/1/_work/24/s/common/~/npmx-sp-pages/~/@ms/odsp-utilities/lib/models/store/BaseDataStore.js\n// module id = 68\n// module chunks = 0\n\n\n// WEBPACK FOOTER //\n// webpack:///D:/agent/1/_work/24/s/common/~/npmx-sp-pages/~/@ms/odsp-utilities/lib/models/store/BaseDataStore.js","\"use strict\";\nvar DataStoreCachingType;\n(function (DataStoreCachingType) {\n    DataStoreCachingType[DataStoreCachingType[\"none\"] = 0] = \"none\";\n    DataStoreCachingType[DataStoreCachingType[\"session\"] = 1] = \"session\";\n    DataStoreCachingType[DataStoreCachingType[\"local\"] = 2] = \"local\";\n    DataStoreCachingType[DataStoreCachingType[\"sharedMemory\"] = 3] = \"sharedMemory\";\n})(DataStoreCachingType || (DataStoreCachingType = {}));\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.default = DataStoreCachingType;\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// D:/agent/1/_work/24/s/common/~/npmx-sp-pages/~/@ms/odsp-utilities/lib/models/store/DataStoreCachingType.js\n// module id = 69\n// module chunks = 0\n\n\n// WEBPACK FOOTER //\n// webpack:///D:/agent/1/_work/24/s/common/~/npmx-sp-pages/~/@ms/odsp-utilities/lib/models/store/DataStoreCachingType.js","// OneDrive:IgnoreCodeCoverage\n\"use strict\";\nvar Qos_event_1 = require(\"../events/Qos.event\");\nvar PLT_event_1 = require(\"../events/PLT.event\");\nvar Beacon_event_1 = require(\"../events/Beacon.event\");\nvar UnhandledError_event_1 = require(\"../events/UnhandledError.event\");\nvar RequireJSError_event_1 = require(\"../events/RequireJSError.event\");\nvar CaughtError_event_1 = require(\"../events/CaughtError.event\");\nvar QosError_event_1 = require(\"../events/QosError.event\");\nvar Verbose_event_1 = require(\"../events/Verbose.event\");\nvar Engagement_event_1 = require(\"../events/Engagement.event\");\nvar EventBase_1 = require(\"../EventBase\");\nvar RUMOneDataUpload_event_1 = require(\"../events/RUMOneDataUpload.event\");\nvar DebugPriorityLevel_1 = require(\"./DebugPriorityLevel\");\nvar LogProcessor;\n(function (LogProcessor) {\n    \"use strict\";\n    LogProcessor.STORE_KEY = \"SPCacheLogger\";\n    LogProcessor.STORE_SIZE_KEY = \"Size\";\n    var SOURCE_V2_Engagement = \"ClientV2Engagement\";\n    var DEBUG_LOG_STREAM = \"ReliabilityLog\";\n    var USER_ENGAGEMENT_STREAM = \"UserEngagement\";\n    var SOURCE_V2_Reliability = \"ClientV2Reliability\";\n    // regex for SLAPI event names\n    var SLAPI_EVENT_NAME_ALLOW = /[^a-z0-9\\.\\_\\-\\+]+/ig;\n    var _spModuleLink = window['_spModuleLink'];\n    var _appVersion = _spModuleLink ? _spModuleLink.buildNumber : \"\";\n    function processAndLogEvent(params) {\n        // Ignored events\n        if (params.handlers.ignoredEventsHandler && params.handlers.ignoredEventsHandler(params.event)) {\n            return;\n        }\n        // Get the data to log\n        var logDataArray = Engagement_event_1.Engagement.isTypeOf(params.event) ? _processEngagementEvent(params.event) :\n            Qos_event_1.Qos.isTypeOf(params.event) ? _processQosEvent(params.event, params.handlers.qosEventNameHandler || null, params.handlers.qosEventExtraDataHandler || null) :\n                PLT_event_1.PLT.isTypeOf(params.event) ? _processPLTEvent(params.event) :\n                    UnhandledError_event_1.UnhandledError.isTypeOf(params.event) ? _processUnhandledErrorEvent(params.event) :\n                        RequireJSError_event_1.RequireJSError.isTypeOf(params.event) ? _processRequireJSErrorEvent(params.event) :\n                            CaughtError_event_1.CaughtError.isTypeOf(params.event) ? _processCaughtErrorEvent(params.event) :\n                                Verbose_event_1.Verbose.isTypeOf(params.event) ? _processVerboseEvent(params.event) :\n                                    Beacon_event_1.Beacon.isTypeOf(params.event) ? _processBeaconEvent(params.event) :\n                                        RUMOneDataUpload_event_1.RUMOneDataUpload.isTypeOf(params.event) ? _processRUMOneDataUploadEvent(params.event) :\n                                            null;\n        // If the log data array is not defined the event was unhandled, log\n        // the event name so is easy to discover and fix\n        if (!logDataArray) {\n            logDataArray = [{\n                    userEngagementData: {\n                        EngagementName: \"UnknownEvent\",\n                        Duration: 0,\n                        LogType: 0,\n                        Properties: JSON.stringify({ name: params.event.eventName }),\n                        ClientTime: params.event.eventType === EventBase_1.ClonedEventType.End ? params.event.endTime : params.event.startTime,\n                        Source: SOURCE_V2_Engagement\n                    }\n                }];\n        }\n        // Log all the data in the array adding the event prefix to the tag/name\n        for (var index = 0, length = logDataArray.length; index < length; index++) {\n            var logData = logDataArray[index];\n            if (logData.debugData) {\n                logData.debugData.Tag = _addEventPrefix(logData.debugData.Tag, params.eventNamePrefix).replace(SLAPI_EVENT_NAME_ALLOW, \"\");\n                params.logFunc(DEBUG_LOG_STREAM, logData.debugData);\n            }\n            if (logData.userEngagementData) {\n                // SPList: special case for Engagement events\n                // set prefix to the name of the list type\n                // to be able to track usage/engagement by list type\n                var prefix = params.eventNamePrefix;\n                if (Engagement_event_1.Engagement.isTypeOf(params.event) && prefix === 'SPList') {\n                    // prefix will be set to a list type based on list base template\n                    // if list type not found, [refix will be set back to generic SPList\n                    prefix = _getScenarioNameFromListType();\n                }\n                logData.userEngagementData.EngagementName = _addEventPrefix(logData.userEngagementData.EngagementName, prefix).replace(SLAPI_EVENT_NAME_ALLOW, \"\");\n                // SPList: special case for Qos events; add listBaseTemplate ID to the property bag\n                if (Qos_event_1.Qos.isTypeOf(params.event) && params.eventNamePrefix === 'SPList') {\n                    params.event.data.extraData[\"ListBaseTemplate\"] = _getListBaseTemplate();\n                }\n                params.logFunc(USER_ENGAGEMENT_STREAM, logData.userEngagementData);\n            }\n            if (logData.rumOneData) {\n                params.logFunc(logData.rumOneData.streamName, logData.rumOneData.dictionary);\n            }\n        }\n    }\n    LogProcessor.processAndLogEvent = processAndLogEvent;\n    // get the list base template id\n    function _getListBaseTemplate() {\n        var listTemplate = -1;\n        var spPageContextInfo = window['_spPageContextInfo'];\n        if (spPageContextInfo !== undefined && spPageContextInfo !== null) {\n            listTemplate = spPageContextInfo.listBaseTemplate;\n        }\n        return listTemplate;\n    }\n    // get the name of the listType; it's SPList for the unrecognized\n    // list templates; TODO: add all templates\n    function _getScenarioNameFromListType() {\n        var scenarioName = \"\";\n        var listTemplate = _getListBaseTemplate();\n        switch (listTemplate) {\n            case 100:\n                scenarioName = \"ListNext\";\n                break;\n            case 101:\n                scenarioName = \"DocsNext\";\n                break;\n            case 102:\n                scenarioName = \"SurveyNext\";\n                break;\n            case 103:\n                scenarioName = \"LinksNext\";\n                break;\n            case 104:\n                scenarioName = \"AnnouncementsNext\";\n                break;\n            case 107:\n                scenarioName = \"TasksNext\";\n                break;\n            case 109:\n                scenarioName = \"PicLibNext\";\n                break;\n            default:\n                scenarioName = \"SPList\";\n                break;\n        }\n        return scenarioName;\n    }\n    // string examples: \"{\\\"w3cResponseEnd\\\":2\", \"\\\"appStart\\\":750\"\n    function _cleanString(dataPLT) {\n        var cleanString = dataPLT;\n        cleanString = cleanString.replace(\"{\", \"\");\n        cleanString = cleanString.replace(/\\\"/gi, \"\");\n        cleanString = cleanString.replace(\"}\", \"\");\n        return cleanString;\n    }\n    function _addEventPrefix(eventName, prefix) {\n        if (!prefix) {\n            return eventName;\n        }\n        return prefix + '.' + eventName;\n    }\n    function _getResultTypeSuffix(resultType) {\n        if (resultType === Qos_event_1.ResultTypeEnum.Success) {\n            return \".Success\";\n        }\n        else if (resultType === Qos_event_1.ResultTypeEnum.Failure) {\n            return \".Failure\";\n        }\n        else if (resultType === Qos_event_1.ResultTypeEnum.ExpectedFailure) {\n            return \".ExpectedFailure\";\n        }\n        return \"\";\n    }\n    function _processRUMOneDataUploadEvent(event) {\n        if (!event.data) {\n            return [{\n                    userEngagementData: {\n                        EngagementName: \"RUMOne.no_EventData\",\n                        Duration: 0,\n                        LogType: 0,\n                        ClientTime: event.startTime,\n                        Source: SOURCE_V2_Engagement\n                    }\n                }];\n        }\n        var rumOneDataUpdateEventData = event.data;\n        return [{\n                rumOneData: {\n                    streamName: rumOneDataUpdateEventData.streamName,\n                    dictionary: rumOneDataUpdateEventData.dictionary\n                }\n            }];\n    }\n    function _processEngagementEvent(event) {\n        var logDataList = [];\n        // if the event has not data we will get this in COSMOS\n        // if it's a start we have only the name and append \".Start\" to it\n        // else we look for resultCode and append it to data.name with result type\n        // if resultCode is not present than we append only the result type to the name\n        // i.e. serverDataGetValue.Start OR serverDataGetValue.ResponseText.GetAuth.ExpectedFailure\n        var name = \"no_EngagementName\";\n        var properties = \"\";\n        if (event.data) {\n            var engagementData = event.data;\n            if (engagementData.name) {\n                name = engagementData.name;\n            }\n            // if there is an experimentData object, it means there is an experiment so create and log a new tag for it\n            // put all the experiment data in the properties bag;\n            if (engagementData.experiment) {\n                var abExperiment = engagementData.experiment;\n                var experimentData = abExperiment.GetExperimentData();\n                logDataList.push({ userEngagementData: {\n                        EngagementName: _getExperimentEventName(experimentData, abExperiment.IsExperimentOn()),\n                        Properties: JSON.stringify(experimentData),\n                        Duration: 0,\n                        LogType: 0,\n                        ClientTime: event.startTime,\n                        Source: SOURCE_V2_Engagement\n                    } });\n            }\n            // put the extraData in the properties bag\n            properties = engagementData.extraData ? JSON.stringify(engagementData.extraData) : \"\";\n        }\n        logDataList.push({ userEngagementData: {\n                EngagementName: name,\n                Properties: properties,\n                Duration: 0,\n                LogType: 0,\n                ClientTime: event.startTime,\n                Source: SOURCE_V2_Engagement\n            } });\n        return logDataList;\n    }\n    function _getExperimentEventName(experimentData, isOn) {\n        var name = (experimentData.name ? experimentData.name : 'noExperimentData') +\n            '.Experiment' +\n            (isOn ? 'ON' : 'OFF');\n        return name;\n    }\n    function _processQosEvent(event, qoSEventNameHandler, qosEventExtraDataHandler) {\n        var logData = {};\n        // if the event has not data we will get this in COSMOS\n        // if it's a start we have only the name and append \".Start\" to it\n        // else we look for resultCode and append it to data.name with result type\n        // if resultCode is not present than we append only the result type to the name\n        // i.e. serverDataGetValue.ResponseText.Success OR serverDataGetValue.ResponseText.GetAuth.ExpectedFailure\n        var name = \"no_QosName\";\n        var qosData = event.data ? event.data : null;\n        if (qosData) {\n            if (qosData.name) {\n                name = qosData.name;\n            }\n            if (qoSEventNameHandler != null) {\n                name = qoSEventNameHandler(event, name);\n            }\n            qosData.extraData = qosData.extraData || {};\n            if (qosEventExtraDataHandler != null) {\n                qosEventExtraDataHandler(event, qosData);\n            }\n            qosData.extraData[\"appver\"] = _appVersion;\n        }\n        // Duration is calculated only when we have an END event\n        var durationTime;\n        if (event.eventType === EventBase_1.ClonedEventType.End && event.startTime && event.endTime) {\n            durationTime = event.endTime - event.startTime;\n        }\n        else {\n            durationTime = 0;\n        }\n        logData.userEngagementData = {\n            EngagementName: name,\n            Properties: qosData && qosData.extraData ? JSON.stringify(qosData.extraData) : \"\",\n            Duration: durationTime,\n            LogType: 0,\n            ClientTime: event.eventType === EventBase_1.ClonedEventType.End ? event.endTime : event.startTime,\n            Source: SOURCE_V2_Reliability\n        };\n        return [logData];\n    }\n    function _processBeaconEvent(event) {\n        var logData = {};\n        var durationTime;\n        if (event.eventType === EventBase_1.ClonedEventType.End && event.startTime && event.endTime) {\n            durationTime = event.endTime - event.startTime;\n        }\n        else {\n            durationTime = 0;\n        }\n        logData.userEngagementData = {\n            EngagementName: \"Beacon\",\n            Properties: event.data ? JSON.stringify(event.data) : \"no_EventData\",\n            Duration: durationTime,\n            LogType: 0,\n            ClientTime: event.eventType === EventBase_1.ClonedEventType.End ? event.endTime : event.startTime,\n            Source: SOURCE_V2_Reliability\n        };\n        return [logData];\n    }\n    function _processPLTEvent(event) {\n        if (!event.data) {\n            return [{\n                    userEngagementData: {\n                        EngagementName: \"PLT.no_EventData\",\n                        Duration: 0,\n                        LogType: 0,\n                        ClientTime: event.startTime,\n                        Source: SOURCE_V2_Engagement\n                    }\n                }];\n        }\n        var logDataList = [];\n        //get the data for this event\n        var pltData = event.data;\n        // this will be the prefix for the tags; i.e. PLT.SetView-Files.w3cResponseEnd\n        var name = \"PLT.\" + pltData.name.replace(\" \", \"\");\n        // break down the PLT data and log each one as a separate record in the stream\n        //{\"name\":\"SetView-Files\",\"w3cResponseEnd\":424,\"appStart\":254,\"preRender\":20,\"dataFetch\":310,\"postRender\":327,\"render\":347,\"plt\":1335}\n        var dataPLT = JSON.stringify(pltData).split(',');\n        var duration = 0;\n        // iterate through data and extract each type\n        // create tags like this: PLT.<pagename>.w3cResponseEnd; PLT.<pagename>.appStart\n        for (var i = 0; i < dataPLT.length; i++) {\n            var cleanedPLTString = _cleanString(dataPLT[i]);\n            // split the string and get the name and duration\n            // special case for duration when appCacheHit is a boolean\n            var subDataPLTs = cleanedPLTString.split(':');\n            // skip the 'name' key-value pair\n            if (_cleanString(subDataPLTs[1]) !== pltData.name) {\n                if (subDataPLTs[1] === 'true') {\n                    duration = 1;\n                }\n                else if (subDataPLTs[1] === 'false' || subDataPLTs[1] === 'null') {\n                    duration = 0;\n                }\n                else {\n                    duration = parseInt(subDataPLTs[1], 10);\n                }\n                logDataList.push({ userEngagementData: {\n                        EngagementName: name + \".\" + subDataPLTs[0],\n                        Properties: (subDataPLTs[0] === 'appCacheHit') ? JSON.stringify(event.data) : \"\",\n                        Duration: duration,\n                        LogType: 0,\n                        ClientTime: event.startTime,\n                        Source: SOURCE_V2_Engagement\n                    } });\n            }\n        }\n        return logDataList;\n    }\n    function _processUnhandledErrorEvent(event) {\n        return [{\n                userEngagementData: {\n                    EngagementName: \"UnhandledError\",\n                    Duration: 0,\n                    LogType: 0,\n                    ClientTime: event.startTime,\n                    Source: SOURCE_V2_Engagement\n                },\n                debugData: {\n                    Tag: \"UnhandledError\",\n                    Level: DebugPriorityLevel_1.default.Normal,\n                    Message: event.data ? JSON.stringify(event.data) : \"no_EventData\",\n                    Misc: \"\",\n                    ClientTime: event.startTime\n                }\n            }];\n    }\n    function _processRequireJSErrorEvent(event) {\n        var logData = {};\n        var name = \"RequireJSError\";\n        var errorData;\n        var errorMessage;\n        if (event.data) {\n            // clone all properties so that we can omit 'message' in JSON\n            errorData = {};\n            for (var key in event.data) {\n                if (key !== \"message\") {\n                    errorData[key] = event.data[key];\n                }\n                else {\n                    errorMessage = event.data[key];\n                }\n            }\n        }\n        logData.userEngagementData = {\n            EngagementName: name,\n            Duration: 0,\n            LogType: 0,\n            ClientTime: event.startTime,\n            Source: SOURCE_V2_Engagement\n        };\n        logData.debugData = {\n            Tag: name,\n            Level: DebugPriorityLevel_1.default.Normal,\n            Message: errorMessage ? errorMessage : \"no_ErrorMessage\",\n            Misc: errorData ? JSON.stringify(errorData) : \"no_ErrorData\",\n            ClientTime: event.startTime\n        };\n        return [logData];\n    }\n    function _processCaughtErrorEvent(event) {\n        var logData = {};\n        var name = \"CaughtError\";\n        if (QosError_event_1.QosError.isTypeOf(event)) {\n            if (event.data) {\n                var qosErrorData = event.data;\n                name = qosErrorData.name;\n                if (qosErrorData.resultCode) {\n                    name += \".\" + qosErrorData.resultCode;\n                }\n                name += _getResultTypeSuffix(qosErrorData.resultType);\n            }\n            else {\n                name = \"QosErrorEvent.no_EventData\";\n            }\n        }\n        else {\n            // log it once in the UserEngagement stream to count the hits\n            logData.userEngagementData = {\n                EngagementName: name,\n                Duration: 0,\n                LogType: 0,\n                ClientTime: event.startTime,\n                Source: SOURCE_V2_Engagement\n            };\n        }\n        // log it again in ReliabilityLog stream with data for debugging\n        var caughtErrorData = event.data ? event.data : null;\n        logData.debugData = {\n            Tag: name,\n            Level: DebugPriorityLevel_1.default.Normal,\n            Message: caughtErrorData && caughtErrorData.message ? caughtErrorData.message : \"\",\n            Misc: caughtErrorData && caughtErrorData.stack ? JSON.stringify(caughtErrorData.stack) : \"\",\n            ClientTime: event.startTime\n        };\n        return [logData];\n    }\n    function _processVerboseEvent(event) {\n        var logData = {};\n        var name = \"Verbose\";\n        if (event.data) {\n            var verboseData = event.data;\n            if (verboseData.name) {\n                name = verboseData.name + \".Verbose\";\n            }\n        }\n        else {\n            name += \".no_EventData\";\n        }\n        // log it in ReliabilityLog stream with data for debugging\n        logData.debugData = {\n            Tag: name,\n            Level: DebugPriorityLevel_1.default.Low,\n            Message: verboseData.message,\n            Misc: \"\",\n            ClientTime: event.startTime\n        };\n        return [logData];\n    }\n})(LogProcessor || (LogProcessor = {}));\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.default = LogProcessor;\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// D:/agent/1/_work/24/s/common/~/npmx-sp-pages/~/@ms/odsp-utilities/lib/logging/odb/LogProcessor.js\n// module id = 70\n// module chunks = 0\n\n\n// WEBPACK FOOTER //\n// webpack:///D:/agent/1/_work/24/s/common/~/npmx-sp-pages/~/@ms/odsp-utilities/lib/logging/odb/LogProcessor.js","// OneDrive:IgnoreCodeCoverage\n\"use strict\";\nvar __extends = (this && this.__extends) || function (d, b) {\n    for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p];\n    function __() { this.constructor = d; }\n    d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n};\nvar SingleEventBase_1 = require('../SingleEventBase');\nvar Features_1 = require('../../features/Features');\nvar PLT = (function (_super) {\n    __extends(PLT, _super);\n    /**\n     * The PLT event constructor\n     * @param parent {IEvent} The optional parent for this event\n     */\n    function PLT(parent) {\n        _super.call(this, 'PLT,', 'PLT', parent);\n    }\n    /**\n     * This is true if the PLT event is enabled\n     */\n    PLT.enabled = function () {\n        return Features_1.default.isFeatureEnabled(PLT.samplingFeature);\n    };\n    /**\n     * This will create a single PLT event\n     * @param data {IPLTSingleSchema}\n     * -required name - The name of the PLT event\n     * -required w3cResponseEnd - Time to get the aspx from the server\n     * -required prefetchStart - Time it takes for our app to *start* prefetching\n     * -required deferredListDataRender - Time it takes for defered list data render from server\n     * -required appStart - Time it takes for our app to *start* running\n     * -required preRender - Time it takes for our app to make the relevant data fetch for this view\n     * -required dataFetch - Time it takes for our app to get data back from the server\n     * -required dataFetchServerTime - time the datafetch request spent on the server\n     * -required postRender - Time it takes from appDataFetchEnd to PLT\n     * -required render - Post render plus pre render\n     * -required plt - Time from fetchStart to plt\n     * -required pltWithUnload - Time from navigationStart to plt\n     * -required httpRequests - The count of http request till plt\n     * -required appCacheHit - Whether this page load is served from appCache\n     * @param parent {IEvent} The optional parent for this event\n     */\n    PLT.logData = function (data, parent) {\n        return SingleEventBase_1.SingleEventBase._logData(PLT, data, parent);\n    };\n    /**\n     * This is true when PLT event is enabled\n     */\n    PLT.prototype.isEnabled = function () {\n        return Features_1.default.isFeatureEnabled(PLT.samplingFeature);\n    };\n    PLT.prototype.setSingleData = function (data) {\n        this.data.name = this.cleanString(data.name);\n        this.data.w3cResponseEnd = data.w3cResponseEnd;\n        this.data.prefetchStart = data.prefetchStart;\n        this.data.deferredListDataRender = data.deferredListDataRender;\n        this.data.appStart = data.appStart;\n        this.data.preRender = data.preRender;\n        this.data.dataFetch = data.dataFetch;\n        this.data.dataFetchServerTime = data.dataFetchServerTime;\n        this.data.postRender = data.postRender;\n        this.data.render = data.render;\n        this.data.plt = data.plt;\n        this.data.pltWithUnload = data.pltWithUnload;\n        this.data.httpRequests = data.httpRequests;\n        this.data.appCacheHit = data.appCacheHit;\n    };\n    /**\n     * The name of the PLT event\n     */\n    PLT.fullName = 'PLT,';\n    /**\n     * The short name of the PLT event\n     */\n    PLT.shortName = 'PLT';\n    /**\n     * This is true if the PLT event is enabled\n     */\n    PLT.metadata = {\n        name: {\n            type: \"String\",\n            definedInName: \"PLT\",\n            definedInFullName: \"PLT,\",\n            isKey: true,\n            isPrefixingDisabled: false,\n            isMetric: false\n        },\n        w3cResponseEnd: {\n            type: \"Number\",\n            definedInName: \"PLT\",\n            definedInFullName: \"PLT,\",\n            isPrefixingDisabled: false,\n            isMetric: true\n        },\n        prefetchStart: {\n            type: \"Number\",\n            definedInName: \"PLT\",\n            definedInFullName: \"PLT,\",\n            isPrefixingDisabled: false,\n            isMetric: true\n        },\n        deferredListDataRender: {\n            type: \"Number\",\n            definedInName: \"PLT\",\n            definedInFullName: \"PLT,\",\n            isPrefixingDisabled: false,\n            isMetric: true\n        },\n        appStart: {\n            type: \"Number\",\n            definedInName: \"PLT\",\n            definedInFullName: \"PLT,\",\n            isPrefixingDisabled: false,\n            isMetric: true\n        },\n        preRender: {\n            type: \"Number\",\n            definedInName: \"PLT\",\n            definedInFullName: \"PLT,\",\n            isPrefixingDisabled: false,\n            isMetric: true\n        },\n        dataFetch: {\n            type: \"Number\",\n            definedInName: \"PLT\",\n            definedInFullName: \"PLT,\",\n            isPrefixingDisabled: false,\n            isMetric: true\n        },\n        dataFetchServerTime: {\n            type: \"Number\",\n            definedInName: \"PLT\",\n            definedInFullName: \"PLT,\",\n            isPrefixingDisabled: false,\n            isMetric: true\n        },\n        postRender: {\n            type: \"Number\",\n            definedInName: \"PLT\",\n            definedInFullName: \"PLT,\",\n            isPrefixingDisabled: false,\n            isMetric: true\n        },\n        render: {\n            type: \"Number\",\n            definedInName: \"PLT\",\n            definedInFullName: \"PLT,\",\n            isPrefixingDisabled: false,\n            isMetric: true\n        },\n        plt: {\n            type: \"Number\",\n            definedInName: \"PLT\",\n            definedInFullName: \"PLT,\",\n            isPrefixingDisabled: false,\n            isMetric: true\n        },\n        pltWithUnload: {\n            type: \"Number\",\n            definedInName: \"PLT\",\n            definedInFullName: \"PLT,\",\n            isPrefixingDisabled: false,\n            isMetric: true\n        },\n        httpRequests: {\n            type: \"Number\",\n            definedInName: \"PLT\",\n            definedInFullName: \"PLT,\",\n            isPrefixingDisabled: false,\n            isMetric: true\n        },\n        appCacheHit: {\n            type: \"Boolean\",\n            definedInName: \"PLT\",\n            definedInFullName: \"PLT,\",\n            isPrefixingDisabled: false,\n            isMetric: false\n        }\n    };\n    /**\n     * The sampling feature for the PLT event\n     */\n    PLT.samplingFeature = { ODB: true, ODC: 'PLTLoggingSampling', Fallback: false };\n    return PLT;\n}(SingleEventBase_1.SingleEventBase));\nexports.PLT = PLT;\nPLT.prototype.metadata = PLT.metadata;\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.default = PLT;\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// D:/agent/1/_work/24/s/common/~/npmx-sp-pages/~/@ms/odsp-utilities/lib/logging/events/PLT.event.js\n// module id = 71\n// module chunks = 0\n\n\n// WEBPACK FOOTER //\n// webpack:///D:/agent/1/_work/24/s/common/~/npmx-sp-pages/~/@ms/odsp-utilities/lib/logging/events/PLT.event.js","// OneDrive:IgnoreCodeCoverage\n\"use strict\";\nvar __extends = (this && this.__extends) || function (d, b) {\n    for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p];\n    function __() { this.constructor = d; }\n    d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n};\nvar SingleEventBase_1 = require('../SingleEventBase');\nvar UnhandledError = (function (_super) {\n    __extends(UnhandledError, _super);\n    /**\n     * The UnhandledError event constructor\n     * @param parent {IEvent} The optional parent for this event\n     */\n    function UnhandledError(parent) {\n        _super.call(this, 'UnhandledError,', 'UnhandledError', parent);\n    }\n    /**\n     * This is true if the UnhandledError event is enabled\n     */\n    UnhandledError.enabled = function () {\n        return true;\n    };\n    /**\n     * This will create a single UnhandledError event\n     * @param data {IUnhandledErrorSingleSchema}\n     * -required message - This is the error message returned during the window.onerror handler\n     * -required stack - This is the stack trace of the error returned during the window.onerror handler, this is not available in all browsers and may only show up in certain ones (IEs)\n     * -required builtStack - This is the manually built stack trace of the unhandled exception\n     * -required line - This is the js line the unhandled exception happened on\n     * -required col - This is the js column the unhandled exception happened on\n     * -required url - This url of the js file that errored\n     * @param parent {IEvent} The optional parent for this event\n     */\n    UnhandledError.logData = function (data, parent) {\n        return SingleEventBase_1.SingleEventBase._logData(UnhandledError, data, parent);\n    };\n    /**\n     * This is false when UnhandledError event does not require a parent event\n     */\n    UnhandledError.prototype.requiresParent = function () {\n        return false;\n    };\n    /**\n     * This is true when UnhandledError event is a critical event\n     */\n    UnhandledError.prototype.isCritical = function () {\n        return true;\n    };\n    UnhandledError.prototype.setSingleData = function (data) {\n        this.data.message = this.cleanString(data.message);\n        this.data.stack = this.cleanString(data.stack);\n        this.data.builtStack = this.cleanString(data.builtStack);\n        this.data.line = data.line;\n        this.data.col = data.col;\n        this.data.url = this.cleanString(data.url);\n    };\n    /**\n     * The name of the UnhandledError event\n     */\n    UnhandledError.fullName = 'UnhandledError,';\n    /**\n     * The short name of the UnhandledError event\n     */\n    UnhandledError.shortName = 'UnhandledError';\n    /**\n     * This is true if the UnhandledError event is enabled\n     */\n    UnhandledError.metadata = {\n        message: {\n            type: \"String\",\n            definedInName: \"UnhandledError\",\n            definedInFullName: \"UnhandledError,\",\n            isPrefixingDisabled: false,\n            isMetric: false\n        },\n        stack: {\n            type: \"String\",\n            definedInName: \"UnhandledError\",\n            definedInFullName: \"UnhandledError,\",\n            isPrefixingDisabled: false,\n            isMetric: false\n        },\n        builtStack: {\n            type: \"String\",\n            definedInName: \"UnhandledError\",\n            definedInFullName: \"UnhandledError,\",\n            isPrefixingDisabled: false,\n            isMetric: false\n        },\n        line: {\n            type: \"Number\",\n            definedInName: \"UnhandledError\",\n            definedInFullName: \"UnhandledError,\",\n            isPrefixingDisabled: false,\n            isMetric: true\n        },\n        col: {\n            type: \"Number\",\n            definedInName: \"UnhandledError\",\n            definedInFullName: \"UnhandledError,\",\n            isPrefixingDisabled: false,\n            isMetric: true\n        },\n        url: {\n            type: \"String\",\n            definedInName: \"UnhandledError\",\n            definedInFullName: \"UnhandledError,\",\n            isPrefixingDisabled: false,\n            isMetric: false\n        },\n        unMinStack: {\n            type: \"Object\",\n            definedInName: \"UnhandledError\",\n            definedInFullName: \"UnhandledError,\",\n            isPrefixingDisabled: false,\n            isMetric: false\n        }\n    };\n    return UnhandledError;\n}(SingleEventBase_1.SingleEventBase));\nexports.UnhandledError = UnhandledError;\nUnhandledError.prototype.metadata = UnhandledError.metadata;\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.default = UnhandledError;\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// D:/agent/1/_work/24/s/common/~/npmx-sp-pages/~/@ms/odsp-utilities/lib/logging/events/UnhandledError.event.js\n// module id = 72\n// module chunks = 0\n\n\n// WEBPACK FOOTER //\n// webpack:///D:/agent/1/_work/24/s/common/~/npmx-sp-pages/~/@ms/odsp-utilities/lib/logging/events/UnhandledError.event.js","// OneDrive:IgnoreCodeCoverage\n\"use strict\";\nvar __extends = (this && this.__extends) || function (d, b) {\n    for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p];\n    function __() { this.constructor = d; }\n    d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n};\nvar SingleEventBase_1 = require('../SingleEventBase');\nvar RequireJSError = (function (_super) {\n    __extends(RequireJSError, _super);\n    /**\n     * The RequireJSError event constructor\n     * @param parent {IEvent} The optional parent for this event\n     */\n    function RequireJSError(parent) {\n        _super.call(this, 'RequireJSError,', 'RequireJSError', parent);\n    }\n    /**\n     * This is true if the RequireJSError event is enabled\n     */\n    RequireJSError.enabled = function () {\n        return true;\n    };\n    /**\n     * This will create a single RequireJSError event\n     * @param data {IRequireJSErrorSingleSchema}\n     * -required message - This is the error message returned during the window.onerror handler\n     * -required requireModules - This is the array of required modules\n     * -required requireType - This is the require error type\n     * -required stack - This is the stack trace of the error returned during the window.onerror handler\n     * @param parent {IEvent} The optional parent for this event\n     */\n    RequireJSError.logData = function (data, parent) {\n        return SingleEventBase_1.SingleEventBase._logData(RequireJSError, data, parent);\n    };\n    /**\n     * This is false when RequireJSError event does not require a parent event\n     */\n    RequireJSError.prototype.requiresParent = function () {\n        return false;\n    };\n    /**\n     * This is true when RequireJSError event is a critical event\n     */\n    RequireJSError.prototype.isCritical = function () {\n        return true;\n    };\n    RequireJSError.prototype.setSingleData = function (data) {\n        this.data.message = this.cleanString(data.message);\n        this.data.requireModules = data.requireModules;\n        this.data.requireType = this.cleanString(data.requireType);\n        this.data.stack = this.cleanString(data.stack);\n    };\n    /**\n     * The name of the RequireJSError event\n     */\n    RequireJSError.fullName = 'RequireJSError,';\n    /**\n     * The short name of the RequireJSError event\n     */\n    RequireJSError.shortName = 'RequireJSError';\n    /**\n     * This is true if the RequireJSError event is enabled\n     */\n    RequireJSError.metadata = {\n        message: {\n            type: \"String\",\n            definedInName: \"RequireJSError\",\n            definedInFullName: \"RequireJSError,\",\n            isPrefixingDisabled: false,\n            isMetric: false\n        },\n        requireModules: {\n            type: \"Array\",\n            definedInName: \"RequireJSError\",\n            definedInFullName: \"RequireJSError,\",\n            isPrefixingDisabled: false,\n            isMetric: false\n        },\n        requireType: {\n            type: \"String\",\n            definedInName: \"RequireJSError\",\n            definedInFullName: \"RequireJSError,\",\n            isPrefixingDisabled: false,\n            isMetric: false\n        },\n        stack: {\n            type: \"String\",\n            definedInName: \"RequireJSError\",\n            definedInFullName: \"RequireJSError,\",\n            isPrefixingDisabled: false,\n            isMetric: false\n        },\n        unMinStack: {\n            type: \"Object\",\n            definedInName: \"RequireJSError\",\n            definedInFullName: \"RequireJSError,\",\n            isPrefixingDisabled: false,\n            isMetric: false\n        }\n    };\n    return RequireJSError;\n}(SingleEventBase_1.SingleEventBase));\nexports.RequireJSError = RequireJSError;\nRequireJSError.prototype.metadata = RequireJSError.metadata;\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.default = RequireJSError;\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// D:/agent/1/_work/24/s/common/~/npmx-sp-pages/~/@ms/odsp-utilities/lib/logging/events/RequireJSError.event.js\n// module id = 73\n// module chunks = 0\n\n\n// WEBPACK FOOTER //\n// webpack:///D:/agent/1/_work/24/s/common/~/npmx-sp-pages/~/@ms/odsp-utilities/lib/logging/events/RequireJSError.event.js","// OneDrive:IgnoreCodeCoverage\n\"use strict\";\nvar DebugPriorityLevel;\n(function (DebugPriorityLevel) {\n    DebugPriorityLevel[DebugPriorityLevel[\"Low\"] = 0] = \"Low\";\n    DebugPriorityLevel[DebugPriorityLevel[\"Normal\"] = 1] = \"Normal\";\n})(DebugPriorityLevel || (DebugPriorityLevel = {}));\n;\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.default = DebugPriorityLevel;\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// D:/agent/1/_work/24/s/common/~/npmx-sp-pages/~/@ms/odsp-utilities/lib/logging/odb/DebugPriorityLevel.js\n// module id = 74\n// module chunks = 0\n\n\n// WEBPACK FOOTER //\n// webpack:///D:/agent/1/_work/24/s/common/~/npmx-sp-pages/~/@ms/odsp-utilities/lib/logging/odb/DebugPriorityLevel.js","\"use strict\";\n// OneDrive:IgnoreCodeCoverage\nvar RUMOneLogger_1 = require(\"./RUMOneLogger\");\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.default = RUMOneLogger_1.ControlPerformanceData;\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// D:/agent/1/_work/24/s/common/~/npmx-sp-pages/~/@ms/odsp-utilities/lib/logging/rumone/ControlPerformanceData.js\n// module id = 75\n// module chunks = 0\n\n\n// WEBPACK FOOTER //\n// webpack:///D:/agent/1/_work/24/s/common/~/npmx-sp-pages/~/@ms/odsp-utilities/lib/logging/rumone/ControlPerformanceData.js","\"use strict\";\nvar DateTime = require('@ms/odsp-utilities/lib/dateTime/DateTime');\nexports.DateTime = DateTime;\nvar StringHelper = require('@ms/odsp-utilities/lib/string/StringHelper');\nexports.StringHelper = StringHelper;\nvar Api_event_1 = require('@ms/odsp-utilities/lib/logging/events/Api.event');\nexports.Api = Api_event_1.Api;\nvar PLT_event_1 = require('@ms/odsp-utilities/lib/logging/events/PLT.event');\nexports.PLT = PLT_event_1.PLT;\nvar Async_1 = require('@ms/odsp-utilities/lib/async/Async');\nexports.Async = Async_1.default;\nvar Component_1 = require('@ms/odsp-utilities/lib/component/Component');\nexports.Component = Component_1.default;\nvar BaseDataStore_1 = require('@ms/odsp-utilities/lib/models/store/BaseDataStore');\nexports.DataStore = BaseDataStore_1.default;\nvar DataStoreCachingType_1 = require('@ms/odsp-utilities/lib/models/store/DataStoreCachingType');\nexports.DataStoreCachingType = DataStoreCachingType_1.default;\nvar EventGroup_1 = require('@ms/odsp-utilities/lib/events/EventGroup');\nexports.EventGroup = EventGroup_1.default;\nvar FabricTheming_1 = require('@ms/odsp-utilities/lib/theming/FabricTheming');\nexports.FabricTheming = FabricTheming_1.default;\nvar Features_1 = require('@ms/odsp-utilities/lib/features/Features');\nexports.Features = Features_1.default;\nvar GroupDataSource_1 = require('@ms/odsp-utilities/lib/dataSources/group/GroupDataSource');\nexports.GroupDataSource = GroupDataSource_1.default;\nvar Guid_1 = require('@ms/odsp-utilities/lib/guid/Guid');\nexports.Guid = Guid_1.default;\nvar HtmlEncoding_1 = require('@ms/odsp-utilities/lib/encoding/HtmlEncoding');\nexports.HtmlEncoding = HtmlEncoding_1.default;\nvar Locale_1 = require('@ms/odsp-utilities/lib/locale/Locale');\nexports.Locale = Locale_1.default;\nvar Manager_1 = require('@ms/odsp-utilities/lib/logging/Manager');\nexports.Manager = Manager_1.default;\nvar ObjectUtil_1 = require('@ms/odsp-utilities/lib/object/ObjectUtil');\nexports.ObjectUtil = ObjectUtil_1.default;\nvar PerformanceCollection_1 = require('@ms/odsp-utilities/lib/performance/PerformanceCollection');\nexports.PerformanceCollection = PerformanceCollection_1.default;\nvar PlatformDetection_1 = require('@ms/odsp-utilities/lib/browser/PlatformDetection');\nexports.PlatformDetection = PlatformDetection_1.default;\nvar Promise_1 = require('@ms/odsp-utilities/lib/async/Promise');\nexports.Promise = Promise_1.default;\nvar RgbaColor_1 = require('@ms/odsp-utilities/lib/theming/RgbaColor');\nexports.RgbaColor = RgbaColor_1.default;\nvar SiteHeaderLogoAcronym_1 = require('@ms/odsp-utilities/lib/dataSources/acronym/SiteHeaderLogoAcronym');\nexports.SiteHeaderLogoAcronym = SiteHeaderLogoAcronym_1.default;\nvar ThemeProvider_1 = require('@ms/odsp-utilities/lib/theming/ThemeProvider');\nexports.ThemeProvider = ThemeProvider_1.default;\nvar Uri_1 = require('@ms/odsp-utilities/lib/uri/Uri');\nexports.Uri = Uri_1.default;\nvar UriEncoding_1 = require('@ms/odsp-utilities/lib/encoding/UriEncoding');\nexports.UriEncoding = UriEncoding_1.default;\nvar WebTheme_1 = require('@ms/odsp-utilities/lib/theming/WebTheme');\nexports.WebTheme = WebTheme_1.default;\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// D:/agent/1/_work/24/s/libraries/sp-telemetry/lib/odsp-utilities/odsp-utilities-extended.js\n// module id = 76\n// module chunks = 0\n\n\n// WEBPACK FOOTER //\n// webpack:///D:/agent/1/_work/24/s/libraries/sp-telemetry/lib/odsp-utilities/odsp-utilities-extended.js","// OneDrive:IgnoreCodeCoverage\n\"use strict\";\nvar DatetimeResx = require('./DateTime.resx');\nvar Locale_1 = require('../locale/Locale');\nvar StringHelper_1 = require('../string/StringHelper');\n// this is the difference between the .net ticks and the javascript Date ticks\nvar TICKS_CONVERSION_CONSTANT = 62135596800000;\n// number of milliseconds for the given timespan\n// copied from SPRelativeDateTime, including 32 days to a month\nvar ONE_SECOND = 1000;\nvar ONE_MINUTE = 60 * ONE_SECOND;\nvar TWO_MINUTES = 2 * ONE_MINUTE;\nvar ONE_HOUR = 60 * ONE_MINUTE;\nvar TWO_HOURS = 2 * ONE_HOUR;\nvar ONE_DAY = 24 * ONE_HOUR;\nvar TWO_DAYS = 2 * ONE_DAY;\nvar ONE_WEEK = 7 * ONE_DAY;\nvar ONE_MONTH = 32 * ONE_DAY;\nvar _getLocale;\nvar supportsTimeZoneDateOptions;\nvar shortDateFormat;\nvar shortTimeFormat;\nvar shortDateFormatUTC;\nvar shortTimeFormatUTC;\nvar formatShortDate;\nvar formatShortTime;\nvar formatShortDateUTC;\nvar formatShortTimeUTC;\n/**\n * Convert a date-time string to a JavaScript Date object, for IE8 compat.\n *  Modern browsers and IE9+ can just take the string directly to the Date constructor.\n *  Format is: 1999-12-31T12:34:56.0000000Z\n *  Trailing Z indicates UTC timezone, otherwise it uses the browser's time zone.\n */\nfunction iso8601DateTimeToJsDate(dateTime) {\n    'use strict';\n    // note that Date.parse() doesn't work for this format in IE8 either\n    var isUTC = false;\n    if (dateTime.toUpperCase().indexOf('Z') === dateTime.length - 1) {\n        isUTC = true;\n    }\n    var timeValues = dateTime.split(/[^0-9]/);\n    if (timeValues.length < 6) {\n        return; // error\n    }\n    // note that Date 0-indexes months\n    if (!isUTC) {\n        return new Date(Number(timeValues[0]), Number(timeValues[1]) - 1, Number(timeValues[2]), Number(timeValues[3]), Number(timeValues[4]), Number(timeValues[5]));\n    }\n    else {\n        return new Date(Date.UTC(Number(timeValues[0]), Number(timeValues[1]) - 1, Number(timeValues[2]), Number(timeValues[3]), Number(timeValues[4]), Number(timeValues[5])));\n    }\n}\nexports.iso8601DateTimeToJsDate = iso8601DateTimeToJsDate;\n/**\n * Get a string like \"X minutes ago\" that reflects the time elapsed since the input time.\n * Only works for past times, future times just return a browser-determined localized time string.\n */\nfunction getRelativeDateTimeStringPast(pastTime, startWithLowerCase) {\n    'use strict';\n    if (startWithLowerCase === void 0) { startWithLowerCase = false; }\n    var timespan = Date.now() - pastTime.getTime(); // time elapsed in ms\n    if (timespan < -5 * ONE_MINUTE) {\n        return pastTime.toLocaleDateString(Locale_1.default.language);\n    }\n    else if (timespan < ONE_MINUTE) {\n        // \"Less than a minute ago\"\n        return startWithLowerCase ? DatetimeResx.strings.RelativeDateTime_LessThanAMinute_StartWithLowerCase : DatetimeResx.strings.RelativeDateTime_LessThanAMinute;\n    }\n    else if (timespan < TWO_MINUTES) {\n        // \"About a minute ago\"\n        return startWithLowerCase ? DatetimeResx.strings.RelativeDateTime_AboutAMinute_StartWithLowerCase : DatetimeResx.strings.RelativeDateTime_AboutAMinute;\n    }\n    else if (timespan < ONE_HOUR) {\n        // \"{0} minutes ago\"\n        var minutes = Math.floor(timespan / ONE_MINUTE);\n        return StringHelper_1.getLocalizedCountValue(DatetimeResx.strings.RelativeDateTime_XMinutes, DatetimeResx.strings.RelativeDateTime_XMinutesIntervals, minutes).replace(\"{0}\", String(minutes));\n    }\n    else if (timespan < TWO_HOURS) {\n        // \"About an hour ago\"\n        return startWithLowerCase ? DatetimeResx.strings.RelativeDateTime_AboutAnHour_StartWithLowerCase : DatetimeResx.strings.RelativeDateTime_AboutAnHour;\n    }\n    else if (timespan < ONE_DAY) {\n        // \"{0} hours ago\"\n        var hours = Math.floor(timespan / ONE_HOUR);\n        return StringHelper_1.getLocalizedCountValue(DatetimeResx.strings.RelativeDateTime_XHours, DatetimeResx.strings.RelativeDateTime_XHoursIntervals, hours).replace(\"{0}\", String(hours));\n    }\n    else if (timespan < TWO_DAYS) {\n        // \"Yesterday at {0}\"\n        return startWithLowerCase ? DatetimeResx.strings.RelativeDateTime_YesterdayAndTime_StartWithLowerCase.replace(\"{0}\", pastTime.toLocaleTimeString(Locale_1.default.language)) :\n            DatetimeResx.strings.RelativeDateTime_YesterdayAndTime.replace(\"{0}\", pastTime.toLocaleTimeString(Locale_1.default.language));\n    }\n    else if (timespan < ONE_MONTH) {\n        // \"{0} days ago\" (in the past month-ish)\n        var days = Math.floor(timespan / ONE_DAY);\n        return StringHelper_1.getLocalizedCountValue(DatetimeResx.strings.RelativeDateTime_XDays, DatetimeResx.strings.RelativeDateTime_XDaysIntervals, days).replace(\"{0}\", String(days));\n    }\n    // Any other time, just return the regular full original time\n    return pastTime.toLocaleDateString(Locale_1.default.language); // browser-determined localized date (no time)\n}\nexports.getRelativeDateTimeStringPast = getRelativeDateTimeStringPast;\n/**\n * This is a modified implementation of DateTime.GetRelativeDateTimeStringPast(...).\n * The differences here are as follows:\n *      (1) The time string for yesterday does not include the seconds\n *      (2) Instead of showing 'X days ago' for dates older than a month, default to showing the full date\n *      (3) The full date will also include the time (also without seconds)\n */\nfunction getRelativeDateTimeStringPastWithHourMinute(pastTime) {\n    'use strict';\n    var timespan = Date.now() - pastTime.getTime(); // time elapsed in ms\n    var date = pastTime.toLocaleDateString(Locale_1.default.language); // browser-determined localized date\n    var time = pastTime.toLocaleTimeString(Locale_1.default.language, { hour: 'numeric', minute: '2-digit' }); //time without seconds\n    if (timespan < ONE_DAY) {\n        return getRelativeDateTimeStringPast(pastTime);\n    }\n    else if (timespan < TWO_DAYS) {\n        // \"Yesterday at {0}\" without seconds\n        return StringHelper_1.format(DatetimeResx.strings.RelativeDateTime_YesterdayAndTime, time);\n    }\n    // Any other time, just return the regular full original date with time, without seconds\n    return StringHelper_1.format(DatetimeResx.strings.DateTime_DateAndTime, date, time);\n}\nexports.getRelativeDateTimeStringPastWithHourMinute = getRelativeDateTimeStringPastWithHourMinute;\n/**\n * True if the date is on or between the first and last day of the current week. This uses the Date function getDay()\n * which returns the day of the week for the specified date according to local time, where 0 represents Sunday.\n */\nfunction isThisWeek(pastTime) {\n    'use strict';\n    var today = new Date();\n    var start = new Date(today.getTime() - today.getDay() * ONE_DAY);\n    var end = new Date(start.getTime() + ONE_WEEK - ONE_DAY);\n    var isThisWeek = (start.getTime() <= pastTime.getTime() && pastTime.getTime() <= end.getTime());\n    return isThisWeek;\n}\nexports.isThisWeek = isThisWeek;\n/**\n * True if the date is on or between the first and last day of the previous week. This uses the Date function getDay()\n * which returns the day of the week for the specified date according to local time, where 0 represents Sunday.\n */\nfunction isLastWeek(pastTime) {\n    'use strict';\n    var today = new Date();\n    var start = new Date(today.getTime() - today.getDay() * ONE_DAY - ONE_WEEK);\n    var end = new Date(start.getTime() + ONE_WEEK - ONE_DAY);\n    var isLastWeek = (start.getTime() <= pastTime.getTime() && pastTime.getTime() <= end.getTime());\n    return isLastWeek;\n}\nexports.isLastWeek = isLastWeek;\n// for use with lists' server-processed date value\n/**\n * @param relativeDateTimeJSString: list server-processed date value string\n * @startWithLowerCase: use this option when the return string is not at beginning of the sentence.\n */\nfunction getRelativeDateTimeStringForLists(relativeDateTimeJSString, startWithLowerCase) {\n    'use strict';\n    if (startWithLowerCase === void 0) { startWithLowerCase = false; }\n    var ret = null;\n    var retTemplate = null;\n    var codes = relativeDateTimeJSString.split('|');\n    // Passthrough case\n    if (codes[0] === \"0\") {\n        return relativeDateTimeJSString.substring(2);\n    }\n    var bFuture = codes[1] === \"1\";\n    var timeBucket = codes[2];\n    var timeValue = codes.length >= 4 ? codes[3] : null;\n    var timeValue2 = codes.length >= 5 ? codes[4] : null;\n    switch (timeBucket) {\n        // a few seconds\n        case \"1\":\n            ret = bFuture ? (startWithLowerCase ? DatetimeResx.strings.RelativeDateTime_AFewSecondsFuture_StartWithLowerCase : DatetimeResx.strings.RelativeDateTime_AFewSecondsFuture) :\n                (startWithLowerCase ? DatetimeResx.strings.RelativeDateTime_AFewSeconds_StartWithLowerCase : DatetimeResx.strings.RelativeDateTime_AFewSeconds);\n            break;\n        // about a minute\n        case \"2\":\n            ret = bFuture ? (startWithLowerCase ? DatetimeResx.strings.RelativeDateTime_AboutAMinuteFuture_StartWithLowerCase : DatetimeResx.strings.RelativeDateTime_AboutAMinuteFuture) :\n                (startWithLowerCase ? DatetimeResx.strings.RelativeDateTime_AboutAMinute_StartWithLowerCase : DatetimeResx.strings.RelativeDateTime_AboutAMinute);\n            break;\n        // x minutes\n        case \"3\":\n            retTemplate = StringHelper_1.getLocalizedCountValue(bFuture ? (startWithLowerCase ? DatetimeResx.strings.RelativeDateTime_XMinutesFuture_StartWithLowerCase : DatetimeResx.strings.RelativeDateTime_XMinutesFuture)\n                : DatetimeResx.strings.RelativeDateTime_XMinutes, bFuture ? DatetimeResx.strings.RelativeDateTime_XMinutesFutureIntervals : DatetimeResx.strings.RelativeDateTime_XMinutesIntervals, Number(timeValue));\n            break;\n        // about an hour\n        case \"4\":\n            ret = bFuture ? (startWithLowerCase ? DatetimeResx.strings.RelativeDateTime_AboutAnHourFuture_StartWithLowerCase : DatetimeResx.strings.RelativeDateTime_AboutAnHourFuture)\n                : (startWithLowerCase ? DatetimeResx.strings.RelativeDateTime_AboutAnHour_StartWithLowerCase : DatetimeResx.strings.RelativeDateTime_AboutAnHour);\n            break;\n        // yesterday / tomorrow\n        case \"5\":\n            if (timeValue == null) {\n                ret = bFuture ? (startWithLowerCase ? DatetimeResx.strings.RelativeDateTime_Tomorrow_StartWithLowerCase : DatetimeResx.strings.RelativeDateTime_Tomorrow)\n                    : (startWithLowerCase ? DatetimeResx.strings.RelativeDateTime_Yesterday_StartWithLowerCase : DatetimeResx.strings.RelativeDateTime_Yesterday);\n            }\n            else {\n                retTemplate = bFuture ? (startWithLowerCase ? DatetimeResx.strings.RelativeDateTime_TomorrowAndTime_StartWithLowerCase : DatetimeResx.strings.RelativeDateTime_TomorrowAndTime)\n                    : (startWithLowerCase ? DatetimeResx.strings.RelativeDateTime_YesterdayAndTime_StartWithLowerCase : DatetimeResx.strings.RelativeDateTime_YesterdayAndTime);\n            }\n            break;\n        // x hours\n        case \"6\":\n            retTemplate = StringHelper_1.getLocalizedCountValue(bFuture ? (startWithLowerCase ? DatetimeResx.strings.RelativeDateTime_XHoursFuture_StartWithLowerCase : DatetimeResx.strings.RelativeDateTime_XHoursFuture)\n                : DatetimeResx.strings.RelativeDateTime_XHours, bFuture ? DatetimeResx.strings.RelativeDateTime_XHoursFutureIntervals : DatetimeResx.strings.RelativeDateTime_XHoursIntervals, Number(timeValue));\n            break;\n        // day and time\n        case \"7\":\n            if (timeValue2 === null) {\n                ret = timeValue;\n            }\n            else {\n                retTemplate = DatetimeResx.strings.RelativeDateTime_DayAndTime;\n            }\n            break;\n        // <Days> days\n        case \"8\":\n            retTemplate = StringHelper_1.getLocalizedCountValue(bFuture ? DatetimeResx.strings.RelativeDateTime_XDaysFuture : DatetimeResx.strings.RelativeDateTime_XDays, bFuture ? DatetimeResx.strings.RelativeDateTime_XDaysFutureIntervals : DatetimeResx.strings.RelativeDateTime_XDaysIntervals, Number(timeValue));\n            break;\n        // today\n        case \"9\":\n            ret = startWithLowerCase ? DatetimeResx.strings.RelativeDateTime_Today_StartWithLowerCase : DatetimeResx.strings.RelativeDateTime_Today;\n            break;\n    }\n    if (retTemplate !== null) {\n        ret = retTemplate.replace(\"{0}\", timeValue);\n        if (timeValue2 !== null) {\n            ret = ret.replace(\"{1}\", timeValue2);\n        }\n    }\n    return ret;\n}\nexports.getRelativeDateTimeStringForLists = getRelativeDateTimeStringForLists;\n/**\n * Converts a given date string into its UTC/ISO standard format\n */\nfunction convertDateToISOString(expiration) {\n    'use strict';\n    var expirationDate = new Date(expiration);\n    // For more info on the time zone offset and its signage, see:\n    // https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Date/getTimezoneOffset\n    var isOffsetNegative = (expirationDate.getTimezoneOffset() < 0) ? true : false;\n    var year = expirationDate.getFullYear().toString();\n    var month = _padStringWithZeroes((expirationDate.getMonth() + 1).toString(), 2); //zero based month\n    var day = _padStringWithZeroes(expirationDate.getDate().toString(), 2);\n    var hours = _padStringWithZeroes(expirationDate.getHours().toString(), 2);\n    var minutes = _padStringWithZeroes(expirationDate.getMinutes().toString(), 2);\n    var seconds = _padStringWithZeroes(expirationDate.getSeconds().toString(), 2);\n    var offsetHours = _padStringWithZeroes((isOffsetNegative ? Math.ceil(expirationDate.getTimezoneOffset() / 60).toString().replace(\"-\", \"\") : Math.floor(expirationDate.getTimezoneOffset() / 60).toString()), 2);\n    var offsetMinutes = _padStringWithZeroes((expirationDate.getTimezoneOffset() % 60).toString().replace(\"-\", \"\"), 2);\n    var expirationString = year + month + day + 'T' + hours + minutes + seconds + (isOffsetNegative ? '+' : '-') + offsetHours + offsetMinutes;\n    return expirationString;\n}\nexports.convertDateToISOString = convertDateToISOString;\n/**\n * get the last day of the month based on the input date\n */\nfunction getLastDayOfMonth(date) {\n    'use strict';\n    var lastDay = new Date(Date.UTC(date.getUTCFullYear(), date.getUTCMonth(), 1, 0, 0, 0, 0));\n    // To get the last day of the month we will increment the month\n    lastDay.setUTCMonth(lastDay.getUTCMonth() + 1);\n    // Then subtract a day\n    lastDay.setUTCDate(lastDay.getUTCDate() - 1);\n    // Then set the time to be the last second of the day\n    lastDay.setUTCHours(23, 59, 59, 999);\n    return lastDay;\n}\nexports.getLastDayOfMonth = getLastDayOfMonth;\n/**\n * Given the .Net ticks of a date, convert it to a Date\n */\nfunction getDateFromDotNetTicks(dotNetTicks) {\n    'use strict';\n    if (!dotNetTicks) {\n        return null;\n    }\n    var ticksInMilliseconds = (dotNetTicks / 10000) - TICKS_CONVERSION_CONSTANT;\n    return new Date(ticksInMilliseconds);\n}\nexports.getDateFromDotNetTicks = getDateFromDotNetTicks;\nfunction createShortDateFormatters() {\n    'use strict';\n    var locale = _getLocale();\n    var supportsUTC = _supportsTimeZoneDateOptions();\n    if (window['Intl'] && window['Intl']['DateTimeFormat']) {\n        var dateOptions = {};\n        var timeOptions = { hour: '2-digit', minute: '2-digit' };\n        shortDateFormat = new Intl.DateTimeFormat(locale, dateOptions);\n        shortTimeFormat = new Intl.DateTimeFormat(locale, timeOptions);\n        if (supportsUTC) {\n            dateOptions.timeZone = 'UTC';\n            timeOptions.timeZone = 'UTC';\n        }\n        shortDateFormatUTC = new Intl.DateTimeFormat(locale, dateOptions);\n        shortTimeFormatUTC = new Intl.DateTimeFormat(locale, timeOptions);\n        formatShortDate = shortDateFormat.format;\n        formatShortTime = shortTimeFormat.format;\n        formatShortDateUTC = shortDateFormatUTC.format;\n        formatShortTimeUTC = shortTimeFormatUTC.format;\n    }\n    else {\n        // No support for formatter objects.\n        formatShortDate = formatShortDateUTC = function (date) {\n            return date.toLocaleDateString(locale);\n        };\n        formatShortTime = formatShortTimeUTC = function (date) {\n            return date.toLocaleTimeString(locale);\n        };\n    }\n}\n/**\n * Returns a short version of a date to display (e.g. 11:45 PM if today, or 11/2/2015 if not today)\n */\nfunction getShortDisplayDate(date, useUTCTimezone) {\n    'use strict';\n    if (!date) {\n        return '';\n    }\n    if (!formatShortDate) {\n        createShortDateFormatters();\n    }\n    var now = new Date();\n    var isToday = date.getDate() === now.getDate() && Math.abs(now.getTime() - date.getTime()) < ONE_DAY;\n    var formatter;\n    if (useUTCTimezone) {\n        if (isToday) {\n            formatter = formatShortTimeUTC;\n        }\n        else {\n            formatter = formatShortDateUTC;\n        }\n    }\n    else {\n        if (isToday) {\n            formatter = formatShortTime;\n        }\n        else {\n            formatter = formatShortDate;\n        }\n    }\n    return formatter(date);\n}\nexports.getShortDisplayDate = getShortDisplayDate;\n/**\n * Returns a full version of a date to display (e.g. 11/2/2015 11:45 PM)\n * useUTCTimezone defaults to false\n * useHour12 is ignored, and will be determined by the locale.\n */\nfunction getFullDisplayDate(date, useUTCTimezone, useHour12) {\n    'use strict';\n    if (!formatShortDate) {\n        createShortDateFormatters();\n    }\n    var dateString = useUTCTimezone ? formatShortDateUTC(date) : formatShortDate(date);\n    var timeString = useUTCTimezone ? formatShortTimeUTC(date) : formatShortTime(date);\n    return StringHelper_1.format(DatetimeResx.strings.DateAndTime, dateString, timeString);\n}\nexports.getFullDisplayDate = getFullDisplayDate;\n_getLocale = function () {\n    'use strict';\n    var validLocale;\n    var locales = [\n        window['$Config'] && window['$Config']['mkt'],\n        Locale_1.default.language,\n        navigator.language,\n        'en'].filter(function (str) { return !!str; });\n    for (var _i = 0, locales_1 = locales; _i < locales_1.length; _i++) {\n        var locale = locales_1[_i];\n        try {\n            new Date().toLocaleDateString(locale);\n            validLocale = locale;\n            break;\n        }\n        catch (e) {\n        }\n    }\n    _getLocale = function () { return validLocale; };\n    return validLocale;\n};\nfunction _supportsTimeZoneDateOptions() {\n    'use strict';\n    if (supportsTimeZoneDateOptions === void 0) {\n        try {\n            var locale = _getLocale();\n            (new Date()).toLocaleDateString(locale, { timeZone: 'UTC' });\n            supportsTimeZoneDateOptions = true;\n        }\n        catch (E) {\n            // We know of some versions of IE 11 that fail when date options with a timezone is specified.\n            supportsTimeZoneDateOptions = false;\n        }\n    }\n    return supportsTimeZoneDateOptions;\n}\n/**\n * Pads a date string with the request number of '0' characters\n */\nfunction _padStringWithZeroes(toPad, numDigits) {\n    'use strict';\n    var paddedString = toPad;\n    while (paddedString.length < numDigits) {\n        paddedString = '0' + paddedString;\n    }\n    return paddedString;\n}\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// D:/agent/1/_work/24/s/common/~/npmx-sp-pages/~/@ms/odsp-utilities/lib/dateTime/DateTime.js\n// module id = 77\n// module chunks = 0\n\n\n// WEBPACK FOOTER //\n// webpack:///D:/agent/1/_work/24/s/common/~/npmx-sp-pages/~/@ms/odsp-utilities/lib/dateTime/DateTime.js","// OneDrive:IgnoreCodeCoverage\n\"use strict\";\nexports.strings = { \"RelativeDateTime_AFewSeconds\": \"A few seconds ago\", \"RelativeDateTime_AFewSeconds_StartWithLowerCase\": \"a few seconds ago\", \"RelativeDateTime_Format_DateTimeFormattingString_Override\": \"\", \"RelativeDateTime_Format_DateTimeFormattingString\": \"{0}, {1}\", \"RelativeDateTime_AFewSecondsFuture\": \"In a few seconds\", \"RelativeDateTime_AFewSecondsFuture_StartWithLowerCase\": \"in a few seconds\", \"RelativeDateTime_AboutAMinuteFuture\": \"In about a minute\", \"RelativeDateTime_AboutAMinuteFuture_StartWithLowerCase\": \"in about a minute\", \"RelativeDateTime_LessThanAMinute\": \"Less than a minute ago\", \"RelativeDateTime_LessThanAMinute_StartWithLowerCase\": \"less than a minute ago\", \"RelativeDateTime_AboutAMinute\": \"About a minute ago\", \"RelativeDateTime_AboutAMinute_StartWithLowerCase\": \"about a minute ago\", \"RelativeDateTime_XMinutesFuture\": \"In {0} minute||In {0} minutes\", \"RelativeDateTime_XMinutesFuture_StartWithLowerCase\": \"in {0} minute||in {0} minutes\", \"RelativeDateTime_XMinutesFutureIntervals\": \"1||2-\", \"RelativeDateTime_XMinutesIntervals\": \"1||2-\", \"RelativeDateTime_AboutAnHourFuture\": \"In about an hour\", \"RelativeDateTime_AboutAnHourFuture_StartWithLowerCase\": \"in about an hour\", \"RelativeDateTime_AboutAnHour\": \"About an hour ago\", \"RelativeDateTime_AboutAnHour_StartWithLowerCase\": \"about an hour ago\", \"RelativeDateTime_Tomorrow\": \"Tomorrow\", \"RelativeDateTime_Tomorrow_StartWithLowerCase\": \"tomorrow\", \"RelativeDateTime_Yesterday\": \"Yesterday\", \"RelativeDateTime_Yesterday_StartWithLowerCase\": \"yesterday\", \"RelativeDateTime_YesterdayAndTime\": \"Yesterday at {0}\", \"RelativeDateTime_YesterdayAndTime_StartWithLowerCase\": \"yesterday at {0}\", \"DateTime_DateAndTime\": \"{0} at {1}\", \"RelativeDateTime_TomorrowAndTime\": \"Tomorrow at {0}\", \"RelativeDateTime_TomorrowAndTime_StartWithLowerCase\": \"tomorrow at {0}\", \"RelativeDateTime_XHoursFuture\": \"In {0} hour||In {0} hours\", \"RelativeDateTime_XHoursFuture_StartWithLowerCase\": \"in {0} hour||in {0} hours\", \"RelativeDateTime_XHours\": \"{0} hour ago||{0} hours ago\", \"RelativeDateTime_XHoursFutureIntervals\": \"1||2-\", \"RelativeDateTime_XHoursIntervals\": \"1||2-\", \"RelativeDateTime_DayAndTime\": \"{0} at {1}\", \"RelativeDateTime_XDaysFuture\": \"{0} day from now||{0} days from now\", \"RelativeDateTime_XDays\": \"{0} day ago||{0} days ago\", \"RelativeDateTime_XDaysFutureIntervals\": \"1||2-\", \"RelativeDateTime_XDaysIntervals\": \"1||2-\", \"RelativeDateTime_Today\": \"Today\", \"RelativeDateTime_Today_StartWithLowerCase\": \"today\", \"RelativeDateTime_XMinutes\": \"{0} minute ago||{0} minutes ago\", \"DateAndTime\": \"{0} {1}\" };\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// D:/agent/1/_work/24/s/common/~/npmx-sp-pages/~/@ms/odsp-utilities/lib/dateTime/DateTime.resx.js\n// module id = 78\n// module chunks = 0\n\n\n// WEBPACK FOOTER //\n// webpack:///D:/agent/1/_work/24/s/common/~/npmx-sp-pages/~/@ms/odsp-utilities/lib/dateTime/DateTime.resx.js","// OneDrive:IgnoreCodeCoverage\n\"use strict\";\nvar Locale = (function () {\n    function Locale() {\n    }\n    Locale.invalidate = function () {\n        Locale.isRightToLeft = (document.documentElement.getAttribute('dir') === 'rtl');\n        Locale.safeLeft = Locale.isRightToLeft ? 'right' : 'left';\n        Locale.safeRight = Locale.isRightToLeft ? 'left' : 'right';\n        /** Robert Chen has the detailed explanation here : The most magic thing here is that OneDrive page and teamsite page has exactly the same line of code with regard to html tag Lang attribute.\n         * <SharePoint:SPHtmlTag lang=\"<%$Resources:wss,language_value%>\" dir=\"<%$Resources:wss,multipages_direction_dir_value%>\" ID=\"SPHtmlTag\" runat=\"server\">\n         * And in teamsite doclib, this lang gets executed to the current user locale. And that is actually already a magic------What happens here is the in order to get the doclib page in ContentDB, we had a standard MondoSproc call which gets the page and the SPWeb. In constructing the web, SP *  * code has smart logic to set Thread.CurrentThread.CurrentUICulture to match the MUI language! And with that magic, =\"<%$Resources:wss,language_value%> actually gets sets properly to the user language, not the pre-defined web language.\n         * For OneDrive.aspx which lives inside _layouts folder, the order of code execution changes. We must have executed this line of ASPX code first =\"<%$Resources:wss,language_value%> before SPWeb was opened and did the magic to set Thread.CurrentThread.CurrentUICulture.\n         * So the Thread.CurrentThread.CurrentUICulture affecting =\"<%$Resources:wss,language_value%> with SPWeb magic end up not working in Onedrive.aspx! And theres really nothing that we can do about it unless we rewrite the page!\n         * So the conclusion is that the lang attribute is by design (of implementation) different from the regular team site pages which live inside content db.\n         */\n        var language = window[\"_spPageContextInfo\"] && window[\"_spPageContextInfo\"].currentCultureName;\n        // fallback of xml:lang for IE9\n        Locale.language = language ||\n            document.documentElement.getAttribute('lang') ||\n            document.documentElement.getAttribute('xml:lang') ||\n            'en-us';\n    };\n    return Locale;\n}());\nLocale.invalidate();\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.default = Locale;\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// D:/agent/1/_work/24/s/common/~/npmx-sp-pages/~/@ms/odsp-utilities/lib/locale/Locale.js\n// module id = 79\n// module chunks = 0\n\n\n// WEBPACK FOOTER //\n// webpack:///D:/agent/1/_work/24/s/common/~/npmx-sp-pages/~/@ms/odsp-utilities/lib/locale/Locale.js","// OneDrive:IgnoreCodeCoverage\n\"use strict\";\n// Regex that finds { and } so they can be removed on a lookup for string format\nvar FORMAT_ARGS_REGEX = /[\\{\\}]/g;\n// Regex that finds {#} so it can be replaced by the arguments in string format\nvar FORMAT_REGEX = /\\{\\d+\\}/g;\n/**\n * String Format is like C# string format.\n * Usage Example: \"hello {0}!\".format(\"mike\") will return \"hello mike!\"\n * Calling format on a string with less arguments than specified in the format is invalid\n * Example \"I love {0} every {1}\".format(\"CXP\") will result in a Debug Exception.\n */\nfunction format(s) {\n    'use strict';\n    var values = [];\n    for (var _i = 1; _i < arguments.length; _i++) {\n        values[_i - 1] = arguments[_i];\n    }\n    var args = values;\n    // Callback match function\n    function replace_func(match) {\n        // looks up in the args\n        var replacement = args[match.replace(FORMAT_ARGS_REGEX, \"\")];\n        // catches undefined in nondebug and null in debug and nondebug\n        if (replacement === null) {\n            replacement = '';\n        }\n        return replacement;\n    }\n    return (s.replace(FORMAT_REGEX, replace_func));\n}\nexports.format = format;\n/**\n * Returns true if s ends with suffix.\n */\nfunction doesStringEndWith(s, suffix) {\n    'use strict';\n    return s.substr(s.length - suffix.length) === suffix;\n}\nexports.doesStringEndWith = doesStringEndWith;\n/**\n * Returns true if s starts with prefix.\n */\nfunction doesStringStartWith(s, prefix) {\n    'use strict';\n    return s.substr(0, prefix.length) === prefix;\n}\nexports.doesStringStartWith = doesStringStartWith;\n/**\n * Return a string of the given length, using 0s to pad in from the right.\n */\nfunction rightPad(data, length) {\n    'use strict';\n    var result = data.toString();\n    while (result.length < length) {\n        result = result + \"0\";\n    }\n    return result;\n}\nexports.rightPad = rightPad;\n/**\n * Look for any of the chars in searchValues in str.\n * Returns the index of the char found or -1 if nothing is found.\n */\nfunction findOneOf(str, searchValues) {\n    'use strict';\n    for (var idx = 0; idx < str.length; idx++) {\n        var ch = str[idx];\n        if (searchValues.indexOf(ch) !== -1) {\n            return idx;\n        }\n    }\n    return -1; //none of the searchValues exist in string\n}\nexports.findOneOf = findOneOf;\n/**\n * Determines if two strings are equal when both converted to lowercase.\n */\nfunction equalsCaseInsensitive(a, b) {\n    'use strict';\n    if (a && b) {\n        return a.toLowerCase() === b.toLowerCase();\n    }\n    return a === b;\n}\nexports.equalsCaseInsensitive = equalsCaseInsensitive;\n/**\n * Capitalizes the first letter of str.\n */\nfunction capitalize(str) {\n    'use strict';\n    if (str) {\n        return str[0].toUpperCase() + str.substr(1);\n    }\n    return str;\n}\nexports.capitalize = capitalize;\n/**\n * De-capitalizes the first letter of str.\n */\nfunction decapitalize(str) {\n    'use strict';\n    if (str) {\n        return str[0].toLowerCase() + str.substr(1);\n    }\n    return str;\n}\nexports.decapitalize = decapitalize;\n/**\n * Selects a string based on plurality.\n *\n * @param count - The value to base selection on\n * @param single - The string to select when it's a singular value\n * @param multiple - The string to select when it's a plural value\n *\n * @deprecated This method does NOT give accurate results for many languages!!\n *             Use getLocalizedCountValue instead.\n */\nfunction pluralSelect(count, single, plural) {\n    'use strict';\n    return count === 1 ? single : plural;\n}\nexports.pluralSelect = pluralSelect;\n/**\n * Given a specially formatted localized text, a set of intervals, and a count,\n * return the localized text which corresponds to the first interval the\n * count falls into.\n *\n * Please see https://microsoft.sharepoint.com/teams/OISGPortal/LocKits/_layouts/15/start.aspx#/Lockit%20Instructions/SharePoint%20Core%20Localization.aspx\n * for more details.\n *\n * @param {string} locText - || deliminated blocks of localized texts, representing\n *  the various singular and plural forms of the string  being localized\n * @param {string} intervals - || deliminated blocks of numeric intervals, defining the ranges\n *  of that interval. Has special support for , * and -.\n * @param {number} count - The count used to determine which interval to return.\n *\n * @return\n * The localized block which corresponds to the first interval the count falls into.\n *\n * @example\n * StringHelper.getLocalizedCountValue('items||item||items', '0||1||2-', 0)\n *   returns items\n * StringHelper.getLocalizedCountValue('items||item||items', '0||1||2-', 1)\n *   returns item\n * StringHelper.getLocalizedCountValue('items||item||items', '0||1||2-', 2)\n *   returns items\n */\nfunction getLocalizedCountValue(locText, intervals, count) {\n    'use strict';\n    count = Number(count); // defensively make sure count is a number\n    // !!!IMPORTANT!!! changes in this function need to be in sync with\n    // the methods with the same name located at:\n    // otools/inc/sts/stsom/utilities/SPLocUtility.cs\n    // sts/Client/Script/Init/LocUtility.cs\n    if (locText === undefined || intervals === undefined || count === undefined) {\n        return null;\n    }\n    var ret = '';\n    var locIndex = -1;\n    var intervalsArray = intervals.split('||');\n    for (var i = 0, length_1 = intervalsArray.length; i < length_1; i++) {\n        var interval = intervalsArray[i];\n        if (!interval) {\n            continue;\n        }\n        var subIntervalsArray = interval.split(',');\n        for (var _i = 0, subIntervalsArray_1 = subIntervalsArray; _i < subIntervalsArray_1.length; _i++) {\n            var subInterval = subIntervalsArray_1[_i];\n            if (!subInterval) {\n                continue;\n            }\n            // there are three possiblities, wildcard, interval, or number\n            if (isNaN(Number(subInterval))) {\n                if (subInterval.indexOf('-') !== -1) {\n                    // if it's an interval the format is Number-Number\n                    var range = subInterval.split('-');\n                    if (range.length !== 2) {\n                        continue;\n                    }\n                    var min = void 0;\n                    var max = void 0;\n                    if (range[0] === '') {\n                        min = 0;\n                    }\n                    else {\n                        if (isNaN(Number(range[0]))) {\n                            continue;\n                        }\n                        else {\n                            min = parseInt(range[0], 10);\n                        }\n                    }\n                    if (count >= min) {\n                        if (range[1] === '') {\n                            locIndex = i;\n                            break;\n                        }\n                        else {\n                            if (isNaN(Number(range[1]))) {\n                                continue;\n                            }\n                            else {\n                                max = parseInt(range[1], 10);\n                            }\n                        }\n                        if (count <= max) {\n                            locIndex = i;\n                            break;\n                        }\n                    }\n                }\n                else if (subInterval.indexOf('*') !== -1) {\n                    // Wildcard\n                    var regexExpr = subInterval.trim().replace(/\\*/g, '[0-9]*');\n                    var regex = new RegExp(\"^\" + regexExpr + \"$\");\n                    if (regex.test(count.toString())) {\n                        locIndex = i;\n                        break;\n                    }\n                }\n            }\n            else {\n                var exactNumber = parseInt(subInterval, 10);\n                if (count === exactNumber) {\n                    locIndex = i;\n                    break;\n                }\n            }\n        }\n        if (locIndex !== -1) {\n            break;\n        }\n    }\n    if (locIndex !== -1) {\n        var locValues = locText.split('||');\n        if (locValues[locIndex]) {\n            ret = locValues[locIndex];\n        }\n    }\n    return ret;\n}\nexports.getLocalizedCountValue = getLocalizedCountValue;\n/**\n * Format the locText with the localized count value.\n */\nfunction formatWithLocalizedCountValue(locText, intervals, count) {\n    'use strict';\n    var template = getLocalizedCountValue(locText, intervals, count);\n    var result = format(template, count.toString());\n    return result;\n}\nexports.formatWithLocalizedCountValue = formatWithLocalizedCountValue;\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// D:/agent/1/_work/24/s/common/~/npmx-sp-pages/~/@ms/odsp-utilities/lib/string/StringHelper.js\n// module id = 80\n// module chunks = 0\n\n\n// WEBPACK FOOTER //\n// webpack:///D:/agent/1/_work/24/s/common/~/npmx-sp-pages/~/@ms/odsp-utilities/lib/string/StringHelper.js","// OneDrive:IgnoreCodeCoverage\n\"use strict\";\nvar __extends = (this && this.__extends) || function (d, b) {\n    for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p];\n    function __() { this.constructor = d; }\n    d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n};\nvar PairedEventBase_1 = require('../PairedEventBase');\nvar Features_1 = require('../../features/Features');\nvar ResultTypeEnum_1 = require('./ResultTypeEnum');\nvar ResultTypeEnum_2 = require('./ResultTypeEnum');\nexports.ResultTypeEnum = ResultTypeEnum_2.ResultTypeEnum;\nvar Api = (function (_super) {\n    __extends(Api, _super);\n    /**\n     * The Api event constructor\n     * @param data {IApiStartSchema}\n     * -required url - The api url\n     * -required name - This is the name of the qos event\n     * -optional resultCode - This is result code for the qos event\n     * -optional resultType - This is the result type enum\n     * -optional error - This is the error message to be logged with failed result\n     * -optional extraData - This is the random extra data for the qos event\n     * -optional extraMetrics - Extra data for the qos event that should be logged as aggregatable metrics\n     * @param parent {IEvent} The optional parent for this event\n     */\n    function Api(data, parent) {\n        _super.call(this, 'Api,Qos,', 'Api', data, parent);\n    }\n    /**\n     * This is true if the Api event is enabled\n     */\n    Api.enabled = function () {\n        return Features_1.default.isFeatureEnabled(Api.samplingFeature);\n    };\n    Api.instrumentPromise = function (startSchema, createPromise, getCompleteSchema, getErrorSchema, timeoutMs, timeoutSchema, parent) {\n        return PairedEventBase_1.PairedEventBase._instrumentPromise(Api, startSchema, createPromise, getCompleteSchema, getErrorSchema, timeoutMs, timeoutSchema, parent);\n    };\n    /**\n     * This will end the Api event\n     * @param data {IApiEndSchema}\n     * -optional resultCode - This is result code for the qos event\n     * -required resultType - This is the result type enum\n     * -optional error - This is the error message to be logged with failed result\n     * -optional extraData - This is the random extra data for the qos event\n     * -optional extraMetrics - Extra data for the qos event that should be logged as aggregatable metrics\n     */\n    Api.prototype.end = function (data) {\n        return this._end(data);\n    };\n    /**\n     * This writes verbose logs to memory to be uploaded if event ends with failure\n     */\n    Api.prototype.verbose = function (message) {\n        return this._verbose(message);\n    };\n    /**\n     * Sets a time limit for the scenario. A timeout result will be logged if no end happens in desired timeframe\n     */\n    Api.prototype.setTimeout = function (ms, data) {\n        return this._setTimeout(ms, data);\n    };\n    /**\n     * This is true when Api event is enabled\n     */\n    Api.prototype.isEnabled = function () {\n        return Features_1.default.isFeatureEnabled(Api.samplingFeature);\n    };\n    Api.prototype.setStartData = function (data) {\n        this.data.url = this.cleanString(data.url);\n        this.data.name = this.cleanString(data.name);\n        if (typeof data.resultCode !== \"undefined\") {\n            this.data.resultCode = this.cleanString(data.resultCode);\n        }\n        if (typeof data.resultType !== \"undefined\") {\n            this.data.resultType = data.resultType;\n        }\n        if (typeof data.error !== \"undefined\") {\n            this.data.error = this.cleanString(data.error);\n        }\n        if (typeof data.extraData !== \"undefined\") {\n            this.data.extraData = data.extraData;\n        }\n        if (typeof data.extraMetrics !== \"undefined\") {\n            this.data.extraMetrics = data.extraMetrics;\n        }\n    };\n    Api.prototype.setEndData = function (data) {\n        if (typeof data.resultCode !== \"undefined\") {\n            this.data.resultCode = this.cleanString(data.resultCode);\n        }\n        this.data.resultType = data.resultType;\n        if (typeof data.error !== \"undefined\") {\n            this.data.error = this.cleanString(data.error);\n        }\n        if (typeof data.extraData !== \"undefined\") {\n            this.data.extraData = data.extraData;\n        }\n        if (typeof data.extraMetrics !== \"undefined\") {\n            this.data.extraMetrics = data.extraMetrics;\n        }\n    };\n    /**\n     * The name of the Api event\n     */\n    Api.fullName = 'Api,Qos,';\n    /**\n     * The short name of the Api event\n     */\n    Api.shortName = 'Api';\n    /**\n     * This is true if the Api event is enabled\n     */\n    Api.metadata = {\n        url: {\n            type: \"String\",\n            definedInName: \"Api\",\n            definedInFullName: \"Api,\",\n            isPrefixingDisabled: false,\n            isMetric: false\n        },\n        name: {\n            type: \"String\",\n            definedInName: \"Qos\",\n            definedInFullName: \"Qos,\",\n            isKey: true,\n            isPrefixingDisabled: true,\n            isMetric: false\n        },\n        resultCode: {\n            type: \"String\",\n            definedInName: \"Qos\",\n            definedInFullName: \"Qos,\",\n            isPrefixingDisabled: true,\n            isMetric: false\n        },\n        resultType: {\n            type: \"ResultTypeEnum\",\n            definedInName: \"Qos\",\n            definedInFullName: \"Qos,\",\n            baseType: \"Enum\",\n            typeRef: ResultTypeEnum_1.ResultTypeEnum,\n            isPrefixingDisabled: true,\n            isMetric: false\n        },\n        error: {\n            type: \"String\",\n            definedInName: \"Qos\",\n            definedInFullName: \"Qos,\",\n            isPrefixingDisabled: true,\n            isMetric: false\n        },\n        extraData: {\n            type: \"Object\",\n            definedInName: \"Qos\",\n            definedInFullName: \"Qos,\",\n            isPrefixingDisabled: false,\n            isMetric: false\n        },\n        extraMetrics: {\n            type: \"Object\",\n            definedInName: \"Qos\",\n            definedInFullName: \"Qos,\",\n            isPrefixingDisabled: true,\n            isMetric: false\n        }\n    };\n    /**\n     * The sampling feature for the Api event\n     */\n    Api.samplingFeature = { ODB: true, ODC: 'ApiEventLogging', Fallback: false };\n    return Api;\n}(PairedEventBase_1.PairedEventBase));\nexports.Api = Api;\nApi.prototype.metadata = Api.metadata;\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.default = Api;\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// D:/agent/1/_work/24/s/common/~/npmx-sp-pages/~/@ms/odsp-utilities/lib/logging/events/Api.event.js\n// module id = 81\n// module chunks = 0\n\n\n// WEBPACK FOOTER //\n// webpack:///D:/agent/1/_work/24/s/common/~/npmx-sp-pages/~/@ms/odsp-utilities/lib/logging/events/Api.event.js","\"use strict\";\nvar Scope_1 = require('../scope/Scope');\nvar Resources_1 = require('../resources/Resources');\n/**\n * Base class for lifetime-managed, scoped components.\n *\n * Many web components ultimately need to set up subscriptions to events,\n * manage HTML elements, wait on asychronous activities, and clean up\n * loaded state. The `Component` base class provides a way to create a hierarchy\n * of objects with lifetime management and automatic resource scoping.\n *\n * `Component` combines the benefits of `ResourceScope` and `Scope` into a single\n *  package for convenience.\n *\n * If a component-like class needs the benefits of lifetime management but cannot\n * extend `Component`, consider wrapping a `Scope` and a `ResourceScope` in order\n * to create child components.\n *\n * @export\n * @class Component\n * @implements {IDisposable}\n *\n * @example\n *  export interface ISearchServiceParams extends IComponentParams {\n *      searchMode: SearchMode;\n *  }\n *\n *  export interface ISearchDependencies extends IComponentDependencies {\n *      context: IContext\n *      DataRequestor?: typeof DataRequestor;\n *  }\n *\n *  export default class SearchService extends Component {\n *      public static readonly dependencies = ObjectUtil.extend({\n *          context: contextKey\n *      }, Component.dependencies);\n *\n *      private _dataRequestor: DataRequestor;\n *      private _context: IContext;\n *      private _searchMode: SearchMode;\n *\n *      constructor(params: ISearchServiceParams, dependencies: ISearchServiceDependencies) {\n *          super(params, dependencies);\n *\n *          const {\n *              searchMode\n *          } = params;\n *\n *          const {\n *              context\n *              DataRequestor: dataRequestorType // This parameter is only used in unit tests\n *          } = dependencies;\n *\n *          this._searchMode = searchMode;\n *\n *          this._context = context;\n *\n *          this._dataRequestor = new (this.child(dataRequestorType))();\n *      }\n *\n *      public search(options: ISearchOptions): Promise<ISearchResult> {\n *          return this._dataRequestor.getData(...).then((data: ISearchResponse) => {\n *              return this._processResponse(data);\n *          });\n *      }\n *  }\n */\nvar Component = (function () {\n    /**\n     * Creates an instance of Component.\n     * In general, derived classes should invoke `super(params, dependencies)`, supplying both\n     * `params` and `dependencies` to the `Component` class.\n     * When creating a new instance of a derived component, use either\n     * `new (resources.injected(MyComponent))()`\n     * when outside a `Component` or\n     * `new (this.child(MyComponent))()`\n     * when inside a `Component`. This will ensure that resources are properly passed and lifetimes\n     * are properly managed.\n     *\n     * @param {IComponentParams} [params={}] Optional params to control behaviors of this class.\n     * In general, classes which extend components\n     * @param {IComponentDependencies} [dependencies={}] Optional dependencies to override types consumed by this class.\n     * `dependencies` is intended for use during unit testing, to override types consumed outside of resourcing.\n     * Most dependency injection should be done using `ResourceScope`.\n     */\n    function Component(params, dependencies) {\n        if (params === void 0) { params = {}; }\n        if (dependencies === void 0) { dependencies = {}; }\n        var _a = this.resources, resources = _a === void 0 ? (dependencies.resources || params.resources) : _a;\n        this.resources = resources;\n        this._Component_scope = new Scope_1.default();\n    }\n    Object.defineProperty(Component.prototype, \"scope\", {\n        /**\n         * Gets the lifetime scope manager for this component.\n         * In general, use `new (this.child(Type))()` to create child components\n         * with proper lifetime management.\n         * However, `this.scope` can be used to\n         *\n         * @protected\n         * @type {Scope}\n         */\n        get: function () {\n            return this._Component_scope;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(Component.prototype, \"isDisposed\", {\n        /**\n         * Determines whether or not this component has been disposed.\n         *\n         * @readonly\n         * @protected\n         * @type {boolean}\n         */\n        get: function () {\n            return this.scope.isDisposed;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Component.prototype.dispose = function () {\n        this._Component_scope.dispose();\n    };\n    /**\n     * Produces a constructor for a type which injects instances\n     * with this component's current resources and binds them\n     * to this component's lifetime. New code should prefer `this.child`.\n     *\n     * @protected\n     * @template T\n     * @param {T} type\n     * @returns {T}\n     */\n    Component.prototype.managed = function (type) {\n        if (this.resources) {\n            type = this.resources.injected(type);\n        }\n        return this.scope.attached(type);\n    };\n    Component.prototype.child = function (keyOrType) {\n        var type;\n        if (keyOrType instanceof Resources_1.ResourceKey) {\n            type = this.resources.consume(keyOrType);\n        }\n        else if (this.resources) {\n            type = this.resources.injected(keyOrType, {\n                injectChildResourceScope: true\n            });\n        }\n        else {\n            type = keyOrType;\n        }\n        return this.scope.attached(type);\n    };\n    Component.dependencies = {\n        resources: Resources_1.resourceScopeKey\n    };\n    return Component;\n}());\nexports.Component = Component;\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.default = Component;\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// D:/agent/1/_work/24/s/common/~/npmx-sp-pages/~/@ms/odsp-utilities/lib/component/Component.js\n// module id = 82\n// module chunks = 0\n\n\n// WEBPACK FOOTER //\n// webpack:///D:/agent/1/_work/24/s/common/~/npmx-sp-pages/~/@ms/odsp-utilities/lib/component/Component.js","\"use strict\";\nvar Disposable_1 = require('../disposable/Disposable');\n/**\n * Lifetime manager for scoping components.\n *\n * @export\n * @class Scope\n * @implements {IDisposable}\n *\n * @example\n *  const scope = new Scope();\n *\n *  let instance = new (scope.attached(MyComponent))();\n *\n *  scope.dispose();\n */\nvar Scope = (function () {\n    /**\n     * Creates an instance of Scope.\n     */\n    function Scope() {\n        this._disposables = {};\n        this._lastDisposableId = 0;\n    }\n    /**\n     * Produces a constructor for instances of a type which will be bound to the lifetime\n     * of this scope.\n     *\n     * @template T the type of object to be created.\n     * @param {T} the original constructor for the type.\n     * @returns {T} a new constructor to invoke to create the object.\n     */\n    Scope.prototype.attached = function (type) {\n        var scope = this;\n        var Attached = function () {\n            return scope.attach(type.apply(this, arguments) || this);\n        };\n        if (DEBUG) {\n            // This pattern results in the correct type being displayed in the debugger\n            var wrappedConstructor_1 = Attached;\n            Attached = function () {\n                return wrappedConstructor_1.apply(Object.create(type.prototype), arguments);\n            };\n        }\n        Attached.prototype = type.prototype;\n        return Attached;\n    };\n    Scope.prototype.attach = function (instance) {\n        var _this = this;\n        var id = \"\" + ++this._lastDisposableId;\n        var disposable = Disposable_1.hook(instance, function () {\n            delete _this._disposables[id];\n        });\n        this._disposables[id] = disposable;\n        return disposable;\n    };\n    /**\n     * Disposes this scope and any attached objects.\n     */\n    Scope.prototype.dispose = function () {\n        if (!this.isDisposed) {\n            this.isDisposed = true;\n        }\n        var disposables = this._disposables;\n        for (var _i = 0, _a = Object.keys(disposables); _i < _a.length; _i++) {\n            var id = _a[_i];\n            var disposable = disposables[id];\n            if (disposable && Disposable_1.isDisposable(disposable)) {\n                disposable.dispose();\n            }\n            delete disposables[id];\n        }\n    };\n    return Scope;\n}());\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.default = Scope;\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// D:/agent/1/_work/24/s/common/~/npmx-sp-pages/~/@ms/odsp-utilities/lib/scope/Scope.js\n// module id = 83\n// module chunks = 0\n\n\n// WEBPACK FOOTER //\n// webpack:///D:/agent/1/_work/24/s/common/~/npmx-sp-pages/~/@ms/odsp-utilities/lib/scope/Scope.js","\"use strict\";\nvar DisposalChain = (function () {\n    function DisposalChain(owner) {\n        this._callbacks = [];\n        this._owner = owner;\n    }\n    DisposalChain.prototype.addCallback = function (callback) {\n        this._callbacks.push(callback);\n    };\n    DisposalChain.prototype.dispose = function () {\n        // Handle dispose callbacks is the reverse order from when they were attached.\n        while (this._callbacks.length) {\n            var callback = this._callbacks.pop();\n            callback.call(this._owner);\n        }\n    };\n    return DisposalChain;\n}());\n/**\n * Determines whether not an object requires is disposable.\n *\n * @export\n * @template T\n * @param {(T | IDisposable)} object\n * @returns {object is IDisposable}\n */\nfunction isDisposable(object) {\n    'use strict';\n    return typeof object.dispose === 'function';\n}\nexports.isDisposable = isDisposable;\nfunction hook(instance, onDispose) {\n    'use strict';\n    var disposable = instance;\n    var dispose = disposable.dispose;\n    var disposalChain = typeof dispose === 'function' && dispose.disposalChain;\n    if (!disposalChain) {\n        disposalChain = new DisposalChain(disposable);\n        var disposeHook = (function () {\n            disposalChain.dispose();\n            if (dispose) {\n                // Restore the old dispose method and clean up modifications.\n                disposable.dispose = dispose;\n                disposable.dispose();\n            }\n        });\n        disposable.dispose = disposeHook;\n        disposeHook.disposalChain = disposalChain;\n    }\n    disposalChain.addCallback(onDispose);\n    return disposable;\n}\nexports.hook = hook;\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// D:/agent/1/_work/24/s/common/~/npmx-sp-pages/~/@ms/odsp-utilities/lib/disposable/Disposable.js\n// module id = 84\n// module chunks = 0\n\n\n// WEBPACK FOOTER //\n// webpack:///D:/agent/1/_work/24/s/common/~/npmx-sp-pages/~/@ms/odsp-utilities/lib/disposable/Disposable.js","\"use strict\";\nfunction __export(m) {\n    for (var p in m) if (!exports.hasOwnProperty(p)) exports[p] = m[p];\n}\nvar ResourceScope_1 = require('./ResourceScope');\nvar Disposable_1 = require('../disposable/Disposable');\n/**\n * An implementation of IResourceLoader that constructs a {ResolvedResourceFactory} from the type that the load function resolves to.\n */\nvar ResolvedResourceLoader = (function () {\n    function ResolvedResourceLoader(load, dependencies) {\n        this._load = load;\n        this._dependencies = dependencies;\n    }\n    ResolvedResourceLoader.prototype.load = function () {\n        var _this = this;\n        var promise = this._load().then(function (type) {\n            return new ResolvedResourceFactory(type, _this._dependencies);\n        });\n        this.load = function () { return promise; };\n        return promise;\n    };\n    return ResolvedResourceLoader;\n}());\nexports.ResolvedResourceLoader = ResolvedResourceLoader;\n/**\n * An implementation of IResourceFactory that instantiates the passed type, resolving any dependencies from resources.\n */\nvar ResolvedResourceFactory = (function () {\n    function ResolvedResourceFactory(type, dependencies) {\n        this._type = type;\n        this.dependencies = type.dependencies || dependencies;\n    }\n    ResolvedResourceFactory.prototype.create = function (dependencies) {\n        var instance = new this._type({}, dependencies);\n        return {\n            instance: instance,\n            disposable: instance\n        };\n    };\n    return ResolvedResourceFactory;\n}());\nexports.ResolvedResourceFactory = ResolvedResourceFactory;\n/**\n * An implementation of IResourceFactory that provides a constructor for the passed type with dependencies resolved from resources.\n */\nvar ResolvedResourceTypeFactory = (function () {\n    function ResolvedResourceTypeFactory(type, dependencies) {\n        this._type = type;\n        this.dependencies = type.dependencies || dependencies;\n    }\n    ResolvedResourceTypeFactory.prototype.create = function (dependencies) {\n        return {\n            instance: ResourceScope_1.getResolvedConstructor(this._type, dependencies)\n        };\n    };\n    return ResolvedResourceTypeFactory;\n}());\nexports.ResolvedResourceTypeFactory = ResolvedResourceTypeFactory;\n/**\n * An implementation of IResourceFactory for classes that have no dependencies and take no parameters.\n */\nvar SimpleResourceFactory = (function () {\n    function SimpleResourceFactory(type) {\n        this._type = type;\n    }\n    Object.defineProperty(SimpleResourceFactory.prototype, \"dependencies\", {\n        get: function () {\n            return {};\n        },\n        enumerable: true,\n        configurable: true\n    });\n    SimpleResourceFactory.prototype.create = function () {\n        var instance = new this._type();\n        return {\n            instance: instance,\n            disposable: Disposable_1.isDisposable(instance) && instance\n        };\n    };\n    return SimpleResourceFactory;\n}());\nexports.SimpleResourceFactory = SimpleResourceFactory;\n__export(require('./ResourceScope'));\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// D:/agent/1/_work/24/s/common/~/npmx-sp-pages/~/@ms/odsp-utilities/lib/resources/Resources.js\n// module id = 85\n// module chunks = 0\n\n\n// WEBPACK FOOTER //\n// webpack:///D:/agent/1/_work/24/s/common/~/npmx-sp-pages/~/@ms/odsp-utilities/lib/resources/Resources.js","\"use strict\";\nvar Promise_1 = require('../async/Promise');\nvar ObjectUtil_1 = require('../object/ObjectUtil');\nvar Scope_1 = require('../scope/Scope');\nvar Disposable_1 = require('../disposable/Disposable');\nvar lastId = 0;\nvar ResourceKey = (function () {\n    function ResourceKey(nameOrOptions) {\n        this.id = ++lastId;\n        if (typeof nameOrOptions === 'string') {\n            this.name = nameOrOptions;\n        }\n        else {\n            this.name = nameOrOptions.name;\n            this.factory = nameOrOptions.factory;\n            this.useNarrowestScope = nameOrOptions.useNarrowestScope;\n        }\n    }\n    /**\n     * Provides information about this resource key\n     */\n    ResourceKey.prototype.toString = function () {\n        return \"Resource #\" + this.id + \" \\\"\" + this.name + \"\\\"\";\n    };\n    return ResourceKey;\n}());\nexports.ResourceKey = ResourceKey;\nvar ConstantResourceFactory = (function () {\n    function ConstantResourceFactory(value) {\n        this._value = value;\n    }\n    Object.defineProperty(ConstantResourceFactory.prototype, \"dependencies\", {\n        get: function () {\n            return {};\n        },\n        enumerable: true,\n        configurable: true\n    });\n    ConstantResourceFactory.prototype.create = function () {\n        return { instance: this._value };\n    };\n    return ConstantResourceFactory;\n}());\nexports.ConstantResourceFactory = ConstantResourceFactory;\nexports.resourceScopeKey = new ResourceKey({\n    name: 'resources'\n});\nvar Handle = (function () {\n    function Handle(factory, instanceManager) {\n        this.factory = factory;\n        this.manager = instanceManager;\n    }\n    Handle.prototype.getInstance = function (key, resourceScopeOptions) {\n        var factory = this.factory.value;\n        var resource = factory.create(this.manager.getConsumer().resolve(factory.dependencies, resourceScopeOptions));\n        var instance = resource.instance;\n        if (resource.disposable) {\n            this.manager.scope.attach(resource.disposable);\n        }\n        this.getInstance = function () { return instance; };\n        return instance;\n    };\n    Handle.prototype.promote = function (targetHandleManager) {\n        return new Handle({\n            manager: targetHandleManager,\n            loader: this.factory.loader,\n            value: this.factory.value\n        });\n    };\n    return Handle;\n}());\nvar logBeginConstruction;\nvar logEndConstruction;\nvar logConsume;\nvar logExpose;\nvar log;\nfunction getResolvedConstructor(resolvableConstructor, resolvedDependencies) {\n    var Resolved = function (params) {\n        var instance = resolvableConstructor.call(this, params, resolvedDependencies) || this;\n        return instance;\n    };\n    if (DEBUG) {\n        // This pattern results in the correct type being displayed in the debugger\n        var wrappedConstructor_1 = Resolved;\n        Resolved = function (params) {\n            logBeginConstruction(resolvableConstructor, 'Resources.resolved');\n            var instance = wrappedConstructor_1.call(Object.create(resolvableConstructor.prototype), params);\n            logEndConstruction(resolvableConstructor, 'Resources.resolved');\n            return instance;\n        };\n    }\n    Resolved.prototype = resolvableConstructor.prototype;\n    return Resolved;\n}\nexports.getResolvedConstructor = getResolvedConstructor;\nvar HandleManager = (function () {\n    function HandleManager(parentOrOptions) {\n        this.handles = {};\n        var options;\n        if (parentOrOptions instanceof HandleManager) {\n            if (parentOrOptions.isDisposed) {\n                throw new Error('Parent ResourceScope has already been disposed!');\n            }\n            options = parentOrOptions.options;\n            this._parent = parentOrOptions;\n            this._level = parentOrOptions._level + 1;\n        }\n        else {\n            options = parentOrOptions || {};\n            this._level = 0;\n            if (DEBUG) {\n                // Check for setting and enable tracing if set\n                if (!('__ResourceTraceState' in window) && localStorage['EnableResourceTracing']) {\n                    window['__ResourceTraceState'] = {\n                        log: [],\n                        stack: [],\n                        types: {},\n                        exposed: {}\n                    };\n                }\n                log('Created new root level Resource Scope');\n            }\n        }\n        this.scope = new Scope_1.default();\n        this.options = options;\n    }\n    Object.defineProperty(HandleManager.prototype, \"isDisposed\", {\n        get: function () {\n            return this.scope.isDisposed;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    HandleManager.prototype.block = function (key) {\n        return this._expose(key);\n    };\n    HandleManager.prototype.isDescendantOf = function (manager) {\n        return this._level > manager._level;\n    };\n    HandleManager.prototype.getResourceScope = function (options) {\n        // Bypass type check in order to pass non-exported class to public constructor\n        return this.scope.attach(new ResourceScope(this, options));\n    };\n    HandleManager.prototype.getHandle = function (key) {\n        var manager = this;\n        var keyId = key.id;\n        // Starting with this scope, attempt to find the first scope with an entry (may be undefined)\n        // for the given key. Stop when there are no more ancestor scopes.\n        while (!(keyId in manager.handles) && manager._parent) {\n            manager = manager._parent;\n        }\n        return manager.handles[keyId] || (this.options.useFactoriesOnKeys && key.factory && (manager.handles[keyId] = new Handle({\n            value: key.factory,\n            manager: manager\n        })));\n    };\n    HandleManager.prototype.getLocalInstanceHandle = function (keyId) {\n        var handle = this.handles[keyId];\n        // If we have a handle with a manager, return it.\n        return handle && handle.manager && handle;\n    };\n    HandleManager.prototype.expose = function (key, factory, instance) {\n        return this._expose(key, function (handleManager) { return new Handle({\n            value: factory.value,\n            loader: factory.loader,\n            manager: handleManager\n        }, instance && handleManager); });\n    };\n    HandleManager.prototype.getConsumer = function () {\n        this.lock();\n        var consumer = new ResourceConsumer(this);\n        this.getConsumer = function () { return consumer; };\n        return consumer;\n    };\n    HandleManager.prototype.getLoader = function () {\n        this.lock();\n        var loader = new ResourceLoader(this);\n        this.getLoader = function () { return loader; };\n        return loader;\n    };\n    HandleManager.prototype.dispose = function () {\n        this.scope.dispose();\n        this.handles = {};\n        this.getConsumer = onConsumeAfterDispose;\n        this.getLoader = onLoadAfterDispose;\n    };\n    HandleManager.prototype.bind = function (key) {\n        var handle = this.getHandle(key);\n        if (handle) {\n            return this._expose(key, function (handleManager) { return handle.promote(handleManager); });\n        }\n        return this;\n    };\n    HandleManager.prototype.getWritableHandleManager = function () {\n        return this;\n    };\n    HandleManager.prototype.lock = function () {\n        this.getWritableHandleManager = this._fork;\n    };\n    HandleManager.prototype._fork = function () {\n        if (this.options.lockResourcesForChildren) {\n            return this.scope.attach(new HandleManager(this));\n        }\n        else if (DEBUG) {\n            log(\"Expose after consume/child at \" + this._level);\n        }\n        return this;\n    };\n    HandleManager.prototype._expose = function (key, createHandle) {\n        if (this.isDisposed) {\n            throw new Error('Cannot expose a resource on a ResourceScope that has been disposed.');\n        }\n        if (key === exports.resourceScopeKey) {\n            throw new Error('It is illegal to expose the ResourceScope key');\n        }\n        var keyId = key.id;\n        var handleManager = this.getWritableHandleManager();\n        var handles = handleManager.handles;\n        if (handles[keyId]) {\n            if (this.options.noDoubleExpose) {\n                throw new Error(key.toString() + \" has already been exposed/consumed at this scope.\");\n            }\n            else if (DEBUG) {\n                log(\"Duplicate exposure of \" + key.toString() + \".\");\n            }\n        }\n        handles[keyId] = createHandle ? createHandle(handleManager) : void 0;\n        return handleManager;\n    };\n    return HandleManager;\n}());\nfunction onConsumeAfterDispose() {\n    throw new Error('Cannot consume a resource from a ResourceScope that has been disposed.');\n}\nfunction onLoadAfterDispose() {\n    throw new Error('Cannot load a resource from a ResourceScope that has been disposed.');\n}\nvar ResourceLoader = (function () {\n    function ResourceLoader(handleManager) {\n        this._handleManager = handleManager;\n        this._loadState = {};\n    }\n    ResourceLoader.prototype.loadAllAsync = function (dependencies) {\n        var _this = this;\n        var unloadedDependencies = this._getAllUnloadedDependencies(dependencies);\n        if (unloadedDependencies instanceof Error) {\n            return Promise_1.default.wrapError(unloadedDependencies);\n        }\n        else {\n            var loadPromises = [];\n            var _loop_1 = function(keyId) {\n                var factory = unloadedDependencies[keyId];\n                // Protect against duplicate loads due to timing bugs\n                var rawPromise = factory.loader.load();\n                factory.loader = {\n                    load: function () { return rawPromise; }\n                };\n                loadPromises.push(rawPromise.then(function (value) {\n                    if (DEBUG) {\n                        log(\"Loaded Resource #\" + keyId);\n                    }\n                    factory.value = value;\n                    var factoryDependencies = value.dependencies;\n                    if (factoryDependencies) {\n                        return _this.loadAllAsync(factoryDependencies);\n                    }\n                }));\n            };\n            for (var keyId in unloadedDependencies) {\n                _loop_1(keyId);\n            }\n            return Promise_1.default.all(loadPromises).then(function () {\n                // Return void;\n            }, function (errors) { return errors[0] || errors; });\n        }\n    };\n    ResourceLoader.prototype._getAllUnloadedDependencies = function (dependencies) {\n        var loadStateMap = this._loadState;\n        var unloaded = {};\n        for (var id in dependencies) {\n            var dependency = dependencies[id];\n            var key = dependency.key || dependency;\n            if (key === exports.resourceScopeKey) {\n                continue;\n            }\n            var keyId = key.id;\n            if (!(keyId in loadStateMap)) {\n                loadStateMap[keyId] = true;\n                var isOptional = dependency.isOptional;\n                var handle = this._handleManager.getHandle(key);\n                if (handle) {\n                    var factory = handle.factory;\n                    if (factory.value) {\n                        var factoryDependencies = factory.value.dependencies;\n                        var unloadedDependencies = factoryDependencies ? this._getAllUnloadedDependencies(factoryDependencies) : {};\n                        if (!(unloadedDependencies instanceof Error)) {\n                            ObjectUtil_1.default.extend(unloaded, unloadedDependencies);\n                        }\n                        else if (!isOptional) {\n                            return unloadedDependencies;\n                        }\n                    }\n                    else if (!factory.loader) {\n                        return new Error(key.toString() + \" is being loaded, but no loader was defined.\");\n                    }\n                    else {\n                        unloaded[keyId] = factory;\n                    }\n                }\n                else if (!isOptional) {\n                    return new Error(key.toString() + \" is being loaded, but has not been exposed by a parent scope.\");\n                }\n            }\n        }\n        return unloaded;\n    };\n    return ResourceLoader;\n}());\nvar ResourceConsumer = (function () {\n    function ResourceConsumer(handleManager) {\n        this._handleManager = handleManager;\n    }\n    ResourceConsumer.prototype.consume = function (key, isOptional, scopeOptions) {\n        var result = this._getValidHandle(key, []);\n        if (!(result instanceof Error)) {\n            return result.getInstance(key, scopeOptions);\n        }\n        else if (!isOptional) {\n            throw result;\n        }\n    };\n    ResourceConsumer.prototype.resolve = function (dependencies, scopeOptions) {\n        var result = {};\n        for (var id in dependencies) {\n            var dependency = dependencies[id];\n            if ((dependency.key || dependency) === exports.resourceScopeKey) {\n                result[id] = this._handleManager.getResourceScope(scopeOptions);\n                continue;\n            }\n            var handle = this._getValidHandle(dependency, []);\n            if (!(handle instanceof Error)) {\n                result[id] = handle.getInstance(dependency.key || dependency, scopeOptions);\n            }\n            else if (!dependency.isOptional) {\n                throw handle;\n            }\n        }\n        return result;\n    };\n    ResourceConsumer.prototype.isExposed = function (key) {\n        return !(this._getValidHandle(key, []) instanceof Error);\n    };\n    ResourceConsumer.prototype._getValidHandle = function (resourceDependency, stack) {\n        var key = resourceDependency.key || resourceDependency;\n        var keyId = key.id;\n        if (stack.indexOf(key) >= 0) {\n            // Circular reference will *always* throw, even on isExposed.\n            throw new Error(key.toString() + \" has a circular dependency.\");\n        }\n        // Check the cache first\n        var handleManager = this._handleManager;\n        var localHandle = handleManager.getLocalInstanceHandle(keyId);\n        if (localHandle) {\n            return localHandle;\n        }\n        var handle = localHandle || handleManager.getHandle(key);\n        if (!handle) {\n            return new Error(key.toString() + \" is being consumed, but has not been exposed by a parent scope.\");\n        }\n        var factoryEntry = handle.factory;\n        var factory = factoryEntry.value;\n        if (!factory) {\n            return new Error(key.toString() + \" is being consumed synchronously, but was exposed asynchronously and has not been loaded.\");\n        }\n        // Find the highest possible scope at which an instance of T can be stored.\n        stack.push(key);\n        var instanceManager = handle.manager;\n        var targetManager = key.useNarrowestScope ? handleManager : instanceManager || factoryEntry.manager;\n        var dependencies = factory.dependencies || {};\n        for (var id in dependencies) {\n            var dependency = dependencies[id];\n            if ((dependency.key || dependency) === exports.resourceScopeKey) {\n                continue;\n            }\n            // Recurse on dependencies.\n            var dependencyHandle = this._getValidHandle(dependency, stack);\n            if (dependencyHandle instanceof Error) {\n                if (!dependency.isOptional) {\n                    stack.pop();\n                    return dependencyHandle;\n                }\n            }\n            else if (dependencyHandle.manager.isDescendantOf(targetManager)) {\n                targetManager = dependencyHandle.manager;\n            }\n        }\n        stack.pop();\n        if (!instanceManager || instanceManager !== targetManager) {\n            // Need a new handle.\n            handle = new Handle(factoryEntry, targetManager);\n            // Place on targetManager, so that other levels can reuse\n            targetManager.handles[keyId] = handle;\n        }\n        return handleManager.handles[keyId] = handle;\n    };\n    return ResourceConsumer;\n}());\nvar ResourceScope = (function () {\n    function ResourceScope(parentOrOptions, options) {\n        var parentOwner;\n        var handleManager;\n        if (parentOrOptions instanceof ResourceScope) {\n            handleManager = parentOrOptions._handleManager;\n            parentOwner = parentOrOptions._owner;\n        }\n        else if (parentOrOptions instanceof HandleManager) {\n            handleManager = parentOrOptions;\n        }\n        else {\n            options = parentOrOptions || options;\n        }\n        var scope = new Scope_1.default();\n        if (handleManager) {\n            if (handleManager.scope.isDisposed) {\n                throw new Error('Parent ResourceScope has already been disposed.');\n            }\n            handleManager.lock();\n            if (!handleManager.options.lockResourcesForChildren) {\n                this._getWritableHandleManager = this._fork;\n            }\n        }\n        this._handleManager = handleManager || (handleManager = scope.attach(new HandleManager(options)));\n        this._scope = scope;\n        var owner = options ? options.owner : '';\n        this._owner = parentOwner ? parentOwner + \" > \" + owner : owner;\n        if (DEBUG) {\n            log(\"new ResourceScope: '\" + owner + \"'\");\n        }\n    }\n    /**\n     * Obtains an instance of a resource with the given key exposed by either this scope\n     * or a parent. Throws if the resource is not found and isOptional is not set.\n     * @param key {ResourceKey} - a shared resource key corresponding to a specific named resource.\n     * @param isOptional {boolean} - if true, consuming an unexposed resource will return undefined\n     * @returns an instance of the resource, if available in this scope or a parent.\n     */\n    ResourceScope.prototype.consume = function (key, isOptional) {\n        if (DEBUG) {\n            logConsume(key, isOptional);\n        }\n        return this._handleManager.getConsumer().consume(key, isOptional, { owner: key.toString() });\n    };\n    /**\n     * Obtains an instance of a resource with the given key exposed by either this scope\n     * or a parent. Throws if the resource is not found and isOptional is not set.\n     * @param key {ResourceKey} - a shared resource key corresponding to a specific named resource.\n     * @param isOptional {boolean} - if true, consuming an unexposed resource will return undefined\n     * @returns a promise for an instance of the resource, if available in this scope or a parent.\n     */\n    ResourceScope.prototype.consumeAsync = function (key, isOptional) {\n        if (DEBUG) {\n            logConsume(key, isOptional);\n        }\n        var handleManager = this._handleManager;\n        return handleManager.getLoader().loadAllAsync({\n            resource: {\n                key: key,\n                isOptional: isOptional\n            }\n        }).then(function () {\n            return handleManager.getConsumer().consume(key, isOptional, { owner: key.toString() });\n        });\n    };\n    /**\n     * Ensures that the specified dependencies have been loaded for synchronous consumption.\n     * @param dependencies {IResourceDependencies} - the dependencies to load.\n     * @returns a promise that will complete when the specified resources are available.\n     */\n    ResourceScope.prototype.load = function (dependencies) {\n        return this._handleManager.getLoader().loadAllAsync(dependencies);\n    };\n    /**\n     * Exposes an asynchronous loader for a resource with the given type-safe key.\n     * @param key {ResourceKey} - a shared resource key corresponding to a specific named resource.\n     * @param loader - the object that can asynchronously load a factory of the desired type\n     */\n    ResourceScope.prototype.exposeAsync = function (key, loader) {\n        this._expose(key, {\n            loader: loader\n        });\n    };\n    /**\n     * Exposes a factory for a resource with the given type-safe key.\n     * @param key {ResourceKey} - a shared resource key corresponding to a specific named resource.\n     * @param factory - the factory that will construct instances when required by this or any child scope.\n     */\n    ResourceScope.prototype.exposeFactory = function (key, factory) {\n        this._expose(key, {\n            value: factory\n        });\n    };\n    /**\n     * Exposes a resource with the given type-safe key.\n     * @param key {ResourceKey} - a shared resource key corresponding to a specific named resource.\n     * @param instance - the instance of the resource to use within this scope.\n     */\n    ResourceScope.prototype.expose = function (key, instance) {\n        if (DEBUG) {\n            logExpose(key, this._owner, instance);\n        }\n        this._expose(key, {\n            value: new ConstantResourceFactory(instance)\n        }, instance);\n        return instance;\n    };\n    /**\n     * Hides any resources exposed by parent scopes for the specified key.\n     * @param key {ResourceKey} - a shared resource key corresponding to a specific named resource.\n     */\n    ResourceScope.prototype.block = function (key) {\n        this._handleManager = this._getWritableHandleManager().block(key);\n    };\n    /**\n     * Re-exposes the currently exposed resource at the specified key at the current resource scope.\n     * The effect of this is that the lifetime of instances created by the resource system that depend on the\n     * specific key will not exceed the lifetime of this resource scope.\n     * @param key {ResourceKey} - a shared resource key corresponding to a specific named resource.\n     */\n    ResourceScope.prototype.bind = function (key) {\n        this._handleManager = this._getWritableHandleManager().bind(key);\n    };\n    /**\n     * Checks if a given resource key is exposed in the resource scope (including in parent scopes).\n     * @param key {ResourceKey} - a shared resource key corresponding to a specific named resource.\n     * @return {boolean}\n     */\n    ResourceScope.prototype.isExposed = function (key) {\n        if (DEBUG) {\n            logConsume(key, true);\n        }\n        var handleManager = this._handleManager;\n        return !handleManager.isDisposed && handleManager.getConsumer().isExposed(key);\n    };\n    /**\n     * Produces an alternate constructor for the given type which pre-injects the instance with resources\n     * before invoking the real constructor.\n     * This function preserves the original argument types for the constructor, allowing validation\n     * of arguments.\n     * @param type - the type of object for which to create an injected constructor.\n     * @returns an injected version of the original constructor for the type.\n     */\n    ResourceScope.prototype.injected = function (type, options) {\n        if (options === void 0) { options = {}; }\n        var injectChildResourceScope = options.injectChildResourceScope;\n        var childOptions = {\n            owner: options.owner || type.name\n        };\n        var resources = injectChildResourceScope ? this._scope.attach(new ResourceScope(this, childOptions)) : this;\n        var Injected = function () {\n            this.resources = resources;\n            var instance = type.apply(this, arguments) || this;\n            if (injectChildResourceScope) {\n                Disposable_1.hook(instance, disposeInstanceResources);\n            }\n            return instance;\n        };\n        if (DEBUG) {\n            // This pattern results in the correct type being displayed in the debugger\n            var wrappedConstructor_2 = Injected;\n            Injected = function () {\n                logBeginConstruction(type, 'Resources.injected');\n                var instance = wrappedConstructor_2.apply(Object.create(type.prototype), arguments);\n                logEndConstruction(type, 'Resources.injected');\n                return instance;\n            };\n        }\n        Injected.prototype = type.prototype;\n        return Injected;\n    };\n    ResourceScope.prototype.resolved = function (type, dependencies) {\n        var finalDependencies = ObjectUtil_1.default.extend(ObjectUtil_1.default.extend({}, type.dependencies), dependencies);\n        var resolvedDependencies = this._handleManager.getConsumer().resolve(finalDependencies);\n        return getResolvedConstructor(type, resolvedDependencies);\n    };\n    ResourceScope.prototype.resolvedAsync = function (type, dependencies) {\n        var _this = this;\n        dependencies = type.dependencies || dependencies;\n        return this._handleManager.getLoader().loadAllAsync(dependencies).then(function () { return _this.resolved(type, dependencies); });\n    };\n    /**\n     * Disposes this resource scope and any resources bound to this scope's lifetime.\n     */\n    ResourceScope.prototype.dispose = function () {\n        this._scope.dispose();\n    };\n    ResourceScope.prototype._expose = function (key, factoryInfo, instance) {\n        this._handleManager = this._getWritableHandleManager().expose(key, factoryInfo, instance);\n    };\n    // These methods are to support legacy call patterns by imitating old behavior\n    ResourceScope.prototype._getWritableHandleManager = function () {\n        return this._handleManager;\n    };\n    ResourceScope.prototype._fork = function () {\n        delete this._getWritableHandleManager;\n        if (DEBUG) {\n            log(\"Fork: '\" + this._owner + \"'\");\n        }\n        return this._scope.attach(new HandleManager(this._handleManager));\n    };\n    return ResourceScope;\n}());\nexports.ResourceScope = ResourceScope;\nfunction disposeInstanceResources() {\n    this.resources.dispose();\n}\nif (DEBUG) {\n    var getTraceState_1 = function () {\n        return window['__ResourceTraceState'];\n    };\n    logBeginConstruction = function (type, wrapperType) {\n        var traceState = getTraceState_1();\n        if (traceState) {\n            var typeName = type['name'];\n            var stack = traceState.stack, types = traceState.types;\n            var parent_1 = stack[stack.length - 1] || '_root';\n            (types[parent_1] || (types[parent_1] = {}))[typeName] = wrapperType;\n            if (!(typeName in types)) {\n                types[typeName] = {};\n            }\n        }\n    };\n    logEndConstruction = function (type, wrapperType) {\n        var traceState = getTraceState_1();\n        if (traceState) {\n            traceState.stack.pop();\n        }\n    };\n    logConsume = function (key, isOptional) {\n        var traceState = getTraceState_1();\n        if (traceState) {\n            var stack = traceState.stack, types = traceState.types;\n            var parent_2 = stack[stack.length - 1] || '_root';\n            (types[parent_2] || (types[parent_2] = {}))[isOptional ? key.id + \"?\" : key.id] = key.name;\n        }\n    };\n    logExpose = function (key, owner, instance) {\n        var traceState = getTraceState_1();\n        if (traceState) {\n            var typeName = instance && instance.constructor['name'];\n            var exposed = traceState.exposed;\n            (exposed[owner] || (exposed[owner] = [])).push({\n                id: key.id,\n                name: key.name,\n                type: typeName\n            });\n        }\n    };\n    log = function (message) {\n        var traceState = getTraceState_1();\n        if (traceState) {\n            traceState.log.push(message);\n        }\n    };\n}\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.default = ResourceScope;\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// D:/agent/1/_work/24/s/common/~/npmx-sp-pages/~/@ms/odsp-utilities/lib/resources/ResourceScope.js\n// module id = 86\n// module chunks = 0\n\n\n// WEBPACK FOOTER //\n// webpack:///D:/agent/1/_work/24/s/common/~/npmx-sp-pages/~/@ms/odsp-utilities/lib/resources/ResourceScope.js","/**\n * This file was originally ported from WinJS.\n */\n\"use strict\";\nvar __extends = (this && this.__extends) || function (d, b) {\n    for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p];\n    function __() { this.constructor = d; }\n    d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n};\nvar Async_1 = require('./Async');\nvar EventGroup_1 = require('../events/EventGroup');\nvar async = new Async_1.default();\nfunction doneHandler(value) {\n    \"use strict\";\n    async.setImmediate(function () {\n        throw value;\n    });\n}\nvar errorET = \"error\";\nvar canceledName = \"Canceled\";\nvar events;\n//\n// Global error counter, for each error which enters the system we increment this once and then\n// the error number travels with the error as it traverses the tree of potential handlers.\n//\n// When someone has registered to be told about error [using EventGroup.on(Promise, 'error')] promises\n// which are in error will get tagged with a ._errorId field. This tagged field is the\n// contract by which nested promises with errors will be identified as chaining for the\n// purposes of the callonerror semantics. If a nested promise in error is encountered without\n// a ._errorId it will be assumed to be foreign and treated as an interop boundary and\n// a new error id will be minted.\n//\nvar error_number = 1;\n;\nvar state_created; // -> working\nvar state_working; // -> error | error_notify | success | success_notify | canceled | waiting\nvar state_waiting; // -> error | error_notify | success | success_notify | waiting_canceled\nvar state_waiting_canceled; // -> error | error_notify | success | success_notify | canceling\nvar state_canceled; // -> error | error_notify | success | success_notify | canceling\nvar state_canceling; // -> error_notify\nvar state_success_notify; // -> success\nvar state_success; // -> .\nvar state_error_notify; // -> error\nvar state_error; // -> .\n// Noop function, used in the various states to indicate that they don't support a given\n// message. Named with the somewhat cute name '_' because it reads really well in the states.\nfunction _() {\n    \"use strict\";\n}\n// Initial state\n//\nstate_created = {\n    name: \"created\",\n    enter: function (promise) {\n        promise._setState(state_working);\n    },\n    cancel: _,\n    done: _,\n    then: _,\n    _completed: _,\n    _error: _,\n    _notify: _,\n    _setCompleteValue: _,\n    _setErrorValue: _\n};\n// Ready state, waiting for a message (completed/error), able to be canceled\n//\nstate_working = {\n    name: \"working\",\n    enter: _,\n    cancel: function (promise) {\n        promise._setState(state_canceled);\n    },\n    done: done,\n    then: then,\n    _completed: completed,\n    _error: error,\n    _notify: _,\n    _setCompleteValue: setCompleteValue,\n    _setErrorValue: setErrorValue\n};\n// Waiting state, if a promise is completed with a value which is itself a promise\n// (has a then() method) it signs up to be informed when that child promise is\n// fulfilled at which point it will be fulfilled with that value.\n//\nstate_waiting = {\n    name: \"waiting\",\n    enter: function (promise) {\n        var waitedUpon = promise._value;\n        // We can special case our own intermediate promises which are not in a\n        //  terminal state by just pushing this promise as a listener without\n        //  having to create new indirection functions\n        if (waitedUpon instanceof ThenPromise &&\n            waitedUpon._state !== state_error &&\n            waitedUpon._state !== state_success) {\n            pushListener(waitedUpon, { promise: promise });\n        }\n        else {\n            var error_1 = function (value) {\n                if (waitedUpon._errorId) {\n                    promise._chainedError(value, waitedUpon);\n                }\n                else {\n                    // Because this is an interop boundary we want to indicate that this\n                    //  error has been handled by the promise infrastructure before we\n                    //  begin a new handling chain.\n                    //\n                    callonerror(promise, value, detailsForHandledError, waitedUpon, error_1);\n                    promise._error(value);\n                }\n            };\n            error_1.handlesOnError = true;\n            waitedUpon.then(promise._completed.bind(promise), error_1);\n        }\n    },\n    cancel: function (promise) {\n        promise._setState(state_waiting_canceled);\n    },\n    done: done,\n    then: then,\n    _completed: completed,\n    _error: error,\n    _notify: _,\n    _setCompleteValue: setCompleteValue,\n    _setErrorValue: setErrorValue\n};\n// Waiting canceled state, when a promise has been in a waiting state and receives a\n// request to cancel its pending work it will forward that request to the child promise\n// and then waits to be informed of the result. This promise moves itself into the\n// canceling state but understands that the child promise may instead push it to a\n// different state.\n//\nstate_waiting_canceled = {\n    name: \"waiting_canceled\",\n    enter: function (promise) {\n        // Initiate a transition to canceling. Triggering a cancel on the promise\n        // that we are waiting upon may result in a different state transition\n        // before the state machine pump runs again.\n        promise._setState(state_canceling);\n        var waitedUpon = promise._value;\n        if (waitedUpon.cancel) {\n            waitedUpon.cancel();\n        }\n    },\n    cancel: _,\n    done: done,\n    then: then,\n    _completed: completed,\n    _error: error,\n    _notify: _,\n    _setCompleteValue: setCompleteValue,\n    _setErrorValue: setErrorValue\n};\n// Canceled state, moves to the canceling state and then tells the promise to do\n// whatever it might need to do on cancelation.\n//\nstate_canceled = {\n    name: \"canceled\",\n    enter: function (promise) {\n        // Initiate a transition to canceling. The _cancelAction may change the state\n        // before the state machine pump runs again.\n        promise._setState(state_canceling);\n        promise._cancelAction();\n    },\n    cancel: _,\n    done: done,\n    then: then,\n    _completed: completed,\n    _error: error,\n    _notify: _,\n    _setCompleteValue: setCompleteValue,\n    _setErrorValue: setErrorValue\n};\n// Canceling state, commits to the promise moving to an error state with an error\n// object whose 'name' and 'message' properties contain the string \"Canceled\"\n//\nstate_canceling = {\n    name: \"canceling\",\n    enter: function (promise) {\n        var error = new Error(canceledName);\n        error.name = error.message;\n        error[\"_handled\"] = true;\n        promise._value = error;\n        promise._setState(state_error_notify);\n    },\n    cancel: _,\n    done: _,\n    then: _,\n    _completed: _,\n    _error: _,\n    _notify: _,\n    _setCompleteValue: _,\n    _setErrorValue: _\n};\n// Success notify state, moves a promise to the success state and notifies all children\n//\nstate_success_notify = {\n    name: \"complete_notify\",\n    enter: function (promise) {\n        promise.done = CompletePromise.prototype.done;\n        promise.then = CompletePromise.prototype.then;\n        if (promise._listeners) {\n            var queue = [promise];\n            var p = void 0;\n            while (queue.length) {\n                p = queue.shift();\n                p._state._notify(p, queue);\n            }\n        }\n        promise._setState(state_success);\n    },\n    cancel: _,\n    done: null,\n    then: null,\n    _completed: _,\n    _error: _,\n    _notify: notifySuccess,\n    _setCompleteValue: _,\n    _setErrorValue: _\n};\n// Success state, moves a promise to the success state and does NOT notify any children.\n// Some upstream promise is owning the notification pass.\n//\nstate_success = {\n    name: \"success\",\n    enter: function (promise) {\n        promise.done = CompletePromise.prototype.done;\n        promise.then = CompletePromise.prototype.then;\n        promise._cleanupAction();\n    },\n    cancel: _,\n    done: null,\n    then: null,\n    _completed: _,\n    _error: _,\n    _notify: notifySuccess,\n    _setCompleteValue: _,\n    _setErrorValue: _\n};\n// Error notify state, moves a promise to the error state and notifies all children\n//\nstate_error_notify = {\n    name: \"error_notify\",\n    enter: function (promise) {\n        promise.done = ErrorPromise.prototype.done;\n        promise.then = ErrorPromise.prototype.then;\n        if (promise._listeners) {\n            var queue = [promise];\n            var p = void 0;\n            while (queue.length) {\n                p = queue.shift();\n                p._state._notify(p, queue);\n            }\n        }\n        promise._setState(state_error);\n    },\n    cancel: _,\n    done: null,\n    then: null,\n    _completed: _,\n    _error: _,\n    _notify: notifyError,\n    _setCompleteValue: _,\n    _setErrorValue: _\n};\n// Error state, moves a promise to the error state and does NOT notify any children.\n// Some upstream promise is owning the notification pass.\n//\nstate_error = {\n    name: \"error\",\n    enter: function (promise) {\n        promise.done = ErrorPromise.prototype.done;\n        promise.then = ErrorPromise.prototype.then;\n        promise._cleanupAction();\n    },\n    cancel: _,\n    done: null,\n    then: null,\n    _completed: _,\n    _error: _,\n    _notify: notifyError,\n    _setCompleteValue: _,\n    _setErrorValue: _\n};\n//\n// The statemachine implementation follows a very particular pattern, the states are specified\n// as static stateless bags of functions which are then indirected through the state machine\n// instance (a Promise). As such all of the functions on each state have the promise instance\n// passed to them explicitly as a parameter and the Promise instance members do a little\n// dance where they indirect through the state and insert themselves in the argument list.\n//\n// We could instead call directly through the promise states however then every caller\n// would have to remember to do things like pumping the state machine to catch state transitions.\n//\n//\n// Implementations of shared state machine code.\n//\nfunction completed(promise, value) {\n    \"use strict\";\n    var targetState;\n    if (value && typeof value === \"object\" && typeof value.then === \"function\") {\n        targetState = state_waiting;\n    }\n    else {\n        targetState = state_success_notify;\n    }\n    promise._value = value;\n    promise._setState(targetState);\n}\nfunction createErrorDetails(exception, error, promise, id, parent, handler) {\n    \"use strict\";\n    return {\n        exception: exception,\n        error: error,\n        promise: promise,\n        handler: handler,\n        id: id,\n        parent: parent\n    };\n}\nfunction detailsForHandledError(promise, errorValue, context, handler) {\n    \"use strict\";\n    var exception = context._isException;\n    var errorId = context._errorId;\n    return createErrorDetails(exception ? errorValue : null, exception ? null : errorValue, promise, errorId, context, handler);\n}\nfunction detailsForChainedError(promise, errorValue, context) {\n    \"use strict\";\n    var exception = context._isException;\n    var errorId = context._errorId;\n    setErrorInfo(promise, errorId, exception);\n    return createErrorDetails(exception ? errorValue : null, exception ? null : errorValue, promise, errorId, context);\n}\nfunction detailsForError(promise, errorValue) {\n    \"use strict\";\n    var errorId = ++error_number;\n    setErrorInfo(promise, errorId);\n    return createErrorDetails(null, errorValue, promise, errorId);\n}\nfunction detailsForException(promise, exceptionValue) {\n    \"use strict\";\n    var errorId = ++error_number;\n    setErrorInfo(promise, errorId, true);\n    return createErrorDetails(exceptionValue, null, promise, errorId);\n}\nfunction done(promise, onComplete, onError) {\n    \"use strict\";\n    pushListener(promise, { c: onComplete, e: onError });\n}\nfunction error(promise, value, onerrorDetails, context) {\n    \"use strict\";\n    promise._value = value;\n    callonerror(promise, value, onerrorDetails, context);\n    promise._setState(state_error_notify);\n}\nfunction notifySuccess(promise, queue) {\n    \"use strict\";\n    var value = promise._value;\n    var listeners = promise._listeners;\n    if (!listeners) {\n        return;\n    }\n    promise._listeners = null;\n    var i;\n    var len;\n    for (i = 0, len = Array.isArray(listeners) ? listeners.length : 1; i < len; i++) {\n        var listener = len === 1 ? listeners : listeners[i];\n        var onComplete = listener.c;\n        var target = listener.promise;\n        if (target) {\n            try {\n                target._setCompleteValue(onComplete ? onComplete(value) : value);\n            }\n            catch (ex) {\n                target._setExceptionValue(ex);\n            }\n            if (target._state !== state_waiting && target._listeners) {\n                queue.push(target);\n            }\n        }\n        else {\n            CompletePromise.prototype.done.call(promise, onComplete);\n        }\n    }\n}\nfunction notifyError(promise, queue) {\n    \"use strict\";\n    var value = promise._value;\n    var listeners = promise._listeners;\n    if (!listeners) {\n        return;\n    }\n    promise._listeners = null;\n    var i;\n    var len;\n    for (i = 0, len = Array.isArray(listeners) ? listeners.length : 1; i < len; i++) {\n        var listener = len === 1 ? listeners : listeners[i];\n        var onError = listener.e;\n        var target = listener.promise;\n        if (target) {\n            var asyncCallbackStarted = false;\n            try {\n                if (onError) {\n                    asyncCallbackStarted = true;\n                    if (!onError.handlesOnError) {\n                        callonerror(target, value, detailsForHandledError, promise, onError);\n                    }\n                    target._setCompleteValue(onError(value));\n                }\n                else {\n                    target._setChainedErrorValue(value, promise);\n                }\n            }\n            catch (ex) {\n                target._setExceptionValue(ex);\n            }\n            if (target._state !== state_waiting && target._listeners) {\n                queue.push(target);\n            }\n        }\n        else {\n            ErrorPromise.prototype.done.call(promise, null, onError);\n        }\n    }\n}\nfunction callonerror(promise, value, onerrorDetailsGenerator, context, handler) {\n    \"use strict\";\n    if (value instanceof Error && value.message === canceledName) {\n        return;\n    }\n    events.raise(errorET, onerrorDetailsGenerator(promise, value, context, handler));\n}\nfunction pushListener(promise, listener) {\n    \"use strict\";\n    var listeners = promise._listeners;\n    if (listeners) {\n        // We may have either a single listener (which will never be wrapped in an array)\n        // or 2+ listeners (which will be wrapped). Since we are now adding one more listener\n        // we may have to wrap the single listener before adding the second.\n        listeners = Array.isArray(listeners) ? listeners : [listeners];\n        listeners.push(listener);\n    }\n    else {\n        listeners = listener;\n    }\n    promise._listeners = listeners;\n}\n// The difference beween setCompleteValue()/setErrorValue() and complete()/error() is that setXXXValue() moves\n// a promise directly to the success/error state without starting another notification pass (because one\n// is already ongoing).\nfunction setErrorInfo(promise, errorId, isException) {\n    \"use strict\";\n    promise._isException = isException || false;\n    promise._errorId = errorId;\n}\nfunction setErrorValue(promise, value, onerrorDetails, context) {\n    \"use strict\";\n    promise._value = value;\n    callonerror(promise, value, onerrorDetails, context);\n    promise._setState(state_error);\n}\nfunction setCompleteValue(promise, value) {\n    \"use strict\";\n    var targetState;\n    if (value && typeof value === \"object\" && typeof value.then === \"function\") {\n        targetState = state_waiting;\n    }\n    else {\n        targetState = state_success;\n    }\n    promise._value = value;\n    promise._setState(targetState);\n}\nfunction then(promise, onComplete, onError) {\n    \"use strict\";\n    var result = new ThenPromise(promise);\n    pushListener(promise, { promise: result, c: onComplete, e: onError });\n    return result;\n}\n//\n// Slim promise implementations for already completed promises, these are created\n// under the hood on synchronous completion paths as well as by Promise.wrap\n// and Promise.wrapError.\n//\nvar ErrorPromise = (function () {\n    function ErrorPromise(value, errorFunc) {\n        if (errorFunc === void 0) { errorFunc = detailsForError; }\n        this._value = value;\n        callonerror(this, value, errorFunc);\n    }\n    ErrorPromise.prototype.cancel = function () {\n        /* No-op */\n    };\n    ErrorPromise.prototype.done = function (unused, onError) {\n        var value = this._value;\n        if (onError) {\n            try {\n                if (!onError.handlesOnError) {\n                    callonerror(null, value, detailsForHandledError, this, onError);\n                }\n                var result = onError(value);\n                if (result && typeof result === \"object\" && typeof result.done === \"function\") {\n                    // If a promise is returned we need to wait on it.\n                    result.done();\n                }\n                return;\n            }\n            catch (ex) {\n                value = ex;\n            }\n        }\n        if (value instanceof Error && value.message === canceledName) {\n            // suppress cancel\n            return;\n        }\n        // force the exception to be thrown asyncronously to avoid any try/catch blocks\n        //\n        doneHandler(value);\n    };\n    ErrorPromise.prototype.then = function (unused, onError) {\n        // If the promise is already in a error state and no error handler is provided\n        // we optimize by simply returning the promise instead of creating a new one.\n        //\n        if (!onError) {\n            return this;\n        }\n        var result;\n        var value = this._value;\n        try {\n            if (!onError.handlesOnError) {\n                callonerror(null, value, detailsForHandledError, this, onError);\n            }\n            result = new CompletePromise(onError(value));\n        }\n        catch (ex) {\n            // If the value throw from the error handler is the same as the value\n            // provided to the error handler then there is no need for a new promise.\n            //\n            if (ex === value) {\n                result = this;\n            }\n            else {\n                result = new ExceptionPromise(ex);\n            }\n        }\n        return result;\n    };\n    return ErrorPromise;\n}());\nvar ExceptionPromise = (function (_super) {\n    __extends(ExceptionPromise, _super);\n    function ExceptionPromise(value) {\n        _super.call(this, value, detailsForException);\n    }\n    return ExceptionPromise;\n}(ErrorPromise));\nvar CompletePromise = (function () {\n    function CompletePromise(value) {\n        if (value && typeof value === \"object\" && typeof value.then === \"function\") {\n            var result = new ThenPromise(null);\n            result._setCompleteValue(value);\n            return result;\n        }\n        this._value = value;\n    }\n    CompletePromise.prototype.cancel = function () {\n        /* No-op */\n    };\n    CompletePromise.prototype.done = function (onComplete) {\n        if (!onComplete) {\n            return;\n        }\n        try {\n            var result = onComplete(this._value);\n            if (result && typeof result === \"object\" && typeof result.done === \"function\") {\n                result.done();\n            }\n        }\n        catch (ex) {\n            // force the exception to be thrown asynchronously to avoid any try/catch blocks\n            doneHandler(ex);\n        }\n    };\n    CompletePromise.prototype.then = function (onComplete) {\n        var resultPromise;\n        try {\n            // If the value returned from the completion handler is the same as the value\n            // provided to the completion handler then there is no need for a new promise.\n            //\n            var newValue = onComplete ? onComplete(this._value) : this._value;\n            resultPromise = newValue === this._value ? this : new CompletePromise(newValue);\n        }\n        catch (ex) {\n            resultPromise = new ExceptionPromise(ex);\n        }\n        return resultPromise;\n    };\n    return CompletePromise;\n}());\nfunction timeout(timeoutMS) {\n    \"use strict\";\n    var id;\n    return new Promise(function (c) {\n        if (timeoutMS) {\n            id = async.setTimeout(c, timeoutMS);\n        }\n        else {\n            async.setImmediate(c);\n        }\n    }, function () {\n        if (id) {\n            async.clearTimeout(id);\n        }\n    });\n}\nfunction timeoutWithPromise(timeout, promise) {\n    \"use strict\";\n    var cancelPromise = function () { promise.cancel(); };\n    var cancelTimeout = function () { timeout.cancel(); };\n    timeout.then(cancelPromise);\n    promise.then(cancelTimeout, cancelTimeout);\n    return promise;\n}\nvar staticCanceledPromise;\nvar Promise = (function () {\n    function Promise(init, oncancel) {\n        this._init(init, oncancel);\n    }\n    Object.defineProperty(Promise, \"cancel\", {\n        get: function () {\n            return (staticCanceledPromise = staticCanceledPromise || new ErrorPromise(canceledName));\n        },\n        enumerable: true,\n        configurable: true\n    });\n    /**\n     * Returns a promise that is fulfilled when one of the input promises\n     * has been fulfilled.\n     */\n    Promise.any = function (values) {\n        return new Promise(function (complete, error) {\n            var keys = Object.keys(values);\n            if (keys.length === 0) {\n                complete();\n            }\n            var canceled = 0;\n            keys.forEach(function (key) {\n                Promise.as(values[key]).then(function () { complete({ key: key, value: values[key] }); }, function (e) {\n                    if (e instanceof Error && e.name === canceledName) {\n                        if ((++canceled) === keys.length) {\n                            complete(Promise.cancel);\n                        }\n                        return;\n                    }\n                    error({ key: key, value: values[key] });\n                });\n            });\n        }, function () {\n            var keys = Object.keys(values);\n            keys.forEach(function (key) {\n                var promise = Promise.as(values[key]);\n                if (typeof promise.cancel === \"function\") {\n                    promise.cancel();\n                }\n            });\n        });\n    };\n    Promise.as = function (value) {\n        var returnValue;\n        if (value && typeof value === \"object\" && typeof value.then === \"function\") {\n            returnValue = value;\n        }\n        else {\n            returnValue = new CompletePromise(value);\n        }\n        return returnValue;\n    };\n    /**\n     * Determines whether a value fulfills the promise contract.\n     */\n    Promise.is = function (value) {\n        return value && typeof value === \"object\" && typeof value.then === \"function\";\n    };\n    /**\n     * Determines whether an error value represents a promise cancellation.\n     */\n    Promise.isCanceled = function (e) {\n        return (e instanceof Error && e.name === canceledName);\n    };\n    Promise.all = function (values) {\n        return new Promise(function (complete, error) {\n            var keys = Object.keys(values);\n            var errors = Array.isArray(values) ? [] : {};\n            var results = Array.isArray(values) ? [] : {};\n            var undefineds = 0;\n            var pending = keys.length;\n            var argDone = function (key) {\n                if ((--pending) === 0) {\n                    var errorCount = Object.keys(errors).length;\n                    if (errorCount === 0) {\n                        complete(results);\n                    }\n                    else {\n                        var canceledCount_1 = 0;\n                        keys.forEach(function (key) {\n                            var e = errors[key];\n                            if (e instanceof Error && e.name === canceledName) {\n                                canceledCount_1++;\n                            }\n                        });\n                        if (canceledCount_1 === errorCount) {\n                            complete(Promise.cancel);\n                        }\n                        else {\n                            error(errors);\n                        }\n                    }\n                }\n            };\n            keys.forEach(function (key) {\n                var value = values[key];\n                if (value === undefined) {\n                    undefineds++;\n                }\n                else {\n                    Promise.then(value, function (value) { results[key] = value; argDone(key); }, function (value) { errors[key] = value; argDone(key); });\n                }\n            });\n            pending -= undefineds;\n            if (pending === 0) {\n                complete(results);\n                return;\n            }\n        }, function () {\n            Object.keys(values).forEach(function (key) {\n                var promise = Promise.as(values[key]);\n                if (typeof promise.cancel === \"function\") {\n                    promise.cancel();\n                }\n            });\n        });\n    };\n    Promise.then = function (value, onComplete, onError) {\n        return Promise.as(value).then(onComplete, onError);\n    };\n    Promise.thenEach = function (values, onComplete, onError) {\n        var result = Array.isArray(values) ? [] : {};\n        Object.keys(values).forEach(function (key) {\n            result[key] = Promise.as(values[key]).then(onComplete, onError);\n        });\n        return Promise.all(result);\n    };\n    Promise.serial = function (tasks) {\n        return tasks.reduce(function (previous, task) {\n            return previous.then(task);\n        }, Promise.wrap());\n    };\n    Promise.timeout = function (time, promise) {\n        var to = timeout(time);\n        return promise ? timeoutWithPromise(to, promise) : to;\n    };\n    Promise.wrap = function (value) {\n        var cp = new CompletePromise(value);\n        return cp;\n    };\n    /**\n     * Wraps a non-promise error value in a promise. You can use this function if you need\n     * to pass an error to a function that requires a promise.\n     */\n    Promise.wrapError = function (error) {\n        var ep = new ErrorPromise(error);\n        return ep;\n    };\n    /**\n     * Attempts to cancel the fulfillment of a promised value. If the promise hasn't\n     * already been fulfilled and cancellation is supported, the promise enters\n     * the error state with a value of Error(\"Canceled\").\n     */\n    Promise.prototype.cancel = function () {\n        this._state.cancel(this);\n        this._run();\n    };\n    /**\n     * Allows you to specify the work to be done on the fulfillment of the promised value,\n     * the error handling to be performed if the promise fails to fulfill\n     * a value.\n     *\n     * After the handlers have finished executing, this function throws any error that would have been returned\n     * from then() as a promise in the error state.\n     *\n     * @param onComplete The function to be called if the promise is fulfilled successfully with a value. The fulfilled value is passed as the single argument. If the value is null, the fulfilled value is returned. The value returned from the function becomes the fulfilled value of the promise returned by then. If an exception is thrown while executing the function, the promise returned by then moves into the error state.\n     * @param onError The function to be called if the promise is fulfilled with an error. The error is passed as the single argument. If it is null, the error is forwarded. The value returned from the function is the fulfilled value of the promise returned by then.\n     */\n    Promise.prototype.done = function (onComplete, onError) {\n        this._state.done(this, onComplete, onError);\n    };\n    Promise.prototype.then = function (onComplete, onError) {\n        return this._state.then(this, onComplete, onError);\n    };\n    Promise.prototype._init = function (init, oncancel) {\n        this._oncancel = oncancel;\n        this._setState(state_created);\n        this._run();\n        try {\n            var complete = this._completed.bind(this);\n            var error_2 = this._error.bind(this);\n            init(complete, error_2);\n        }\n        catch (ex) {\n            this._setExceptionValue(ex);\n        }\n    };\n    Promise.prototype._cancelAction = function () {\n        if (this._oncancel) {\n            try {\n                this._oncancel();\n            }\n            catch (ex) { }\n        }\n    };\n    Promise.prototype._cleanupAction = function () {\n        this._oncancel = null;\n    };\n    Promise.prototype._chainedError = function (value, context) {\n        var result = this._state._error(this, value, detailsForChainedError, context);\n        this._run();\n        return result;\n    };\n    Promise.prototype._completed = function (value) {\n        var result = this._state._completed(this, value);\n        this._run();\n        return result;\n    };\n    Promise.prototype._error = function (value) {\n        var result = this._state._error(this, value, detailsForError);\n        this._run();\n        return result;\n    };\n    Promise.prototype._setState = function (state) {\n        this._nextState = state;\n    };\n    Promise.prototype._setCompleteValue = function (value) {\n        this._state._setCompleteValue(this, value);\n        this._run();\n    };\n    Promise.prototype._setChainedErrorValue = function (value, context) {\n        var result = this._state._setErrorValue(this, value, detailsForChainedError, context);\n        this._run();\n        return result;\n    };\n    Promise.prototype._setExceptionValue = function (value) {\n        var result = this._state._setErrorValue(this, value, detailsForException);\n        this._run();\n        return result;\n    };\n    Promise.prototype._run = function () {\n        while (this._nextState) {\n            this._state = this._nextState;\n            this._nextState = null;\n            this._state.enter(this);\n        }\n    };\n    return Promise;\n}());\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.default = Promise;\nevents = new EventGroup_1.default(Promise);\nevents.declare(errorET);\n//\n// Internal implementation detail promise, ThenPromise is created when a promise needs\n// to be returned from a then() method.\n//\nvar ThenPromise = (function (_super) {\n    __extends(ThenPromise, _super);\n    function ThenPromise(creator) {\n        _super.call(this);\n        this._creator = creator;\n        this._initThen();\n    }\n    ThenPromise.prototype._init = function () {\n        // Override to do nothing.\n    };\n    ThenPromise.prototype._cancelAction = function () {\n        if (this._creator) {\n            this._creator.cancel();\n        }\n    };\n    ThenPromise.prototype._cleanupAction = function () {\n        this._creator = null;\n    };\n    ThenPromise.prototype._initThen = function () {\n        this._setState(state_created);\n        this._run();\n    };\n    return ThenPromise;\n}(Promise));\nvar SignalPromise = (function (_super) {\n    __extends(SignalPromise, _super);\n    function SignalPromise(cancel) {\n        _super.call(this);\n        this._oncancel = cancel;\n        this._initSignal();\n    }\n    SignalPromise.prototype._init = function () {\n        // Override to do nothing.\n    };\n    SignalPromise.prototype._cancelAction = function () {\n        if (this._oncancel) {\n            this._oncancel();\n        }\n    };\n    SignalPromise.prototype._cleanupAction = function () {\n        this._oncancel = null;\n    };\n    SignalPromise.prototype._initSignal = function () {\n        this._setState(state_created);\n        this._run();\n    };\n    return SignalPromise;\n}(Promise));\nexports.SignalPromise = SignalPromise;\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// D:/agent/1/_work/24/s/common/~/npmx-sp-pages/~/@ms/odsp-utilities/lib/async/Promise.js\n// module id = 87\n// module chunks = 0\n\n\n// WEBPACK FOOTER //\n// webpack:///D:/agent/1/_work/24/s/common/~/npmx-sp-pages/~/@ms/odsp-utilities/lib/async/Promise.js","\"use strict\";\nvar ErrorHelper_1 = require(\"../logging/ErrorHelper\");\n/** An instance of EventGroup allows anything with a handle to it to trigger events on it.\n *  If the target is an HTMLElement, the event will be attached to the element and can be\n *  triggered as usual (like clicking for onclick).\n *  The event can be triggered by calling EventGroup.raise() here. If the target is an\n *  HTMLElement, the event gets raised and is handled by the browser. Otherwise, it gets\n *  handled here in EventGroup, and the handler is called in the context of the parent\n *  (which is passed in in the constructor).\n */\nvar EventGroup = (function () {\n    /** parent: the context in which events attached to non-HTMLElements are called */\n    function EventGroup(parent) {\n        this._id = EventGroup._uniqueId++;\n        this._parent = parent;\n        this._eventRecords = [];\n    }\n    /** For IE8, bubbleEvent is ignored here and must be dealt with by the handler.\n     *  Events raised here by default have bubbling set to false and cancelable set to true.\n     *  This applies also to built-in events being raised manually here on HTMLElements,\n     *  which may lead to unexpected behavior if it differs from the defaults.\n     */\n    EventGroup.raise = function (target, eventName, eventArgs, bubbleEvent) {\n        var retVal;\n        if (EventGroup._isElement(target)) {\n            if (document.createEvent) {\n                var ev = document.createEvent('HTMLEvents');\n                ev.initEvent(eventName, bubbleEvent, true);\n                ev['args'] = eventArgs;\n                retVal = target.dispatchEvent(ev);\n            }\n            else if (document['createEventObject']) {\n                var evObj = document['createEventObject'](eventArgs);\n                // cannot set cancelBubble on evObj, fireEvent will overwrite it\n                target.fireEvent(\"on\" + eventName, evObj);\n            }\n        }\n        else {\n            while (target && retVal !== false) {\n                var events = target.__events__;\n                var eventRecords = events ? events[eventName] : null;\n                for (var id in eventRecords) {\n                    var eventRecordList = eventRecords[id];\n                    for (var listIndex = 0; retVal !== false && listIndex < eventRecordList.length; listIndex++) {\n                        var record = eventRecordList[listIndex];\n                        if (record.objectCallback) {\n                            retVal = record.objectCallback.call(record.parent, eventArgs);\n                        }\n                    }\n                }\n                // If the target has a parent, bubble the event up.\n                target = bubbleEvent ? target.parent : null;\n            }\n        }\n        return retVal;\n    };\n    EventGroup.isObserved = function (target, eventName) {\n        var events = target && target.__events__;\n        return !!events && !!events[eventName];\n    };\n    /** Check to see if the target has declared support of the given event. */\n    EventGroup.isDeclared = function (target, eventName) {\n        var declaredEvents = target && target.__declaredEvents;\n        return !!declaredEvents && !!declaredEvents[eventName];\n    };\n    EventGroup.stopPropagation = function (event) {\n        if (event.stopPropagation) {\n            event.stopPropagation();\n        }\n        else {\n            event.cancelBubble = true;\n        }\n    };\n    EventGroup._isElement = function (target) {\n        return !!target && (target instanceof HTMLElement || target.addEventListener);\n    };\n    EventGroup.prototype.dispose = function () {\n        if (!this._isDisposed) {\n            this._isDisposed = true;\n            this.off();\n            this._parent = null;\n        }\n    };\n    /** On the target, attach a set of events, where the events object is a name to function mapping. */\n    EventGroup.prototype.onAll = function (target, events, useCapture) {\n        for (var eventName in events) {\n            this.on(target, eventName, events[eventName], useCapture);\n        }\n    };\n    /** On the target, attach an event whose handler will be called in the context of the parent\n     * of this instance of EventGroup.\n     */\n    EventGroup.prototype.on = function (target, eventName, callback, useCapture) {\n        var _this = this;\n        if (eventName.indexOf(',') > -1) {\n            var events = eventName.split(/[ ,]+/);\n            for (var i = 0; i < events.length; i++) {\n                this.on(target, events[i], callback, useCapture);\n            }\n        }\n        else {\n            var parent = this._parent;\n            var eventRecord = {\n                target: target,\n                eventName: eventName,\n                parent: parent,\n                callback: callback,\n                objectCallback: null,\n                elementCallback: null,\n                useCapture: useCapture\n            };\n            // Initialize and wire up the record on the target, so that it can call the callback if the event fires.\n            var events_1 = (target.__events__ = target.__events__ || {});\n            events_1[eventName] = events_1[eventName] || {\n                count: 0\n            };\n            events_1[eventName][this._id] = events_1[eventName][this._id] || [];\n            events_1[eventName][this._id].push(eventRecord);\n            events_1[eventName].count++;\n            if (EventGroup._isElement(target)) {\n                var processElementEvent = function () {\n                    var args = [];\n                    for (var _i = 0; _i < arguments.length; _i++) {\n                        args[_i - 0] = arguments[_i];\n                    }\n                    if (_this._isDisposed) {\n                        return;\n                    }\n                    try {\n                        var result = callback.apply(parent, args);\n                        if (result === false && args[0] && args[0].preventDefault) {\n                            var e = args[0];\n                            e.preventDefault();\n                            e.cancelBubble = true;\n                        }\n                    }\n                    catch (e) {\n                        ErrorHelper_1.default.log(e);\n                    }\n                    return result;\n                };\n                eventRecord.elementCallback = processElementEvent;\n                if (target.addEventListener) {\n                    /* tslint:disable:ban-native-functions */\n                    target.addEventListener(eventName, processElementEvent, useCapture);\n                }\n                else if (target.attachEvent) {\n                    target.attachEvent(\"on\" + eventName, processElementEvent);\n                }\n            }\n            else {\n                var processObjectEvent = function () {\n                    var args = [];\n                    for (var _i = 0; _i < arguments.length; _i++) {\n                        args[_i - 0] = arguments[_i];\n                    }\n                    if (_this._isDisposed) {\n                        return;\n                    }\n                    return callback.apply(parent, args);\n                };\n                eventRecord.objectCallback = processObjectEvent;\n            }\n            // Remember the record locally, so that it can be removed.\n            this._eventRecords.push(eventRecord);\n        }\n    };\n    EventGroup.prototype.off = function (target, eventName, callback, useCapture) {\n        for (var i = 0; i < this._eventRecords.length; i++) {\n            var eventRecord = this._eventRecords[i];\n            if ((!target || target === eventRecord.target) &&\n                (!eventName || eventName === eventRecord.eventName) &&\n                (!callback || callback === eventRecord.callback) &&\n                ((typeof useCapture !== 'boolean') || useCapture === eventRecord.useCapture)) {\n                var events = eventRecord.target.__events__;\n                var targetArrayLookup = events[eventRecord.eventName];\n                var targetArray = targetArrayLookup ? targetArrayLookup[this._id] : null;\n                // We may have already target's entries, so check for null.\n                if (targetArray) {\n                    if (targetArray.length === 1 || !callback) {\n                        targetArrayLookup.count -= targetArray.length;\n                        delete events[eventRecord.eventName][this._id];\n                    }\n                    else {\n                        targetArrayLookup.count--;\n                        targetArray.splice(targetArray.indexOf(eventRecord), 1);\n                    }\n                    if (!targetArrayLookup.count) {\n                        delete events[eventRecord.eventName];\n                    }\n                }\n                if (eventRecord.elementCallback) {\n                    if (eventRecord.target.removeEventListener) {\n                        eventRecord.target.removeEventListener(eventRecord.eventName, eventRecord.elementCallback, eventRecord.useCapture);\n                    }\n                    else if (eventRecord.target.detachEvent) {\n                        eventRecord.target.detachEvent(\"on\" + eventRecord.eventName, eventRecord.elementCallback);\n                    }\n                }\n                this._eventRecords.splice(i--, 1);\n            }\n        }\n    };\n    /** Trigger the given event in the context of this instance of EventGroup. */\n    EventGroup.prototype.raise = function (eventName, eventArgs, bubbleEvent) {\n        return EventGroup.raise(this._parent, eventName, eventArgs, bubbleEvent);\n    };\n    /** Declare an event as being supported by this instance of EventGroup. */\n    EventGroup.prototype.declare = function (event) {\n        var declaredEvents = this._parent.__declaredEvents = this._parent.__declaredEvents || {};\n        if (typeof event === 'string') {\n            declaredEvents[event] = true;\n        }\n        else {\n            for (var i = 0; i < event.length; i++) {\n                declaredEvents[event[i]] = true;\n            }\n        }\n    };\n    EventGroup._uniqueId = 0;\n    return EventGroup;\n}());\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.default = EventGroup;\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// D:/agent/1/_work/24/s/common/~/npmx-sp-pages/~/@ms/odsp-utilities/lib/events/EventGroup.js\n// module id = 88\n// module chunks = 0\n\n\n// WEBPACK FOOTER //\n// webpack:///D:/agent/1/_work/24/s/common/~/npmx-sp-pages/~/@ms/odsp-utilities/lib/events/EventGroup.js","\"use strict\";\nvar HslColor_1 = require('./HslColor');\nvar RgbaColor_1 = require('./RgbaColor');\nvar Shades_1 = require('./Shades');\n/**\n * Utility class with static methods to work with Fabric-style themes.\n */\nvar FabricTheming = (function () {\n    function FabricTheming() {\n    }\n    /**\n     * Generates a palette of Fabric colors from a primary RGB color value.\n     * @param {RgbaColor} primaryRgb Primary RGB color used to generate a palette.\n     * @param {boolean} inverted Whether the theme is inverted, with a dark background and light foreground.\n     */\n    FabricTheming.generateFabricColors = function (primaryRgb, inverted) {\n        if (inverted === void 0) { inverted = false; }\n        var generatedShades = {\n            \"themeDarker\": Shades_1.Shades.Darkest,\n            \"themeDark\": Shades_1.Shades.Darker,\n            \"themeDarkAlt\": Shades_1.Shades.Darker,\n            \"themeLight\": Shades_1.Shades.Lighter,\n            \"themeLightAlt\": Shades_1.Shades.Lighter,\n            \"themeLighter\": Shades_1.Shades.Lightest,\n            \"themeLighterAlt\": Shades_1.Shades.Lightest,\n            \"themePrimary\": Shades_1.Shades.Unshaded,\n            \"themeAccent\": Shades_1.Shades.Unshaded,\n            \"themeSecondary\": Shades_1.Shades.Medium,\n            \"themeTertiary\": Shades_1.Shades.Lighter,\n            \"themeTertiaryAlt\": Shades_1.Shades.Lighter\n        };\n        // Expected color slots. Start each defaulting to null to avoid warnings about missing slots.\n        var colors = FabricTheming._getDefaultThemeTokenMap();\n        // Starting points for the generated palette.\n        var primaryColor = RgbaColor_1.default.fromRgba(primaryRgb.R, primaryRgb.G, primaryRgb.B);\n        for (var shadeName in generatedShades) {\n            var shade = generatedShades[shadeName];\n            if (inverted && shade !== Shades_1.Shades.Unshaded) {\n                shade = Shades_1.Shades.Darkest + Shades_1.Shades.Lightest - shade;\n            }\n            colors[shadeName] = Shades_1.getShade(primaryColor, shade);\n        }\n        var accent = colors[\"themeAccent\"];\n        colors[\"themeAccentTranslucent10\"] = accent ?\n            RgbaColor_1.default.fromRgba(accent.R, accent.G, accent.B, 0.1 * RgbaColor_1.default.maxComponent) : null;\n        // Handle neutral slots for inverted themes\n        if (inverted) {\n            var invertedText = '#f8f8f8'; // neutralLighterAlt\n            var invertedNeutralQuaternary = '#6b6b6b';\n            var invertedNeutralQuaternaryAlt = '#707070';\n            var invertedNeutralColors = {\n                'black': '#fff',\n                'blackTranslucent40': '#66ffffff',\n                'neutralDark': '#fff',\n                'neutralPrimary': invertedText,\n                'neutralPrimaryTranslucent50': '#7ff8f8f8',\n                'neutralPrimaryAlt': '#f4f4f4',\n                'neutralSecondary': '#eaeaea',\n                'neutralSecondaryAlt': '#c8c8c8',\n                'neutralTertiary': '#a6a6a6',\n                'neutralTertiaryAlt': '#767676',\n                'neutralQuaternary': invertedNeutralQuaternary,\n                'neutralQuaternaryAlt': invertedNeutralQuaternaryAlt,\n                'cmdbarSelected': invertedNeutralQuaternary,\n                'cmdbarSelectedHover': invertedNeutralQuaternaryAlt,\n                'neutralLight': '#666666',\n                'neutralLighter': '#333',\n                'neutralLighterAlt': '#212121',\n                'primaryText': invertedText,\n                'primaryBackground': '#000',\n                'white': '#000',\n                'whiteTranslucent40': '#66000000',\n                'error': '#f00',\n                'errorBackground': '#7e3333'\n            };\n            for (var neutralSlot in invertedNeutralColors) {\n                if (invertedNeutralColors.hasOwnProperty(neutralSlot)) {\n                    colors[neutralSlot] =\n                        RgbaColor_1.default.fromHtmlColor(invertedNeutralColors[neutralSlot]);\n                }\n            }\n        }\n        return colors;\n    };\n    /**\n     * Applies an Hsl delta to an HslColor to produce a new HslColor.\n     * @param {HslColor} primaryHsl Starting HSL color value.\n     * @param {number} hDelta Delta to apply to the hue.\n     * @param {number} sDelta Delta to apply to the saturation.\n     * @param {number} lDelta Delta to apply to the luminance.\n     */\n    FabricTheming.applyHslDelta = function (primaryHsl, hDelta, sDelta, lDelta) {\n        var hue = primaryHsl.hue - hDelta;\n        if (hue > 1 || hue < 0) {\n            hue = hue - Math.floor(hue);\n        }\n        var sat = primaryHsl.sat - sDelta;\n        if (sat > 1) {\n            sat = 1;\n        }\n        else if (sat < 0) {\n            sat = 0;\n        }\n        var lum = primaryHsl.lum - lDelta;\n        if (lum > 1) {\n            lum = 1;\n        }\n        else if (lum < 0) {\n            lum = 0;\n        }\n        var hslValue = new HslColor_1.default(hue, sat, lum);\n        return hslValue;\n    };\n    FabricTheming._getDefaultThemeTokenMap = function () {\n        return {\n            backgroundOverlay: null,\n            primaryBackground: null,\n            primaryText: null,\n            themeDarker: null,\n            themeDark: null,\n            themeDarkAlt: null,\n            themePrimary: null,\n            themeSecondary: null,\n            themeTertiary: null,\n            themeLight: null,\n            themeLighter: null,\n            themeLighterAlt: null,\n            black: null,\n            cmdbarSelected: null,\n            cmdbarSelectedHover: null,\n            neutralDark: null,\n            neutralPrimary: null,\n            neutralPrimaryAlt: null,\n            neutralPrimaryTranslucent50: null,\n            neutralSecondary: null,\n            neutralSecondaryAlt: null,\n            neutralTertiary: null,\n            neutralTertiaryAlt: null,\n            neutralQuaternary: null,\n            neutralQuaternaryAlt: null,\n            neutralLight: null,\n            neutralLighter: null,\n            neutralLighterAlt: null,\n            white: null,\n            blackTranslucent40: null,\n            whiteTranslucent40: null,\n            yellow: null,\n            yellowLight: null,\n            orange: null,\n            orangeLight: null,\n            redDark: null,\n            red: null,\n            magentaDark: null,\n            magenta: null,\n            magentaLight: null,\n            purpleDark: null,\n            purple: null,\n            purpleLight: null,\n            blueDark: null,\n            blueMid: null,\n            blue: null,\n            blueLight: null,\n            tealDark: null,\n            teal: null,\n            tealLight: null,\n            greenDark: null,\n            green: null,\n            greenLight: null,\n            error: null,\n            errorBackground: null,\n            success: null,\n            successBackground: null,\n            alert: null,\n            alertBackground: null,\n            infoBackground: null,\n            info: null,\n            orangeLighter: null\n        };\n    };\n    return FabricTheming;\n}());\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.default = FabricTheming;\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// D:/agent/1/_work/24/s/common/~/npmx-sp-pages/~/@ms/odsp-utilities/lib/theming/FabricTheming.js\n// module id = 89\n// module chunks = 0\n\n\n// WEBPACK FOOTER //\n// webpack:///D:/agent/1/_work/24/s/common/~/npmx-sp-pages/~/@ms/odsp-utilities/lib/theming/FabricTheming.js","\"use strict\";\nvar RgbaColor_1 = require('./RgbaColor');\n/**\n * A color represented by hue, saturation, luminance, and alpha (opacity) components.\n */\nvar HslColor = (function () {\n    /**\n     * Constructs a new HSL color object.\n     * @param {number} h The hue (between 0 and 1) of the color.\n     * @param {number} s The saturation (between 0 and 1) of the color.\n     * @param {number} l The luminance (between 0 and 1) of the color.\n     * @param {number} a The opacity (between 0 and 255) of the color.\n     */\n    function HslColor(h, s, l, a) {\n        function LimitNumberToUnitInterval(value) {\n            return Math.min(1.0, Math.max(0.0, value));\n        }\n        this.hue = LimitNumberToUnitInterval(h);\n        this.sat = LimitNumberToUnitInterval(s);\n        this.lum = LimitNumberToUnitInterval(l);\n        this.alpha = a == null ? RgbaColor_1.default.maxComponent : a;\n    }\n    /**\n     * Constructs an HslColor from an RgbaColor.\n     * @param {RgbaColor} color The color to convert to HSL.\n     */\n    HslColor.fromRgba = function (color) {\n        // Using integer values as much as possible to make comparisons easier.\n        // I will indicate non-integer values with a  \"_float\" suffix.\n        // These integer values are each some integer multiple of the true value.\n        var scaleFactor = RgbaColor_1.default.maxComponent;\n        var h_float = 0.0;\n        var s_float = 0.0;\n        var l_float = 0.0;\n        var r = color.R;\n        var g = color.G;\n        var b = color.B;\n        var cMax = Math.max(Math.max(r, g), b);\n        var cMin = Math.min(Math.min(r, g), b);\n        var twiceL = cMax + cMin;\n        l_float = twiceL / (2 * scaleFactor);\n        if (cMax === cMin) {\n            s_float = 0.0;\n            h_float = -1.0;\n        }\n        else {\n            var dmax = cMax - cMin;\n            var pmax = cMax + cMin;\n            // The scale factor cancels when we divide scaled values, so divisions can ignore it.\n            if (twiceL <= 1 * scaleFactor) {\n                s_float = dmax / pmax;\n            }\n            else {\n                s_float = dmax / (2 * scaleFactor - pmax); // Safe, since cMax != cMin\n            }\n            var dr_float = (cMax - r) * (1 / 6) / dmax;\n            var dg_float = (cMax - g) * (1 / 6) / dmax;\n            var db_float = (cMax - b) * (1 / 6) / dmax;\n            if (r === cMax) {\n                h_float = db_float - dg_float;\n            }\n            else if (g === cMax) {\n                h_float = (1 / 3) + dr_float - db_float;\n            }\n            else {\n                h_float = (2 / 3) + dg_float - dr_float;\n            }\n            if (h_float < 0) {\n                h_float += 1.0;\n            }\n            if (h_float > 1.0) {\n                h_float -= 1.0;\n            }\n        }\n        return new HslColor(h_float, s_float, l_float, color.A);\n    };\n    /**\n     * Converts a hue, saturation, or luminance value between 0 and 1 into\n     * an integer between 0 and 255.\n     */\n    HslColor._hslComponentToByte = function (value) {\n        var c_rgbaMax = RgbaColor_1.default.maxComponent;\n        var result = Math.round(c_rgbaMax * value);\n        return Math.min(c_rgbaMax, Math.max(0, result));\n    };\n    /**\n     * Internal method which given the calculated magic numbers and the hue,\n     * will calculate the appropriate RGB number.\n     * This algorithm is intended to stay in-sync with the equivalent code in\n     * mso\\officespace\\fscolorgallery.cpp.\n     * @param {number} m1 The first magic number.\n     * @param {number} m2 The second magic number.\n     * @param {number} hue The hue to be converted using the magic numbers.\n     */\n    HslColor._hueToRgbComponent = function (m1, m2, hue) {\n        var result;\n        if (hue < 0) {\n            hue += 1;\n        }\n        if (hue > 1) {\n            hue -= 1;\n        }\n        if (hue < 1 / 6) {\n            result = m1 + (m2 - m1) * hue * 6;\n        }\n        else if (hue < 1 / 2) {\n            result = m2;\n        }\n        else if (hue < 2 / 3) {\n            result = m1 + (m2 - m1) * (2 / 3 - hue) * 6;\n        }\n        else {\n            result = m1;\n        }\n        return HslColor._hslComponentToByte(result);\n    };\n    /**\n     * Darkens the color by the provided factor.\n     * @param {number} factor The factor (between 0 and 1) by which to scale the luminance.\n     */\n    HslColor.prototype.darken = function (factor) {\n        // TODO: Validate input.\n        this.lum *= factor;\n    };\n    /**\n     * Lightens the color by the provided factor.\n     * @param {number} factor The factor (between 0 and 1) by which to scale the luminance.\n     */\n    HslColor.prototype.lighten = function (factor) {\n        // TODO: Validate input.\n        this.lum = this.lum * factor + (1 - factor);\n    };\n    /**\n     * Returns an RgbaColor representation of this HslColor.\n     */\n    HslColor.prototype.toRgbaColor = function () {\n        var r;\n        var g;\n        var b;\n        var hue = this.hue;\n        var saturation = this.sat;\n        var luminance = this.lum;\n        if (Math.round(saturation * RgbaColor_1.default.maxComponent) === 0) {\n            r = g = b = HslColor._hslComponentToByte(luminance);\n        }\n        else {\n            var m1;\n            var m2;\n            if (luminance <= 0.5) {\n                m2 = luminance * (1 + saturation);\n            }\n            else {\n                m2 = luminance + saturation - (luminance * saturation);\n            }\n            m1 = 2 * luminance - m2;\n            r = HslColor._hueToRgbComponent(m1, m2, hue + (1 / 3));\n            g = HslColor._hueToRgbComponent(m1, m2, hue);\n            b = HslColor._hueToRgbComponent(m1, m2, hue - (1 / 3));\n        }\n        return RgbaColor_1.default.fromRgba(r, g, b, this.alpha);\n    };\n    return HslColor;\n}());\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.default = HslColor;\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// D:/agent/1/_work/24/s/common/~/npmx-sp-pages/~/@ms/odsp-utilities/lib/theming/HslColor.js\n// module id = 90\n// module chunks = 0\n\n\n// WEBPACK FOOTER //\n// webpack:///D:/agent/1/_work/24/s/common/~/npmx-sp-pages/~/@ms/odsp-utilities/lib/theming/HslColor.js","\"use strict\";\n/**\n * A color represented by red, green, blue, and alpha (opacity) components.\n */\nvar RgbaColor = (function () {\n    /** Constructs a default RgbaColor. Use RgbaColor.fromRgba to specify components. */\n    function RgbaColor() {\n        this.R = 0;\n        this.G = 0;\n        this.B = 0;\n        this.A = RgbaColor.maxComponent; // Default to fully opaque.\n    }\n    /**\n     * Creates a copy of the given color.\n     * @param {RgbaColor} c The color to clone.\n     */\n    RgbaColor.clone = function (c) {\n        return RgbaColor.fromRgba(c.R, c.G, c.B, c.A);\n    };\n    /**\n     * Returns true if the colors have identical component values of R, G, B, and A.\n     * @param {RgbaColor} c1 The first color to compare.\n     * @param {RgbaColor} c2 The second color to compare.\n     */\n    RgbaColor.equals = function (c1, c2) {\n        var c1IsNull = !c1;\n        var c2IsNull = !c2;\n        if (c1IsNull || c2IsNull) {\n            return c1IsNull && c2IsNull;\n        }\n        else {\n            return c1.R === c2.R && c1.G === c2.G && c1.B === c2.B && c1.A === c2.A;\n        }\n    };\n    /**\n     * Creates an RgbaColor from red, green, blue, and alpha component values.\n     * @param {number} r The red component value (between 0 and 255).\n     * @param {number} g The green component value (between 0 and 255).\n     * @param {number} b The blue component value (between 0 and 255).\n     * @param {number} a The alpha component value (between 0 and 255).\n     */\n    RgbaColor.fromRgba = function (r, g, b, a) {\n        var colorObj = new RgbaColor;\n        colorObj.R = Math.round(r);\n        colorObj.G = Math.round(g);\n        colorObj.B = Math.round(b);\n        colorObj.A = a != null ? Math.round(a) : RgbaColor.maxComponent;\n        return colorObj;\n    };\n    /**\n     * Parses an HTML color string in the formats #AARRGGBB, #RRGGBB, or #RGB.\n     * @param {string} htmlColor The HTML color string to parse.\n     */\n    RgbaColor.fromHtmlColor = function (htmlColor) {\n        function TwoHexCharsToNumber(str, index1, index2) {\n            return parseInt(str.charAt(index1) + str.charAt(index2), 16);\n        }\n        var resultColor = new RgbaColor;\n        if (typeof htmlColor === \"string\" && htmlColor.charAt(0) === \"#\") {\n            switch (htmlColor.length) {\n                case 9:\n                    resultColor.A = TwoHexCharsToNumber(htmlColor, 1, 2);\n                    resultColor.R = TwoHexCharsToNumber(htmlColor, 3, 4);\n                    resultColor.G = TwoHexCharsToNumber(htmlColor, 5, 6);\n                    resultColor.B = TwoHexCharsToNumber(htmlColor, 7, 8);\n                    break;\n                case 7:\n                    resultColor.R = TwoHexCharsToNumber(htmlColor, 1, 2);\n                    resultColor.G = TwoHexCharsToNumber(htmlColor, 3, 4);\n                    resultColor.B = TwoHexCharsToNumber(htmlColor, 5, 6);\n                    break;\n                case 4:\n                    resultColor.R = TwoHexCharsToNumber(htmlColor, 1, 1);\n                    resultColor.G = TwoHexCharsToNumber(htmlColor, 2, 2);\n                    resultColor.B = TwoHexCharsToNumber(htmlColor, 3, 3);\n                    break;\n            }\n        }\n        return resultColor;\n    };\n    /**\n     * Converts an RgbaColor into an HTML string suitable for use as a CSS color value.\n     * @param {RgbaColor} c The color to convert.\n     * @param {boolean} bFilterValue If true, this produces a string to in the #AARRGGBB format.\n     */\n    RgbaColor.toHtmlString = function (c, bFilterValue) {\n        function ByteToHexString(b) {\n            var byte = Number(b);\n            if (!(byte >= 0 && byte <= RgbaColor.maxComponent)) {\n                throw new Error(\"Argument must be a Number in [0, 255]\");\n            }\n            var hex = byte.toString(16);\n            if (byte < 16) {\n                hex = \"0\" + hex;\n            }\n            return hex;\n        }\n        if (c.A < RgbaColor.maxComponent && !bFilterValue) {\n            return \"rgba(\" +\n                c.R.toString(10) + \", \" +\n                c.G.toString(10) + \", \" +\n                c.B.toString(10) + \", \" +\n                (c.A / RgbaColor.maxComponent).toFixed(2) + \")\";\n        }\n        else {\n            return \"#\" +\n                (bFilterValue ? ByteToHexString(c.A) : \"\") +\n                ByteToHexString(c.R) +\n                ByteToHexString(c.G) +\n                ByteToHexString(c.B);\n        }\n    };\n    /**\n     * The maximum value of an R, G, B, or A component in an RgbaColor.\n     */\n    RgbaColor.maxComponent = 255;\n    return RgbaColor;\n}());\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.default = RgbaColor;\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// D:/agent/1/_work/24/s/common/~/npmx-sp-pages/~/@ms/odsp-utilities/lib/theming/RgbaColor.js\n// module id = 91\n// module chunks = 0\n\n\n// WEBPACK FOOTER //\n// webpack:///D:/agent/1/_work/24/s/common/~/npmx-sp-pages/~/@ms/odsp-utilities/lib/theming/RgbaColor.js","\"use strict\";\nvar HslColor_1 = require('./HslColor');\nvar RgbaColor_1 = require('./RgbaColor');\n// Various constants used for generated shades of a color.\nvar WhiteShadeTable = [0.95, 0.85, 0.75, 0.65, 0.50];\nvar BlackTintTable = [0.50, 0.65, 0.75, 0.85, 0.95];\nvar ColorTintTable = [0.20, 0.40, 0.60];\nvar ColorShadeTable = [0.75, 0.50];\nvar LumTintTable = [0.10, 0.25, 0.50, 0.75, 0.90];\nvar LumShadeTable = [0.90, 0.75, 0.50, 0.25, 0.10];\nvar c_LuminanceLow = 0.2;\nvar c_LuminanceHigh = 0.8;\nvar rgbaMax = RgbaColor_1.default.maxComponent;\nvar rgbaWhite = RgbaColor_1.default.fromRgba(rgbaMax, rgbaMax, rgbaMax);\nvar rgbaBlack = RgbaColor_1.default.fromRgba(0, 0, 0);\n/** Shades of a given color, from Lightest to Darkest. */\n(function (Shades) {\n    Shades[Shades[\"Unshaded\"] = 0] = \"Unshaded\";\n    Shades[Shades[\"Lightest\"] = 1] = \"Lightest\";\n    Shades[Shades[\"Lighter\"] = 2] = \"Lighter\";\n    Shades[Shades[\"Medium\"] = 3] = \"Medium\";\n    Shades[Shades[\"Darker\"] = 4] = \"Darker\";\n    Shades[Shades[\"Darkest\"] = 5] = \"Darkest\";\n})(exports.Shades || (exports.Shades = {}));\nvar Shades = exports.Shades;\n/**\n * Returns true if the argument is a valid Shades value\n * @param {Shades} shade The Shades value to validate.\n */\nfunction _isValidShade(shade) {\n    'use strict';\n    return (shade >= Shades.Unshaded) && (shade <= Shades.Darkest);\n}\n/**\n * Given an RgbaColor and a shade specification, generates the requested shade of the color.\n * @param {RgbaColor} color The base color whose shades are to be computed\n * @param {Shades} shade The shade of the base color to compute.\n */\nfunction getShade(color, shade) {\n    'use strict';\n    if (!color) {\n        return null;\n    }\n    if (shade === Shades.Unshaded || !_isValidShade(shade)) {\n        return RgbaColor_1.default.fromRgba(color.R, color.G, color.B, color.A);\n    }\n    var hsl = HslColor_1.default.fromRgba(color);\n    var lum = hsl.lum;\n    var tableIndex = shade - 1;\n    if (RgbaColor_1.default.equals(color, rgbaWhite)) {\n        hsl.darken(WhiteShadeTable[tableIndex]);\n    }\n    else if (RgbaColor_1.default.equals(color, rgbaBlack)) {\n        hsl.lighten(BlackTintTable[tableIndex]);\n    }\n    else if (lum < c_LuminanceLow) {\n        hsl.lighten(LumTintTable[tableIndex]);\n    }\n    else if (lum > c_LuminanceHigh) {\n        hsl.darken(LumShadeTable[tableIndex]);\n    }\n    else {\n        if (tableIndex < ColorTintTable.length) {\n            hsl.lighten(ColorTintTable[tableIndex]);\n        }\n        else {\n            hsl.darken(ColorShadeTable[tableIndex - ColorTintTable.length]);\n        }\n    }\n    color = hsl.toRgbaColor();\n    return color;\n}\nexports.getShade = getShade;\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// D:/agent/1/_work/24/s/common/~/npmx-sp-pages/~/@ms/odsp-utilities/lib/theming/Shades.js\n// module id = 92\n// module chunks = 0\n\n\n// WEBPACK FOOTER //\n// webpack:///D:/agent/1/_work/24/s/common/~/npmx-sp-pages/~/@ms/odsp-utilities/lib/theming/Shades.js","// OneDrive:IgnoreCodeCoverage\n\"use strict\";\nvar StringHelper_1 = require('../../string/StringHelper');\nvar MembersList_1 = require('./MembersList');\n/**\n * This datasource makes server call to get group related information.\n */\nvar GroupDataSource = (function () {\n    /**\n     * @constructor\n     */\n    function GroupDataSource(hostSettings) {\n        this._hostSettings = hostSettings;\n    }\n    /**\n     * Get REST Url to get group properties\n     * @param {string} Id (Guid) of the group\n     * @returns the REST url that can be used to get group basic properties\n     */\n    GroupDataSource.prototype.getGroupBasicPropertiesRESTUrl = function (groupId, withMembership) {\n        return this._getRESTUrl(StringHelper_1.format(withMembership ? GroupDataSource.groupBasicPropertiesWithMembershipUrlTemplate : GroupDataSource.groupBasicPropertiesUrlTemplate, groupId), 'SP.Directory.DirectorySession');\n    };\n    GroupDataSource.prototype.getGroupBasicProperties = function (responseText) {\n        var group = {};\n        try {\n            var response = JSON.parse(responseText);\n            if (response.d) {\n                group = this._copyGroup(response.d);\n                this._calculateMissingGroupProperties(group, group.id);\n            }\n        }\n        catch (e) {\n            group = {};\n        }\n        return group;\n    };\n    GroupDataSource.prototype._getRESTUrl = function (op, ns) {\n        return this._hostSettings.webServerRelativeUrl + '/_api/' + ns + '/' + op;\n    };\n    /**\n     * Given response from the server convert it into a group\n     */\n    GroupDataSource.prototype._copyGroup = function (src) {\n        var groupInfo = {};\n        if (src.description) {\n            groupInfo.description = src.description;\n        }\n        if (src.alias) {\n            groupInfo.alias = src.alias;\n        }\n        if (src.displayName) {\n            groupInfo.name = src.displayName;\n        }\n        if (src.principalName) {\n            groupInfo.principalName = src.principalName;\n        }\n        if (src.creationTime) {\n            groupInfo.creationTime = src.creationTime;\n        }\n        if (src.pictureUrl) {\n            groupInfo.pictureUrl = src.pictureUrl;\n        }\n        if (src.inboxUrl) {\n            groupInfo.inboxUrl = src.inboxUrl;\n        }\n        if (src.calendarUrl) {\n            groupInfo.calendarUrl = src.calendarUrl;\n        }\n        if (src.documentsUrl) {\n            groupInfo.filesUrl = src.documentsUrl;\n        }\n        if (src.siteUrl) {\n            groupInfo.sharePointUrl = src.siteUrl;\n        }\n        if (src.editGroupUrl) {\n            groupInfo.editUrl = src.editGroupUrl;\n        }\n        if (src.peopleUrl) {\n            groupInfo.membersUrl = src.peopleUrl;\n        }\n        if (src.notebookUrl) {\n            groupInfo.notebookUrl = src.notebookUrl;\n        }\n        if (src.isPublic) {\n            groupInfo.isPublic = src.isPublic;\n        }\n        if (src.mail) {\n            groupInfo.mail = src.mail;\n        }\n        // TODO: remove this once all branches get lowerCamelCase changelist\n        if (src.Description) {\n            groupInfo.description = src.Description;\n        }\n        if (src.Alias) {\n            groupInfo.alias = src.Alias;\n        }\n        if (src.DisplayName) {\n            groupInfo.name = src.DisplayName;\n        }\n        if (src.PrincipalName) {\n            groupInfo.principalName = src.PrincipalName;\n        }\n        if (src.CreationTime) {\n            groupInfo.creationTime = src.CreationTime;\n        }\n        if (src.PictureUrl) {\n            groupInfo.pictureUrl = src.PictureUrl;\n        }\n        if (src.InboxUrl) {\n            groupInfo.inboxUrl = src.InboxUrl;\n        }\n        if (src.CalendarUrl) {\n            groupInfo.calendarUrl = src.CalendarUrl;\n        }\n        if (src.DocumentsUrl) {\n            groupInfo.filesUrl = src.DocumentsUrl;\n        }\n        if (src.SiteUrl) {\n            groupInfo.sharePointUrl = src.SiteUrl;\n        }\n        if (src.EditGroupUrl) {\n            groupInfo.editUrl = src.EditGroupUrl;\n        }\n        if (src.PeopleUrl) {\n            groupInfo.membersUrl = src.PeopleUrl;\n        }\n        if (src.NotebookUrl) {\n            groupInfo.notebookUrl = src.NotebookUrl;\n        }\n        if (src.IsPublic) {\n            groupInfo.isPublic = src.IsPublic;\n        }\n        if (src.Mail) {\n            groupInfo.mail = src.Mail;\n        }\n        if (src.members || src.owners) {\n            this._copyMembership(src);\n        }\n        return groupInfo;\n    };\n    /**\n     *  Remove once federated directory makes appropriate fixes\n     */\n    GroupDataSource.prototype._calculateMissingGroupProperties = function (group, groupId) {\n        if (!group.creationTime) {\n            group.creationTime = Date.now();\n        }\n        if (!group.pictureUrl) {\n            group.pictureUrl = group.pictureUrl.replace(\"EWS/Exchange.asmx/s/GetUserPhoto\", \"OWA/service.svc/s/GetPersonaPhoto\");\n        }\n        if (!group.profileUrl) {\n            group.profileUrl = this._getProfileUrl(groupId);\n        }\n        if (!group.notebookUrl && groupId) {\n            group.notebookUrl = this._getGroupStatusNotebookUrl(groupId);\n        }\n    };\n    GroupDataSource.prototype._getProfileUrl = function (id) {\n        return this._hostSettings.siteAbsoluteUrl + StringHelper_1.format(GroupDataSource.groupStatusPageTemplate, id, 'profile');\n    };\n    GroupDataSource.prototype._getGroupStatusNotebookUrl = function (id) {\n        return this._hostSettings.siteAbsoluteUrl + StringHelper_1.format(GroupDataSource.groupStatusPageTemplate, id, 'notebook');\n    };\n    GroupDataSource.prototype._copyMembership = function (src) {\n        var membershipInfo = {};\n        if (src.members && src.members.results) {\n            var membersList = this._copyMembers(src.members.results);\n            membershipInfo.membersList = membersList;\n        }\n        if (src.owners && src.owners.results) {\n            var ownersList = this._copyMembers(src.owners.results);\n            membershipInfo.ownersList = ownersList;\n        }\n        return membershipInfo;\n    };\n    /**\n     * Copy from member list json to memberList object\n     */\n    GroupDataSource.prototype._copyMembers = function (src) {\n        var membersList = new MembersList_1.default();\n        var members = new Array();\n        for (var i = 0; i < src.length; i++) {\n            var member = this._copyMember(src[i]);\n            members.push(member);\n        }\n        membersList.members = members;\n        membersList.totalCount = members.length;\n        return membersList;\n    };\n    /**\n     * Copy from json to IPerson object\n     */\n    GroupDataSource.prototype._copyMember = function (src) {\n        var user = {};\n        if (src.alias) {\n            user.sip = src.alias;\n        }\n        if (src.id) {\n            user.userId = src.id;\n        }\n        if (src.principalName) {\n            user.email = src.principalName;\n        }\n        if (src.displayName) {\n            user.name = src.displayName;\n        }\n        if (src.title) {\n            user.job = src.title;\n        }\n        if (src.pictureUrl) {\n            user.image = src.pictureUrl;\n        }\n        if (src.profilePage) {\n            user.profilePage = src.profilePage;\n        }\n        return user;\n    };\n    /**\n     * Static members\n     */\n    // Url templates\n    GroupDataSource.groupBasicPropertiesUrlTemplate = 'Group(\\'{0}\\')?$select=PrincipalName,DisplayName,Alias,Description,InboxUrl,CalendarUrl,DocumentsUrl,SiteUrl,EditGroupUrl,PictureUrl,PeopleUrl,NotebookUrl,Mail,IsPublic,CreationTime';\n    GroupDataSource.groupBasicPropertiesWithMembershipUrlTemplate = 'Group(\\'{0}\\')?$expand=Members,Owners&$select=PrincipalName,DisplayName,Alias,Description,InboxUrl,CalendarUrl,DocumentsUrl,SiteUrl,EditGroupUrl,PictureUrl,PeopleUrl,NotebookUrl,Mail,IsPublic,CreationTime,Members/PrincipalName,Members/Id,Members/DisplayName,Members/PictureUrl,Owners/PrincipalName,Owners/Id,Owners/DisplayName,Owners/PictureUrl';\n    GroupDataSource.groupStatusPageTemplate = '_layouts/15/groupstatus?id={0}&target={1}';\n    return GroupDataSource;\n}());\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.default = GroupDataSource;\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// D:/agent/1/_work/24/s/common/~/npmx-sp-pages/~/@ms/odsp-utilities/lib/dataSources/group/GroupDataSource.js\n// module id = 93\n// module chunks = 0\n\n\n// WEBPACK FOOTER //\n// webpack:///D:/agent/1/_work/24/s/common/~/npmx-sp-pages/~/@ms/odsp-utilities/lib/dataSources/group/GroupDataSource.js","// OneDrive:IgnoreCodeCoverage\n\"use strict\";\n;\nvar MembersList = (function () {\n    function MembersList() {\n        this.totalCount = 0;\n        this.members = new Array();\n    }\n    /**\n     * Add given user to the members list of the group\n     */\n    MembersList.prototype.addUserToList = function (user) {\n        this.members.unshift(user);\n        this.totalCount++;\n    };\n    /**\n     * Remove user from members list of a group\n     */\n    MembersList.prototype.removeUserFromList = function (user) {\n        var indexToRemove = -1; // not found by default\n        for (var i = 0; i < this.members.length; i++) {\n            if (this.members[i].userId === user.userId) {\n                indexToRemove = i; // find the index\n            }\n        }\n        // If user exists in members list then remove it\n        if (indexToRemove >= 0) {\n            this.members.splice(indexToRemove, 1);\n            this.totalCount--;\n        }\n    };\n    return MembersList;\n}());\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.default = MembersList;\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// D:/agent/1/_work/24/s/common/~/npmx-sp-pages/~/@ms/odsp-utilities/lib/dataSources/group/MembersList.js\n// module id = 94\n// module chunks = 0\n\n\n// WEBPACK FOOTER //\n// webpack:///D:/agent/1/_work/24/s/common/~/npmx-sp-pages/~/@ms/odsp-utilities/lib/dataSources/group/MembersList.js","\"use strict\";\n// encode <>&'\"\nvar ENCODE_HTML_TEXT_REGEX = /[<>&'\"\\\\]/g;\nvar CODES = {\n    '<': '&lt;',\n    '>': '&gt;',\n    '&': '&amp;',\n    '\"': '&quot;',\n    '\\'': '&#39;',\n    '\\\\': '&#92;'\n};\nvar HtmlEncoding = (function () {\n    function HtmlEncoding() {\n    }\n    /**\n     * Encodes a string for use in HTML text. Not recommended for attribute values\n     * or anything that might be used in a URL.\n     */\n    HtmlEncoding.encodeText = function (inputString) {\n        if (!inputString) {\n            return \"\";\n        }\n        return inputString.replace(ENCODE_HTML_TEXT_REGEX, function (_match) { return CODES[_match]; });\n    };\n    return HtmlEncoding;\n}());\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.default = HtmlEncoding;\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// D:/agent/1/_work/24/s/common/~/npmx-sp-pages/~/@ms/odsp-utilities/lib/encoding/HtmlEncoding.js\n// module id = 95\n// module chunks = 0\n\n\n// WEBPACK FOOTER //\n// webpack:///D:/agent/1/_work/24/s/common/~/npmx-sp-pages/~/@ms/odsp-utilities/lib/encoding/HtmlEncoding.js","// OneDrive:IgnoreCodeCoverage\n\"use strict\";\nvar PLT_event_1 = require('../logging/events/PLT.event');\nvar PLTHttpRequest_event_1 = require('../logging/events/PLTHttpRequest.event');\nvar Api_event_1 = require('../logging/events/Api.event');\nvar EventBase_1 = require(\"../logging/EventBase\");\nvar ErrorHelper_1 = require('../logging/ErrorHelper');\nvar Manager_1 = require('../logging/Manager');\nexports.AppStartMarkerName = \"EUPL.AppStart\";\nexports.DataFetchStartMarkerName = \"EUPL.DataManager.FirstDataFetch.GetItem.Start\";\nexports.DataFetchEndMarkerName = \"EUPL.DataManager.FirstDataFetch.GetItem.End\";\n//For reference see http://www.w3.org/TR/navigation-timing/\n//also, got tips at http://www.stevesouders.com/blog/2014/08/21/resource-timing-practical-tips/\nvar PerformanceCollection = (function () {\n    function PerformanceCollection() {\n    }\n    /**\n     * When list data is returned from server as deferred control, browser w3c timing responseEnd may not reflect correct timing of the manifest response end.\n     * To workaround this, we write \"var g_responseEnd = new Date().getTime();\" in server duration script tag.\n     * In most of the scenarios, we will still use performance.timing.responseEnd.\n     * If g_responseEnd is less than performance.timing.responseEnd or performance.timing.responseEnd is not available yet (this is will happen for deferred SPListRender sends splist data back to html), we will use g_responseEnd.\n     */\n    PerformanceCollection.getResponseEnd = function () {\n        if (window.performance && performance.timing) {\n            if (window[\"g_responseEnd\"] &&\n                (!!performance.timing.responseEnd && (Number(window[\"g_responseEnd\"]) < performance.timing.responseEnd) || !performance.timing.responseEnd)) {\n                return Number(window[\"g_responseEnd\"]);\n            }\n            else {\n                return performance.timing.responseEnd;\n            }\n        }\n        else {\n            return NaN;\n        }\n    };\n    ;\n    PerformanceCollection.appStart = function () {\n        try {\n            if (window.performance && performance.timing) {\n                PerformanceCollection.mark(exports.AppStartMarkerName);\n                Manager_1.Manager.addLogHandler(this.eventLogHandler);\n                this.summary.w3cResponseEnd = (PerformanceCollection.getResponseEnd() - performance.timing.fetchStart); //Time to get the aspx from the server\n                this._times[\"appStart\"] = new Date().getTime(); //Time it takes for our app to *start* running\n                this.summary.appStart = this._times[\"appStart\"] - PerformanceCollection.getResponseEnd(); //Time it takes for our app to *start* running\n                this.summary.prefetchStart = -1;\n                this.summary.deferredListDataRender = -1;\n            }\n        }\n        catch (e) {\n            ErrorHelper_1.default.log(e);\n        }\n    };\n    //called when the view is fully loaded\n    PerformanceCollection.plt = function (name) {\n        try {\n            if (window.performance && performance.timing && PerformanceCollection._times[\"plt\"] === undefined) {\n                var now = new Date().getTime();\n                Manager_1.Manager.removeLogHandler(this.eventLogHandler);\n                this._times[\"plt\"] = (now - performance.timing.fetchStart);\n                this.summary.preRender = PerformanceCollection.getMarkerTime(exports.DataFetchStartMarkerName) - PerformanceCollection.getMarkerTime(exports.AppStartMarkerName); //Time it takes for our app to make the relevant data fetch for this view\n                this.summary.dataFetch = PerformanceCollection.getMarkerTime(exports.DataFetchEndMarkerName) - PerformanceCollection.getMarkerTime(exports.DataFetchStartMarkerName); //Time it takes for our app to get data back from the server\n                this.summary.postRender = PerformanceCollection.now() - PerformanceCollection.getMarkerTime(exports.DataFetchEndMarkerName);\n                this.summary.render = this.summary[\"preRender\"] + this.summary[\"postRender\"];\n                this.summary.plt = now - performance.timing.fetchStart; //unbiased end to end PLT from fetchStart that excludes unload of previous page.\n                this.summary.pltWithUnload = now - performance.timing.navigationStart; //unbiased end to end PLT from navigationStart that includes the unload of the previous page\n                this.summary.name = name;\n                //we consider an appcache hit if the w3cResponseEnd time is less than 40ms\n                this.summary.appCacheHit = this.summary.w3cResponseEnd <= 40 &&\n                    Boolean(window.applicationCache) &&\n                    Boolean(window.applicationCache.status !== window.applicationCache.UNCACHED);\n                // ASSERT(this.summary.appStart +\n                //     this.summary.dataFetch +\n                //     this.summary.postRender +\n                //     this.summary.preRender +\n                //     this.summary.w3cResponseEnd ===\n                //     this.summary.plt,\n                //     \"PLT summary times do not add up\");\n                // Get the count of events so we have it in the plt event logs\n                // This must be logged before log data otherwise the count is not passed\n                this.getHttpRequests();\n                var event_1 = PLT_event_1.PLT.logData(this.summary);\n                if (this.httpRequestCollection) {\n                    for (var _i = 0, _a = this.httpRequestCollection; _i < _a.length; _i++) {\n                        var eventData = _a[_i];\n                        PLTHttpRequest_event_1.PLTHttpRequest.logData(eventData, event_1);\n                    }\n                }\n                PerformanceCollection.mark('EUPL.glass');\n            }\n        }\n        catch (e) {\n            ErrorHelper_1.default.log(e);\n        }\n    };\n    PerformanceCollection.mark = function (name, limit) {\n        if (limit === null || limit === undefined || PerformanceCollection._markCount < limit) {\n            if (window.performance && window.performance.mark) {\n                window.performance.mark(name);\n            }\n            else {\n                if (window[\"_perfMarks\"] === undefined) {\n                    window[\"_perfMarks\"] = PerformanceCollection._marks; // make it exposed to TAB tests\n                }\n                PerformanceCollection._marks.push({\n                    name: name,\n                    startTime: new Date().getTime()\n                });\n            }\n            PerformanceCollection._markCount++;\n        }\n    };\n    PerformanceCollection.pageLoaded = function () {\n        return this._times[\"plt\"] !== undefined;\n    };\n    PerformanceCollection.getMarkerTime = function (name) {\n        if (window.performance && window.performance.mark) {\n            var mark = window.performance.getEntriesByName(name);\n            return mark && mark.length > 0 ? Math.round(mark[0].startTime) : NaN;\n        }\n        else {\n            return NaN;\n        }\n    };\n    PerformanceCollection.now = function () {\n        return window.performance && window.performance.now ? Math.round(performance.now()) : NaN;\n    };\n    PerformanceCollection.eventLogHandler = function (event) {\n        // Look at all api events\n        if (Api_event_1.Api.isTypeOf(event)) {\n            if (PerformanceCollection._times[\"appDataFetchStart\"] === undefined) {\n                // Calculate the start time from the first api event\n                PerformanceCollection._times[\"appDataFetchStart\"] = event.startTime;\n            }\n            else if (event.eventType === EventBase_1.ClonedEventType.End || event.eventType === EventBase_1.ClonedEventType.Single) {\n                // Calculate the end time from the api events\n                PerformanceCollection._times[\"appDataFetchEnd\"] = PerformanceCollection._times[\"appDataFetchEnd\"] ? Math.max(PerformanceCollection._times[\"appDataFetchEnd\"], event.endTime) : event.endTime;\n            }\n        }\n    };\n    PerformanceCollection.getHttpRequests = function () {\n        if (window.performance && window.performance.getEntriesByType) {\n            var httpRequestCollection = [];\n            var perfEntries = performance.getEntriesByType(\"resource\");\n            var httpRequests = perfEntries.length;\n            for (var j = 0; j < httpRequests; j++) {\n                var data = {\n                    startTime: Math.round(perfEntries[j].startTime),\n                    url: perfEntries[j].name,\n                    duration: Math.round(perfEntries[j].duration)\n                };\n                httpRequestCollection.push(data);\n            }\n            //Make sure we get all the http requests from iframes as well\n            var iFrames = document.getElementsByTagName(\"iframe\");\n            httpRequests += iFrames.length;\n            for (var i = 0; i < iFrames.length; i++) {\n                try {\n                    perfEntries = iFrames[i].contentWindow.performance.getEntriesByType(\"resource\");\n                }\n                catch (e) {\n                    // If the iframe in question isn't domain lowered, we can't access it.\n                    perfEntries = null;\n                }\n                if (perfEntries) {\n                    var requests = perfEntries.length;\n                    httpRequests += requests;\n                    for (var j = 0; j < requests; j++) {\n                        var iframeData = {\n                            startTime: Math.round(perfEntries[j].startTime),\n                            url: perfEntries[j].name,\n                            duration: Math.round(perfEntries[j].duration)\n                        };\n                        httpRequestCollection.push(iframeData);\n                    }\n                }\n            }\n            this.summary.httpRequests = httpRequests;\n            this.httpRequestCollection = httpRequestCollection;\n        }\n    };\n    PerformanceCollection.summary = {};\n    PerformanceCollection._times = {};\n    PerformanceCollection._marks = []; // this is to support perf marks for enviorment like phantomJS that does not have performance.mark\n    PerformanceCollection._markCount = 0; // limit of how many perf marks to be collected\n    return PerformanceCollection;\n}());\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.default = PerformanceCollection;\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// D:/agent/1/_work/24/s/common/~/npmx-sp-pages/~/@ms/odsp-utilities/lib/performance/PerformanceCollection.js\n// module id = 96\n// module chunks = 0\n\n\n// WEBPACK FOOTER //\n// webpack:///D:/agent/1/_work/24/s/common/~/npmx-sp-pages/~/@ms/odsp-utilities/lib/performance/PerformanceCollection.js","// OneDrive:IgnoreCodeCoverage\n\"use strict\";\n/**\n * This datasource makes a call to the Acronyms and Colors service and returns an IAcronymColor object.\n */\nvar SiteHeaderLogoAcronym = (function () {\n    /**\n     * @constructor\n     */\n    function SiteHeaderLogoAcronym(hostSettings) {\n        this._hostSettings = hostSettings;\n    }\n    /**\n     * Given a site name, return an URL to a REST endpoint where the site logo acronym and color information can be retrieved from.\n     * The REST endpoint is through the GetAcronymsAndColors API.\n     * Note: API takes in additional optional arguments like lcid, which as of this writing this method doesn't support.\n     *       Please extend as appropriate.\n     *\n     * @param {string} siteName Name of the site.\n     * @returns { string} the REST endpoint relative URL.\n     */\n    SiteHeaderLogoAcronym.prototype.getAcronymRESTUrl = function (siteName) {\n        return this._hostSettings.webServerRelativeUrl + (\"/_api/sphome/GetAcronymsAndColors?labels=[{Text:\" + encodeURIComponent('\"' + siteName + '\"') + \"}]\");\n    };\n    SiteHeaderLogoAcronym.prototype.getAcronymColor = function (responseText) {\n        //parse the responseText\n        var rtnObj = { acronym: undefined, color: undefined };\n        try {\n            var response = JSON.parse(responseText);\n            var responseResult = response.d.GetAcronymsAndColors.results[0];\n            rtnObj.acronym = responseResult.Acronym;\n            rtnObj.color = responseResult.Color;\n        }\n        catch (e) {\n            // try xml parsing\n            var parser = this._parseFn();\n            var elements = void 0;\n            var xmlDoc = parser(responseText);\n            if (elements = xmlDoc.getElementsByTagName(\"element\")) {\n                var element = elements[0];\n                for (var i = 0; i < element.childNodes.length; i++) {\n                    switch (element.childNodes[i].nodeName) {\n                        case 'Acronym':\n                            rtnObj.acronym = element.childNodes[i].nodeValue;\n                            break;\n                        case 'Color':\n                            rtnObj.color = element.childNodes[i].nodeValue;\n                            break;\n                    }\n                }\n            }\n        }\n        return rtnObj;\n    };\n    /**\n     * Returns an XML parser.\n     */\n    SiteHeaderLogoAcronym.prototype._parseFn = function () {\n        var parseXml;\n        if (DOMParser) {\n            parseXml = function (xmlStr) {\n                return (new DOMParser()).parseFromString(xmlStr, \"text/xml\");\n            };\n        }\n        else if (ActiveXObject &&\n            new ActiveXObject(\"Microsoft.XMLDOM\")) {\n            parseXml = function (xmlStr) {\n                var xmlDoc = new ActiveXObject(\"Microsoft.XMLDOM\");\n                xmlDoc.async = \"false\";\n                xmlDoc.loadXML(xmlStr);\n                return xmlDoc;\n            };\n        }\n        else {\n            throw new Error(\"No XML parser found\");\n        }\n        return parseXml;\n    };\n    return SiteHeaderLogoAcronym;\n}());\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.default = SiteHeaderLogoAcronym;\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// D:/agent/1/_work/24/s/common/~/npmx-sp-pages/~/@ms/odsp-utilities/lib/dataSources/acronym/SiteHeaderLogoAcronym.js\n// module id = 97\n// module chunks = 0\n\n\n// WEBPACK FOOTER //\n// webpack:///D:/agent/1/_work/24/s/common/~/npmx-sp-pages/~/@ms/odsp-utilities/lib/dataSources/acronym/SiteHeaderLogoAcronym.js","// OneDrive:IgnoreCodeCoverage\n\"use strict\";\nvar RgbaColor_1 = require('./RgbaColor');\nvar ThemeCache_1 = require('./ThemeCache');\nvar Promise_1 = require('../async/Promise');\nvar Engagement_event_1 = require('../logging/events/Engagement.event');\nvar Qos_event_1 = require('../logging/events/Qos.event');\n/**\n * Provides theme data, either from the local cache or from the server.\n */\nvar ThemeProvider = (function () {\n    /**\n     * Constructs a ThemeProvider which acts like the provided loadData function but with caching.\n     * @param {() => Promise<IThemeData>} loadData Used to load data on a cache miss.\n     */\n    function ThemeProvider(loadData) {\n        this._loadData = loadData;\n    }\n    /**\n     * Given a URL, returns a string value which can be safely used as a\n     * background-image value in a CSS rule. If the url is falsey, this\n     * returns \"none\" to specify no background-image.\n     * @param {string} url The URL of a background image.\n     */\n    ThemeProvider._makeCssUrl = function (url) {\n        var cssUrlValue = \"none\";\n        if (url) {\n            cssUrlValue = 'url(\"' +\n                ThemeProvider._escapeQuotesAndParentheses(url) +\n                '\")';\n        }\n        return cssUrlValue;\n    };\n    /**\n     * Escapes single- and double-quotes along with parentheses so that the\n     * resulting string is safe to use in a CSS background-image: url()\n     * @param {string} str The string to escape.\n     */\n    ThemeProvider._escapeQuotesAndParentheses = function (str) {\n        var replacements = { \"'\": \"%27\", '\"': \"%22\", \"(\": \"%28\", \")\": \"%29\" };\n        var result = null;\n        if (str != null) {\n            result = str.replace(/(['\"\\(\\)])/gm, function (match, capture) {\n                return replacements[capture];\n            });\n        }\n        return result;\n    };\n    /**\n     * Loads the theme data and returns a map from theme tokens to replacement values.\n     * Suitable for use with loadTheme in load-themed-styles.\n     * @param {string} cacheToken Cache token used to validate cached data.\n     * @param {boolean} forceUpdate Whether to force fresh data to be loaded and cached.\n     */\n    ThemeProvider.prototype.loadThemeTokenMap = function (cacheToken, forceUpdate) {\n        return this.loadThemeData(cacheToken, forceUpdate).then(function (themeData) {\n            var themeValues;\n            if (themeData && themeData.palette) {\n                themeValues = {};\n                var palette = themeData.palette;\n                for (var colorSlot in palette) {\n                    var rgbaValue = palette[colorSlot];\n                    themeValues[colorSlot] = rgbaValue ? RgbaColor_1.default.toHtmlString(rgbaValue) : null;\n                }\n                themeValues[\"backgroundImageUri\"] =\n                    ThemeProvider._makeCssUrl(themeData.backgroundImageUri);\n            }\n            return themeValues;\n        }, function (error) { return null; }); // on error, return null\n    };\n    /**\n     * Loads the theme data from the cache or via the a loadData method.\n     * @param {string} cacheToken Cache token used to validate cached data.\n     * @param {boolean} forceUpdate Whether to force fresh data to be loaded and cached.\n     */\n    ThemeProvider.prototype.loadThemeData = function (cacheToken, forceUpdate) {\n        if (!forceUpdate && this._dataPromise) {\n            return this._dataPromise;\n        }\n        var _this = this;\n        var failureResultCode = null;\n        var failureResultType = Qos_event_1.ResultTypeEnum.Failure;\n        this._dataPromise = Qos_event_1.Qos.instrumentPromise(\n        /*startSchema*/ { name: \"ThemeProvider.LoadData\" }, \n        /*createPromise*/ function () { return new Promise_1.default(function loadDataOnExecute(complete, error) {\n            var previousData = null;\n            if (!forceUpdate) {\n                // Checks if we have valid cached data before returning it.\n                previousData = ThemeCache_1.default.getCachedTheme(cacheToken);\n            }\n            // If we have previous data and an update is not forced, use that data.\n            if (previousData) {\n                Engagement_event_1.Engagement.logData({ name: \"ThemeProvider.DataFromCache\" });\n                complete(previousData);\n            }\n            else {\n                if (forceUpdate) {\n                    Engagement_event_1.Engagement.logData({ name: \"ThemeProvider.ForceUpdateData\" });\n                }\n                Engagement_event_1.Engagement.logData({ name: \"ThemeProvider.DataFromServer\" });\n                // Get updated data. Might result in a server call.\n                _this._loadData(forceUpdate).done(function onComplete(themeData) {\n                    if (themeData) {\n                        if (themeData.cacheToken) {\n                            ThemeCache_1.default.updateThemeCache(themeData, cacheToken);\n                            complete(themeData);\n                        }\n                        else {\n                            //TODO what happens if error() is undefined?\n                            failureResultCode = \"NoCacheToken\";\n                            if (error) {\n                                error(\"Theme data with no CacheToken returned\");\n                            }\n                        }\n                    }\n                    else {\n                        failureResultCode = \"NoData\";\n                        if (error) {\n                            error(\"No model returned\");\n                        }\n                    }\n                }, function onError(err) {\n                    if (Promise_1.default.isCanceled(error)) {\n                        failureResultCode = \"Canceled\";\n                        failureResultType = Qos_event_1.ResultTypeEnum.ExpectedFailure;\n                    }\n                    else {\n                        failureResultCode = \"ServerLoadFailure\";\n                    }\n                    if (error) {\n                        error(err);\n                    }\n                });\n            }\n        }); }, \n        /*getCompleteSchema*/ null, \n        /*getErrorSchema*/ function getErrorSchema(error) {\n            if (Promise_1.default.isCanceled(error)) {\n                failureResultType = Qos_event_1.ResultTypeEnum.ExpectedFailure;\n                failureResultCode = \"Canceled\";\n            }\n            return {\n                resultType: failureResultType,\n                resultCode: failureResultCode || \"Other\",\n                error: error\n            };\n        });\n        return this._dataPromise;\n    };\n    return ThemeProvider;\n}());\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.default = ThemeProvider;\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// D:/agent/1/_work/24/s/common/~/npmx-sp-pages/~/@ms/odsp-utilities/lib/theming/ThemeProvider.js\n// module id = 98\n// module chunks = 0\n\n\n// WEBPACK FOOTER //\n// webpack:///D:/agent/1/_work/24/s/common/~/npmx-sp-pages/~/@ms/odsp-utilities/lib/theming/ThemeProvider.js","// OneDrive:IgnoreCodeCoverage\n\"use strict\";\nvar BaseDataStore_1 = require('../models/store/BaseDataStore');\nvar DataStoreCachingType_1 = require('../models/store/DataStoreCachingType');\nvar THEME_CACHE_VERSION = '1.7';\nvar THEME_CACHE_PREFIX = 'odTheme';\nvar DATA_KEY = 'Data';\nvar TOKEN_KEY = 'CacheToken';\nvar VERSION_KEY = 'CacheVersion';\n/**\n * Utility methods for caching theme data.\n */\nvar ThemeCache = (function () {\n    function ThemeCache() {\n    }\n    /**\n     * Clears the theme cache.\n     */\n    ThemeCache.clearThemeCache = function () {\n        \"use strict\";\n        var ds = ThemeCache.getThemeDataStore();\n        ds.remove(DATA_KEY);\n        ds.remove(TOKEN_KEY);\n        ds.remove(VERSION_KEY);\n    };\n    /**\n     * Reads the cached theme, if the cacheToken is compatible.\n     * @param {string} cacheToken The cached value will only be returned if it has the same cache token.\n     */\n    ThemeCache.getCachedTheme = function (cacheToken) {\n        \"use strict\";\n        var cachedTheme;\n        var ds = ThemeCache.getThemeDataStore();\n        try {\n            // Make sure the data was cached with the expected version and\n            // the current theme cache token. Otherwise, return undefined.\n            if (cacheToken === ds.getValue(TOKEN_KEY) &&\n                THEME_CACHE_VERSION === ds.getValue(VERSION_KEY)) {\n                cachedTheme = ds.getValue(DATA_KEY);\n            }\n        }\n        catch (exReadCache) {\n        }\n        return cachedTheme;\n    };\n    /**\n     * Updates the theme data in the cache.\n     * @param {IThemeData} themeData The new theme data to cache.\n     */\n    ThemeCache.updateThemeCache = function (themeData, cacheToken) {\n        \"use strict\";\n        var ds = ThemeCache.getThemeDataStore();\n        ds.setValue(DATA_KEY, themeData);\n        ds.setValue(TOKEN_KEY, cacheToken || themeData.cacheToken);\n        ds.setValue(VERSION_KEY, THEME_CACHE_VERSION);\n    };\n    /**\n     * Returns an instance of the supporting data store for this cache.\n     */\n    ThemeCache.getThemeDataStore = function () {\n        \"use strict\";\n        return new BaseDataStore_1.default(THEME_CACHE_PREFIX, DataStoreCachingType_1.default.local);\n    };\n    return ThemeCache;\n}());\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.default = ThemeCache;\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// D:/agent/1/_work/24/s/common/~/npmx-sp-pages/~/@ms/odsp-utilities/lib/theming/ThemeCache.js\n// module id = 99\n// module chunks = 0\n\n\n// WEBPACK FOOTER //\n// webpack:///D:/agent/1/_work/24/s/common/~/npmx-sp-pages/~/@ms/odsp-utilities/lib/theming/ThemeCache.js","\"use strict\";\nvar ObjectUtil_1 = require('../object/ObjectUtil');\nvar StringHelper_1 = require('../string/StringHelper');\n(function (UriPartial) {\n    /** The scheme segment of the URI */\n    UriPartial[UriPartial[\"scheme\"] = 0] = \"scheme\";\n    /** The scheme and authority segments of the URI */\n    UriPartial[UriPartial[\"authority\"] = 1] = \"authority\";\n    /** The scheme, authority, and path segments of the URI */\n    UriPartial[UriPartial[\"path\"] = 2] = \"path\";\n    /** The scheme, authority, path, and query segments of the URI */\n    UriPartial[UriPartial[\"query\"] = 3] = \"query\";\n})(exports.UriPartial || (exports.UriPartial = {}));\nvar UriPartial = exports.UriPartial;\n/**\n * Partial port of groove\\Misc\\URI.cpp, which was based on RFC2396 and RFC3986 (http://www.ietf.org/rfc/rfc2396.txt).\n * There are a few differences between this implementation and the RFC:\n *  - Implementation does not support parameters (we don't use them, and partial implementation was incorrect)\n *  - Implementation supports some relative URIs at a glance but more investigation required\n *\n *   foo://example.com:8042/over/there?name=ferret#nose\n *   \\_/   \\______________/\\_________/ \\_________/ \\__/\n *    |           |            |            |        |\n * scheme     authority       path        query   fragment\n *\n * Possible improvements:\n *  - Support path parameters\n *  - Fully support and test relative URLs based on RFC\n *  - Allow changing/removing remaining URI components (i.e. user, host, port, parameters)\n *  - URI.equals could allow ?foo=1&bar=2 equals ?bar=2&foo=1\n *  - URI.parseURI should have better error handling rather than just setting it as path\n *  - URI.getQueryAsObject should have better error handling for query of \"a=1&a=2\"\n */\nvar Uri = (function () {\n    function Uri(uriString, options) {\n        this._queryCaseInsensitive = false;\n        this._pathCaseInsensitive = false;\n        // All of these are decoded (if relevant) unless specified as encoded.\n        this._scheme = \"\";\n        this._user = \"\";\n        this._host = \"\";\n        this._port = \"\";\n        this._path = \"\";\n        this._pathSegments = [];\n        this._pathEncoded = \"\";\n        this._query = {};\n        this._fragment = \"\";\n        if (Boolean(options)) {\n            this._queryCaseInsensitive = Boolean(options.queryCaseInsensitive);\n            this._pathCaseInsensitive = Boolean(options.pathCaseInsensitive);\n        }\n        this._parseURI(uriString);\n    }\n    Uri.concatenate = function () {\n        var uriParts = [];\n        for (var _i = 0; _i < arguments.length; _i++) {\n            uriParts[_i - 0] = arguments[_i];\n        }\n        var result = '';\n        for (var i = 0; i < uriParts.length; i++) {\n            var part = uriParts[i];\n            if (i > 0) {\n                part = Uri.ensureNoPrecedingSlash(part);\n            }\n            if (i < uriParts.length - 1) {\n                part = Uri.ensureTrailingSlash(part);\n            }\n            result += part;\n        }\n        return result;\n    };\n    Uri.ensureNoPrecedingSlash = function (part) {\n        return part[0] === \"/\" ? part.substr(1) : part;\n    };\n    Uri.ensureTrailingSlash = function (part) {\n        return part[part.length - 1] !== \"/\" ? (part + \"/\") : part;\n    };\n    Uri.prototype.getScheme = function () {\n        return this._scheme;\n    };\n    Uri.prototype.setScheme = function (scheme) {\n        this._scheme = scheme;\n    };\n    Uri.prototype.getAuthority = function () {\n        return this._getAuthority(false);\n    };\n    Uri.prototype.setAuthority = function (authority) {\n        this._parseAuthority(authority);\n    };\n    Uri.prototype.getUser = function () {\n        return this._user;\n    };\n    Uri.prototype.getHost = function () {\n        return this._host;\n    };\n    Uri.prototype.getPort = function () {\n        return this._port;\n    };\n    Uri.prototype.getPath = function (trimTrailingSlash) {\n        var retPath = this._path;\n        if (Boolean(trimTrailingSlash)) {\n            // If the last character is a slash\n            if (retPath !== null && retPath.lastIndexOf(\"/\") === (retPath.length - 1)) {\n                retPath = retPath.slice(0, -1); //trim last character\n            }\n        }\n        return retPath;\n    };\n    /**\n     * Returns a string containing the leftmost portion of the URI string, ending with the portion specified by part\n     */\n    Uri.prototype.getLeftPart = function (part) {\n        var ret = this._scheme + \"://\"; // default value is UriPartial.scheme\n        if (part === UriPartial.authority) {\n            ret += this.getAuthority();\n        }\n        if (part === UriPartial.path) {\n            ret += this.getPath();\n        }\n        if (part === UriPartial.query) {\n            ret += this.getQuery();\n        }\n        return ret;\n    };\n    Uri.prototype.setPath = function (path) {\n        if (path && path[0] !== \"/\") {\n            path = \"/\" + path;\n        }\n        this._parsePath(path);\n    };\n    Uri.prototype.getPathSegments = function () {\n        return this._pathSegments;\n    };\n    Uri.prototype.getLastPathSegment = function () {\n        if (this._pathSegments.length === 0) {\n            return \"\";\n        }\n        return this._pathSegments[this._pathSegments.length - 1];\n    };\n    Uri.prototype.getQuery = function (encoded) {\n        return this._serializeQuery(encoded);\n    };\n    /**\n     * Query is not well-defined but is commonly formatted as key=value and delimited with & or ;\n     * (http://www.w3.org/TR/REC-html40/appendix/notes.html#h-B.2.2)\n     *  - URI with query \"a=1&b=2\" or \"a=1;b=2\" will return {a: \"1\", b: \"2\"}\n     *  - Mixed-mode will also work: \"a=1&b=2;c=3\" will return {a: \"1\", b: \"2\", c: \"3\"}\n     *  - Assumes that parameters will be unique (i.e. \"a=1&a=2\" is not allowed and will produce unexpected results)\n     */\n    Uri.prototype.setQuery = function (query) {\n        var queryObject = this._deserializeQuery(query);\n        this.setQueryFromObject(queryObject);\n    };\n    Uri.prototype.getQueryAsObject = function () {\n        return this._query;\n    };\n    Uri.prototype.setQueryFromObject = function (queryObj) {\n        this._query = {};\n        for (var queryKey in queryObj) {\n            if (queryObj.hasOwnProperty(queryKey)) {\n                this.setQueryParameter(queryKey, queryObj[queryKey]);\n            }\n        }\n    };\n    Uri.prototype.getQueryParameter = function (queryKey) {\n        var ret = null;\n        var query = this._query;\n        if (this._queryCaseInsensitive) {\n            queryKey = queryKey.toLowerCase();\n            for (var key in query) {\n                if (this._query.hasOwnProperty(key) && key.toLowerCase() === queryKey) {\n                    ret = query[key];\n                }\n            }\n        }\n        else {\n            ret = query[queryKey];\n        }\n        return ret || null;\n    };\n    /**\n     * Adds query parameter to the end if queryKey does not exist, or\n     * overwrites existing query value if queryKey already exists.\n     */\n    Uri.prototype.setQueryParameter = function (queryKey, queryValue, ignoreEmptyValues) {\n        if (ignoreEmptyValues === void 0) { ignoreEmptyValues = true; }\n        var queryKeyDecoded = this._decodeQueryString(queryKey);\n        var queryValueDecoded = this._decodeQueryString(queryValue);\n        // there is no point adding undefined or modifying existing values to undefined or null.\n        if (!!queryValueDecoded || ignoreEmptyValues) {\n            this._query[queryKeyDecoded] = queryValueDecoded;\n        }\n    };\n    Uri.prototype.removeQueryParameter = function (queryKey) {\n        var queryKeyDecoded = this._decodeQueryString(queryKey);\n        delete this._query[queryKeyDecoded];\n    };\n    Uri.prototype.getFragment = function () {\n        return this._fragment;\n    };\n    Uri.prototype.setFragment = function (fragment) {\n        if (fragment[0] === \"#\") {\n            fragment = fragment.substring(1);\n        }\n        // Treat the fragment as a query string (decode + as space) because we pass in\n        // query parameters using the fragment on page load.\n        this._fragment = this._decodeQueryString(fragment);\n    };\n    /**\n     * Does a strict equality check of URIs (including same query parameters\n     * in the same order, and most comparisons case-sensitive).\n     * According to RFC3986: scheme and host should be case-insensitive.\n     * Note: This does not follow RFC2616's URI Comparison since it is not HTTP-specific.\n     *\n     * KNOWN ISSUE: Depending on your definition of \"incorrect,\" this could return\n     * incorrect results for URI parts that get decoded.\n     * For example: http://somewhere/my%2fpath and http://somewhere/my/path\n     * will compare as equal because the comparisons are done to decoded versions.\n     */\n    Uri.prototype.equals = function (uri) {\n        return StringHelper_1.equalsCaseInsensitive(this._scheme, uri.getScheme()) &&\n            this._user === uri.getUser() &&\n            StringHelper_1.equalsCaseInsensitive(this._host, uri.getHost()) &&\n            this._port === uri.getPort() &&\n            this._fragment === uri.getFragment() &&\n            this._equalsCaseAppropriate(this.getPath(/*trimTrailingSlash*/ true), uri.getPath(true), this._pathCaseInsensitive) &&\n            this._equalsCaseAppropriate(this.getQuery(), uri.getQuery(), this._queryCaseInsensitive);\n    };\n    /**\n     * Does an equivalence check of two URIs. Checks to see if the URIs are\n     * equivalent, but they may not be exact! Strings are compared case\n     * insensitive and query parameters can be in any order.\n     *\n     * KNOWN ISSUE: Depending on your definition of \"incorrect,\" this could return\n     * incorrect results for URI parts that get decoded.\n     * For example: http://somewhere/my%2fpath and http://somewhere/my/path\n     * will compare as equal because the comparisons are done to decoded versions.\n     */\n    Uri.prototype.equivalent = function (uri) {\n        var queryToLower = function (queryObj) {\n            var newQuery = {};\n            for (var key in queryObj) {\n                if (queryObj.hasOwnProperty(key)) {\n                    newQuery[key.toLowerCase()] = queryObj[key].toLowerCase();\n                }\n            }\n            return newQuery;\n        };\n        return StringHelper_1.equalsCaseInsensitive(this._scheme, uri.getScheme()) &&\n            StringHelper_1.equalsCaseInsensitive(this._user, uri.getUser()) &&\n            StringHelper_1.equalsCaseInsensitive(this._host, uri.getHost()) &&\n            StringHelper_1.equalsCaseInsensitive(this._port, uri.getPort()) &&\n            StringHelper_1.equalsCaseInsensitive(this.getPath(/*trimTrailingSlash*/ true), uri.getPath(true)) &&\n            ObjectUtil_1.default.deepCompare(queryToLower(this.getQueryAsObject()), queryToLower(uri.getQueryAsObject())) &&\n            StringHelper_1.equalsCaseInsensitive(this._fragment, uri.getFragment());\n    };\n    /**\n     * Note that this returns the URL encoded/escaped while the getXXX() methods\n     * for the individual components return the unescaped strings. Returning a\n     * concatenation of the decoded components would change the semantics of the\n     * URL. See section 2.4.2 of RFC 2396 (http://www.ietf.org/rfc/rfc2396.txt).\n     *\n     * Use doNotPercentEncodeHost to indicate that the output should not have a\n     * percent-encoded host, such as when passing to the url parameter of\n     * XmlHttpRequest.open(). Section 3.2.2 of RFC 2396 only allows alphanumeric\n     * characters and hyphen in the host of a URL, so percent-encoded hosts are\n     * not allowed. While section 3.2.2 of RFC 3986 does not restrict the host\n     * character set anymore, not all browsers can handle a percent-encoded host\n     * - DNS lookup fails.  But, they will convert the unencoded Unicode to the\n     * IDNA encoding (punycode), so leaving the host as-is in this case is preferred.\n     */\n    Uri.prototype.toString = function (outputOptions) {\n        return this._getStringInternal(/*encoded*/ true, outputOptions);\n    };\n    /**\n     * This method should be used to obtain a string for display purposes only,\n     * because as mentioned above, a decoded URL may have different semantics than\n     * the encoded version.\n     */\n    Uri.prototype.getDecodedStringForDisplay = function () {\n        return this._getStringInternal(/*encoded*/ false);\n    };\n    /*\n     * Input URI of \"foo://user:pass@host.com/alpha/beta/gamma/delta;p;a;r;a;m;s?q=1&u=2&e=3&r=4&y=5#fragment\"\n     * would return \"foo://user:pass@host.com/alpha/beta/gamma/delta;p;a;r;a;m;s\";\n     */\n    Uri.prototype.getStringWithoutQueryAndFragment = function () {\n        return this._getStringWithoutQueryAndFragmentInternal(/*encoded=*/ true);\n    };\n    Uri.prototype._equalsCaseAppropriate = function (a, b, isCaseInsensitive) {\n        if (isCaseInsensitive) {\n            return StringHelper_1.equalsCaseInsensitive(a, b);\n        }\n        return a === b;\n    };\n    Uri.prototype._getStringInternal = function (encoded, outputOptions) {\n        var ret = this._getStringWithoutQueryAndFragmentInternal(encoded, outputOptions);\n        var query = this.getQuery(encoded);\n        if (query) {\n            ret += \"?\" + query;\n        }\n        if (this._fragment) {\n            ret += \"#\" + (encoded ? encodeURIComponent(this._fragment) : this._fragment);\n        }\n        return ret;\n    };\n    Uri.prototype._getStringWithoutQueryAndFragmentInternal = function (encoded, outputOptions) {\n        var ret = \"\";\n        if (this._scheme) {\n            ret += (encoded ? encodeURIComponent(this._scheme) : this._scheme) + \":\";\n        }\n        // Authority includes user, host, and port\n        var authority = this._getAuthority(/*encoded=*/ encoded, outputOptions);\n        if (authority) {\n            ret += \"//\" + authority;\n        }\n        if (this._pathEncoded) {\n            ret += (encoded ? this._pathEncoded : this._path);\n        }\n        return ret;\n    };\n    Uri.prototype._deserializeQuery = function (queryStr) {\n        var queryObj = {};\n        if (queryStr.indexOf(\"?\") === 0) {\n            queryStr = queryStr.substring(1);\n        }\n        var queryParts = queryStr.split(/[;&]+/);\n        for (var queryIdx = 0; queryIdx < queryParts.length; queryIdx++) {\n            var queryPart = queryParts[queryIdx];\n            var queryPartSegments = queryPart.split(\"=\");\n            if (queryPartSegments.length > 0) {\n                var queryKey = queryPartSegments[0];\n                if (queryKey.length > 0) {\n                    var queryValue = queryPartSegments.slice(1).join('=');\n                    queryObj[queryKey] = queryValue;\n                }\n            }\n        }\n        return queryObj;\n    };\n    Uri.prototype._serializeQuery = function (encoded) {\n        encoded = Boolean(encoded);\n        var queryStr = \"\";\n        for (var queryKey in this._query) {\n            if (this._query.hasOwnProperty(queryKey)) {\n                var key = queryKey;\n                var value = this._query[queryKey];\n                if (encoded) {\n                    key = encodeURIComponent(key);\n                    value = encodeURIComponent(value);\n                }\n                if (value === null || value === \"\") {\n                    queryStr += key + \"=&\";\n                }\n                else {\n                    queryStr += key + \"=\" + value + \"&\";\n                }\n            }\n        }\n        if (queryStr !== \"\") {\n            queryStr = queryStr.slice(0, -1); //trim extra & at the end\n        }\n        return queryStr;\n    };\n    Uri.prototype._parseURI = function (uriString) {\n        var remainingString = uriString;\n        // Find fragment\n        var fragmentBeginPos = remainingString.indexOf(\"#\");\n        if (fragmentBeginPos >= 0) {\n            var fragment = remainingString.substring(fragmentBeginPos + 1);\n            this.setFragment(fragment);\n            remainingString = remainingString.substring(0, fragmentBeginPos); //remove fragment\n        }\n        // Find scheme\n        var schemeEndPos = StringHelper_1.findOneOf(remainingString, Uri.DELIMITERS);\n        if (schemeEndPos >= 0) {\n            var firstColonPos = remainingString.indexOf(\":\");\n            if (firstColonPos >= 0 && firstColonPos === schemeEndPos) {\n                this.setScheme(remainingString.substring(0, schemeEndPos));\n                remainingString = remainingString.substring(schemeEndPos + 1); //remove scheme\n            }\n        }\n        else {\n            this.setPath(remainingString);\n            return;\n        }\n        // Find authority\n        var authority = \"\";\n        var doubleSlashPos = remainingString.indexOf(\"//\");\n        if (doubleSlashPos >= 0 && doubleSlashPos === 0) {\n            remainingString = remainingString.substring(2); //skip the //\n            var authorityEndPos = StringHelper_1.findOneOf(remainingString, Uri.AUTHORITY_TERMINATORS);\n            if (authorityEndPos >= 0) {\n                authority = remainingString.substring(0, authorityEndPos);\n                remainingString = remainingString.substring(authorityEndPos); //remove authority\n            }\n            else {\n                authority = remainingString;\n                remainingString = null;\n            }\n            this.setAuthority(authority);\n            if (!remainingString) {\n                this.setPath(\"\");\n                return;\n            }\n        }\n        // Find query\n        var queryBeginPos = remainingString.indexOf(\"?\");\n        if (queryBeginPos >= 0) {\n            this.setQuery(remainingString.substring(queryBeginPos + 1));\n            remainingString = remainingString.substring(0, queryBeginPos);\n        }\n        this.setPath(remainingString);\n    };\n    Uri.prototype._parseAuthority = function (authority) {\n        this._host = authority;\n        var userNameEndPos = authority.lastIndexOf(\"@\");\n        if (userNameEndPos >= 0) {\n            this._host = this._host.substring(userNameEndPos + 1);\n        }\n        var hostPortSeparatorPos = this._host.indexOf(\":\");\n        if (userNameEndPos < 0 && hostPortSeparatorPos < 0) {\n            return;\n        }\n        var authorityComponents = authority;\n        if (userNameEndPos < 0) {\n            this._host = authorityComponents;\n        }\n        else {\n            this._user = authorityComponents.substring(0, userNameEndPos);\n            this._host = authorityComponents.substring(userNameEndPos + 1);\n        }\n        if (hostPortSeparatorPos >= 0) {\n            this._port = this._host.substring(hostPortSeparatorPos + 1);\n            this._host = this._host.substring(0, hostPortSeparatorPos);\n        }\n        this._user = decodeURIComponent(this._user);\n        this._host = decodeURIComponent(this._host);\n    };\n    Uri.prototype._parsePath = function (remainingString) {\n        this._path = decodeURIComponent(remainingString);\n        this._pathSegments = [];\n        this._pathEncoded = remainingString;\n        // We have to split the path BEFORE decoding so that encoded / characters\n        // don't get interpreted as path separators.\n        var encodedPathSegments = remainingString.split(\"/\");\n        for (var i = 0; i < encodedPathSegments.length; ++i) {\n            var decodedSegment = decodeURIComponent(encodedPathSegments[i]);\n            this._pathSegments[i] = decodedSegment;\n        }\n        // Trims first/last element if empty\n        if (this._pathSegments[0] === \"\") {\n            this._pathSegments.shift(); // remove first element\n        }\n        if (this._pathSegments[this._pathSegments.length - 1] === \"\") {\n            this._pathSegments.pop(); // remove last element\n        }\n    };\n    Uri.prototype._getAuthority = function (encoded, outputOptions) {\n        if (outputOptions === void 0) { outputOptions = {}; }\n        // Note that if encoded is false, doNotPercentEncodeHost doesn't matter - the whole URI (including host) will not be encoded.\n        var doNotPercentEncodeHost = outputOptions && outputOptions.doNotPercentEncodeHost;\n        var authority = \"\";\n        var user;\n        var host;\n        var port;\n        if (encoded) {\n            // While technically a reserved character, ':' is commonly used in the\n            // username to denote username:password, so we special case not encoding\n            // the first occurence of this character.\n            user = encodeURIComponent(this._user).replace(\"%3A\", \":\");\n            if (doNotPercentEncodeHost) {\n                host = this._host;\n            }\n            else {\n                host = encodeURIComponent(this._host);\n            }\n            port = encodeURIComponent(this._port);\n        }\n        else {\n            user = this._user;\n            host = this._host;\n            port = this._port;\n        }\n        if (user !== \"\") {\n            authority = user + \"@\";\n        }\n        if (this._host !== \"\") {\n            authority += host;\n        }\n        if (this._port !== \"\") {\n            authority += \":\" + port;\n        }\n        return authority;\n    };\n    Uri.prototype._decodeQueryString = function (component) {\n        // For query strings only, \"+\" is a valid substitute for a space, but decodeURIComponent\n        // doesn't take this into account. (Note that replace(\"+\", \" \") only replaces one +.)\n        var result = component;\n        try {\n            result = decodeURIComponent(component.replace(/\\+/g, \" \"));\n        }\n        catch (e) {\n        }\n        return result;\n    };\n    Uri.DELIMITERS = \";/?:@&=$,\";\n    Uri.AUTHORITY_TERMINATORS = \"/?\";\n    return Uri;\n}());\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.default = Uri;\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// D:/agent/1/_work/24/s/common/~/npmx-sp-pages/~/@ms/odsp-utilities/lib/uri/Uri.js\n// module id = 100\n// module chunks = 0\n\n\n// WEBPACK FOOTER //\n// webpack:///D:/agent/1/_work/24/s/common/~/npmx-sp-pages/~/@ms/odsp-utilities/lib/uri/Uri.js","// OneDrive:IgnoreCodeCoverage\n\"use strict\";\nvar FabricTheming_1 = require('./FabricTheming');\nvar RgbaColor_1 = require('./RgbaColor');\nvar UriEncoding_1 = require('../encoding/UriEncoding');\n/**\n * Utility methods which can be used to load the theme of a SharePoint site.\n */\nvar WebTheme = (function () {\n    function WebTheme() {\n    }\n    /**\n     * Constructs the URL of a REST endpoint which will return the web theme.\n     * @param {IWebContextInfo} webContextInfo Context information about the web.\n     * @param {string} cultureName Current UI culture.\n     * @param {string} themeOverride URL to a temporary override theme (e.g. preview).\n     */\n    WebTheme.makeWebThemeRestUrl = function (webServerRelativeUrl, cultureName, themeOverride) {\n        \"use strict\";\n        var webUrl = webServerRelativeUrl;\n        if (webUrl && webUrl[webUrl.length - 1] === '/') {\n            // Trim trailing slash.\n            webUrl = webUrl.substring(0, webUrl.length - 1);\n        }\n        webUrl = UriEncoding_1.default.escapeUrlForCallback(webUrl);\n        var webThemeRestEndpoint = UriEncoding_1.default.escapeUrlForCallback(webUrl) +\n            '/_api/SP.Web.GetContextWebThemeData?noImages=true&lcid=' +\n            UriEncoding_1.default.encodeURIComponent(cultureName);\n        if (themeOverride) {\n            webThemeRestEndpoint += \"&ThemeOverride=\" + UriEncoding_1.default.encodeURIComponent(themeOverride);\n        }\n        return webThemeRestEndpoint;\n    };\n    /**\n     * Constructs the URL of a REST endpoint which will return the web theme.\n     * @param {IWebContextInfo} webContextInfo Context information about the web.\n     */\n    WebTheme.processWebThemeRestResponse = function (responseText) {\n        // This could throw if the handler returns an HTML error page or invalis JSON.\n        // DataSource will count that as an error and call the error callback.\n        \"use strict\";\n        var response = JSON.parse(responseText);\n        var rawThemeData;\n        if (response && response.d && response.d.GetContextWebThemeData) {\n            rawThemeData = JSON.parse(response.d.GetContextWebThemeData);\n        }\n        var themeData = WebTheme.processRawThemeData(rawThemeData);\n        return themeData;\n    };\n    /**\n     * Converts an IThemeDataRaw into an IThemeData.\n     * @param {IThemeDataRaw} themeData Raw theme data to process.\n     */\n    WebTheme.processRawThemeData = function (themeData) {\n        \"use strict\";\n        if (themeData) {\n            var coerceToColor = WebTheme.coerceToColor;\n            var colors = {};\n            var inputColors = themeData.Palette ? themeData.Palette.Colors : {};\n            for (var colorKey in inputColors) {\n                if (inputColors.hasOwnProperty(colorKey)) {\n                    var colorValue = coerceToColor(inputColors[colorKey]);\n                    // TODO: console.warn if colorValue is undefined?\n                    if (colorValue) {\n                        colors[colorKey] = colorValue;\n                    }\n                }\n            }\n            var fabricColors = FabricTheming_1.default.generateFabricColors(colors['ContentAccent1'], themeData.IsInverted);\n            var pageBG = coerceToColor(colors['PageBackground']) || null;\n            var bgOverlay = coerceToColor(colors['BackgroundOverlay']) || null;\n            var alpha40 = Math.round(0.4 * RgbaColor_1.default.maxComponent);\n            fabricColors['white'] = pageBG;\n            // RgbaColor.fromRgba and RgbaColor.clone both return new objects.\n            // This is important for avoiding duplicate filtering logic in the caching layer.\n            fabricColors['primaryBackground'] = RgbaColor_1.default.clone(pageBG);\n            fabricColors['primaryText'] = fabricColors['primaryText'] || coerceToColor('#333');\n            fabricColors['whiteTranslucent40'] = pageBG && RgbaColor_1.default.fromRgba(pageBG.R, pageBG.G, pageBG.B, alpha40);\n            fabricColors['backgroundOverlay'] = bgOverlay;\n            fabricColors['suiteBarBackground'] = coerceToColor(colors['SuiteBarBackground']) || null;\n            fabricColors['suiteBarText'] = coerceToColor(colors['SuiteBarText']) || null;\n            fabricColors['suiteBarDisabledText'] = coerceToColor(colors['SuiteBarDisabledText']) || null;\n            fabricColors['topBarBackground'] = coerceToColor(colors['TopBarBackground']) || null;\n            fabricColors['topBarText'] = coerceToColor(colors['TopBarText']) || null;\n            fabricColors['topBarHoverText'] = coerceToColor(colors['TopBarHoverText']) || null;\n            fabricColors['dialogBorder'] = coerceToColor(colors['DialogBorder']) || null;\n            return {\n                backgroundImageUri: themeData.BackgroundImageUri,\n                cacheToken: themeData.ThemeCacheToken,\n                isDefault: themeData.IsDefault,\n                isInverted: themeData.IsInverted,\n                palette: fabricColors,\n                version: themeData.Version\n            };\n        }\n        return {\n            backgroundImageUri: \"\",\n            cacheToken: \"\",\n            isDefault: true,\n            isInverted: false,\n            palette: {},\n            version: \"\"\n        };\n    };\n    /**\n     * Coerces an HTML color string or a color object in raw web theme data into an RgbaColor.\n     * @param {any} toColor Object to be converted into an RgbaColor.\n     */\n    WebTheme.coerceToColor = function (toColor) {\n        \"use strict\";\n        var resultColor;\n        // Use duck typing to extract a color\n        if (!toColor) {\n            resultColor = null;\n        }\n        else if (typeof toColor === \"string\" || toColor instanceof String) {\n            resultColor = RgbaColor_1.default.fromHtmlColor(String(toColor));\n        }\n        else if (\"DefaultColor\" in toColor) {\n            resultColor = WebTheme.coerceToColor(toColor[\"DefaultColor\"]);\n        }\n        else if (\"R\" in toColor && \"G\" in toColor && \"B\" in toColor) {\n            resultColor = RgbaColor_1.default.fromRgba(toColor.R, toColor.G, toColor.B, toColor.A);\n        }\n        return resultColor;\n    };\n    return WebTheme;\n}());\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.default = WebTheme;\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// D:/agent/1/_work/24/s/common/~/npmx-sp-pages/~/@ms/odsp-utilities/lib/theming/WebTheme.js\n// module id = 101\n// module chunks = 0\n\n\n// WEBPACK FOOTER //\n// webpack:///D:/agent/1/_work/24/s/common/~/npmx-sp-pages/~/@ms/odsp-utilities/lib/theming/WebTheme.js","require('CKTextEditor.css');\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./lib/local/appBase/components/sp-rte/ckeditor/CKTextEditor.scss.js\n// module id = 104\n// module chunks = 0\n\n\n// WEBPACK FOOTER //\n// webpack:///lib/local/appBase/components/sp-rte/ckeditor/CKTextEditor.scss.js","var content = require(\"!!./../../../../../../../../common/node_modules/css-loader/index.js?-minimize!./CKTextEditor.css\");\nvar loader = require(\"D:\\\\agent\\\\1\\\\_work\\\\24\\\\s\\\\common\\\\node_modules\\\\@microsoft\\\\load-themed-styles\\\\lib\\\\index.js\");\n\nif(typeof content === \"string\") content = [[module.id, content]];\n\n// add the styles to the DOM\nfor (var i = 0; i < content.length; i++) loader.loadStyles(content[i][1]);\n\nif(content.locals) module.exports = content.locals;\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./lib/local/appBase/components/sp-rte/ckeditor/CKTextEditor.css\n// module id = 105\n// module chunks = 0\n\n\n// WEBPACK FOOTER //\n// webpack:///lib/local/appBase/components/sp-rte/ckeditor/CKTextEditor.css?d425","exports = module.exports = require(\"./../../../../../../../../common/node_modules/css-loader/lib/css-base.js\")();\n// imports\n\n\n// module\nexports.push([module.id, \".cke_editable{overflow:hidden}[dir=ltr] .cke_editable{text-align:left}[dir=rtl] .cke_editable{text-align:right}[dir=ltr] .cke_editable ol,[dir=ltr] .cke_editable ul{padding-left:50px}[dir=rtl] .cke_editable ol,[dir=rtl] .cke_editable ul{padding-right:50px}[dir=ltr] .cke_editable li::before{margin-left:-19px}[dir=rtl] .cke_editable li::before{margin-right:-19px}[dir=ltr] .cke_editable li::before{margin-right:4px}[dir=rtl] .cke_editable li::before{margin-left:4px}[dir=ltr] .cke_editable li::before{text-align:right}[dir=rtl] .cke_editable li::before{text-align:left}.cke_editable ol{counter-reset:item}.cke_editable ol>li{counter-increment:item}.cke_editable ol ol>li{display:block}.cke_editable ol ol>li:before{content:counter(item,lower-alpha) \\\". \\\"}.cke_editable li p{display:inline-block}.cke_editable table,.cke_editable td,.cke_editable th,.cke_editable tr{border:1px solid \\\"[theme:neutralTertiary, default: #a6a6a6]\\\"!important;border-collapse:collapse}.cke_editable table{margin-top:10px;margin-bottom:10px;max-width:820px!important}.cke_editable td,.cke_editable td p,.cke_editable th,.cke_editable th p{font-family:\\\"Segoe UI WestEuropean\\\",\\\"Segoe UI\\\",-apple-system,BlinkMacSystemFont,Roboto,\\\"Helvetica Neue\\\",sans-serif;-webkit-font-smoothing:antialiased;font-size:14px;font-weight:400;color:\\\"[theme:neutralPrimary, default: #333333]\\\";word-wrap:break-word;font-family:\\\"Segoe UI Regular WestEuropean\\\",\\\"Segoe UI\\\",\\\"Segoe WP\\\",Tahoma,Arial,sans-serif}.cke_editable th{font-weight:600;text-align:center}[dir=ltr] .cke_editable th{padding-left:20px}[dir=rtl] .cke_editable th{padding-right:20px}[dir=ltr] .cke_editable th{padding-right:20px}[dir=rtl] .cke_editable th{padding-left:20px}[dir=ltr] .cke_editable td{padding-left:8px}[dir=rtl] .cke_editable td{padding-right:8px}[dir=ltr] .cke_editable td{padding-right:20px}[dir=rtl] .cke_editable td{padding-left:20px}[dir=ltr] .cke_editable td p[style*=\\\"text-align: center\\\"]{padding-left:20px}[dir=rtl] .cke_editable td p[style*=\\\"text-align: center\\\"]{padding-right:20px}[dir=ltr] .cke_editable td p[style*=\\\"text-align: center\\\"]{padding-right:20px}[dir=rtl] .cke_editable td p[style*=\\\"text-align: center\\\"]{padding-left:20px}[dir=ltr] .cke_editable td p[style*=\\\"text-align: left\\\"]{padding-left:8px}[dir=rtl] .cke_editable td p[style*=\\\"text-align: left\\\"]{padding-right:8px}[dir=ltr] .cke_editable td p[style*=\\\"text-align: left\\\"]{padding-right:20px}[dir=rtl] .cke_editable td p[style*=\\\"text-align: left\\\"]{padding-left:20px}[dir=ltr] .cke_editable td p[style*=\\\"text-align: right\\\"]{padding-left:20px}[dir=rtl] .cke_editable td p[style*=\\\"text-align: right\\\"]{padding-right:20px}[dir=ltr] .cke_editable td p[style*=\\\"text-align: right\\\"]{padding-right:8px}[dir=rtl] .cke_editable td p[style*=\\\"text-align: right\\\"]{padding-left:8px}.cke_editable tr td:nth-last-child(n+20):first-child,.cke_editable tr td:nth-last-child(n+20):first-child~*{padding:0 4px 0 4px!important;font-size:14px!important}[dir=ltr] .cke_editable .ql-indent-1{padding-left:40px}[dir=rtl] .cke_editable .ql-indent-1{padding-right:40px}[dir=ltr] .cke_editable li.ql-indent-1{padding-left:59px}[dir=rtl] .cke_editable li.ql-indent-1{padding-right:59px}[dir=ltr] .cke_editable .ql-indent-2{padding-left:80px}[dir=rtl] .cke_editable .ql-indent-2{padding-right:80px}[dir=ltr] .cke_editable li.ql-indent-2{padding-left:99px}[dir=rtl] .cke_editable li.ql-indent-2{padding-right:99px}[dir=ltr] .cke_editable .ql-indent-3{padding-left:120px}[dir=rtl] .cke_editable .ql-indent-3{padding-right:120px}[dir=ltr] .cke_editable li.ql-indent-3{padding-left:139px}[dir=rtl] .cke_editable li.ql-indent-3{padding-right:139px}[dir=ltr] .cke_editable .ql-indent-4{padding-left:160px}[dir=rtl] .cke_editable .ql-indent-4{padding-right:160px}[dir=ltr] .cke_editable li.ql-indent-4{padding-left:179px}[dir=rtl] .cke_editable li.ql-indent-4{padding-right:179px}[dir=ltr] .cke_editable .ql-indent-5{padding-left:200px}[dir=rtl] .cke_editable .ql-indent-5{padding-right:200px}[dir=ltr] .cke_editable li.ql-indent-5{padding-left:219px}[dir=rtl] .cke_editable li.ql-indent-5{padding-right:219px}[dir=ltr] .cke_editable .ql-indent-6{padding-left:240px}[dir=rtl] .cke_editable .ql-indent-6{padding-right:240px}[dir=ltr] .cke_editable li.ql-indent-6{padding-left:259px}[dir=rtl] .cke_editable li.ql-indent-6{padding-right:259px}[dir=ltr] .cke_editable .ql-indent-7{padding-left:280px}[dir=rtl] .cke_editable .ql-indent-7{padding-right:280px}[dir=ltr] .cke_editable li.ql-indent-7{padding-left:299px}[dir=rtl] .cke_editable li.ql-indent-7{padding-right:299px}[dir=ltr] .cke_editable .ql-indent-8{padding-left:320px}[dir=rtl] .cke_editable .ql-indent-8{padding-right:320px}[dir=ltr] .cke_editable li.ql-indent-8{padding-left:339px}[dir=rtl] .cke_editable li.ql-indent-8{padding-right:339px}[dir=ltr] .cke_editable .ql-align-right{text-align:right}[dir=rtl] .cke_editable .ql-align-right{text-align:left}.cke_editable .ql-align-center{text-align:center}@media only screen and (max-width:640px){.cke_editable table,.cke_editable td,.cke_editable th{padding:0 8px 0 8px!important;word-break:break-all}.cke_editable table{max-width:600px!important}.cke_editable td p,.cke_editable td p span,.cke_editable th p,.cke_editable th p span{font-size:14px!important}}\", \"\"]);\n\n// exports\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// D:/agent/1/_work/24/s/common/~/css-loader?-minimize!./lib/local/appBase/components/sp-rte/ckeditor/CKTextEditor.css\n// module id = 106\n// module chunks = 0\n\n\n// WEBPACK FOOTER //\n// webpack:///lib/local/appBase/components/sp-rte/ckeditor/CKTextEditor.css","/*\r\n\tMIT License http://www.opensource.org/licenses/mit-license.php\r\n\tAuthor Tobias Koppers @sokra\r\n*/\r\n// css base code, injected by the css-loader\r\nmodule.exports = function() {\r\n\tvar list = [];\r\n\r\n\t// return the list of modules as css string\r\n\tlist.toString = function toString() {\r\n\t\tvar result = [];\r\n\t\tfor(var i = 0; i < this.length; i++) {\r\n\t\t\tvar item = this[i];\r\n\t\t\tif(item[2]) {\r\n\t\t\t\tresult.push(\"@media \" + item[2] + \"{\" + item[1] + \"}\");\r\n\t\t\t} else {\r\n\t\t\t\tresult.push(item[1]);\r\n\t\t\t}\r\n\t\t}\r\n\t\treturn result.join(\"\");\r\n\t};\r\n\r\n\t// import a list of modules into the list\r\n\tlist.i = function(modules, mediaQuery) {\r\n\t\tif(typeof modules === \"string\")\r\n\t\t\tmodules = [[null, modules, \"\"]];\r\n\t\tvar alreadyImportedModules = {};\r\n\t\tfor(var i = 0; i < this.length; i++) {\r\n\t\t\tvar id = this[i][0];\r\n\t\t\tif(typeof id === \"number\")\r\n\t\t\t\talreadyImportedModules[id] = true;\r\n\t\t}\r\n\t\tfor(i = 0; i < modules.length; i++) {\r\n\t\t\tvar item = modules[i];\r\n\t\t\t// skip already imported module\r\n\t\t\t// this implementation is not 100% perfect for weird media query combinations\r\n\t\t\t//  when a module is imported multiple times with different media queries.\r\n\t\t\t//  I hope this will never occur (Hey this way we have smaller bundles)\r\n\t\t\tif(typeof item[0] !== \"number\" || !alreadyImportedModules[item[0]]) {\r\n\t\t\t\tif(mediaQuery && !item[2]) {\r\n\t\t\t\t\titem[2] = mediaQuery;\r\n\t\t\t\t} else if(mediaQuery) {\r\n\t\t\t\t\titem[2] = \"(\" + item[2] + \") and (\" + mediaQuery + \")\";\r\n\t\t\t\t}\r\n\t\t\t\tlist.push(item);\r\n\t\t\t}\r\n\t\t}\r\n\t};\r\n\treturn list;\r\n};\r\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// D:/agent/1/_work/24/s/common/~/css-loader/lib/css-base.js\n// module id = 107\n// module chunks = 0\n\n\n// WEBPACK FOOTER //\n// webpack:///D:/agent/1/_work/24/s/common/~/css-loader/lib/css-base.js","/**\n * An IThemingInstruction can specify a rawString to be preserved or a theme slot and a default value\n * to use if that slot is not specified by the theme.\n */\n\n// Declaring a global here in case that the execution environment is Node.js (without importing the\n// entire node.js d.ts for now)\ndeclare var global: any; // tslint:disable-line:no-any\n\nexport interface IThemingInstruction {\n  theme?: string;\n  defaultValue?: string;\n  rawString?: string;\n}\n\nexport type ThemableArray = Array<IThemingInstruction>;\n\nexport interface ITheme {\n  [key: string]: string;\n}\n\ninterface IStyleSheet {\n  cssText: string;\n}\n\ninterface IExtendedHtmlStyleElement extends HTMLStyleElement {\n  styleSheet: IStyleSheet;\n}\n\ninterface IThemeState {\n  theme: ITheme;\n  lastStyleElement: IExtendedHtmlStyleElement;\n  registeredStyles: IStyleRecord[];\n  loadStyles: (styles: string) => void;\n}\n\ninterface IStyleRecord {\n  styleElement: Element;\n  themableStyle: ThemableArray;\n}\n\n// IE needs to inject styles using cssText. However, we need to evaluate this lazily, so this\n// value will initialize as undefined, and later will be set once on first loadStyles injection.\nlet _injectStylesWithCssText: boolean;\n\n// Store the theming state in __themeState__ global scope for reuse in the case of duplicate\n// load-themed-styles hosted on the page.\nconst _root: any = (typeof window === 'undefined') ? global : window; // tslint:disable-line:no-any\n\nconst _themeState: IThemeState = _root.__themeState__ = _root.__themeState__ || {\n  theme: undefined,\n  lastStyleElement: undefined,\n  registeredStyles: []\n};\n\n/**\n * Matches theming tokens. For example, \"[theme: themeSlotName, default: #FFF]\" (including the quotes).\n */\n/* tslint:disable: max-line-length */\nconst _themeTokenRegex: RegExp = /[\\'\\\"]\\[theme:\\s*(\\w+)\\s*(?:\\,\\s*default:\\s*([\\\\\"\\']?[\\.\\,\\(\\)\\#\\-\\s\\w]*[\\.\\,\\(\\)\\#\\-\\w][\\\"\\']?))?\\s*\\][\\'\\\"]/g;\n/* tslint:enable: max-line-length */\n\n/** Maximum style text length, for supporting IE style restrictions. */\nconst MAX_STYLE_CONTENT_SIZE: number = 10000;\n\n/**\n * Loads a set of style text. If it is registered too early, we will register it when the window.load\n * event is fired.\n * @param {string | ThemableArray} styles Themable style text to register.\n */\nexport function loadStyles(styles: string | ThemableArray): void {\n  const styleParts: ThemableArray = Array.isArray(styles) ? styles : splitStyles(styles);\n\n  if (_injectStylesWithCssText === undefined) {\n    _injectStylesWithCssText = shouldUseCssText();\n  }\n\n  applyThemableStyles(styleParts);\n}\n\n/**\n * Allows for customizable loadStyles logic. e.g. for server side rendering application\n * @param {(styles: string) => void} a loadStyles callback that gets called when styles are loaded or reloaded\n */\nexport function configureLoadStyles(callback: (styles: string) => void): void {\n  _themeState.loadStyles = callback;\n}\n\n/**\n * Loads a set of style text. If it is registered too early, we will register it when the window.load event\n * is fired.\n * @param {string} styleText Style to register.\n * @param {IStyleRecord} styleRecord Existing style record to re-apply.\n */\nfunction applyThemableStyles(stylesArray: ThemableArray, styleRecord?: IStyleRecord): void {\n  if (_themeState.loadStyles) {\n    const styles: string = resolveThemableArray(stylesArray);\n    _themeState.loadStyles(styles);\n  } else {\n    _injectStylesWithCssText ?\n      registerStylesIE(stylesArray, styleRecord) :\n      registerStyles(stylesArray, styleRecord);\n  }\n}\n\n/**\n * Registers a set theme tokens to find and replace. If styles were already registered, they will be\n * replaced.\n * @param {theme} theme JSON object of theme tokens to values.\n */\nexport function loadTheme(theme: ITheme): void {\n  _themeState.theme = theme;\n\n  // reload styles.\n  reloadStyles();\n}\n\n/**\n * Reloads styles.\n */\nfunction reloadStyles(): void {\n  if (_themeState.theme) {\n    for (const styleRecord of _themeState.registeredStyles) {\n      applyThemableStyles(styleRecord.themableStyle, styleRecord);\n    }\n  }\n}\n\n/**\n * Find theme tokens and replaces them with provided theme values.\n * @param {string} styles Tokenized styles to fix.\n */\nexport function detokenize(styles: string): string {\n  if (styles) {\n    styles = resolveThemableArray(splitStyles(styles));\n  }\n\n  return styles;\n}\n\n/**\n * Resolves ThemingInstruction objects in an array and joins the result into a string.\n * @param {ThemableArray} splitStyleArray ThemableArray to resolve and join.\n */\nfunction resolveThemableArray(splitStyleArray: ThemableArray): string {\n  const { theme }: IThemeState = _themeState;\n  let resolvedCss: string;\n  if (splitStyleArray) {\n    // Resolve the array of theming instructions to an array of strings.\n    // Then join the array to produce the final CSS string.\n    const resolvedArray: string[] = splitStyleArray.map((currentValue: IThemingInstruction) => {\n      const themeSlot: string = currentValue.theme;\n      if (themeSlot) {\n        // A theming annotation. Resolve it.\n        const themedValue: string = theme ? theme[themeSlot] : undefined;\n        const defaultValue: string = currentValue.defaultValue;\n\n        // Warn to console if we hit an unthemed value even when themes are provided.\n        // Allow the themedValue to be undefined to explicitly request the default value.\n        if (theme && !themedValue && console && !(themeSlot in theme)) {\n          /* tslint:disable: max-line-length */\n          console.warn(`Theming value not provided for \"${themeSlot}\". Falling back to \"${defaultValue || 'inherit'}\".`);\n          /* tslint:enable: max-line-length */\n        }\n\n        return themedValue || defaultValue || 'inherit';\n      } else {\n        // A non-themable string. Preserve it.\n        return currentValue.rawString;\n      }\n    });\n\n    resolvedCss = resolvedArray.join('');\n  }\n\n  return resolvedCss;\n}\n\n/**\n * Split tokenized CSS into an array of strings and theme specification objects\n * @param {string} styles Tokenized styles to split.\n */\nexport function splitStyles(styles: string): ThemableArray {\n  const result: ThemableArray = [];\n  if (styles) {\n    let pos: number = 0; // Current position in styles.\n    let tokenMatch: RegExpExecArray;\n    while (tokenMatch = _themeTokenRegex.exec(styles)) {\n      const matchIndex: number = tokenMatch.index;\n      if (matchIndex > pos) {\n        result.push({\n          rawString: styles.substring(pos, matchIndex)\n        });\n      }\n\n      result.push({\n        theme: tokenMatch[1],\n        defaultValue: tokenMatch[2] // May be undefined\n      });\n\n      // index of the first character after the current match\n      pos = _themeTokenRegex.lastIndex;\n    }\n\n    // Push the rest of the string after the last match.\n    result.push({\n      rawString: styles.substring(pos)\n    });\n  }\n\n  return result;\n}\n\n/**\n * Registers a set of style text. If it is registered too early, we will register it when the\n * window.load event is fired.\n * @param {ThemableArray} styleArray Array of IThemingInstruction objects to register.\n * @param {IStyleRecord} styleRecord May specify a style Element to update.\n */\nfunction registerStyles(styleArray: ThemableArray, styleRecord?: IStyleRecord): void {\n  const head: HTMLHeadElement = document.getElementsByTagName('head')[0];\n  const styleElement: HTMLStyleElement = document.createElement('style');\n\n  styleElement.type = 'text/css';\n  styleElement.appendChild(document.createTextNode(resolveThemableArray(styleArray)));\n\n  if (styleRecord) {\n    head.replaceChild(styleElement, styleRecord.styleElement);\n    styleRecord.styleElement = styleElement;\n  } else {\n    head.appendChild(styleElement);\n  }\n\n  if (!styleRecord) {\n    _themeState.registeredStyles.push({\n      styleElement: styleElement,\n      themableStyle: styleArray\n    });\n  }\n}\n\n/**\n * Registers a set of style text, for IE 9 and below, which has a ~30 style element limit so we need\n * to register slightly differently.\n * @param {ThemableArray} styleArray Array of IThemingInstruction objects to register.\n * @param {IStyleRecord} styleRecord May specify a style Element to update.\n */\nfunction registerStylesIE(styleArray: ThemableArray, styleRecord?: IStyleRecord): void {\n  const head: HTMLHeadElement = document.getElementsByTagName('head')[0];\n  let { lastStyleElement, registeredStyles }: IThemeState = _themeState;\n\n  const stylesheet: IStyleSheet = lastStyleElement ? lastStyleElement.styleSheet : undefined;\n  const lastStyleContent: string = stylesheet ? stylesheet.cssText : '';\n  let lastRegisteredStyle: IStyleRecord = registeredStyles[registeredStyles.length - 1];\n  const resolvedStyleText: string = resolveThemableArray(styleArray);\n\n  if (!lastStyleElement || (lastStyleContent.length + resolvedStyleText.length) > MAX_STYLE_CONTENT_SIZE) {\n    lastStyleElement = document.createElement('style') as IExtendedHtmlStyleElement;\n    lastStyleElement.type = 'text/css';\n\n    if (styleRecord) {\n      head.replaceChild(lastStyleElement, styleRecord.styleElement);\n      styleRecord.styleElement = lastStyleElement;\n    } else {\n      head.appendChild(lastStyleElement);\n    }\n\n    if (!styleRecord) {\n      lastRegisteredStyle = {\n        styleElement: lastStyleElement,\n        themableStyle: styleArray\n      };\n      registeredStyles.push(lastRegisteredStyle);\n    }\n  }\n\n  lastStyleElement.styleSheet.cssText += detokenize(resolvedStyleText);\n  Array.prototype.push.apply(lastRegisteredStyle.themableStyle, styleArray); // concat in-place\n\n  // Preserve the theme state.\n  _themeState.lastStyleElement = lastStyleElement;\n}\n\n/**\n * Checks to see if styleSheet exists as a property off of a style element.\n * This will determine if style registration should be done via cssText (<= IE9) or not\n */\nfunction shouldUseCssText(): boolean {\n  let useCSSText: boolean = false;\n\n  if (typeof document !== 'undefined') {\n    const emptyStyle: IExtendedHtmlStyleElement = document.createElement('style') as IExtendedHtmlStyleElement;\n\n    emptyStyle.type = 'text/css';\n    useCSSText = !!emptyStyle.styleSheet;\n  }\n\n  return useCSSText;\n}\n\n\n\n// WEBPACK FOOTER //\n// /src/index.ts\n\n\n// WEBPACK FOOTER //\n// webpack:///src/index.ts","\"use strict\";\nexports.CKEDITOR_TABLEPASTE_FLIGHT_ID = 958;\nexports.CKEDITOR_FLIGHT_ID = 955;\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./lib/local/appBase/components/sp-rte/ckeditor/CKEditorFlights.js\n// module id = 109\n// module chunks = 0\n\n\n// WEBPACK FOOTER //\n// webpack:///lib/local/appBase/components/sp-rte/ckeditor/CKEditorFlights.js","\"use strict\";\nvar __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\n};\nvar office_ui_fabric_react_1 = require('office-ui-fabric-react');\nvar sp_telemetry_1 = require('@ms/sp-telemetry');\nvar sp_core_library_1 = require('@microsoft/sp-core-library');\nvar QuillLoader_1 = require('./QuillLoader');\nrequire('./QuillEditor.scss');\nvar RteStrings_resx_1 = require('../loc/RteStrings.resx');\nvar odsp_utilities_bundle_1 = require('@ms/odsp-utilities-bundle');\nvar QuillEditor = (function () {\n    function QuillEditor(config, currentHTML, editorElement, selectionChangeCallback, textChangeCallback) {\n        this._platform = new odsp_utilities_bundle_1.PlatformDetection();\n        this._config = config;\n        this._editorElement = editorElement;\n        this._handleSelectionChange = selectionChangeCallback;\n        this._handleTextChange = textChangeCallback;\n        this._initialize(currentHTML);\n    }\n    QuillEditor.createNewEditor = function (config, currentHTML, editorElement, selectionChangeCallback, textChangeCallback, startupFocus) {\n        return new Promise(function (resolve) {\n            QuillEditor.moduleLoader.loadModule().then(function () {\n                var editor = new QuillEditor(config, currentHTML, editorElement, selectionChangeCallback, textChangeCallback);\n                resolve(editor);\n            });\n        });\n    };\n    QuillEditor.stripOutNewLinesAndSpacesFromInnerHTML = function (innerHTML) {\n        return innerHTML.replace(/>\\s+</g, '><');\n    };\n    QuillEditor._createQosScope = function (scenario) {\n        return new sp_telemetry_1._QosMonitor(\"Quill\" + scenario);\n    };\n    QuillEditor._handleMonitoredException = function (qos, err) {\n        qos.writeUnexpectedFailure('Exception', err);\n    };\n    QuillEditor.prototype.clearFormatting = function (start, end) {\n        var formats = {};\n        for (var _i = 0, _a = this._config.supportedFormatsArray; _i < _a.length; _i++) {\n            var format = _a[_i];\n            formats[format.editorKey] = false;\n        }\n        this.format(start, end, formats);\n    };\n    QuillEditor.prototype.destroy = function () {\n        if (this._quill) {\n            var previousHTML = this.getHTML();\n            this._quill = undefined;\n            return previousHTML;\n        }\n        return undefined;\n    };\n    QuillEditor.prototype.focus = function () {\n        if (this._editorElement && this._editorElement.setActive) {\n            this._quillEditorElement.setActive();\n        }\n        else {\n            this._quill.focus();\n        }\n    };\n    QuillEditor.prototype.format = function (start, end, formats, applyAllFormatsToLine) {\n        var lineFormats = applyAllFormatsToLine ? formats : {};\n        var nonLineFormats = {};\n        if (!applyAllFormatsToLine) {\n            var _loop_1 = function(formateditorKey) {\n                var format = this_1._config.supportedFormatsArray\n                    .filter(function (format) { return format.editorKey === formateditorKey; })[0];\n                if (format && format.isLine) {\n                    lineFormats[format.editorKey] = formats[format.editorKey];\n                }\n                else {\n                    nonLineFormats[format.editorKey] = formats[format.editorKey];\n                }\n            };\n            var this_1 = this;\n            for (var formateditorKey in formats) {\n                _loop_1(formateditorKey);\n            }\n        }\n        this._quill.formatLine(start, end - start, lineFormats);\n        if (!applyAllFormatsToLine) {\n            if (nonLineFormats.hasOwnProperty('link') &&\n                this.isFormatAppliedToRange(start, end, this._config.formats.get('link'))) {\n                if (start === end) {\n                    var linkElement = this._findWrappingElementByTagName(start, 'A');\n                    if (linkElement) {\n                        if (nonLineFormats['link']) {\n                            linkElement.setAttribute('href', nonLineFormats['link']);\n                            linkElement.setAttribute('target', '_blank');\n                        }\n                        else {\n                            var container = linkElement.parentElement;\n                            if (container) {\n                                var textNode = document.createTextNode(linkElement.textContent);\n                                container.insertBefore(textNode, linkElement);\n                                container.removeChild(linkElement);\n                            }\n                        }\n                        nonLineFormats['link'] = undefined;\n                    }\n                }\n                else if (nonLineFormats['link']) {\n                    var linkElement = void 0;\n                    var linkAtEnd = this._findWrappingElementByTagName(end, 'A');\n                    if (end - start > 1) {\n                        var linkAtStart = this._findWrappingElementByTagName(start + 1, 'A');\n                        linkElement = linkAtStart && linkAtEnd && linkAtStart.isEqualNode(linkAtEnd) ? linkAtEnd : undefined;\n                    }\n                    else {\n                        linkElement = linkAtEnd;\n                    }\n                    if (linkElement) {\n                        linkElement.setAttribute('href', nonLineFormats['link']);\n                        linkElement.setAttribute('target', '_blank');\n                        nonLineFormats['link'] = undefined;\n                    }\n                }\n            }\n            if (start === end) {\n                for (var format in nonLineFormats) {\n                    this._quill.format(format, nonLineFormats[format]);\n                }\n            }\n            else {\n                this._quill.formatText(start, end - start, nonLineFormats);\n            }\n        }\n    };\n    QuillEditor.prototype.getBounds = function (position) {\n        return this._quill.getBounds(position);\n    };\n    QuillEditor.prototype.getFormatValue = function (start, end, format) {\n        if (format.key === 'link') {\n            var linkElement = void 0;\n            var linkAtEnd = this._findWrappingElementByTagName(end, 'A');\n            if (end - start > 1) {\n                var linkAtStart = this._findWrappingElementByTagName(start + 1, 'A');\n                linkElement = linkAtStart && linkAtEnd && linkAtStart.isEqualNode(linkAtEnd) ? linkAtEnd : undefined;\n            }\n            else {\n                linkElement = linkAtEnd;\n            }\n            return linkElement ? linkAtEnd.getAttribute('href') : undefined;\n        }\n        else {\n            var activeFormats = this._quill.getFormat(start, end);\n            return activeFormats[format.editorKey];\n        }\n    };\n    QuillEditor.prototype.getSelection = function () {\n        var range = this._quill.getSelection();\n        return range ? {\n            start: range.index,\n            end: range.index + range.length\n        } : undefined;\n    };\n    QuillEditor.prototype.getText = function (range) {\n        return range ?\n            this._quill.getText(range.start, range.end - range.start) :\n            this._quill.getText();\n    };\n    QuillEditor.prototype.getHTML = function () {\n        return this._quillEditorElement ? this._quillEditorElement.innerHTML : '';\n    };\n    QuillEditor.prototype.getEditorType = function () {\n        return 'Quill';\n    };\n    QuillEditor.prototype.isFormatAppliedToRange = function (start, end, format) {\n        var activeFormats = this._quill.getFormat(start, end - start);\n        return format.editorValue !== undefined ?\n            activeFormats[format.editorKey] === format.editorValue :\n            activeFormats.hasOwnProperty(format.editorKey);\n    };\n    QuillEditor.prototype.setSelection = function (range) {\n        this._quill.setSelection(range.start, range.end - range.start);\n    };\n    QuillEditor.prototype._findWrappingElementByTagName = function (position, tagName) {\n        if (this._quillModule && tagName === 'A') {\n            var _linkFormat = this._quillModule.import('formats/link');\n            var link = this._quill.scroll.descendants(_linkFormat, Math.max(0, position - 1))[0];\n            return link ? link.domNode : undefined;\n        }\n        return undefined;\n    };\n    QuillEditor.prototype._handleSelectionChangeConvert = function (range) {\n        var newRange = range ? {\n            start: range.index,\n            end: range.index + range.length\n        } : undefined;\n        this._handleSelectionChange(newRange);\n    };\n    QuillEditor.prototype._addMatcher = function (quill, tagName, formatName, quillModule) {\n        quill.clipboard.addMatcher(tagName, function (node, delta) {\n            try {\n                sp_telemetry_1._EngagementLogger.logEvent(formatName + '.Paste');\n                return delta.compose(new quillModule.imports.delta().retain(delta.length(), { formatName: true }));\n            }\n            catch (e) {\n                return delta;\n            }\n        });\n    };\n    QuillEditor.prototype._initialize = function (currentHTML) {\n        var _this = this;\n        QuillEditor.moduleLoader.loadModule().then(function (quillModule) {\n            var quillFormatKeys = _this._config.supportedFormatsArray\n                .filter(function (format) { return format.isEditorNative; })\n                .map(function (format) { return format.editorKey; })\n                .filter(function (formatKey, index, self) { return self.indexOf(formatKey) === index; }); \n            _this._quillModule = quillModule;\n            var quill = new quillModule(_this._editorElement, {\n                formats: quillFormatKeys,\n                readOnly: false,\n                styles: false,\n                placeholder: RteStrings_resx_1.default.TextWebPartPlaceholder\n            });\n            var container = document.createElement('DIV');\n            container.innerHTML = currentHTML;\n            var divs = container.querySelectorAll('div');\n            for (var i = 0; i < divs.length; i++) {\n                var div = divs[i];\n                var newElement = div.classList.contains('quote-true') ?\n                    document.createElement('BLOCKQUOTE') :\n                    document.createElement('P');\n                div.classList.remove('quote-true');\n                for (var j = 0; j < div.classList.length; j++) {\n                    newElement.classList.add(div.classList[j]);\n                }\n                if (div.hasAttribute('style')) {\n                    newElement.setAttribute('style', div.getAttribute('style'));\n                }\n                newElement.innerHTML = div.innerHTML;\n                div.parentElement.insertBefore(newElement, div);\n                div.parentElement.removeChild(div);\n            }\n            var newTags = { 'b': 'strong', 'i': 'em' };\n            for (var tag in newTags) {\n                var elements = container.querySelectorAll(tag);\n                for (var i = 0; i < elements.length; i++) {\n                    var element = elements[i];\n                    var newElement = document.createElement(newTags[tag]);\n                    newElement.innerHTML = element.innerHTML;\n                    element.parentElement.insertBefore(newElement, element);\n                    element.parentElement.removeChild(element);\n                }\n            }\n            currentHTML = QuillEditor.stripOutNewLinesAndSpacesFromInnerHTML(container.innerHTML);\n            _this._quillEditorElement = _this._editorElement.querySelector('.ql-editor');\n            _this._quillEditorElement.innerHTML = currentHTML;\n            quill.on('text-change', _this._handleTextChange);\n            quill.on('selection-change', _this._handleSelectionChangeConvert);\n            _this._quill = quill;\n            if (!sp_core_library_1._SPKillSwitch.isActivated(sp_core_library_1.Guid.tryParse('b5f407f5-9f8c-4def-850a-32438487ca2d'), '10/16/2016', 'QuillPasteMatchers')) {\n                quill.clipboard.addMatcher('h1', function (node, delta) {\n                    try {\n                        sp_telemetry_1._EngagementLogger.logEvent('h1.Paste');\n                        return delta.compose(new quillModule.imports.delta().retain(delta.length(), { header: 2 }));\n                    }\n                    catch (e) {\n                        return delta;\n                    }\n                });\n                _this._addMatcher(quill, 'p[class*=\"MsoQuote\"]', 'blockquote', quillModule);\n                _this._addMatcher(quill, 'a', 'link', quillModule);\n                _this._addMatcher(quill, 'table', 'Table', quillModule);\n                _this._addMatcher(quill, 'img', 'Image', quillModule);\n                quill.clipboard.addMatcher('p[class*=\"MsoList\"]', function (node, delta) {\n                    var qos = QuillEditor._createQosScope('PasteMsoList');\n                    try {\n                        var style = node.getAttribute('style');\n                        var x = 1;\n                        var maxLevel = 10; \n                        if (style && style.indexOf('level') !== -1) {\n                            while (style.indexOf('level' + x) === -1 && x <= maxLevel) {\n                                ++x;\n                            }\n                        }\n                        else {\n                            qos.writeExpectedFailure('NonLevelListFormat',  undefined, { 'style': style });\n                        }\n                        if (node.firstChild.nodeType === Node.COMMENT_NODE) {\n                            node.removeChild(node.firstChild);\n                        }\n                        var type = 'ordered';\n                        var firstChild = node.firstChild;\n                        if (/mso-list\\s*:\\s*Ignore/i.test(style) ||\n                            firstChild.nodeType !== Node.TEXT_NODE &&\n                                !/^(:?\\s|&nbsp;)+$/.test(firstChild.textContent) &&\n                                firstChild.nextSibling.nodeType !== Node.TEXT_NODE) {\n                            type = 'bullet';\n                        }\n                        sp_telemetry_1._EngagementLogger.logEvent(type + 'ListItem.Paste');\n                        var attr = { list: type };\n                        if (x > 1) {\n                            attr.indent = x - 1;\n                        }\n                        var textContent = node.textContent;\n                        var deltaLength = delta.length();\n                        var length_1 = deltaLength - textContent.length;\n                        var res = textContent.match(/^\\s*\\S+\\s*/);\n                        if (res && res[0]) {\n                            length_1 += res[0].length;\n                        }\n                        var tempDelta = delta.compose(new quillModule.imports.delta().delete(length_1 - 1));\n                        delta = tempDelta.compose(new quillModule.imports.delta().retain(tempDelta.length(), attr));\n                        qos.writeSuccess();\n                    }\n                    catch (e) {\n                        QuillEditor._handleMonitoredException(qos, e);\n                    }\n                    return delta;\n                });\n            }\n        });\n    };\n    QuillEditor.moduleLoader = new QuillLoader_1.default();\n    __decorate([\n        office_ui_fabric_react_1.autobind\n    ], QuillEditor.prototype, \"focus\", null);\n    __decorate([\n        office_ui_fabric_react_1.autobind\n    ], QuillEditor.prototype, \"format\", null);\n    __decorate([\n        office_ui_fabric_react_1.autobind\n    ], QuillEditor.prototype, \"getSelection\", null);\n    __decorate([\n        office_ui_fabric_react_1.autobind\n    ], QuillEditor.prototype, \"_findWrappingElementByTagName\", null);\n    __decorate([\n        office_ui_fabric_react_1.autobind\n    ], QuillEditor.prototype, \"_handleSelectionChangeConvert\", null);\n    return QuillEditor;\n}());\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.default = QuillEditor;\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./lib/local/appBase/components/sp-rte/quill/QuillEditor.js\n// module id = 110\n// module chunks = 0\n\n\n// WEBPACK FOOTER //\n// webpack:///lib/local/appBase/components/sp-rte/quill/QuillEditor.js","\"use strict\";\nvar sp_telemetry_1 = require('@ms/sp-telemetry');\nvar QuillLoader = (function () {\n    function QuillLoader() {\n    }\n    QuillLoader.prototype.loadModule = function () {\n        if (!QuillLoader._quillPromise) {\n            QuillLoader._quillPromise = new Promise(function (complete) {\n                require.ensure(['quill'], function (require) {\n                    var quill = require('quill');\n                    QuillLoader._quillModule = quill;\n                    complete(quill);\n                }, 'sp-client-preview-quill');\n            });\n            QuillLoader._quillPromise.catch(function (error) {\n                sp_telemetry_1._TraceLogger.logError(QuillLoader.logSource, error);\n            });\n        }\n        return QuillLoader._quillPromise;\n    };\n    QuillLoader.logSource = sp_telemetry_1._LogSource.create('SPRteQuillLoader');\n    return QuillLoader;\n}());\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.default = QuillLoader;\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./lib/local/appBase/components/sp-rte/quill/QuillLoader.js\n// module id = 111\n// module chunks = 0\n\n\n// WEBPACK FOOTER //\n// webpack:///lib/local/appBase/components/sp-rte/quill/QuillLoader.js","require('QuillEditor.css');\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./lib/local/appBase/components/sp-rte/quill/QuillEditor.scss.js\n// module id = 117\n// module chunks = 0\n\n\n// WEBPACK FOOTER //\n// webpack:///lib/local/appBase/components/sp-rte/quill/QuillEditor.scss.js","var content = require(\"!!./../../../../../../../../common/node_modules/css-loader/index.js?-minimize!./QuillEditor.css\");\nvar loader = require(\"D:\\\\agent\\\\1\\\\_work\\\\24\\\\s\\\\common\\\\node_modules\\\\@microsoft\\\\load-themed-styles\\\\lib\\\\index.js\");\n\nif(typeof content === \"string\") content = [[module.id, content]];\n\n// add the styles to the DOM\nfor (var i = 0; i < content.length; i++) loader.loadStyles(content[i][1]);\n\nif(content.locals) module.exports = content.locals;\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./lib/local/appBase/components/sp-rte/quill/QuillEditor.css\n// module id = 118\n// module chunks = 0\n\n\n// WEBPACK FOOTER //\n// webpack:///lib/local/appBase/components/sp-rte/quill/QuillEditor.css?3773","exports = module.exports = require(\"./../../../../../../../../common/node_modules/css-loader/lib/css-base.js\")();\n// imports\n\n\n// module\nexports.push([module.id, \"/*!\\n * Quill Editor v1.1.0\\n * https://quilljs.com/\\n * Copyright (c) 2014, Jason Chen\\n * Copyright (c) 2013, salesforce.com\\n */.ql-container{box-sizing:border-box;font-family:Helvetica,Arial,sans-serif;font-size:13px;height:100%;margin:0;position:relative}.ql-container.ql-disabled .ql-tooltip{visibility:hidden}.ql-clipboard{left:-100000px;height:1px;overflow-y:hidden;position:absolute;top:50%}.ql-clipboard p{margin:0;padding:0}.ql-editor{box-sizing:border-box;cursor:text;line-height:1.42;height:100%;outline:0;overflow-y:auto;padding:12px 15px;tab-size:4;-moz-tab-size:4;text-align:left;white-space:pre-wrap;word-wrap:break-word}.ql-editor blockquote,.ql-editor h1,.ql-editor h2,.ql-editor h3,.ql-editor h4,.ql-editor h5,.ql-editor h6,.ql-editor ol,.ql-editor p,.ql-editor pre,.ql-editor ul{margin:0;padding:0;counter-reset:list-1 list-2 list-3 list-4 list-5 list-6 list-7 list-8 list-9}.ql-editor ol,.ql-editor ul{padding-left:1.5em}.ql-editor ol>li,.ql-editor ul>li{list-style-type:none}.ql-editor ul>li::before{content:'\\\\25CF'}.ql-editor li::before{display:inline-block;margin-right:.3em;text-align:right;white-space:nowrap;width:1.2em}.ql-editor li:not(.ql-direction-rtl)::before{margin-left:-1.5em}.ql-editor ol li,.ql-editor ul li{padding-left:1.5em}.ql-editor ol li{counter-reset:list-1 list-2 list-3 list-4 list-5 list-6 list-7 list-8 list-9;counter-increment:list-num}.ql-editor ol li:before{content:counter(list-num,decimal) '. '}.ql-editor ol li.ql-indent-1{counter-increment:list-1}.ql-editor ol li.ql-indent-1:before{content:counter(list-1,lower-alpha) '. '}.ql-editor ol li.ql-indent-1{counter-reset:list-2 list-3 list-4 list-5 list-6 list-7 list-8 list-9}.ql-editor ol li.ql-indent-2{counter-increment:list-2}.ql-editor ol li.ql-indent-2:before{content:counter(list-2,lower-roman) '. '}.ql-editor ol li.ql-indent-2{counter-reset:list-3 list-4 list-5 list-6 list-7 list-8 list-9}.ql-editor ol li.ql-indent-3{counter-increment:list-3}.ql-editor ol li.ql-indent-3:before{content:counter(list-3,decimal) '. '}.ql-editor ol li.ql-indent-3{counter-reset:list-4 list-5 list-6 list-7 list-8 list-9}.ql-editor ol li.ql-indent-4{counter-increment:list-4}.ql-editor ol li.ql-indent-4:before{content:counter(list-4,lower-alpha) '. '}.ql-editor ol li.ql-indent-4{counter-reset:list-5 list-6 list-7 list-8 list-9}.ql-editor ol li.ql-indent-5{counter-increment:list-5}.ql-editor ol li.ql-indent-5:before{content:counter(list-5,lower-roman) '. '}.ql-editor ol li.ql-indent-5{counter-reset:list-6 list-7 list-8 list-9}.ql-editor ol li.ql-indent-6{counter-increment:list-6}.ql-editor ol li.ql-indent-6:before{content:counter(list-6,decimal) '. '}.ql-editor ol li.ql-indent-6{counter-reset:list-7 list-8 list-9}.ql-editor ol li.ql-indent-7{counter-increment:list-7}.ql-editor ol li.ql-indent-7:before{content:counter(list-7,lower-alpha) '. '}.ql-editor ol li.ql-indent-7{counter-reset:list-8 list-9}.ql-editor ol li.ql-indent-8{counter-increment:list-8}.ql-editor ol li.ql-indent-8:before{content:counter(list-8,lower-roman) '. '}.ql-editor ol li.ql-indent-8{counter-reset:list-9}.ql-editor ol li.ql-indent-9{counter-increment:list-9}.ql-editor ol li.ql-indent-9:before{content:counter(list-9,decimal) '. '}.ql-editor .ql-indent-1:not(.ql-direction-rtl){padding-left:3em}.ql-editor li.ql-indent-1:not(.ql-direction-rtl){padding-left:4.5em}.ql-editor .ql-indent-1.ql-direction-rtl.ql-align-right{padding-right:3em}.ql-editor li.ql-indent-1.ql-direction-rtl.ql-align-right{padding-right:4.5em}.ql-editor .ql-indent-2:not(.ql-direction-rtl){padding-left:6em}.ql-editor li.ql-indent-2:not(.ql-direction-rtl){padding-left:7.5em}.ql-editor .ql-indent-2.ql-direction-rtl.ql-align-right{padding-right:6em}.ql-editor li.ql-indent-2.ql-direction-rtl.ql-align-right{padding-right:7.5em}.ql-editor .ql-indent-3:not(.ql-direction-rtl){padding-left:9em}.ql-editor li.ql-indent-3:not(.ql-direction-rtl){padding-left:10.5em}.ql-editor .ql-indent-3.ql-direction-rtl.ql-align-right{padding-right:9em}.ql-editor li.ql-indent-3.ql-direction-rtl.ql-align-right{padding-right:10.5em}.ql-editor .ql-indent-4:not(.ql-direction-rtl){padding-left:12em}.ql-editor li.ql-indent-4:not(.ql-direction-rtl){padding-left:13.5em}.ql-editor .ql-indent-4.ql-direction-rtl.ql-align-right{padding-right:12em}.ql-editor li.ql-indent-4.ql-direction-rtl.ql-align-right{padding-right:13.5em}.ql-editor .ql-indent-5:not(.ql-direction-rtl){padding-left:15em}.ql-editor li.ql-indent-5:not(.ql-direction-rtl){padding-left:16.5em}.ql-editor .ql-indent-5.ql-direction-rtl.ql-align-right{padding-right:15em}.ql-editor li.ql-indent-5.ql-direction-rtl.ql-align-right{padding-right:16.5em}.ql-editor .ql-indent-6:not(.ql-direction-rtl){padding-left:18em}.ql-editor li.ql-indent-6:not(.ql-direction-rtl){padding-left:19.5em}.ql-editor .ql-indent-6.ql-direction-rtl.ql-align-right{padding-right:18em}.ql-editor li.ql-indent-6.ql-direction-rtl.ql-align-right{padding-right:19.5em}.ql-editor .ql-indent-7:not(.ql-direction-rtl){padding-left:21em}.ql-editor li.ql-indent-7:not(.ql-direction-rtl){padding-left:22.5em}.ql-editor .ql-indent-7.ql-direction-rtl.ql-align-right{padding-right:21em}.ql-editor li.ql-indent-7.ql-direction-rtl.ql-align-right{padding-right:22.5em}.ql-editor .ql-indent-8:not(.ql-direction-rtl){padding-left:24em}.ql-editor li.ql-indent-8:not(.ql-direction-rtl){padding-left:25.5em}.ql-editor .ql-indent-8.ql-direction-rtl.ql-align-right{padding-right:24em}.ql-editor li.ql-indent-8.ql-direction-rtl.ql-align-right{padding-right:25.5em}.ql-editor .ql-indent-9:not(.ql-direction-rtl){padding-left:27em}.ql-editor li.ql-indent-9:not(.ql-direction-rtl){padding-left:28.5em}.ql-editor .ql-indent-9.ql-direction-rtl.ql-align-right{padding-right:27em}.ql-editor li.ql-indent-9.ql-direction-rtl.ql-align-right{padding-right:28.5em}.ql-editor .ql-video{display:block;max-width:100%}.ql-editor .ql-video.ql-align-center{margin:0 auto}.ql-editor .ql-video.ql-align-right{margin:0 0 0 auto}.ql-editor .ql-bg-black{background-color:#000}.ql-editor .ql-bg-red{background-color:#e60000}.ql-editor .ql-bg-orange{background-color:#f90}.ql-editor .ql-bg-yellow{background-color:#ff0}.ql-editor .ql-bg-green{background-color:#008a00}.ql-editor .ql-bg-blue{background-color:#06c}.ql-editor .ql-bg-purple{background-color:#93f}.ql-editor .ql-color-white{color:#fff}.ql-editor .ql-color-red{color:#e60000}.ql-editor .ql-color-orange{color:#f90}.ql-editor .ql-color-yellow{color:#ff0}.ql-editor .ql-color-green{color:#008a00}.ql-editor .ql-color-blue{color:#06c}.ql-editor .ql-color-purple{color:#93f}.ql-editor .ql-font-serif{font-family:Georgia,Times New Roman,serif}.ql-editor .ql-font-monospace{font-family:Monaco,Courier New,monospace}.ql-editor .ql-size-small{font-size:.75em}.ql-editor .ql-size-large{font-size:1.5em}.ql-editor .ql-size-huge{font-size:2.5em}.ql-editor .ql-direction-rtl{direction:rtl;text-align:inherit}.ql-editor .ql-align-center{text-align:center}.ql-editor .ql-align-justify{text-align:justify}.ql-editor .ql-align-right{text-align:right}.ql-editor.ql-blank::before{color:rgba(0,0,0,.6);content:attr(data-placeholder);font-style:italic;pointer-events:none;position:absolute}.ql-editor{overflow:hidden}[dir=ltr] .ql-editor{text-align:left}[dir=rtl] .ql-editor{text-align:right}.ql-editor ol,.ql-editor ul{list-style-position:inside}[dir=ltr] .ql-editor ol,[dir=ltr] .ql-editor ul{padding-left:20px}[dir=rtl] .ql-editor ol,[dir=rtl] .ql-editor ul{padding-right:20px}[dir=ltr] .ql-editor li::before{margin-left:-19px}[dir=rtl] .ql-editor li::before{margin-right:-19px}[dir=ltr] .ql-editor li::before{margin-right:4px}[dir=rtl] .ql-editor li::before{margin-left:4px}[dir=ltr] .ql-editor li::before{text-align:right}[dir=rtl] .ql-editor li::before{text-align:left}[dir=ltr] .ql-editor ol li,[dir=ltr] .ql-editor ul li{padding-left:19px}[dir=rtl] .ql-editor ol li,[dir=rtl] .ql-editor ul li{padding-right:19px}[dir=ltr] .ql-editor .ql-indent-1{padding-left:40px}[dir=rtl] .ql-editor .ql-indent-1{padding-right:40px}[dir=ltr] .ql-editor li.ql-indent-1{padding-left:59px}[dir=rtl] .ql-editor li.ql-indent-1{padding-right:59px}[dir=ltr] .ql-editor .ql-indent-2{padding-left:80px}[dir=rtl] .ql-editor .ql-indent-2{padding-right:80px}[dir=ltr] .ql-editor li.ql-indent-2{padding-left:99px}[dir=rtl] .ql-editor li.ql-indent-2{padding-right:99px}[dir=ltr] .ql-editor .ql-indent-3{padding-left:120px}[dir=rtl] .ql-editor .ql-indent-3{padding-right:120px}[dir=ltr] .ql-editor li.ql-indent-3{padding-left:139px}[dir=rtl] .ql-editor li.ql-indent-3{padding-right:139px}[dir=ltr] .ql-editor .ql-indent-4{padding-left:160px}[dir=rtl] .ql-editor .ql-indent-4{padding-right:160px}[dir=ltr] .ql-editor li.ql-indent-4{padding-left:179px}[dir=rtl] .ql-editor li.ql-indent-4{padding-right:179px}[dir=ltr] .ql-editor .ql-indent-5{padding-left:200px}[dir=rtl] .ql-editor .ql-indent-5{padding-right:200px}[dir=ltr] .ql-editor li.ql-indent-5{padding-left:219px}[dir=rtl] .ql-editor li.ql-indent-5{padding-right:219px}[dir=ltr] .ql-editor .ql-indent-6{padding-left:240px}[dir=rtl] .ql-editor .ql-indent-6{padding-right:240px}[dir=ltr] .ql-editor li.ql-indent-6{padding-left:259px}[dir=rtl] .ql-editor li.ql-indent-6{padding-right:259px}[dir=ltr] .ql-editor .ql-indent-7{padding-left:280px}[dir=rtl] .ql-editor .ql-indent-7{padding-right:280px}[dir=ltr] .ql-editor li.ql-indent-7{padding-left:299px}[dir=rtl] .ql-editor li.ql-indent-7{padding-right:299px}[dir=ltr] .ql-editor .ql-indent-8{padding-left:320px}[dir=rtl] .ql-editor .ql-indent-8{padding-right:320px}[dir=ltr] .ql-editor li.ql-indent-8{padding-left:339px}[dir=rtl] .ql-editor li.ql-indent-8{padding-right:339px}[dir=ltr] .ql-editor .ql-align-right{text-align:right}[dir=rtl] .ql-editor .ql-align-right{text-align:left}\", \"\"]);\n\n// exports\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// D:/agent/1/_work/24/s/common/~/css-loader?-minimize!./lib/local/appBase/components/sp-rte/quill/QuillEditor.css\n// module id = 119\n// module chunks = 0\n\n\n// WEBPACK FOOTER //\n// webpack:///lib/local/appBase/components/sp-rte/quill/QuillEditor.css","\"use strict\";\nvar strings = UNIT_TEST\n    ? require('../../../../../resx-strings/en-us.json')\n    : require('resx-strings');\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.default = (strings['_HZH0fzNkDqTJ/5fF9kAU6A'] || {});\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./lib/local/appBase/components/sp-rte/loc/RteStrings.resx.js\n// module id = 120\n// module chunks = 0\n\n\n// WEBPACK FOOTER //\n// webpack:///lib/local/appBase/components/sp-rte/loc/RteStrings.resx.js","module.exports = __WEBPACK_EXTERNAL_MODULE_121__;\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"resx-strings\"\n// module id = 121\n// module chunks = 0\n\n\n// WEBPACK FOOTER //\n// external \"resx-strings\"","\"use strict\";\nvar __extends = (this && this.__extends) || function (d, b) {\n    for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p];\n    function __() { this.constructor = d; }\n    d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n};\nvar __assign = (this && this.__assign) || Object.assign || function(t) {\n    for (var s, i = 1, n = arguments.length; i < n; i++) {\n        s = arguments[i];\n        for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p))\n            t[p] = s[p];\n    }\n    return t;\n};\nvar __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\n};\nvar React = require('react');\nvar ReactDom = require('react-dom');\nvar sp_telemetry_1 = require('@ms/sp-telemetry');\nvar odsp_utilities_bundle_1 = require('@ms/odsp-utilities-bundle');\nvar sp_core_library_1 = require('@microsoft/sp-core-library');\nvar SPRteFormattingBar_1 = require('../formattingbar/SPRteFormattingBar');\nvar SPRteLinkDialog_1 = require('../formattingbar/SPRteLinkDialog');\nvar CKTextEditor_1 = require('../ckeditor/CKTextEditor');\nvar ToolbarButton_1 = require('../../sp-canvas/toolbar/toolbarButton/ToolbarButton');\nvar ToolbarSubmenu_1 = require('../../sp-canvas/toolbar/toolbarSubMenu/ToolbarSubmenu');\nvar RteA11y_1 = require('../a11y/RteA11y');\nvar office_ui_fabric_react_1 = require('office-ui-fabric-react');\nrequire('./BaseRte.scss');\nvar RteStrings_resx_1 = require('../loc/RteStrings.resx');\nvar CLICK_ACTION = '.Click';\nvar BUTTON_NAME = 'Button';\nexports.CREATE_EDITOR_MONITOR = 'CreateNewEditor';\nexports.CREATE_EDITOR_MONITOR_FAILURE = 'EditorFailedToLoad';\nvar CREATE_EDITOR_MONITOR_EXPECTED = 'CanvasUnmounted';\nvar BaseRte = (function (_super) {\n    __extends(BaseRte, _super);\n    function BaseRte(props, rteOptions) {\n        _super.call(this, props);\n        this._initState();\n        this._options = this.props.options || rteOptions;\n        this._config = this._options.config;\n        this._restoreSelectionOnNextFocus = false;\n        this._buttonStates = new Map();\n        this._selectionInitiated = false;\n        this._selectionShouldEnd = false;\n        this._isRtl = document.documentElement.getAttribute('dir').toLowerCase() === 'rtl';\n        if (this.state.displayMode === sp_core_library_1.DisplayMode.Edit && !this._editor) {\n            this._options.loader.loadModule();\n        }\n    }\n    BaseRte.prototype._initState = function () {\n        this.state = {\n            displayMode: this.props.displayMode,\n            formattingBarPosition: undefined,\n            isFormattingBarHidden: true,\n            isLinkDialogOpen: false\n        };\n    };\n    BaseRte.prototype.render = function () {\n        var formattingBar;\n        var html;\n        var className;\n        if (this.state.displayMode === sp_core_library_1.DisplayMode.Read) {\n            className = this._config.editorElementClassName;\n            html = this._previousHTML || this.props.innerHTML;\n        }\n        var isEditMode = this.state.displayMode === sp_core_library_1.DisplayMode.Edit;\n        if (isEditMode && !this.state.isFormattingBarHidden) {\n            formattingBar = React.createElement(SPRteFormattingBar_1.default, {buttons: this._formattingBarButtons, position: this.state.formattingBarPosition, onKeyDown: this._handleFormattingBarKeyDown, ref: this._resolveRef('_formattingbar')});\n        }\n        return (React.createElement(\"div\", null, \n            React.createElement(\"div\", {\"data-automation-id\": 'textBox', role: isEditMode ? 'textbox' : undefined, \"aria-multiline\": isEditMode || undefined, dangerouslySetInnerHTML: { __html: html }, className: className, onKeyUp: this._handleKeyUp, ref: this._resolveRef('_editorElement')}), \n            formattingBar, \n            React.createElement(SPRteLinkDialog_1.default, {editorElement: this._editableDiv, isOpen: this.state.isLinkDialogOpen, onCancelClicked: this._closeLinkDialog.bind(this), onDismiss: this._closeLinkDialog.bind(this), onSaveClicked: this._onLinkDialogSaved, ref: this._resolveRef('_linkDialog'), textFieldValue: this._linkAddress || '', validationRegex: BaseRte._URL_VALIDATION_REGEX})));\n    };\n    BaseRte.prototype.componentWillMount = function () {\n        window.addEventListener('load', this._onSPRteLoad);\n    };\n    BaseRte.prototype.componentDidMount = function () {\n        var _this = this;\n        if (this.state.displayMode === sp_core_library_1.DisplayMode.Edit) {\n            if (!this._createNewEditorMonitor) {\n                this._createNewEditorMonitor = new sp_telemetry_1._QosMonitor(exports.CREATE_EDITOR_MONITOR);\n            }\n            this._createNewEditor(this.props.innerHTML || '', true).then(function (editor) {\n                _this._afterEditorCreated(editor);\n                _this._createNewEditorMonitor.writeSuccess();\n            }, function (error) {\n                _this._createNewEditorMonitor.writeUnexpectedFailure(exports.CREATE_EDITOR_MONITOR_FAILURE, error, { 'innerHTML': _this.props.innerHTML });\n            });\n        }\n    };\n    BaseRte.prototype.componentDidUpdate = function (prevProps, prevState) {\n        if (this.state.displayMode === sp_core_library_1.DisplayMode.Edit) {\n            if (this._formattingbar) {\n                this._formattingbarElement = ReactDom.findDOMNode(this._formattingbar);\n                this._formattingbarWidth = this._formattingbarElement.offsetWidth || this._formattingbarWidth;\n            }\n            else {\n                this._formattingbarElement = undefined;\n            }\n        }\n    };\n    BaseRte.prototype.componentWillUnmount = function () {\n        if (this._editor) {\n            this._previousHTML = this._editor.destroy();\n            this._editor = undefined;\n            this._editorElement.removeEventListener('paste', this._onBeforePaste, true);\n            this._editorElement.removeEventListener('keydown', this._handleKeyDown);\n            document.removeEventListener('mouseup', this._checkSelectionChange);\n            if (this._editableDiv) {\n                this._editableDiv.removeAttribute('contenteditable');\n                this._editableDiv.removeEventListener('focus', this._handleEditorFocus);\n            }\n            if (this._createNewEditorMonitor) {\n                this._createNewEditorMonitor.writeExpectedFailure(CREATE_EDITOR_MONITOR_EXPECTED);\n            }\n        }\n        window.removeEventListener('load', this._onSPRteLoad);\n    };\n    BaseRte.prototype.componentWillUpdate = function (nextProps, nextState) {\n        var _this = this;\n        if (this.state.displayMode !== nextState.displayMode) {\n            if (nextState.displayMode === sp_core_library_1.DisplayMode.Edit) {\n                if (!this._createNewEditorMonitor) {\n                    this._createNewEditorMonitor = new sp_telemetry_1._QosMonitor(exports.CREATE_EDITOR_MONITOR);\n                }\n                this._createNewEditor(this._previousHTML || this.props.innerHTML || '', false).then(function (editor) {\n                    _this._afterEditorCreated(editor);\n                    _this._setButtonStates();\n                    _this._createNewEditorMonitor.writeSuccess();\n                }, function (error) {\n                    _this._createNewEditorMonitor.writeUnexpectedFailure(exports.CREATE_EDITOR_MONITOR_FAILURE, error, { 'innerHTML': _this.props.innerHTML });\n                });\n            }\n            else if (nextState.displayMode === sp_core_library_1.DisplayMode.Read) {\n                this.componentWillUnmount();\n            }\n        }\n        else if (nextState.displayMode === sp_core_library_1.DisplayMode.Edit && this._editor) {\n            this._setButtonStates();\n        }\n    };\n    BaseRte.prototype.focus = function () {\n        if (this._editor) {\n            this._editor.focus();\n        }\n    };\n    BaseRte.prototype.focusFormattingBar = function () {\n        if (this._formattingbarElement) {\n            RteA11y_1.navigateInside(this._formattingbarElement);\n        }\n    };\n    BaseRte.prototype.setDisplayMode = function (newMode) {\n        if (this.state.displayMode !== newMode) {\n            this.setState({\n                displayMode: newMode,\n                formattingBarPosition: undefined,\n                isFormattingBarHidden: true,\n                isLinkDialogOpen: false\n            });\n        }\n    };\n    BaseRte.prototype.serialize = function () {\n        var serialization = JSON.parse(JSON.stringify(this.props));\n        serialization.innerHTML = this._editor ? this._editor.getHTML() : this.props.innerHTML;\n        if (this._editor) {\n            serialization.editorType = this._editor.getEditorType();\n        }\n        return serialization;\n    };\n    BaseRte.prototype._createNewEditor = function (innerHTML, startupFocus) {\n        return this._options.editor.createNewEditor(this._config, innerHTML, this._editorElement, this._handleSelectionChange, this._handleTextChange.bind(this), startupFocus);\n    };\n    BaseRte.prototype._afterEditorCreated = function (editor) {\n        this._editor = editor;\n        this._handleTextChange();\n        this._editorElement.addEventListener('paste', this._onBeforePaste, true);\n        this._editorElement.addEventListener('keydown', this._handleKeyDown);\n        document.addEventListener('mouseup', this._checkSelectionChange);\n        this._editableDiv = this._editor.getEditorType() === 'CKEditor' ? this._editorElement :\n            this._editorElement.querySelector('.ql-editor');\n        if (this._editableDiv) {\n            this._editableDiv.setAttribute('aria-label', RteStrings_resx_1.default.RichTextEditorAriaLabel);\n            this._editableDiv.setAttribute('title', RteStrings_resx_1.default.RichTextEditorTitle);\n            this._editableDiv.addEventListener('focus', this._handleEditorFocus);\n            this._editableDiv.addEventListener('blur', this._handleEditorBlur);\n        }\n    };\n    BaseRte.prototype._openLinkDialog = function (defaultAddress) {\n        if (defaultAddress === void 0) { defaultAddress = ''; }\n        this._linkAddress = defaultAddress;\n        this.setState({\n            isLinkDialogOpen: true\n        });\n    };\n    BaseRte.prototype._closeLinkDialog = function () {\n        this._restoreSelectionOnNextFocus = true;\n        this._linkAddress = '';\n        this.setState({\n            isLinkDialogOpen: false\n        });\n    };\n    BaseRte.prototype._handleTextChange = function () {\n        sp_telemetry_1._EngagementLogger.logEvent(this._engagementLoggerClickTagName('TextChange'), CLICK_ACTION);\n        if (this.state.displayMode === sp_core_library_1.DisplayMode.Edit) {\n            if (this._editor) {\n                this._currentSelection = this._editor.getSelection() || this._currentSelection;\n            }\n        }\n    };\n    BaseRte.prototype._finalizeAction = function (ariaActionName) {\n        if (ariaActionName) {\n            this._ariaConfirmAction(ariaActionName);\n        }\n        this._updateActiveButtons();\n    };\n    BaseRte.prototype._handleSelectionChange = function (range, forceUpdate) {\n        if (range) {\n            this.setState({ currentSubmenuOpen: undefined });\n            if (this._restoreOnFocus()) {\n                this._updateFormattingBar(false);\n                return;\n            }\n        }\n        if (!range) {\n            this._updateFormattingBar(true);\n        }\n        else {\n            this._updateSelection(range, forceUpdate);\n        }\n    };\n    BaseRte.prototype._updateSelection = function (range, forceUpdate) {\n        if (!this._currentSelection || this.state.isFormattingBarHidden) {\n            this._currentSelection = range;\n            this._updateFormattingBar(false);\n        }\n        else if (forceUpdate || this._currentSelection.start !== range.start ||\n            this._currentSelection.end !== range.end) {\n            this._selectionInitiated = true;\n            if (this._selectionShouldEnd) {\n                this._currentSelection = range;\n                this._updateFormattingBar(false);\n                this._selectionInitiated = false;\n            }\n            this._selectionShouldEnd = false;\n        }\n    };\n    BaseRte.prototype._restoreOnFocus = function () {\n        var restore = false;\n        if (this._restoreSelectionOnNextFocus && this._currentSelection) {\n            this._restoreSelectionOnNextFocus = false;\n            this._editor.setSelection(this._currentSelection);\n            restore = true;\n        }\n        return restore;\n    };\n    BaseRte.prototype._onBeforePaste = function () {\n    };\n    BaseRte.prototype._handleKeyDown = function (evt) {\n        if (RteA11y_1.isTab(evt) || RteA11y_1.isShiftTab(evt)) {\n            evt.stopPropagation();\n            evt.preventDefault();\n        }\n        else if (RteA11y_1.isKey(RteA11y_1.KeyCodes.F10, evt, true) && this._formattingbarElement) {\n            sp_telemetry_1._EngagementLogger.logEvent(this.TAG_NAME + 'ToolbarByKeyboardShortcut.Focus', evt.type);\n            RteA11y_1.navigateInside(this._formattingbarElement);\n            var screenReaderInstruction = odsp_utilities_bundle_1.StringHelper.format(RteStrings_resx_1.default.RichTextNavigationAltF10Keys, RteStrings_resx_1.default.ToolbarNavigationArrowKeys, RteStrings_resx_1.default.ToolbarNavigationTabKeys);\n            RteA11y_1.ariaAlert(screenReaderInstruction);\n            evt.stopPropagation();\n            evt.preventDefault();\n        }\n        else if (RteA11y_1.isKey('K'.charCodeAt(0), evt, false, true)) {\n            this._handleLink();\n            evt.stopPropagation();\n            evt.preventDefault();\n        }\n    };\n    BaseRte.prototype._handleLink = function () {\n        sp_telemetry_1._EngagementLogger.logEvent(this._engagementLoggerClickTagName('link'), CLICK_ACTION);\n        this._isSelectionChangeFromToolbar = true;\n        this._currentSelection = this._editor.getSelection();\n        if (this._currentSelection) {\n            if (this._buttonStates.get('link') === ToolbarButton_1.ButtonState.Active) {\n                var linkAddress = this._editor.getFormatValue(this._currentSelection.start, this._currentSelection.end, this._config.formats.get('link'));\n                this._openLinkDialog(linkAddress);\n            }\n            else if (this._currentSelection.start !== this._currentSelection.end) {\n                this._openLinkDialog();\n            }\n            this._updateActiveButtons();\n        }\n    };\n    BaseRte.prototype._handleFormattingBarKeyDown = function (evt) {\n        if (RteA11y_1.isEscape(evt)) {\n            if (this._editableDiv && !this._editableDiv.isEqualNode(document.activeElement)) {\n                this.focus();\n                evt.stopPropagation();\n                evt.preventDefault();\n            }\n        }\n    };\n    BaseRte.prototype._updateFormattingBar = function (isHidden) {\n    };\n    ;\n    BaseRte.prototype._engagementLoggerClickTagName = function (key) {\n        return this.TAG_NAME + key + BUTTON_NAME + CLICK_ACTION;\n    };\n    BaseRte.prototype._onSPRteLoad = function (e) {\n        if (this._config.editorElementClassName === 'cke_editable' &&\n            !sp_core_library_1._SPKillSwitch.isActivated(sp_core_library_1.Guid.tryParse('f4d628e3-3a01-46e7-8508-96db5caa18e6'), '11/16/2016', 'PreloadCKEditor')) {\n            CKTextEditor_1.default.preloadEditor(this._config);\n        }\n    };\n    BaseRte.prototype._ariaConfirmAction = function (formatKeyOrName) {\n        var format = this._config.formats.get(formatKeyOrName);\n        var name = format ? format.button.title : formatKeyOrName;\n        var message = odsp_utilities_bundle_1.StringHelper.format(RteStrings_resx_1.default.FormattingBarConfirmAction, name);\n        if (this._currentSelection && this._currentSelection.start !== this._currentSelection.end &&\n            !(format && format.isLine)) {\n            var text = this._editor.getText(this._currentSelection);\n            message = odsp_utilities_bundle_1.StringHelper.format(RteStrings_resx_1.default.FormattingBarConfirmActionOnSelection, name, text);\n        }\n        RteA11y_1.ariaAlert(message);\n    };\n    BaseRte.prototype._checkSelectionChange = function () {\n        if (this._editor) {\n            this._selectionShouldEnd = true;\n            if (this._selectionInitiated) {\n                var range = this._editor.getSelection();\n                this._currentSelection = range;\n                this._updateFormattingBar(false);\n                this._selectionShouldEnd = false;\n            }\n            this._selectionInitiated = false;\n        }\n    };\n    BaseRte.prototype._getFormatButtonProps = function (formatKey, onClick) {\n        var format = this._config.formats.get(formatKey);\n        return {\n            key: format.key,\n            fabricIconKey: format.button.fabricIconKey,\n            iconClassName: format.button.iconClassName,\n            onClick: onClick,\n            canBeActive: format.button.canBeActive,\n            isActive: this._buttonStates.get(format.key) === ToolbarButton_1.ButtonState.Active,\n            disabled: this._buttonStates.get(format.key) === ToolbarButton_1.ButtonState.Disabled,\n            title: format.button.title + (format.button.shortcut ? \" (\" + format.button.shortcut + \")\" : ''),\n            label: format.button.label,\n            className: format.button.className,\n            automationId: formatKey + '-button',\n            onBlur: this._handleFormattingBarBlur\n        };\n    };\n    BaseRte.prototype._handleCloseSubmenu = function (isDocumentClick) {\n        this.setState({ currentSubmenuOpen: undefined });\n        if (isDocumentClick) {\n            this._updateFormattingBar(true);\n        }\n    };\n    Object.defineProperty(BaseRte.prototype, \"_formattingBarButtons\", {\n        get: function () {\n            var _this = this;\n            var formatSubmenuButtons = [\n                {\n                    key: 'normalText',\n                    canBeActive: true,\n                    title: RteStrings_resx_1.default.FormattingBarNormalTextButtonTitle,\n                    label: RteStrings_resx_1.default.FormattingBarNormalTextButtonTitle,\n                    onClick: this._handlePlainText,\n                    automationId: 'normalText-button'\n                },\n                this._getFormatButtonProps('h2', this._handleHeading2),\n                this._getFormatButtonProps('h3', this._handleHeading3),\n                this._getFormatButtonProps('h4', this._handleHeading4),\n                this._getFormatButtonProps('blockquote', this._handleQuote)\n            ];\n            var alignLeft = this._getFormatButtonProps('alignLeft', this._handleAlignLeft);\n            var alignCenter = this._getFormatButtonProps('alignCenter', this._handleAlignCenter);\n            var alignRight = this._getFormatButtonProps('alignRight', this._handleAlignRight);\n            var alignmentSubmenuButtons = this._isRtl ?\n                [alignRight, alignCenter, alignLeft] :\n                [alignLeft, alignCenter, alignRight];\n            var linkSubmenuButtons = [\n                this._getFormatButtonProps('link', this._handleLink),\n                {\n                    key: 'unlink',\n                    fabricIconKey: 'Link',\n                    onClick: this._handleUnlink,\n                    canBeActive: false,\n                    disabled: this._buttonStates.get('link') !== ToolbarButton_1.ButtonState.Active,\n                    title: RteStrings_resx_1.default.FormattingBarUnlinkButtonTitle,\n                    className: 'button_linkRemove_temp',\n                    automationId: 'unlink-button',\n                    onBlur: this._handleFormattingBarBlur\n                }\n            ];\n            var buttons = [\n                React.createElement(ToolbarSubmenu_1.default, {key: 'format', buttons: formatSubmenuButtons, isOpen: this.state.currentSubmenuOpen === 'format', isWide: true, onOpen: function () { _this._isSelectionChangeFromToolbar = true; _this.setState({ currentSubmenuOpen: 'format' }); }, onClose: this._handleCloseSubmenu, onBlur: this._handleFormattingBarBlur}),\n                React.createElement(ToolbarButton_1.default, __assign({}, this._getFormatButtonProps('bold', this._handleBold))),\n                React.createElement(ToolbarButton_1.default, __assign({}, this._getFormatButtonProps('italic', this._handleItalic))),\n                React.createElement(ToolbarButton_1.default, __assign({}, this._getFormatButtonProps('underline', this._handleUnderline))),\n                React.createElement(ToolbarSubmenu_1.default, {key: 'alignment', buttons: alignmentSubmenuButtons, isOpen: this.state.currentSubmenuOpen === 'alignment', onOpen: function () { _this._isSelectionChangeFromToolbar = true; _this.setState({ currentSubmenuOpen: 'alignment' }); }, onClose: this._handleCloseSubmenu, onBlur: this._handleFormattingBarBlur}),\n                React.createElement(ToolbarButton_1.default, __assign({}, this._getFormatButtonProps('bullet', this._handleListBullets))),\n                React.createElement(ToolbarButton_1.default, __assign({}, this._getFormatButtonProps('list', this._handleListNumbered))),\n                React.createElement(ToolbarSubmenu_1.default, {key: 'link', buttons: linkSubmenuButtons, isOpen: this.state.currentSubmenuOpen === 'link', onOpen: function () { _this._isSelectionChangeFromToolbar = true; _this.setState({ currentSubmenuOpen: 'link' }); }, onClose: this._handleCloseSubmenu, onBlur: this._handleFormattingBarBlur}),\n                React.createElement(ToolbarButton_1.default, {key: 'clearFormatting', canBeActive: false, fabricIconKey: 'ClearFormatting', onClick: this._handleClearFormatting, title: RteStrings_resx_1.default.FormattingBarClearFormattingButtonTitle, automationId: 'clearFormatting-button', onBlur: this._handleFormattingBarBlur})\n            ];\n            return buttons;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    BaseRte.prototype._formatOrPrepare = function (formatKey) {\n        this.focus();\n        sp_telemetry_1._EngagementLogger.logEvent(this._engagementLoggerClickTagName(formatKey), CLICK_ACTION);\n        var format = this._config.formats.get(formatKey);\n        if (format.maskedBy) {\n            for (var _i = 0, _a = format.maskedBy; _i < _a.length; _i++) {\n                var maskingFormat = _a[_i];\n                if (this._buttonStates.get(maskingFormat) === ToolbarButton_1.ButtonState.Active) {\n                    return;\n                }\n            }\n        }\n        var range = this._editor.getSelection();\n        var _b = [range.start, range.end], start = _b[0], end = _b[1];\n        var isApplied = this._editor.isFormatAppliedToRange(start, end, format);\n        if (!(this._cleanupBeforeFormatting(start, end, format) && isApplied)) {\n            var formats = {};\n            formats[format.editorKey] = isApplied ? false : (format.editorValue !== undefined ? format.editorValue : true);\n            this._editor.format(start, end, formats);\n            this._finalizeAction(formatKey);\n        }\n    };\n    BaseRte.prototype._handleAlignCenter = function () {\n        this._formatOrPrepare('alignCenter');\n    };\n    BaseRte.prototype._handleAlignLeft = function () {\n        this._formatOrPrepare(this._isRtl ? 'alignRight' : 'alignLeft');\n    };\n    BaseRte.prototype._handleAlignRight = function () {\n        this._formatOrPrepare(this._isRtl ? 'alignLeft' : 'alignRight');\n    };\n    BaseRte.prototype._handleBold = function () {\n        this._formatOrPrepare('bold');\n    };\n    BaseRte.prototype._handleHeading2 = function () {\n        this._formatOrPrepare('h2');\n    };\n    BaseRte.prototype._handleHeading3 = function () {\n        this._formatOrPrepare('h3');\n    };\n    BaseRte.prototype._handleHeading4 = function () {\n        this._formatOrPrepare('h4');\n    };\n    BaseRte.prototype._handleItalic = function () {\n        this._formatOrPrepare('italic');\n    };\n    BaseRte.prototype._handleListBullets = function () {\n        this._formatOrPrepare('bullet');\n    };\n    BaseRte.prototype._handleListNumbered = function () {\n        this._formatOrPrepare('list');\n    };\n    BaseRte.prototype._handlePlainText = function () {\n        this.focus();\n        if (this._currentSelection) {\n            var blockStyles = this._config.supportedFormatsArray.filter(function (format) { return format.isBlockStyle; });\n            this._cleanupBeforeFormatting(this._currentSelection.start, this._currentSelection.end, blockStyles[0]);\n            this._finalizeAction();\n        }\n        sp_telemetry_1._EngagementLogger.logEvent(this._engagementLoggerClickTagName('PlainText'), CLICK_ACTION);\n    };\n    BaseRte.prototype._handleQuote = function () {\n        this._formatOrPrepare('blockquote');\n    };\n    BaseRte.prototype._handleClearFormatting = function () {\n        sp_telemetry_1._EngagementLogger.logEvent(this._engagementLoggerClickTagName('ClearFormatting'), CLICK_ACTION);\n        this.focus();\n        var range = this._currentSelection;\n        var _a = [range.start, range.end], start = _a[0], end = _a[1];\n        this._editor.clearFormatting(start, end);\n        this._finalizeAction(RteStrings_resx_1.default.FormattingBarClearFormattingButtonTitle);\n    };\n    BaseRte.prototype._handleUnderline = function () {\n        this._formatOrPrepare('underline');\n    };\n    BaseRte.prototype._handleUnlink = function () {\n        this.focus();\n        sp_telemetry_1._EngagementLogger.logEvent(this._engagementLoggerClickTagName('Unlink'), CLICK_ACTION);\n        if (this._currentSelection) {\n            this._editor.format(this._currentSelection.start, this._currentSelection.end, { 'link': false });\n            this._finalizeAction(RteStrings_resx_1.default.FormattingBarUnlinkButtonTitle);\n        }\n    };\n    BaseRte.prototype._cleanupBeforeFormatting = function (start, end, newFormat) {\n        var formatsToClear = {};\n        if (newFormat.isBlockStyle) {\n            var blockStyles = this._config.supportedFormatsArray.filter(function (format) { return format.isBlockStyle; });\n            for (var _i = 0, blockStyles_1 = blockStyles; _i < blockStyles_1.length; _i++) {\n                var format = blockStyles_1[_i];\n                formatsToClear[format.editorKey] = false;\n            }\n        }\n        if (newFormat.masks) {\n            for (var _a = 0, _b = newFormat.masks; _a < _b.length; _a++) {\n                var maskedFormatKey = _b[_a];\n                formatsToClear[this._config.formats.get(maskedFormatKey).editorKey] = false;\n            }\n        }\n        this._editor.format(start, end, formatsToClear, true);\n        return formatsToClear.hasOwnProperty(newFormat.editorKey);\n    };\n    BaseRte.prototype._onLinkDialogSaved = function () {\n        if (this._linkDialog.textFieldValue) {\n            this._editor.format(this._currentSelection.start, this._currentSelection.end, { 'link': this._linkDialog.textFieldValue });\n        }\n        this._linkElement = undefined;\n        this._finalizeAction(RteStrings_resx_1.default.FormattingBarLinkButtonTitle);\n        this._closeLinkDialog();\n    };\n    BaseRte.prototype._handleEditorFocus = function (evt) {\n        this._restoreOnFocus();\n    };\n    BaseRte.prototype._handleFormattingBarBlur = function (evt) {\n        this._hideFormattingBarOnBlur(evt.relatedTarget);\n    };\n    BaseRte.prototype._handleEditorBlur = function (evt) {\n        this._hideFormattingBarOnBlur(evt.relatedTarget);\n    };\n    BaseRte.prototype._hideFormattingBarOnBlur = function (target) {\n        var elem = target;\n        if ((this._editorElement && this._editorElement.contains(elem)) ||\n            (this._formattingbarElement && this._formattingbarElement.contains(elem)) ||\n            elem && elem.className === 'ControlZone ControlZone--edit ControlZone--selected') {\n            return;\n        }\n        else {\n            this._updateFormattingBar(true);\n        }\n    };\n    BaseRte.prototype._handleKeyUp = function (evt) {\n        this._checkSelectionChange();\n        this._updateActiveButtons();\n    };\n    BaseRte.prototype._setButtonStates = function () {\n        var range = this._editor.getSelection();\n        if (range) {\n            var updatedFormats = new Map();\n            for (var _i = 0, _a = this._config.supportedFormatsArray; _i < _a.length; _i++) {\n                var format = _a[_i];\n                updatedFormats.set(format.key, false);\n            }\n            var maskingFormats = this._config.supportedFormatsArray.filter(function (format) { return !!format.masks; });\n            for (var _b = 0, maskingFormats_1 = maskingFormats; _b < maskingFormats_1.length; _b++) {\n                var maskingFormat = maskingFormats_1[_b];\n                if (!updatedFormats.get(maskingFormat.key)) {\n                    var isActive = this._editor.isFormatAppliedToRange(range.start, range.end, maskingFormat);\n                    this._buttonStates.set(maskingFormat.key, isActive ? ToolbarButton_1.ButtonState.Active : ToolbarButton_1.ButtonState.Normal);\n                    updatedFormats.set(maskingFormat.key, true);\n                    if (isActive) {\n                        for (var _c = 0, _d = maskingFormat.masks; _c < _d.length; _c++) {\n                            var maskedFormat = _d[_c];\n                            this._buttonStates.set(maskedFormat, ToolbarButton_1.ButtonState.Disabled);\n                            updatedFormats.set(maskedFormat, true);\n                        }\n                    }\n                }\n            }\n            for (var _e = 0, _f = this._config.supportedFormatsArray; _e < _f.length; _e++) {\n                var format = _f[_e];\n                if (!updatedFormats.get(format.key)) {\n                    var isActive = this._editor.isFormatAppliedToRange(range.start, range.end, format);\n                    this._buttonStates.set(format.key, isActive ? ToolbarButton_1.ButtonState.Active : ToolbarButton_1.ButtonState.Normal);\n                }\n            }\n        }\n        if (this._isRtl) {\n            var left = this._buttonStates.get('alignLeft');\n            this._buttonStates.set('alignLeft', this._buttonStates.get('alignRight'));\n            this._buttonStates.set('alignRight', left);\n        }\n    };\n    BaseRte.prototype._updateActiveButtons = function () {\n        this.forceUpdate();\n    };\n    BaseRte._URL_VALIDATION_REGEX = new RegExp('((^https?:\\/\\/)|(^ftp:\\/\\/)|(^file:\\/\\/)|(^mailto:)|(^news:)|(^pnm:\\/\\/)|(^mms:\\/\\/)|(^\\/)|(^#)|(^\\\\\\\\)).+', 'i');\n    __decorate([\n        office_ui_fabric_react_1.autobind\n    ], BaseRte.prototype, \"_handleSelectionChange\", null);\n    __decorate([\n        office_ui_fabric_react_1.autobind\n    ], BaseRte.prototype, \"_updateSelection\", null);\n    __decorate([\n        office_ui_fabric_react_1.autobind\n    ], BaseRte.prototype, \"_onBeforePaste\", null);\n    __decorate([\n        office_ui_fabric_react_1.autobind\n    ], BaseRte.prototype, \"_handleKeyDown\", null);\n    __decorate([\n        office_ui_fabric_react_1.autobind\n    ], BaseRte.prototype, \"_handleLink\", null);\n    __decorate([\n        office_ui_fabric_react_1.autobind\n    ], BaseRte.prototype, \"_handleFormattingBarKeyDown\", null);\n    __decorate([\n        office_ui_fabric_react_1.autobind\n    ], BaseRte.prototype, \"_onSPRteLoad\", null);\n    __decorate([\n        office_ui_fabric_react_1.autobind\n    ], BaseRte.prototype, \"_checkSelectionChange\", null);\n    __decorate([\n        office_ui_fabric_react_1.autobind\n    ], BaseRte.prototype, \"_getFormatButtonProps\", null);\n    __decorate([\n        office_ui_fabric_react_1.autobind\n    ], BaseRte.prototype, \"_handleCloseSubmenu\", null);\n    __decorate([\n        office_ui_fabric_react_1.autobind\n    ], BaseRte.prototype, \"_handleAlignCenter\", null);\n    __decorate([\n        office_ui_fabric_react_1.autobind\n    ], BaseRte.prototype, \"_handleAlignLeft\", null);\n    __decorate([\n        office_ui_fabric_react_1.autobind\n    ], BaseRte.prototype, \"_handleAlignRight\", null);\n    __decorate([\n        office_ui_fabric_react_1.autobind\n    ], BaseRte.prototype, \"_handleBold\", null);\n    __decorate([\n        office_ui_fabric_react_1.autobind\n    ], BaseRte.prototype, \"_handleHeading2\", null);\n    __decorate([\n        office_ui_fabric_react_1.autobind\n    ], BaseRte.prototype, \"_handleHeading3\", null);\n    __decorate([\n        office_ui_fabric_react_1.autobind\n    ], BaseRte.prototype, \"_handleHeading4\", null);\n    __decorate([\n        office_ui_fabric_react_1.autobind\n    ], BaseRte.prototype, \"_handleItalic\", null);\n    __decorate([\n        office_ui_fabric_react_1.autobind\n    ], BaseRte.prototype, \"_handleListBullets\", null);\n    __decorate([\n        office_ui_fabric_react_1.autobind\n    ], BaseRte.prototype, \"_handleListNumbered\", null);\n    __decorate([\n        office_ui_fabric_react_1.autobind\n    ], BaseRte.prototype, \"_handlePlainText\", null);\n    __decorate([\n        office_ui_fabric_react_1.autobind\n    ], BaseRte.prototype, \"_handleQuote\", null);\n    __decorate([\n        office_ui_fabric_react_1.autobind\n    ], BaseRte.prototype, \"_handleClearFormatting\", null);\n    __decorate([\n        office_ui_fabric_react_1.autobind\n    ], BaseRte.prototype, \"_handleUnderline\", null);\n    __decorate([\n        office_ui_fabric_react_1.autobind\n    ], BaseRte.prototype, \"_handleUnlink\", null);\n    __decorate([\n        office_ui_fabric_react_1.autobind\n    ], BaseRte.prototype, \"_onLinkDialogSaved\", null);\n    __decorate([\n        office_ui_fabric_react_1.autobind\n    ], BaseRte.prototype, \"_handleEditorFocus\", null);\n    __decorate([\n        office_ui_fabric_react_1.autobind\n    ], BaseRte.prototype, \"_handleFormattingBarBlur\", null);\n    __decorate([\n        office_ui_fabric_react_1.autobind\n    ], BaseRte.prototype, \"_handleEditorBlur\", null);\n    __decorate([\n        office_ui_fabric_react_1.autobind\n    ], BaseRte.prototype, \"_handleKeyUp\", null);\n    return BaseRte;\n}(office_ui_fabric_react_1.BaseComponent));\nexports.BaseRte = BaseRte;\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./lib/local/appBase/components/sp-rte/rte/BaseRte.js\n// module id = 122\n// module chunks = 0\n\n\n// WEBPACK FOOTER //\n// webpack:///lib/local/appBase/components/sp-rte/rte/BaseRte.js","\"use strict\";\nvar __extends = (this && this.__extends) || function (d, b) {\n    for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p];\n    function __() { this.constructor = d; }\n    d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n};\nvar office_ui_fabric_react_1 = require('office-ui-fabric-react');\nvar React = require('react');\nrequire('./SPRteFormattingBar.scss');\nvar office_ui_fabric_react_2 = require('office-ui-fabric-react');\nvar SPRteFormattingBar = (function (_super) {\n    __extends(SPRteFormattingBar, _super);\n    function SPRteFormattingBar(props) {\n        _super.call(this, props);\n        this.state = {\n            isFaded: false\n        };\n    }\n    SPRteFormattingBar.prototype.componentDidMount = function () {\n        this._domNode.addEventListener('keydown', this.props.onKeyDown);\n    };\n    SPRteFormattingBar.prototype.componentWillReceiveProps = function (nextProps) {\n        if (this.props.position.top !== nextProps.position.top) {\n            this.setState({\n                isFaded: true\n            });\n        }\n    };\n    SPRteFormattingBar.prototype.componentDidUpdate = function () {\n        var _this = this;\n        if (this.state.isFaded) {\n            window.setTimeout(function () {\n                _this.setState({\n                    isFaded: false\n                });\n            }, 300);\n        }\n    };\n    SPRteFormattingBar.prototype.render = function () {\n        var style = this.props.position;\n        var className = office_ui_fabric_react_1.css('SPRteFormattingBar', 'rteFlyout-visible', 'stack-panel-class', 'ms-u-slideUpIn10', {\n            'faded': this.state.isFaded\n        });\n        return (React.createElement(\"div\", {role: 'toolbar', \"aria-label\": 'Formatting', className: className, ref: this._resolveRef('_domNode'), style: style, \"data-automation-id\": 'toolbar'}, \n            React.createElement(office_ui_fabric_react_1.FocusZone, {ref: this._resolveRef('_focusZone'), isCircularNavigation: true}, this.props.buttons)\n        ));\n    };\n    SPRteFormattingBar.prototype.focus = function () {\n        this._focusZone.focus();\n    };\n    return SPRteFormattingBar;\n}(office_ui_fabric_react_2.BaseComponent));\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.default = SPRteFormattingBar;\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./lib/local/appBase/components/sp-rte/formattingbar/SPRteFormattingBar.js\n// module id = 123\n// module chunks = 0\n\n\n// WEBPACK FOOTER //\n// webpack:///lib/local/appBase/components/sp-rte/formattingbar/SPRteFormattingBar.js","require('SPRteFormattingBar.css');\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./lib/local/appBase/components/sp-rte/formattingbar/SPRteFormattingBar.scss.js\n// module id = 124\n// module chunks = 0\n\n\n// WEBPACK FOOTER //\n// webpack:///lib/local/appBase/components/sp-rte/formattingbar/SPRteFormattingBar.scss.js","var content = require(\"!!./../../../../../../../../common/node_modules/css-loader/index.js?-minimize!./SPRteFormattingBar.css\");\nvar loader = require(\"D:\\\\agent\\\\1\\\\_work\\\\24\\\\s\\\\common\\\\node_modules\\\\@microsoft\\\\load-themed-styles\\\\lib\\\\index.js\");\n\nif(typeof content === \"string\") content = [[module.id, content]];\n\n// add the styles to the DOM\nfor (var i = 0; i < content.length; i++) loader.loadStyles(content[i][1]);\n\nif(content.locals) module.exports = content.locals;\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./lib/local/appBase/components/sp-rte/formattingbar/SPRteFormattingBar.css\n// module id = 125\n// module chunks = 0\n\n\n// WEBPACK FOOTER //\n// webpack:///lib/local/appBase/components/sp-rte/formattingbar/SPRteFormattingBar.css?ed5b","exports = module.exports = require(\"./../../../../../../../../common/node_modules/css-loader/lib/css-base.js\")();\n// imports\n\n\n// module\nexports.push([module.id, \".rteFlyout-visible{position:absolute;z-index:2;box-shadow:0 0 5px 0 #c8c8c8;top:-45px;font-family:\\\"Segoe UI Regular WestEuropean\\\",\\\"Segoe UI\\\",\\\"Segoe WP\\\",Tahoma,Arial,sans-serif}@media (max-width:720px){.rteFlyout-visible .rteFlyout-button{padding:10px;font-size:11px}}.rteFlyout-visible .rteFlyout-button:hover{background:#0078D7}.rteFlyout-visible .rteFlyout-button .ms-Icon{padding:13px;color:#767676;font-size:14px!important}.rteFlyout-visible .rteFlyout-button:hover .ms-Icon{color:#fff}.rteFlyout-visible .rteFlyout-button img{vertical-align:middle;display:inline-block}.rteFlyout-visible .stack-panel-class{background:\\\"[theme:neutralPrimary, default: #333333]\\\"}.rteFlyout-button{background-color:transparent;border-width:0;padding:0;cursor:pointer!important}.stack-panel-class{white-space:nowrap}.SPRteFormattingBar{display:-webkit-inline-box;display:-ms-inline-flexbox;display:inline-flex;background-color:\\\"[theme:neutralPrimary, default: #333333]\\\";-webkit-transition:all 367ms cubic-bezier(.1,.9,.2,1);transition:all 367ms cubic-bezier(.1,.9,.2,1)}[dir=ltr] .SPRteFormattingBar .ToolbarButton,[dir=ltr] .SPRteFormattingBar .ToolbarSubmenu{float:left}[dir=rtl] .SPRteFormattingBar .ToolbarButton,[dir=rtl] .SPRteFormattingBar .ToolbarSubmenu{float:right}.SPRteFormattingBar.faded{display:none}.SPRteFormattingBar-divider{float:left;height:16px;margin-top:8px;width:0;border-right:solid 1px \\\"[theme:neutralSecondary, default: #666666]\\\"}.msIcon_h2_temp::after{content:'H2';font-size:16px;font-style:normal;font-weight:600}.button_quote_temp .ms-Icon{font-size:28px!important;font-family:\\\"Segoe UI Light WestEuropean\\\",\\\"Segoe UI Light\\\",\\\"Segoe WP Light\\\",\\\"Segoe UI\\\",\\\"Segoe WP\\\",Tahoma,Arial,sans-serif;line-height:1.7!important}.button_linkRemove_temp .ms-Icon::after{content:'x';font-family:Arial;margin-left:-5px;margin-right:5px}\", \"\"]);\n\n// exports\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// D:/agent/1/_work/24/s/common/~/css-loader?-minimize!./lib/local/appBase/components/sp-rte/formattingbar/SPRteFormattingBar.css\n// module id = 126\n// module chunks = 0\n\n\n// WEBPACK FOOTER //\n// webpack:///lib/local/appBase/components/sp-rte/formattingbar/SPRteFormattingBar.css","\"use strict\";\nvar __extends = (this && this.__extends) || function (d, b) {\n    for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p];\n    function __() { this.constructor = d; }\n    d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n};\nvar React = require('react');\nvar RteStrings_resx_1 = require('../loc/RteStrings.resx');\nvar office_ui_fabric_react_1 = require('office-ui-fabric-react');\nvar RteA11y_1 = require('../a11y/RteA11y');\nvar SPRteLinkDialog = (function (_super) {\n    __extends(SPRteLinkDialog, _super);\n    function SPRteLinkDialog(props) {\n        _super.call(this, props);\n        this._getErrorMessage = this._getErrorMessage.bind(this);\n        this._handleKeyDown = this._handleKeyDown.bind(this);\n        this._handleTextFieldChange = this._handleTextFieldChange.bind(this);\n        this._isURLValid = this._isURLValid.bind(this);\n        this.state = {\n            isURLValid: true\n        };\n    }\n    SPRteLinkDialog.prototype.render = function () {\n        var _this = this;\n        var _a = this.props, editorElement = _a.editorElement, isOpen = _a.isOpen, onDismiss = _a.onDismiss, onSaveClicked = _a.onSaveClicked, onCancelClicked = _a.onCancelClicked, textFieldValue = _a.textFieldValue;\n        return (React.createElement(office_ui_fabric_react_1.Dialog, {isOpen: isOpen, type: office_ui_fabric_react_1.DialogType.normal, onDismiss: onDismiss, title: RteStrings_resx_1.default.LinkDialogTitle, isBlocking: true, elementToFocusOnDismiss: editorElement}, \n            React.createElement(office_ui_fabric_react_1.TextField, {label: RteStrings_resx_1.default.LinkDialogTextFieldLabel, ariaLabel: RteStrings_resx_1.default.LinkDialogTextFieldAriaLabel, onChanged: this._handleTextFieldChange, onGetErrorMessage: this._getErrorMessage, onKeyDown: this._handleKeyDown, placeholder: 'http://', defaultValue: textFieldValue, ref: function (c) { return _this._textField = c; }, \"data-automation-id\": 'linkDialogTextField'}), \n            React.createElement(office_ui_fabric_react_1.DialogFooter, null, \n                React.createElement(office_ui_fabric_react_1.Button, {buttonType: office_ui_fabric_react_1.ButtonType.primary, disabled: !this.state.isURLValid, onClick: onSaveClicked, ariaLabel: RteStrings_resx_1.default.RichTextLinkDialogSaveButtonLabel, \"data-automation-id\": 'confirmButton'}, RteStrings_resx_1.default.RichTextLinkDialogSaveButtonLabel), \n                React.createElement(office_ui_fabric_react_1.Button, {onClick: onCancelClicked, ariaLabel: RteStrings_resx_1.default.RichTextLinkDialogCancelButtonLabel, \"data-automation-id\": 'cancelButton'}, RteStrings_resx_1.default.RichTextLinkDialogCancelButtonLabel))));\n    };\n    SPRteLinkDialog.prototype.componentDidUpdate = function (prevProps) {\n        if (this._textField && this.props.isOpen && !this._initCursorSet) {\n            this._initCursorSet = true;\n            this._textField.select();\n            var textValue = this._textField.value;\n            if (textValue) {\n                this._textField.setSelectionStart(textValue.length);\n                this._textField.setSelectionEnd(textValue.length);\n            }\n        }\n        else if (!this.props.isOpen) {\n            this._initCursorSet = false;\n        }\n    };\n    SPRteLinkDialog.prototype.componentWillReceiveProps = function (newProps) {\n        this.state = {\n            isURLValid: this._isURLValid(newProps.textFieldValue)\n        };\n    };\n    Object.defineProperty(SPRteLinkDialog.prototype, \"textFieldValue\", {\n        get: function () {\n            var url = '';\n            if (this._textField) {\n                url = this._textField.value;\n                if (!this._hasProtocol(url)) {\n                    url = 'http://' + url;\n                }\n            }\n            return url;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    SPRteLinkDialog.prototype._getErrorMessage = function () {\n        return !this._isURLValid(this.textFieldValue) && this.textFieldValue !== '' ?\n            RteStrings_resx_1.default.LinkDialogErrorNotSupportedLink : '';\n    };\n    SPRteLinkDialog.prototype._handleKeyDown = function (evt) {\n        if (RteA11y_1.isEnter(evt) && this.state.isURLValid) {\n            this.props.onSaveClicked();\n            evt.stopPropagation();\n            evt.preventDefault();\n        }\n    };\n    SPRteLinkDialog.prototype._handleTextFieldChange = function () {\n        this.setState({\n            isURLValid: this._isURLValid(this.textFieldValue)\n        });\n    };\n    SPRteLinkDialog.prototype._hasProtocol = function (url) {\n        var hasProtocolRegex = new RegExp('^([A-Za-z0-9]+:(\\/\\/)?|#|\\/|\\\\\\\\).+', 'i');\n        return hasProtocolRegex.test(url);\n    };\n    SPRteLinkDialog.prototype._isURLValid = function (url) {\n        return this.props.validationRegex.test(url);\n    };\n    return SPRteLinkDialog;\n}(React.Component));\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.default = SPRteLinkDialog;\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./lib/local/appBase/components/sp-rte/formattingbar/SPRteLinkDialog.js\n// module id = 127\n// module chunks = 0\n\n\n// WEBPACK FOOTER //\n// webpack:///lib/local/appBase/components/sp-rte/formattingbar/SPRteLinkDialog.js","\"use strict\";\n(function (KeyCodes) {\n    KeyCodes[KeyCodes[\"Enter\"] = 13] = \"Enter\";\n    KeyCodes[KeyCodes[\"Escape\"] = 27] = \"Escape\";\n    KeyCodes[KeyCodes[\"Tab\"] = 9] = \"Tab\";\n    KeyCodes[KeyCodes[\"F10\"] = 121] = \"F10\";\n    KeyCodes[KeyCodes[\"P\"] = 80] = \"P\";\n})(exports.KeyCodes || (exports.KeyCodes = {}));\nvar KeyCodes = exports.KeyCodes;\nfunction isEscape(e) {\n    return isKey(KeyCodes.Escape, e);\n}\nexports.isEscape = isEscape;\nfunction isEnter(e) {\n    return isKey(KeyCodes.Enter, e);\n}\nexports.isEnter = isEnter;\nfunction isShiftTab(e) {\n    return isKey(KeyCodes.Tab, e, false, false, true);\n}\nexports.isShiftTab = isShiftTab;\nfunction isTab(e) {\n    return isKey(KeyCodes.Tab, e);\n}\nexports.isTab = isTab;\nfunction isKey(keyCode, e, allowAlt, allowCtrl, allowShift) {\n    if (allowAlt === void 0) { allowAlt = false; }\n    if (allowCtrl === void 0) { allowCtrl = false; }\n    if (allowShift === void 0) { allowShift = false; }\n    return e.keyCode === keyCode &&\n        ((allowAlt && e.altKey) || (!allowAlt && !e.altKey)) &&\n        ((allowCtrl && e.ctrlKey) || (!allowCtrl && !e.ctrlKey)) &&\n        ((allowShift && e.shiftKey) || (!allowShift && !e.shiftKey));\n}\nexports.isKey = isKey;\nfunction getFocusableChildren(elem, ignoreTabIndex) {\n    if (ignoreTabIndex === void 0) { ignoreTabIndex = false; }\n    var children = [];\n    for (var _i = 0, _a = getFocusableDescendants(elem, ignoreTabIndex); _i < _a.length; _i++) {\n        var descendant = _a[_i];\n        if (isElementFocusableChildOf(descendant, elem)) {\n            children.push(descendant);\n        }\n    }\n    return children;\n}\nexports.getFocusableChildren = getFocusableChildren;\nfunction isElementFocusable(elem, ignoreTabIndex) {\n    if (ignoreTabIndex === void 0) { ignoreTabIndex = false; }\n    var tagName = elem.tagName.toLowerCase();\n    if (elem\n        && !elem.hidden\n        && elem.offsetParent\n        && window.getComputedStyle(elem).display !== 'none'\n        && window.getComputedStyle(elem).visibility !== 'hidden') {\n        var hasTabIndex = elem.hasAttribute('tabindex');\n        var tabindex = parseInt(elem.getAttribute('tabindex'), 10);\n        if (!ignoreTabIndex && hasTabIndex && tabindex < 0) {\n            return false;\n        }\n        if (tagName === 'a' && !!elem.href ||\n            elem.isContentEditable) {\n            return true;\n        }\n        if ((tagName === 'button' ||\n            tagName === 'input' ||\n            tagName === 'select' ||\n            tagName === 'textarea') && !elem.disabled) {\n            return true;\n        }\n        if (ignoreTabIndex && elem.getAttribute('data-is-focusable') === 'true') {\n            return true;\n        }\n        if (!ignoreTabIndex && hasTabIndex && tabindex > -1) {\n            return true;\n        }\n    }\n    return false;\n}\nexports.isElementFocusable = isElementFocusable;\nfunction getFocusableParent(elem, topElement) {\n    if (topElement === void 0) { topElement = document.body; }\n    var parent = elem;\n    do {\n        parent = parent.parentElement;\n    } while (!isElementFocusable(parent) && parent !== topElement);\n    return parent;\n}\nexports.getFocusableParent = getFocusableParent;\nfunction queryFocusableSelector(elem) {\n    var selector = 'button,input,textarea,select,a[href]:not([href=\\'\\']),\\\r\n      [tabindex],[contenteditable=\\'true\\'], [data-is-focusable=\\'true\\']';\n    return elem.querySelectorAll(selector);\n}\nfunction getFirstFocusableChild(elem, ignoreTabIndex) {\n    if (ignoreTabIndex === void 0) { ignoreTabIndex = false; }\n    var nodes = queryFocusableSelector(elem);\n    for (var i = 0; i < nodes.length; i++) {\n        var node = nodes[i];\n        if (isElementFocusable(node, ignoreTabIndex)) {\n            return node;\n        }\n    }\n    return undefined;\n}\nexports.getFirstFocusableChild = getFirstFocusableChild;\nfunction getFocusableDescendants(elem, ignoreTabIndex) {\n    if (ignoreTabIndex === void 0) { ignoreTabIndex = false; }\n    var descendants = [];\n    var nodes = queryFocusableSelector(elem);\n    for (var i = 0; i < nodes.length; i++) {\n        var node = nodes[i];\n        if (isElementFocusable(node, ignoreTabIndex)) {\n            descendants.push(node);\n        }\n    }\n    return descendants;\n}\nexports.getFocusableDescendants = getFocusableDescendants;\nfunction getFocusableSiblings(elem, topElement) {\n    if (topElement === void 0) { topElement = document.body; }\n    var children = getFocusableChildren(getFocusableParent(elem, topElement));\n    var siblings = [];\n    var insertPointer = 0;\n    for (var _i = 0, children_1 = children; _i < children_1.length; _i++) {\n        var child = children_1[_i];\n        if (child !== elem) {\n            siblings.splice(insertPointer++, 0, child);\n        }\n        else {\n            insertPointer = 0;\n        }\n    }\n    return siblings;\n}\nexports.getFocusableSiblings = getFocusableSiblings;\nfunction getNextFocusableElement(elem, topElement) {\n    if (topElement === void 0) { topElement = document.body; }\n    var siblings = getFocusableSiblings(elem, topElement);\n    return siblings[0];\n}\nexports.getNextFocusableElement = getNextFocusableElement;\nfunction getPrevFocusableElement(elem, topElement) {\n    if (topElement === void 0) { topElement = document.body; }\n    var siblings = getFocusableSiblings(elem, topElement);\n    return siblings[siblings.length - 1];\n}\nexports.getPrevFocusableElement = getPrevFocusableElement;\nfunction isElementFocusableChildOf(elem, ancestor) {\n    var parent = elem.parentElement;\n    while (parent.tagName !== 'BODY') {\n        if (parent !== ancestor) {\n            return true;\n        }\n        if (isElementFocusable(parent)) {\n            break;\n        }\n        parent = parent.parentElement;\n    }\n    return false;\n}\nexports.isElementFocusableChildOf = isElementFocusableChildOf;\nfunction navigateInside(elem) {\n    var children = getFocusableChildren(elem);\n    if (children.length) {\n        children[0].focus();\n        return true;\n    }\n    else {\n        return false;\n    }\n}\nexports.navigateInside = navigateInside;\nfunction navigateTo(elem) {\n    if (isElementFocusable(elem)) {\n        elem.focus();\n        return true;\n    }\n    else {\n        return navigateInside(elem);\n    }\n}\nexports.navigateTo = navigateTo;\nfunction navigateOutOf(elem, topElement) {\n    if (topElement === void 0) { topElement = document.body; }\n    topElement = topElement || document.body;\n    getFocusableParent(elem, topElement).focus();\n}\nexports.navigateOutOf = navigateOutOf;\nfunction ariaAlert(message) {\n    var divId = 'aria_alert_' + this._randId;\n    var oldAlert = document.querySelector('#' + divId);\n    if (oldAlert) {\n        document.body.removeChild(oldAlert);\n    }\n    var alertNode = document.createElement('p');\n    alertNode.classList.add('Canvas-screenReaderOnly');\n    alertNode.setAttribute('role', 'alert');\n    alertNode.setAttribute('id', divId);\n    var alertText = document.createTextNode(message);\n    alertNode.appendChild(alertText);\n    document.body.appendChild(alertNode);\n}\nexports.ariaAlert = ariaAlert;\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./lib/local/appBase/components/sp-rte/a11y/RteA11y.js\n// module id = 128\n// module chunks = 0\n\n\n// WEBPACK FOOTER //\n// webpack:///lib/local/appBase/components/sp-rte/a11y/RteA11y.js","\"use strict\";\nvar __extends = (this && this.__extends) || function (d, b) {\n    for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p];\n    function __() { this.constructor = d; }\n    d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n};\nvar office_ui_fabric_react_1 = require('office-ui-fabric-react');\nvar React = require('react');\nrequire('./ToolbarButton.scss');\nvar Utilities_1 = require('../../common/Utilities');\n(function (ButtonState) {\n    ButtonState[ButtonState[\"Active\"] = 0] = \"Active\";\n    ButtonState[ButtonState[\"Disabled\"] = 1] = \"Disabled\";\n    ButtonState[ButtonState[\"Normal\"] = 2] = \"Normal\";\n})(exports.ButtonState || (exports.ButtonState = {}));\nvar ButtonState = exports.ButtonState;\nvar ToolbarButton = (function (_super) {\n    __extends(ToolbarButton, _super);\n    function ToolbarButton(props) {\n        _super.call(this, props);\n    }\n    ToolbarButton.prototype.render = function () {\n        var buttonClassName = office_ui_fabric_react_1.css('ToolbarButton', this.props.className, {\n            'ToolbarButton--disabled': this.props.disabled,\n            'ToolbarButton--active': this.props.isActive\n        });\n        var iconCssClass = this.props.fabricIconKey ?\n            \"ms-Icon ms-Icon--\" + this.props.fabricIconKey : (this.props.iconClassName || '');\n        var isTouchDevice = Utilities_1.default.isTouchEnabled();\n        var onClick = isTouchDevice ? undefined : this.props.onClick;\n        var onMouseDown = isTouchDevice ? this.props.onClick : undefined;\n        return (React.createElement(\"button\", {type: 'button', \"aria-disabled\": this.props.disabled ? true : undefined, \"aria-pressed\": this.props.canBeActive ? this.props.isActive : undefined, className: buttonClassName, key: this.props.key, onClick: onClick, onMouseDown: onMouseDown, title: this.props.title, tabIndex: this.props.tabIndex, \"data-automation-id\": this.props.automationId, onKeyDown: this.props.onKeyDown ? this.props.onKeyDown : undefined, onBlur: this.props.onBlur}, \n            React.createElement(\"i\", {className: iconCssClass}), \n            this.props.label));\n    };\n    ToolbarButton.defaultProps = {\n        key: undefined,\n        fabricIconKey: undefined,\n        onClick: undefined,\n        canBeActive: true,\n        className: 'CanvasControlToolbar-item',\n        disabled: false,\n        isActive: false\n    };\n    return ToolbarButton;\n}(React.Component));\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.default = ToolbarButton;\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./lib/local/appBase/components/sp-canvas/toolbar/toolbarButton/ToolbarButton.js\n// module id = 129\n// module chunks = 0\n\n\n// WEBPACK FOOTER //\n// webpack:///lib/local/appBase/components/sp-canvas/toolbar/toolbarButton/ToolbarButton.js","require('ToolbarButton.css');\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./lib/local/appBase/components/sp-canvas/toolbar/toolbarButton/ToolbarButton.scss.js\n// module id = 130\n// module chunks = 0\n\n\n// WEBPACK FOOTER //\n// webpack:///lib/local/appBase/components/sp-canvas/toolbar/toolbarButton/ToolbarButton.scss.js","var content = require(\"!!./../../../../../../../../../common/node_modules/css-loader/index.js?-minimize!./ToolbarButton.css\");\nvar loader = require(\"D:\\\\agent\\\\1\\\\_work\\\\24\\\\s\\\\common\\\\node_modules\\\\@microsoft\\\\load-themed-styles\\\\lib\\\\index.js\");\n\nif(typeof content === \"string\") content = [[module.id, content]];\n\n// add the styles to the DOM\nfor (var i = 0; i < content.length; i++) loader.loadStyles(content[i][1]);\n\nif(content.locals) module.exports = content.locals;\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./lib/local/appBase/components/sp-canvas/toolbar/toolbarButton/ToolbarButton.css\n// module id = 131\n// module chunks = 0\n\n\n// WEBPACK FOOTER //\n// webpack:///lib/local/appBase/components/sp-canvas/toolbar/toolbarButton/ToolbarButton.css?07c7","exports = module.exports = require(\"./../../../../../../../../../common/node_modules/css-loader/lib/css-base.js\")();\n// imports\n\n\n// module\nexports.push([module.id, \".ToolbarButton{background-color:\\\"[theme:neutralPrimary, default: #333333]\\\";border:none;height:34px;overflow:hidden;padding:0 8px;position:relative;text-align:center;top:0;-webkit-transition:all .3s;transition:all .3s;-webkit-transition-property:background-color,color;transition-property:background-color,color;min-width:34px;color:\\\"[theme:neutralLighterAlt, default: #f8f8f8]\\\";font-family:\\\"Segoe UI Regular WestEuropean\\\",\\\"Segoe UI\\\",\\\"Segoe WP\\\",Tahoma,Arial,sans-serif;font-size:14px}.ToolbarButton .ms-Icon{font-size:16px;line-height:1.2}.ToolbarButton:hover{background-color:\\\"[theme:neutralSecondaryAlt, default: #767676]\\\";cursor:pointer}.ToolbarButton.ToolbarButton--active{background-color:\\\"[theme:themeSecondary, default:#2b88d8]\\\"}.ToolbarButton.ToolbarButton--active+.ToolbarButton--divider::after,.ToolbarButton.ToolbarButton--active.ToolbarButton--divider::after{border:\\\"[theme:themeSecondary, default:#2b88d8]\\\"}.ToolbarButton:active{background-color:\\\"[theme:themeDarkAlt, default:#106ebe]\\\"}.ToolbarButton.ToolbarButton--disabled,.ToolbarButton.ToolbarButton--disabled:hover{background-color:\\\"[theme:neutralPrimary, default: #333333]\\\";color:\\\"[theme:neutralSecondary, default: #666666]\\\"}.ToolbarButton.ToolbarButton--disabled .ms-Icon,.ToolbarButton.ToolbarButton--disabled:hover .ms-Icon{color:\\\"[theme:neutralSecondary, default: #666666]\\\"}.ToolbarButton:focus{border:1px solid \\\"[theme:neutralTertiary, default: #a6a6a6]\\\";outline:0}.ToolbarButton.ToolbarButton--divider::after{content:'';position:absolute;height:20px;left:0;top:6px;border-left:1px solid \\\"[theme:neutralSecondary, default: #666666]\\\"}.ToolbarButton--h2{font-size:21px;font-family:\\\"Segoe UI Light WestEuropean\\\",\\\"Segoe UI Light\\\",\\\"Segoe WP Light\\\",\\\"Segoe UI\\\",\\\"Segoe WP\\\",Tahoma,Arial,sans-serif}.ToolbarButton--blockquote{font-style:italic}\", \"\"]);\n\n// exports\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// D:/agent/1/_work/24/s/common/~/css-loader?-minimize!./lib/local/appBase/components/sp-canvas/toolbar/toolbarButton/ToolbarButton.css\n// module id = 132\n// module chunks = 0\n\n\n// WEBPACK FOOTER //\n// webpack:///lib/local/appBase/components/sp-canvas/toolbar/toolbarButton/ToolbarButton.css","\"use strict\";\nvar odsp_utilities_bundle_1 = require('@ms/odsp-utilities-bundle');\nvar Utilities = (function () {\n    function Utilities() {\n    }\n    Utilities.isTouchEnabled = function () {\n        var platform = new odsp_utilities_bundle_1.PlatformDetection();\n        return platform.isAndroid || platform.isIOS;\n    };\n    return Utilities;\n}());\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.default = Utilities;\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./lib/local/appBase/components/sp-canvas/common/Utilities.js\n// module id = 133\n// module chunks = 0\n\n\n// WEBPACK FOOTER //\n// webpack:///lib/local/appBase/components/sp-canvas/common/Utilities.js","\"use strict\";\nvar __extends = (this && this.__extends) || function (d, b) {\n    for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p];\n    function __() { this.constructor = d; }\n    d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n};\nvar __assign = (this && this.__assign) || Object.assign || function(t) {\n    for (var s, i = 1, n = arguments.length; i < n; i++) {\n        s = arguments[i];\n        for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p))\n            t[p] = s[p];\n    }\n    return t;\n};\nvar __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\n};\nvar React = require('react');\nvar office_ui_fabric_react_1 = require('office-ui-fabric-react');\nvar ToolbarButton_1 = require('../toolbarButton/ToolbarButton');\nvar CanvasA11y_1 = require('../../a11y/CanvasA11y');\nvar office_ui_fabric_react_2 = require('office-ui-fabric-react');\nrequire('./ToolbarSubmenu.scss');\nvar DISPLAYBUTTON = 'displayButton';\nvar ToolbarSubmenu = (function (_super) {\n    __extends(ToolbarSubmenu, _super);\n    function ToolbarSubmenu(props) {\n        _super.call(this, props);\n        this._hasExplicitActiveButton = false;\n        this.state = {\n            isOpen: props.isOpen\n        };\n    }\n    ToolbarSubmenu.prototype.componentDidMount = function () {\n        document.addEventListener('click', this._handleDocumentClick);\n    };\n    ToolbarSubmenu.prototype.componentDidUpdate = function (prevProps, prevState) {\n        if (this._isKeyboardNav && !this.state.isOpen && this._focusElement) {\n            this._focusElement.focus();\n            this._focusElement = undefined;\n            this._isKeyboardNav = false;\n        }\n        if (this._isKeyboardNav && this.state.isOpen && this._menuElement) {\n            CanvasA11y_1.navigateInside(this._menuElement);\n            this._isKeyboardNav = false;\n        }\n    };\n    ToolbarSubmenu.prototype.componentWillReceiveProps = function (nextProps) {\n        if (this.props.isOpen !== nextProps.isOpen) {\n            this.setState({ isOpen: nextProps.isOpen });\n        }\n    };\n    ToolbarSubmenu.prototype.componentWillUnmount = function () {\n        document.removeEventListener('click', this._handleDocumentClick);\n    };\n    ToolbarSubmenu.prototype.render = function () {\n        var openedCssClass = this.state.isOpen ? 'is-open' : '';\n        var wideCssClass = this.props.isWide ? 'ToolbarSubmenu--wide' : '';\n        var activeButton = this._getActiveButton();\n        this._bindButtonClickHandlers();\n        var buttonElements = [];\n        for (var _i = 0, _a = this.props.buttons; _i < _a.length; _i++) {\n            var buttonProps = _a[_i];\n            buttonProps.tabIndex = this.state.isOpen ? 0 : -1;\n            if (buttonProps === activeButton) {\n                buttonProps.isActive = true;\n            }\n            buttonElements.push(React.createElement(ToolbarButton_1.default, __assign({}, buttonProps)));\n        }\n        return (React.createElement(\"div\", {className: \"ToolbarSubmenu \" + openedCssClass + \" \" + wideCssClass}, \n            React.createElement(ToolbarButton_1.default, {className: 'ToolbarSubmenu-displayButton', fabricIconKey: activeButton.fabricIconKey, iconClassName: activeButton.iconClassName, key: 'displayButton', onClick: this._handleClickOnDisplayButton, isActive: this._hasExplicitActiveButton, label: activeButton.label, tabIndex: this.state.isOpen ? -1 : 0, title: activeButton.title, onKeyDown: this._handleSubmenuItemsKeyDown, automationId: DISPLAYBUTTON, onBlur: this.props.onBlur}), \n            React.createElement(\"i\", {className: 'ms-Icon ms-Icon--CaretDownSolid8 ToolbarSubmenu-caret'}), \n            React.createElement(office_ui_fabric_react_1.FocusZone, {isCircularNavigation: true}, \n                React.createElement(\"div\", {role: 'presentation', className: 'ToolbarSubmenu-menuItems', ref: this._resolveRef('_menuElement'), onKeyDown: this._handleSubmenuKeyDown, \"data-automation-id\": 'subMenuContainer'}, buttonElements)\n            )));\n    };\n    ToolbarSubmenu.prototype._bindButtonClickHandlers = function () {\n        for (var _i = 0, _a = this.props.buttons; _i < _a.length; _i++) {\n            var buttonProps = _a[_i];\n            buttonProps.onClick = this._handleOnButtonClick.bind(this, buttonProps.onClick);\n        }\n    };\n    ToolbarSubmenu.prototype._getActiveButton = function () {\n        this._hasExplicitActiveButton = false;\n        for (var _i = 0, _a = this.props.buttons; _i < _a.length; _i++) {\n            var button = _a[_i];\n            if (button.isActive) {\n                this._hasExplicitActiveButton = true;\n                return button;\n            }\n        }\n        return this.props.buttons[0];\n    };\n    ToolbarSubmenu.prototype._handleSubmenuKeyDown = function (e) {\n        if (this.state.isOpen &&\n            (e.key === 'ArrowRight' || e.key === 'ArrowLeft')) {\n            this._isKeyboardNav = true;\n            this._handleCloseSubmenu();\n        }\n    };\n    ToolbarSubmenu.prototype._handleSubmenuItemsKeyDown = function (e) {\n        if (e.key === 'ArrowDown') {\n            this._isKeyboardNav = true;\n            this._handleOpenSubmenu();\n        }\n    };\n    ToolbarSubmenu.prototype._handleClickOnDisplayButton = function () {\n        if (this.state.isOpen) {\n            this._handleCloseSubmenu();\n        }\n        else {\n            this._handleOpenSubmenu();\n        }\n    };\n    ToolbarSubmenu.prototype._handleOpenSubmenu = function () {\n        this._focusElement = document.activeElement;\n        this.props.onOpen();\n        this.setState({ isOpen: true });\n    };\n    ToolbarSubmenu.prototype._handleCloseSubmenu = function (isDocumentClick) {\n        this.setState({ isOpen: false });\n        this.props.onClose(isDocumentClick);\n    };\n    ToolbarSubmenu.prototype._handleOnButtonClick = function (onClickCallback) {\n        onClickCallback();\n        this._handleCloseSubmenu();\n    };\n    ToolbarSubmenu.prototype._handleDocumentClick = function (evt) {\n        var currentTarget = evt.target;\n        if (this.state.isOpen &&\n            currentTarget.getAttribute('data-automation-id') !== DISPLAYBUTTON &&\n            currentTarget.parentElement &&\n            currentTarget.parentElement.getAttribute('data-automation-id') !== DISPLAYBUTTON) {\n            this._handleCloseSubmenu(true);\n        }\n    };\n    __decorate([\n        office_ui_fabric_react_2.autobind\n    ], ToolbarSubmenu.prototype, \"_bindButtonClickHandlers\", null);\n    __decorate([\n        office_ui_fabric_react_2.autobind\n    ], ToolbarSubmenu.prototype, \"_handleSubmenuKeyDown\", null);\n    __decorate([\n        office_ui_fabric_react_2.autobind\n    ], ToolbarSubmenu.prototype, \"_handleSubmenuItemsKeyDown\", null);\n    __decorate([\n        office_ui_fabric_react_2.autobind\n    ], ToolbarSubmenu.prototype, \"_handleClickOnDisplayButton\", null);\n    __decorate([\n        office_ui_fabric_react_2.autobind\n    ], ToolbarSubmenu.prototype, \"_handleOpenSubmenu\", null);\n    __decorate([\n        office_ui_fabric_react_2.autobind\n    ], ToolbarSubmenu.prototype, \"_handleCloseSubmenu\", null);\n    __decorate([\n        office_ui_fabric_react_2.autobind\n    ], ToolbarSubmenu.prototype, \"_handleOnButtonClick\", null);\n    __decorate([\n        office_ui_fabric_react_2.autobind\n    ], ToolbarSubmenu.prototype, \"_handleDocumentClick\", null);\n    return ToolbarSubmenu;\n}(office_ui_fabric_react_2.BaseComponent));\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.default = ToolbarSubmenu;\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./lib/local/appBase/components/sp-canvas/toolbar/toolbarSubMenu/ToolbarSubmenu.js\n// module id = 134\n// module chunks = 0\n\n\n// WEBPACK FOOTER //\n// webpack:///lib/local/appBase/components/sp-canvas/toolbar/toolbarSubMenu/ToolbarSubmenu.js","\"use strict\";\n(function (KeyCodes) {\n    KeyCodes[KeyCodes[\"Enter\"] = 13] = \"Enter\";\n    KeyCodes[KeyCodes[\"Escape\"] = 27] = \"Escape\";\n    KeyCodes[KeyCodes[\"Tab\"] = 9] = \"Tab\";\n    KeyCodes[KeyCodes[\"F10\"] = 121] = \"F10\";\n    KeyCodes[KeyCodes[\"P\"] = 80] = \"P\";\n})(exports.KeyCodes || (exports.KeyCodes = {}));\nvar KeyCodes = exports.KeyCodes;\nfunction isEscape(e) {\n    return isKey(KeyCodes.Escape, e);\n}\nexports.isEscape = isEscape;\nfunction isEnter(e) {\n    return isKey(KeyCodes.Enter, e);\n}\nexports.isEnter = isEnter;\nfunction isShiftTab(e) {\n    return isKey(KeyCodes.Tab, e, false, false, true);\n}\nexports.isShiftTab = isShiftTab;\nfunction isTab(e) {\n    return isKey(KeyCodes.Tab, e);\n}\nexports.isTab = isTab;\nfunction isKey(keyCode, e, allowAlt, allowCtrl, allowShift) {\n    if (allowAlt === void 0) { allowAlt = false; }\n    if (allowCtrl === void 0) { allowCtrl = false; }\n    if (allowShift === void 0) { allowShift = false; }\n    return e.keyCode === keyCode &&\n        ((allowAlt && e.altKey) || (!allowAlt && !e.altKey)) &&\n        ((allowCtrl && e.ctrlKey) || (!allowCtrl && !e.ctrlKey)) &&\n        ((allowShift && e.shiftKey) || (!allowShift && !e.shiftKey));\n}\nexports.isKey = isKey;\nfunction getFocusableChildren(elem, ignoreTabIndex) {\n    if (ignoreTabIndex === void 0) { ignoreTabIndex = false; }\n    var children = [];\n    for (var _i = 0, _a = getFocusableDescendants(elem, ignoreTabIndex); _i < _a.length; _i++) {\n        var descendant = _a[_i];\n        if (isElementFocusableChildOf(descendant, elem)) {\n            children.push(descendant);\n        }\n    }\n    return children;\n}\nexports.getFocusableChildren = getFocusableChildren;\nfunction isElementFocusable(elem, ignoreTabIndex) {\n    if (ignoreTabIndex === void 0) { ignoreTabIndex = false; }\n    var tagName = elem.tagName.toLowerCase();\n    if (elem\n        && !elem.hidden\n        && elem.offsetParent\n        && window.getComputedStyle(elem).display !== 'none'\n        && window.getComputedStyle(elem).visibility !== 'hidden') {\n        var hasTabIndex = elem.hasAttribute('tabindex');\n        var tabindex = parseInt(elem.getAttribute('tabindex'), 10);\n        if (!ignoreTabIndex && hasTabIndex && tabindex < 0) {\n            return false;\n        }\n        if (tagName === 'a' && !!elem.href ||\n            elem.isContentEditable) {\n            return true;\n        }\n        if ((tagName === 'button' ||\n            tagName === 'input' ||\n            tagName === 'select' ||\n            tagName === 'textarea') && !elem.disabled) {\n            return true;\n        }\n        if (ignoreTabIndex && elem.getAttribute('data-is-focusable') === 'true') {\n            return true;\n        }\n        if (!ignoreTabIndex && hasTabIndex && tabindex > -1) {\n            return true;\n        }\n    }\n    return false;\n}\nexports.isElementFocusable = isElementFocusable;\nfunction getFocusableParent(elem, topElement) {\n    if (topElement === void 0) { topElement = document.body; }\n    var parent = elem;\n    do {\n        parent = parent.parentElement;\n    } while (!isElementFocusable(parent) && parent !== topElement);\n    return parent;\n}\nexports.getFocusableParent = getFocusableParent;\nfunction queryFocusableSelector(elem) {\n    var selector = 'button,input,textarea,select,a[href]:not([href=\\'\\']),\\\r\n      [tabindex],[contenteditable=\\'true\\'], [data-is-focusable=\\'true\\']';\n    return elem.querySelectorAll(selector);\n}\nfunction getFirstFocusableChild(elem, ignoreTabIndex) {\n    if (ignoreTabIndex === void 0) { ignoreTabIndex = false; }\n    var nodes = queryFocusableSelector(elem);\n    for (var i = 0; i < nodes.length; i++) {\n        var node = nodes[i];\n        if (isElementFocusable(node, ignoreTabIndex)) {\n            return node;\n        }\n    }\n    return undefined;\n}\nexports.getFirstFocusableChild = getFirstFocusableChild;\nfunction getFocusableDescendants(elem, ignoreTabIndex) {\n    if (ignoreTabIndex === void 0) { ignoreTabIndex = false; }\n    var descendants = [];\n    var nodes = queryFocusableSelector(elem);\n    for (var i = 0; i < nodes.length; i++) {\n        var node = nodes[i];\n        if (isElementFocusable(node, ignoreTabIndex)) {\n            descendants.push(node);\n        }\n    }\n    return descendants;\n}\nexports.getFocusableDescendants = getFocusableDescendants;\nfunction getFocusableSiblings(elem, topElement) {\n    if (topElement === void 0) { topElement = document.body; }\n    var children = getFocusableChildren(getFocusableParent(elem, topElement));\n    var siblings = [];\n    var insertPointer = 0;\n    for (var _i = 0, children_1 = children; _i < children_1.length; _i++) {\n        var child = children_1[_i];\n        if (child !== elem) {\n            siblings.splice(insertPointer++, 0, child);\n        }\n        else {\n            insertPointer = 0;\n        }\n    }\n    return siblings;\n}\nexports.getFocusableSiblings = getFocusableSiblings;\nfunction getNextFocusableElement(elem, topElement) {\n    if (topElement === void 0) { topElement = document.body; }\n    var siblings = getFocusableSiblings(elem, topElement);\n    return siblings[0];\n}\nexports.getNextFocusableElement = getNextFocusableElement;\nfunction getPrevFocusableElement(elem, topElement) {\n    if (topElement === void 0) { topElement = document.body; }\n    var siblings = getFocusableSiblings(elem, topElement);\n    return siblings[siblings.length - 1];\n}\nexports.getPrevFocusableElement = getPrevFocusableElement;\nfunction isElementFocusableChildOf(elem, ancestor) {\n    var parent = elem.parentElement;\n    while (parent.tagName !== 'BODY') {\n        if (parent === ancestor) {\n            return true;\n        }\n        if (isElementFocusable(parent)) {\n            break;\n        }\n        parent = parent.parentElement;\n    }\n    return false;\n}\nexports.isElementFocusableChildOf = isElementFocusableChildOf;\nfunction navigateInside(elem) {\n    var children = getFocusableChildren(elem);\n    if (children.length) {\n        children[0].focus();\n        return true;\n    }\n    else {\n        return false;\n    }\n}\nexports.navigateInside = navigateInside;\nfunction navigateTo(elem) {\n    if (isElementFocusable(elem)) {\n        elem.focus();\n        return true;\n    }\n    else {\n        return navigateInside(elem);\n    }\n}\nexports.navigateTo = navigateTo;\nfunction navigateOutOf(elem, topElement) {\n    if (topElement === void 0) { topElement = document.body; }\n    topElement = topElement || document.body;\n    getFocusableParent(elem, topElement).focus();\n}\nexports.navigateOutOf = navigateOutOf;\nvar CanvasA11yManager = (function () {\n    function CanvasA11yManager(canvasElement, shouldHandleKeyDown) {\n        if (shouldHandleKeyDown === void 0) { shouldHandleKeyDown = true; }\n        this._canvasElement = canvasElement;\n        this._handleKeyDown = this._handleKeyDown.bind(this);\n        this._randId = Math.floor(Math.random() * 1000000);\n        if (shouldHandleKeyDown) {\n            this._canvasElement.addEventListener('keydown', this._handleKeyDown);\n        }\n    }\n    CanvasA11yManager.prototype.ariaAlert = function (message) {\n        var divId = 'aria_alert_' + this._randId;\n        var oldAlert = document.querySelector('#' + divId);\n        if (oldAlert) {\n            document.body.removeChild(oldAlert);\n        }\n        var alertNode = document.createElement('p');\n        alertNode.classList.add('Canvas-screenReaderOnly');\n        alertNode.setAttribute('role', 'alert');\n        alertNode.setAttribute('id', divId);\n        var alertText = document.createTextNode(message);\n        alertNode.appendChild(alertText);\n        document.body.appendChild(alertNode);\n    };\n    CanvasA11yManager.prototype.navigateInside = function (elem) {\n        return navigateInside(elem);\n    };\n    CanvasA11yManager.prototype.navigateTo = function (elem) {\n        return navigateTo(elem);\n    };\n    CanvasA11yManager.prototype.navigateOutOf = function (elem) {\n        navigateOutOf(elem);\n    };\n    CanvasA11yManager.prototype.clearState = function () {\n        this._savedFocusedElement = undefined;\n    };\n    CanvasA11yManager.prototype.restoreState = function () {\n        return this.navigateTo(this._savedFocusedElement);\n    };\n    CanvasA11yManager.prototype.saveState = function (elem) {\n        elem = elem || document.activeElement;\n        this._savedFocusedElement = elem;\n    };\n    CanvasA11yManager.prototype.skipEvent = function (e) {\n        e[CanvasA11yManager._SKIP_FLAG] = true;\n    };\n    CanvasA11yManager.prototype._shouldSkipEvent = function (e) {\n        return e[CanvasA11yManager._SKIP_FLAG];\n    };\n    CanvasA11yManager.prototype._handleKeyDown = function (e) {\n        if (this._shouldSkipEvent(e)) {\n            return;\n        }\n        var currentElement = isElementFocusable(e.target) ?\n            e.target : getFocusableParent(e.target, this._canvasElement);\n        var elementToGo;\n        if (isTab(e)) {\n            var children = getFocusableChildren(this._canvasElement);\n            if (children.length && currentElement !== children[children.length - 1]) {\n                elementToGo = getNextFocusableElement(currentElement, this._canvasElement);\n            }\n        }\n        else if (isShiftTab(e)) {\n            var children = getFocusableChildren(this._canvasElement);\n            if (children.length && currentElement !== children[0]) {\n                elementToGo = getPrevFocusableElement(currentElement, this._canvasElement);\n            }\n        }\n        else if (isEnter(e)) {\n            var children = getFocusableChildren(currentElement);\n            elementToGo = children.length ? children[0] : undefined;\n        }\n        else if (isEscape(e)) {\n            elementToGo = getFocusableParent(currentElement, this._canvasElement);\n        }\n        if (elementToGo) {\n            elementToGo.focus();\n            e.preventDefault();\n            e.stopPropagation();\n        }\n    };\n    CanvasA11yManager._SKIP_FLAG = 'a11y-skip';\n    return CanvasA11yManager;\n}());\nexports.CanvasA11yManager = CanvasA11yManager;\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./lib/local/appBase/components/sp-canvas/a11y/CanvasA11y.js\n// module id = 135\n// module chunks = 0\n\n\n// WEBPACK FOOTER //\n// webpack:///lib/local/appBase/components/sp-canvas/a11y/CanvasA11y.js","require('ToolbarSubmenu.css');\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./lib/local/appBase/components/sp-canvas/toolbar/toolbarSubMenu/ToolbarSubmenu.scss.js\n// module id = 136\n// module chunks = 0\n\n\n// WEBPACK FOOTER //\n// webpack:///lib/local/appBase/components/sp-canvas/toolbar/toolbarSubMenu/ToolbarSubmenu.scss.js","var content = require(\"!!./../../../../../../../../../common/node_modules/css-loader/index.js?-minimize!./ToolbarSubmenu.css\");\nvar loader = require(\"D:\\\\agent\\\\1\\\\_work\\\\24\\\\s\\\\common\\\\node_modules\\\\@microsoft\\\\load-themed-styles\\\\lib\\\\index.js\");\n\nif(typeof content === \"string\") content = [[module.id, content]];\n\n// add the styles to the DOM\nfor (var i = 0; i < content.length; i++) loader.loadStyles(content[i][1]);\n\nif(content.locals) module.exports = content.locals;\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./lib/local/appBase/components/sp-canvas/toolbar/toolbarSubMenu/ToolbarSubmenu.css\n// module id = 137\n// module chunks = 0\n\n\n// WEBPACK FOOTER //\n// webpack:///lib/local/appBase/components/sp-canvas/toolbar/toolbarSubMenu/ToolbarSubmenu.css?2fec","exports = module.exports = require(\"./../../../../../../../../../common/node_modules/css-loader/lib/css-base.js\")();\n// imports\n\n\n// module\nexports.push([module.id, \".ToolbarSubmenu{width:44px;position:relative}.ToolbarSubmenu .ToolbarButton{width:44px}.ToolbarSubmenu-displayButton{padding-right:20px}.ToolbarSubmenu-caret{color:\\\"[theme:neutralLighterAlt, default: #f8f8f8]\\\";font-size:8px;pointer-events:none;position:absolute;right:4px;top:50%;-webkit-transform:translateY(-50%);transform:translateY(-50%);z-index:1}.ToolbarSubmenu-menuItems{display:none;position:absolute;top:34px}.ToolbarSubmenu-menuItems .ToolbarButton{padding-right:20px}.ToolbarSubmenu--wide{width:160px!important}.ToolbarSubmenu--wide .ToolbarButton{width:100%;text-align:left}.ToolbarSubmenu.is-open .ToolbarSubmenu-menuItems{display:block}\", \"\"]);\n\n// exports\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// D:/agent/1/_work/24/s/common/~/css-loader?-minimize!./lib/local/appBase/components/sp-canvas/toolbar/toolbarSubMenu/ToolbarSubmenu.css\n// module id = 138\n// module chunks = 0\n\n\n// WEBPACK FOOTER //\n// webpack:///lib/local/appBase/components/sp-canvas/toolbar/toolbarSubMenu/ToolbarSubmenu.css","require('BaseRte.css');\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./lib/local/appBase/components/sp-rte/rte/BaseRte.scss.js\n// module id = 139\n// module chunks = 0\n\n\n// WEBPACK FOOTER //\n// webpack:///lib/local/appBase/components/sp-rte/rte/BaseRte.scss.js","var content = require(\"!!./../../../../../../../../common/node_modules/css-loader/index.js?-minimize!./BaseRte.css\");\nvar loader = require(\"D:\\\\agent\\\\1\\\\_work\\\\24\\\\s\\\\common\\\\node_modules\\\\@microsoft\\\\load-themed-styles\\\\lib\\\\index.js\");\n\nif(typeof content === \"string\") content = [[module.id, content]];\n\n// add the styles to the DOM\nfor (var i = 0; i < content.length; i++) loader.loadStyles(content[i][1]);\n\nif(content.locals) module.exports = content.locals;\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./lib/local/appBase/components/sp-rte/rte/BaseRte.css\n// module id = 140\n// module chunks = 0\n\n\n// WEBPACK FOOTER //\n// webpack:///lib/local/appBase/components/sp-rte/rte/BaseRte.css?dff7","exports = module.exports = require(\"./../../../../../../../../common/node_modules/css-loader/lib/css-base.js\")();\n// imports\n\n\n// module\nexports.push([module.id, \".cke_editable,.ql-editor{cursor:text;margin:0;padding:0;min-height:100%;margin-bottom:-16px}.cke_editable:focus,.ql-editor:focus{outline:0}.cke_editable:focus,.ql-editor:focus{outline:0}.ql-paste-manager{position:absolute;text-indent:-9999px;width:1px;height:1px;padding:0;margin:-1px;overflow:hidden;border:0}.ql-editor.ql-ie-10 br,.ql-editor.ql-ie-9 br{display:none}.cke_editable blockquote,.cke_editable div,.cke_editable h2,.cke_editable h3,.cke_editable h4,.cke_editable ol,.cke_editable p,.cke_editable ul,.cke_editable.ql-blank::before,.ql-editor blockquote,.ql-editor div,.ql-editor h2,.ql-editor h3,.ql-editor h4,.ql-editor ol,.ql-editor p,.ql-editor ul,.ql-editor.ql-blank::before{-webkit-font-smoothing:antialiased;color:\\\"[theme:neutralPrimary, default: #333333]\\\";line-height:1.5;margin:0 0 16px 0;padding:0;word-wrap:break-word}.cke_editable.ql-blank::before,.ql-editor.ql-blank::before{color:\\\"[theme:neutralTertiary, default: #a6a6a6]\\\"!important;content:attr(data-placeholder);font-size:16px;font-family:\\\"Segoe UI Regular WestEuropean\\\",\\\"Segoe UI\\\",\\\"Segoe WP\\\",Tahoma,Arial,sans-serif;font-style:normal;position:absolute;pointer-events:none}.cke_editable div,.cke_editable p,.ql-editor div,.ql-editor p{font-size:16px;font-family:\\\"Segoe UI Regular WestEuropean\\\",\\\"Segoe UI\\\",\\\"Segoe WP\\\",Tahoma,Arial,sans-serif}.cke_editable h2,.cke_editable h3,.cke_editable h4,.ql-editor h2,.ql-editor h3,.ql-editor h4{font-weight:400;font-family:\\\"Segoe UI Light WestEuropean\\\",\\\"Segoe UI Light\\\",\\\"Segoe WP Light\\\",\\\"Segoe UI\\\",\\\"Segoe WP\\\",Tahoma,Arial,sans-serif!important}.cke_editable h2,.ql-editor h2{font-size:24px}.cke_editable h3,.ql-editor h3{font-size:20px}.cke_editable h4,.ql-editor h4{font-size:18px;font-family:\\\"Segoe UI Semilight WestEuropean\\\",\\\"Segoe UI Semilight\\\",\\\"Segoe WP Semilight\\\",\\\"Segoe UI\\\",\\\"Segoe WP\\\",Tahoma,Arial,sans-serif}.cke_editable ol,.cke_editable ul,.ql-editor ol,.ql-editor ul{font-size:16px;font-family:\\\"Segoe UI Regular WestEuropean\\\",\\\"Segoe UI\\\",\\\"Segoe WP\\\",Tahoma,Arial,sans-serif;padding:0}.cke_editable ol li,.cke_editable ul li,.ql-editor ol li,.ql-editor ul li{margin-bottom:8px}.cke_editable ol,.ql-editor ol{list-style-type:decimal}.cke_editable ul,.ql-editor ul{list-style-type:disc}.cke_editable blockquote,.cke_editable div.quote-true,.ql-editor blockquote,.ql-editor div.quote-true{border-bottom:1px solid \\\"[theme:neutralTertiaryAlt, default: #c8c8c8]\\\";border-top:1px solid \\\"[theme:neutralTertiaryAlt, default: #c8c8c8]\\\";border-bottom-color:\\\"[theme:neutralTertiaryAlt, default: #c8c8c8]\\\";border-top-color:\\\"[theme:neutralTertiaryAlt, default: #c8c8c8]\\\";border-left:none;border-right:none;font-family:\\\"Segoe UI Light WestEuropean\\\",\\\"Segoe UI Light\\\",\\\"Segoe WP Light\\\",\\\"Segoe UI\\\",\\\"Segoe WP\\\",Tahoma,Arial,sans-serif;font-size:20px;font-style:italic;margin:28px 0;padding:32px;text-align:center}.cke_editable a,.ql-editor a{text-decoration:underline}.cke_editable i,.ql-editor i{font-style:italic}.cke_editable u,.ql-editor u{text-decoration:underline}@media screen and (min-width:480px){.cke_editable h2,.ql-editor h2{font-size:28px}.cke_editable h3,.ql-editor h3{font-size:24px}.cke_editable h4,.ql-editor h4{font-size:20px}.cke_editable blockquote,.cke_editable div.quote-true,.ql-editor blockquote,.ql-editor div.quote-true{font-size:24px}}@media screen and (min-width:1024px){.cke_editable h2,.ql-editor h2{font-size:32px}.cke_editable h3,.ql-editor h3{font-size:30px}.cke_editable h4,.ql-editor h4{font-size:24px}.cke_editable div,.cke_editable p,.cke_editable.ql-blank::before,.ql-editor div,.ql-editor p,.ql-editor.ql-blank::before{font-size:18px;font-family:\\\"Segoe UI Semilight WestEuropean\\\",\\\"Segoe UI Semilight\\\",\\\"Segoe WP Semilight\\\",\\\"Segoe UI\\\",\\\"Segoe WP\\\",Tahoma,Arial,sans-serif;line-height:1.75}.cke_editable ol,.cke_editable ul,.ql-editor ol,.ql-editor ul{font-size:18px;font-family:\\\"Segoe UI Semilight WestEuropean\\\",\\\"Segoe UI Semilight\\\",\\\"Segoe WP Semilight\\\",\\\"Segoe UI\\\",\\\"Segoe WP\\\",Tahoma,Arial,sans-serif;line-height:1.75}.cke_editable td,.cke_editable td p,.cke_editable th,.cke_editable th p,.ql-editor td,.ql-editor td p,.ql-editor th,.ql-editor th p{font-size:14px;font-family:\\\"Segoe UI Regular WestEuropean\\\",\\\"Segoe UI\\\",\\\"Segoe WP\\\",Tahoma,Arial,sans-serif}}\", \"\"]);\n\n// exports\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// D:/agent/1/_work/24/s/common/~/css-loader?-minimize!./lib/local/appBase/components/sp-rte/rte/BaseRte.css\n// module id = 141\n// module chunks = 0\n\n\n// WEBPACK FOOTER //\n// webpack:///lib/local/appBase/components/sp-rte/rte/BaseRte.css","\"use strict\";\nvar RteStrings_resx_1 = require('../loc/RteStrings.resx');\nvar SPRteQuillConfiguration = (function () {\n    function SPRteQuillConfiguration() {\n        this._supportedFormatsArray = [\n            {\n                key: 'bold',\n                editorKey: 'bold',\n                browserKey: 'bold',\n                isBlockStyle: false,\n                isLine: false,\n                isEditorNative: true,\n                button: {\n                    canBeActive: true,\n                    fabricIconKey: 'Bold',\n                    shortcut: 'Ctrl+B',\n                    title: RteStrings_resx_1.default.FormattingBarBoldButtonTitle\n                }\n            },\n            {\n                key: 'italic',\n                editorKey: 'italic',\n                browserKey: 'italic',\n                isBlockStyle: false,\n                isLine: false,\n                isEditorNative: true,\n                button: {\n                    canBeActive: true,\n                    fabricIconKey: 'Italic',\n                    shortcut: 'Ctrl+I',\n                    title: RteStrings_resx_1.default.FormattingBarItalicButtonTitle\n                }\n            },\n            {\n                key: 'underline',\n                editorKey: 'underline',\n                browserKey: 'underline',\n                isBlockStyle: false,\n                isLine: false,\n                isEditorNative: true,\n                button: {\n                    canBeActive: true,\n                    fabricIconKey: 'Underline',\n                    shortcut: 'Ctrl+U',\n                    title: RteStrings_resx_1.default.FormattingBarUnderlineButtonTitle\n                }\n            },\n            {\n                key: 'link',\n                editorKey: 'link',\n                isBlockStyle: false,\n                isLine: false,\n                isEditorNative: true,\n                masks: ['underline'],\n                button: {\n                    canBeActive: true,\n                    fabricIconKey: 'Link',\n                    shortcut: 'Ctrl+K',\n                    title: RteStrings_resx_1.default.FormattingBarLinkButtonTitle\n                }\n            },\n            {\n                key: 'alignLeft',\n                editorKey: 'align',\n                editorValue: false,\n                browserKey: 'justifyLeft',\n                isBlockStyle: false,\n                isLine: true,\n                isEditorNative: true,\n                button: {\n                    canBeActive: true,\n                    fabricIconKey: 'AlignLeft',\n                    title: RteStrings_resx_1.default.FormattingBarAlignLeftButtonTitle\n                }\n            },\n            {\n                browserKey: 'justifyCenter',\n                key: 'alignCenter',\n                editorKey: 'align',\n                editorValue: 'center',\n                isBlockStyle: false,\n                isLine: true,\n                isEditorNative: true,\n                button: {\n                    canBeActive: true,\n                    fabricIconKey: 'AlignCenter',\n                    title: RteStrings_resx_1.default.FormattingBarAlignCenterButtonTitle\n                }\n            },\n            {\n                key: 'alignRight',\n                editorKey: 'align',\n                editorValue: 'right',\n                browserKey: 'justifyRight',\n                isBlockStyle: false,\n                isLine: true,\n                isEditorNative: true,\n                button: {\n                    canBeActive: true,\n                    fabricIconKey: 'AlignRight',\n                    title: RteStrings_resx_1.default.FormattingBarAlignRightButtonTitle\n                }\n            },\n            {\n                key: 'bullet',\n                editorKey: 'list',\n                editorValue: 'bullet',\n                browserKey: 'insertUnorderedList',\n                isBlockStyle: true,\n                isLine: true,\n                isEditorNative: true,\n                button: {\n                    canBeActive: true,\n                    fabricIconKey: 'BulletedList',\n                    title: RteStrings_resx_1.default.FormattingBarBulletListButtonTitle\n                }\n            },\n            {\n                key: 'list',\n                editorKey: 'list',\n                editorValue: 'ordered',\n                browserKey: 'insertOrderedList',\n                isBlockStyle: true,\n                isLine: true,\n                isEditorNative: true,\n                button: {\n                    canBeActive: true,\n                    fabricIconKey: 'NumberedList',\n                    title: RteStrings_resx_1.default.FormattingBarNumberedListButtonTitle\n                }\n            },\n            {\n                key: 'h2',\n                editorKey: 'header',\n                editorValue: 2,\n                isBlockStyle: true,\n                isLine: true,\n                isEditorNative: true,\n                button: {\n                    canBeActive: true,\n                    title: RteStrings_resx_1.default.FormattingBarHeading2ButtonTitle,\n                    label: RteStrings_resx_1.default.FormattingBarHeading2ButtonTitle,\n                    className: 'ToolbarButton--h2'\n                }\n            },\n            {\n                key: 'h3',\n                editorKey: 'header',\n                editorValue: 3,\n                isBlockStyle: true,\n                isLine: true,\n                isEditorNative: false,\n                button: {\n                    canBeActive: true,\n                    title: RteStrings_resx_1.default.FormattingBarHeading3ButtonTitle,\n                    label: RteStrings_resx_1.default.FormattingBarHeading3ButtonTitle,\n                    className: 'ToolbarButton--h3'\n                }\n            },\n            {\n                key: 'h4',\n                editorKey: 'header',\n                editorValue: 4,\n                isBlockStyle: true,\n                isLine: true,\n                isEditorNative: false,\n                button: {\n                    canBeActive: true,\n                    title: RteStrings_resx_1.default.FormattingBarHeading4ButtonTitle,\n                    label: RteStrings_resx_1.default.FormattingBarHeading4ButtonTitle,\n                    className: 'ToolbarButton--h4'\n                }\n            },\n            {\n                key: 'blockquote',\n                editorKey: 'blockquote',\n                isBlockStyle: true,\n                isLine: true,\n                isEditorNative: true,\n                button: {\n                    canBeActive: true,\n                    title: RteStrings_resx_1.default.FormattingBarQuoteButtonTitle,\n                    label: RteStrings_resx_1.default.FormattingBarQuoteButtonTitle,\n                    className: 'ToolbarButton--blockquote'\n                }\n            },\n            {\n                key: 'indent',\n                editorKey: 'indent',\n                isBlockStyle: false,\n                isLine: true,\n                isEditorNative: true\n            }\n        ];\n        this._formats = new Map();\n        for (var _i = 0, _a = this._supportedFormatsArray; _i < _a.length; _i++) {\n            var format = _a[_i];\n            this._formats.set(format.key, format);\n        }\n        var maskingFormats = this._supportedFormatsArray.filter(function (format) { return !!format.masks; });\n        for (var _b = 0, maskingFormats_1 = maskingFormats; _b < maskingFormats_1.length; _b++) {\n            var maskingFormat = maskingFormats_1[_b];\n            for (var _c = 0, _d = maskingFormat.masks; _c < _d.length; _c++) {\n                var maskedFormatKey = _d[_c];\n                var maskedFormat = this._formats.get(maskedFormatKey);\n                if (!maskedFormat.maskedBy) {\n                    maskedFormat.maskedBy = [maskingFormat.key];\n                }\n                else {\n                    maskedFormat.maskedBy.push(maskingFormat.key);\n                }\n            }\n        }\n    }\n    Object.defineProperty(SPRteQuillConfiguration.prototype, \"editorElementClassName\", {\n        get: function () {\n            return 'ql-editor';\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(SPRteQuillConfiguration.prototype, \"formats\", {\n        get: function () {\n            return this._formats;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(SPRteQuillConfiguration.prototype, \"supportedFormatsArray\", {\n        get: function () {\n            return this._supportedFormatsArray;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    return SPRteQuillConfiguration;\n}());\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.default = SPRteQuillConfiguration;\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./lib/local/appBase/components/sp-rte/rte/SPRteQuillConfiguration.js\n// module id = 142\n// module chunks = 0\n\n\n// WEBPACK FOOTER //\n// webpack:///lib/local/appBase/components/sp-rte/rte/SPRteQuillConfiguration.js","\"use strict\";\nvar RteStrings_resx_1 = require('../loc/RteStrings.resx');\nvar SPRteCKEditorConfiguration = (function () {\n    function SPRteCKEditorConfiguration() {\n        this._supportedFormatsArray = [\n            {\n                key: 'bold',\n                editorKey: 'bold',\n                browserKey: 'bold',\n                isBlockStyle: false,\n                isLine: false,\n                isEditorNative: true,\n                button: {\n                    canBeActive: true,\n                    fabricIconKey: 'Bold',\n                    shortcut: 'Ctrl+B',\n                    title: RteStrings_resx_1.default.FormattingBarBoldButtonTitle\n                }\n            },\n            {\n                key: 'italic',\n                editorKey: 'italic',\n                browserKey: 'italic',\n                isBlockStyle: false,\n                isLine: false,\n                isEditorNative: true,\n                button: {\n                    canBeActive: true,\n                    fabricIconKey: 'Italic',\n                    shortcut: 'Ctrl+I',\n                    title: RteStrings_resx_1.default.FormattingBarItalicButtonTitle\n                }\n            },\n            {\n                key: 'underline',\n                editorKey: 'underline',\n                browserKey: 'underline',\n                isBlockStyle: false,\n                isLine: false,\n                isEditorNative: true,\n                button: {\n                    canBeActive: true,\n                    fabricIconKey: 'Underline',\n                    shortcut: 'Ctrl+U',\n                    title: RteStrings_resx_1.default.FormattingBarUnderlineButtonTitle\n                }\n            },\n            {\n                key: 'link',\n                editorKey: 'link',\n                isBlockStyle: false,\n                isLine: false,\n                isEditorNative: true,\n                masks: ['underline'],\n                button: {\n                    canBeActive: true,\n                    fabricIconKey: 'Link',\n                    shortcut: 'Ctrl+K',\n                    title: RteStrings_resx_1.default.FormattingBarLinkButtonTitle\n                }\n            },\n            {\n                key: 'alignLeft',\n                editorKey: 'justifyleft',\n                browserKey: 'justifyLeft',\n                isBlockStyle: false,\n                isLine: true,\n                isEditorNative: true,\n                button: {\n                    canBeActive: true,\n                    fabricIconKey: 'AlignLeft',\n                    title: RteStrings_resx_1.default.FormattingBarAlignLeftButtonTitle\n                }\n            },\n            {\n                key: 'alignCenter',\n                editorKey: 'justifycenter',\n                browserKey: 'justifyCenter',\n                isBlockStyle: false,\n                isLine: true,\n                isEditorNative: true,\n                button: {\n                    canBeActive: true,\n                    fabricIconKey: 'AlignCenter',\n                    title: RteStrings_resx_1.default.FormattingBarAlignCenterButtonTitle\n                }\n            },\n            {\n                key: 'alignRight',\n                editorKey: 'justifyright',\n                browserKey: 'justifyRight',\n                isBlockStyle: false,\n                isLine: true,\n                isEditorNative: true,\n                button: {\n                    canBeActive: true,\n                    fabricIconKey: 'AlignRight',\n                    title: RteStrings_resx_1.default.FormattingBarAlignRightButtonTitle\n                }\n            },\n            {\n                key: 'bullet',\n                editorKey: 'bulletedlist',\n                browserKey: 'insertUnorderedList',\n                isBlockStyle: true,\n                isLine: true,\n                isEditorNative: true,\n                button: {\n                    canBeActive: true,\n                    fabricIconKey: 'BulletedList',\n                    title: RteStrings_resx_1.default.FormattingBarBulletListButtonTitle\n                }\n            },\n            {\n                key: 'list',\n                editorKey: 'numberedlist',\n                browserKey: 'insertOrderedList',\n                isBlockStyle: true,\n                isLine: true,\n                isEditorNative: true,\n                button: {\n                    canBeActive: true,\n                    fabricIconKey: 'NumberedList',\n                    title: RteStrings_resx_1.default.FormattingBarNumberedListButtonTitle\n                }\n            },\n            {\n                key: 'h2',\n                editorKey: 'heading2',\n                isBlockStyle: true,\n                isLine: true,\n                isEditorNative: true,\n                button: {\n                    canBeActive: true,\n                    title: RteStrings_resx_1.default.FormattingBarHeading2ButtonTitle,\n                    label: RteStrings_resx_1.default.FormattingBarHeading2ButtonTitle,\n                    className: 'ToolbarButton--h2'\n                }\n            },\n            {\n                key: 'h3',\n                editorKey: 'heading3',\n                isBlockStyle: true,\n                isLine: true,\n                isEditorNative: false,\n                button: {\n                    canBeActive: true,\n                    title: RteStrings_resx_1.default.FormattingBarHeading3ButtonTitle,\n                    label: RteStrings_resx_1.default.FormattingBarHeading3ButtonTitle,\n                    className: 'ToolbarButton--h3'\n                }\n            },\n            {\n                key: 'h4',\n                editorKey: 'heading4',\n                isBlockStyle: true,\n                isLine: true,\n                isEditorNative: false,\n                button: {\n                    canBeActive: true,\n                    title: RteStrings_resx_1.default.FormattingBarHeading4ButtonTitle,\n                    label: RteStrings_resx_1.default.FormattingBarHeading4ButtonTitle,\n                    className: 'ToolbarButton--h4'\n                }\n            },\n            {\n                key: 'blockquote',\n                editorKey: 'blockquote',\n                isBlockStyle: true,\n                isLine: true,\n                isEditorNative: true,\n                button: {\n                    canBeActive: true,\n                    title: RteStrings_resx_1.default.FormattingBarQuoteButtonTitle,\n                    label: RteStrings_resx_1.default.FormattingBarQuoteButtonTitle,\n                    className: 'ToolbarButton--blockquote'\n                }\n            }\n        ];\n        this._formats = new Map();\n        for (var _i = 0, _a = this._supportedFormatsArray; _i < _a.length; _i++) {\n            var format = _a[_i];\n            this._formats.set(format.key, format);\n        }\n        var maskingFormats = this._supportedFormatsArray.filter(function (format) { return !!format.masks; });\n        for (var _b = 0, maskingFormats_1 = maskingFormats; _b < maskingFormats_1.length; _b++) {\n            var maskingFormat = maskingFormats_1[_b];\n            for (var _c = 0, _d = maskingFormat.masks; _c < _d.length; _c++) {\n                var maskedFormatKey = _d[_c];\n                var maskedFormat = this._formats.get(maskedFormatKey);\n                if (!maskedFormat.maskedBy) {\n                    maskedFormat.maskedBy = [maskingFormat.key];\n                }\n                else {\n                    maskedFormat.maskedBy.push(maskingFormat.key);\n                }\n            }\n        }\n    }\n    Object.defineProperty(SPRteCKEditorConfiguration.prototype, \"editorElementClassName\", {\n        get: function () {\n            return 'cke_editable';\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(SPRteCKEditorConfiguration.prototype, \"formats\", {\n        get: function () {\n            return this._formats;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(SPRteCKEditorConfiguration.prototype, \"supportedFormatsArray\", {\n        get: function () {\n            return this._supportedFormatsArray;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    return SPRteCKEditorConfiguration;\n}());\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.default = SPRteCKEditorConfiguration;\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./lib/local/appBase/components/sp-rte/rte/SPRteCKEditorConfiguration.js\n// module id = 143\n// module chunks = 0\n\n\n// WEBPACK FOOTER //\n// webpack:///lib/local/appBase/components/sp-rte/rte/SPRteCKEditorConfiguration.js","\"use strict\";\nvar __extends = (this && this.__extends) || function (d, b) {\n    for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p];\n    function __() { this.constructor = d; }\n    d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n};\nvar __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\n};\nvar SPRte_1 = require('./SPRte');\nvar office_ui_fabric_react_1 = require('office-ui-fabric-react');\nvar SPRteTouchDevice = (function (_super) {\n    __extends(SPRteTouchDevice, _super);\n    function SPRteTouchDevice(props) {\n        _super.call(this, props);\n    }\n    SPRteTouchDevice._getFormattingBarDefaultPosition = function (isRtl) {\n        if (isRtl === void 0) { isRtl = false; }\n        var left = isRtl ? 254 : undefined;\n        var top = 198;\n        var position = 'fixed';\n        var right = undefined;\n        return { left: left, top: top, position: position, right: right };\n    };\n    SPRteTouchDevice.prototype.componentWillUnmount = function () {\n        _super.prototype.componentWillUnmount.call(this);\n    };\n    SPRteTouchDevice.prototype._afterEditorCreated = function (editor) {\n        _super.prototype._afterEditorCreated.call(this, editor);\n    };\n    SPRteTouchDevice.prototype._initState = function () {\n        this.state = {\n            displayMode: this.props.displayMode,\n            formattingBarPosition: SPRteTouchDevice._getFormattingBarDefaultPosition(this._isRtl),\n            isFormattingBarHidden: false,\n            isLinkDialogOpen: false\n        };\n    };\n    SPRteTouchDevice.prototype._getFormattingBarPosition = function () {\n        return SPRteTouchDevice._getFormattingBarDefaultPosition(this._isRtl);\n    };\n    SPRteTouchDevice.prototype._handleScroll = function () {\n    };\n    SPRteTouchDevice.prototype._handleSelectionChange = function (range, forceUpdate) {\n        if (range) {\n            this.setState({ currentSubmenuOpen: undefined });\n            if (this._restoreOnFocus()) {\n                this._updateFormattingBar(false);\n                return;\n            }\n        }\n        if (!range) {\n            return;\n        }\n        else {\n            this._updateSelection(range, forceUpdate);\n        }\n    };\n    __decorate([\n        office_ui_fabric_react_1.autobind\n    ], SPRteTouchDevice.prototype, \"_handleSelectionChange\", null);\n    return SPRteTouchDevice;\n}(SPRte_1.default));\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.default = SPRteTouchDevice;\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./lib/local/appBase/components/sp-rte/rte/SPRteTouchDevice.js\n// module id = 144\n// module chunks = 0\n\n\n// WEBPACK FOOTER //\n// webpack:///lib/local/appBase/components/sp-rte/rte/SPRteTouchDevice.js","\"use strict\";\nvar __extends = (this && this.__extends) || function (d, b) {\n    for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p];\n    function __() { this.constructor = d; }\n    d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n};\nvar React = require('react');\nvar sp_core_library_1 = require('@microsoft/sp-core-library');\nvar sp_webpart_base_1 = require('@microsoft/sp-webpart-base');\nvar CanvasA11y_1 = require('../../a11y/CanvasA11y');\nvar WebPartZone = (function (_super) {\n    __extends(WebPartZone, _super);\n    function WebPartZone(props, context) {\n        _super.call(this, props, context);\n        this._webPartManager = this.context.store.webPartManager;\n        this.handleConfigureButtonClicked = this.handleConfigureButtonClicked.bind(this);\n        this.state = {\n            displayMode: this.props.displayMode\n        };\n    }\n    WebPartZone.prototype.componentDidMount = function () {\n        var _this = this;\n        var context = {\n            domElement: this._webPartDiv,\n            instanceId: this.props.id,\n            manifest: this.props.webPartManifest,\n            displayMode: this.props.displayMode,\n            webPartData: this.props.webPartData,\n            addedFromPersistedData: this.props.addedFromPersistedData\n        };\n        var qos = this.context.store.createQosScope('LoadWebPart');\n        this._loadWebPartPromise = this._webPartManager.loadWebPart(context).then(function () {\n            try {\n                if (_this.state.displayMode === sp_core_library_1.DisplayMode.Edit && _this.props.id === _this.context.store.selectedControlId) {\n                    _this.context.store.webPartManager.setPropertyPaneState(_this.props.id);\n                }\n                _this._isLoaded = true;\n                qos.writeSuccess();\n            }\n            catch (err) {\n                qos.writeUnexpectedFailure('Exception', err, { 'id': context.manifest && context.manifest.id });\n            }\n        }, function (error) { return qos.writeUnexpectedFailure('Rejected', error, { 'id': context.manifest && context.manifest.id }); });\n    };\n    WebPartZone.prototype.shouldComponentUpdate = function (newProps, newState) {\n        return false;\n    };\n    WebPartZone.prototype.render = function () {\n        var _this = this;\n        return (React.createElement(\"div\", {ref: function (htmlElement) { return _this._webPartDiv = htmlElement; }, style: { width: '100%' }}));\n    };\n    Object.defineProperty(WebPartZone.prototype, \"instanceId\", {\n        get: function () {\n            return this.props.id;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(WebPartZone.prototype, \"isFocusable\", {\n        get: function () {\n            return !!CanvasA11y_1.getFirstFocusableChild(this._webPartDiv);\n        },\n        enumerable: true,\n        configurable: true\n    });\n    WebPartZone.prototype.focus = function () {\n        if (!this.context.store.a11yManager.navigateInside(this._webPartDiv)) {\n            this.context.store.a11yManager.navigateOutOf(this._webPartDiv);\n        }\n    };\n    WebPartZone.prototype.handleConfigureButtonClicked = function (shouldToggle) {\n        if (this._isLoaded) {\n            this._webPartManager.setPropertyPaneState(this.props.id, shouldToggle ? sp_webpart_base_1.PropertyPaneState.Toggle : sp_webpart_base_1.PropertyPaneState.Open);\n        }\n    };\n    WebPartZone.prototype.handleDeleteButtonClicked = function () {\n        var _this = this;\n        this._loadWebPartPromise.then(function () { return _this._webPartManager.onWebPartDelete(_this.props.id); });\n    };\n    WebPartZone.prototype.serialize = function () {\n        var webPartData = this._isLoaded ? this._webPartManager.serialize(this.props.id).get(this.props.id) : this.props.webPartData;\n        if (webPartData &&\n            (!webPartData.htmlProperties || webPartData.htmlProperties === '') &&\n            webPartData.serverProcessedContent) {\n            webPartData.htmlProperties =\n                sp_webpart_base_1.WebPartDataConverter.convertServerProcessedDataToHtml(webPartData.serverProcessedContent);\n        }\n        var serialization = JSON.parse(JSON.stringify(this.props));\n        serialization.webPartManifest = undefined;\n        serialization.webPartData = webPartData;\n        return serialization;\n    };\n    WebPartZone.prototype.setDisplayMode = function (newDisplayMode) {\n        var _this = this;\n        this.setState({\n            displayMode: newDisplayMode\n        });\n        var qos = this.context.store.createQosScope(\"SetWebPartDisplayModeTo\" + newDisplayMode);\n        this._loadWebPartPromise.then(function () {\n            _this._webPartManager.setDisplayMode(newDisplayMode, _this.props.id);\n            qos.writeSuccess();\n        }, function (error) { return qos.writeUnexpectedFailure('Rejected', error, { 'id': _this.props.webPartId }); });\n    };\n    WebPartZone.contextTypes = {\n        store: React.PropTypes.object.isRequired\n    };\n    WebPartZone.webPartManagerInitialized = false;\n    return WebPartZone;\n}(React.Component));\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.default = WebPartZone;\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./lib/local/appBase/components/sp-canvas/canvas/webPartZone/WebPartZone.js\n// module id = 145\n// module chunks = 0\n\n\n// WEBPACK FOOTER //\n// webpack:///lib/local/appBase/components/sp-canvas/canvas/webPartZone/WebPartZone.js","module.exports = __WEBPACK_EXTERNAL_MODULE_1__;\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"@microsoft/sp-webpart-base\"\n// module id = 1\n// module chunks = 0","\"use strict\";\nvar sp_telemetry_1 = require('@ms/sp-telemetry');\nvar sp_core_library_1 = require('@microsoft/sp-core-library');\nvar sp_webpart_base_1 = require('@microsoft/sp-webpart-base');\nvar CanvasComponent_1 = require('../canvasComponent/CanvasComponent');\nvar CanvasControlType_1 = require('../canvasControl/CanvasControlType');\nvar CanvasSectionPart_1 = require('../canvasLayout/CanvasSectionPart');\nvar CanvasWebPartHost_1 = require('../CanvasWebPartHost/CanvasWebPartHost');\nvar CanvasLayout_1 = require('../canvasLayout/CanvasLayout');\nvar CanvasStrings_resx_1 = require('../../loc/CanvasStrings.resx');\nvar CanvasStore = (function () {\n    function CanvasStore(serviceScope, render, mode, serializedCanvas, handleCanvasChanged, scrollThreshold) {\n        sp_core_library_1.Validate.isNotNullOrUndefined(serviceScope, 'serviceScope');\n        sp_core_library_1.Validate.isNotNullOrUndefined(render, 'render');\n        sp_core_library_1.Validate.isNotNullOrUndefined(mode, 'mode');\n        this._addReference = this._addReference.bind(this);\n        this._notifyChanged = this._notifyChanged.bind(this);\n        this.handleToolboxItemClick = this.handleToolboxItemClick.bind(this);\n        this.closeToolbox = this.closeToolbox.bind(this);\n        this.createQosScope = this.createQosScope.bind(this);\n        this.deleteControl = this.deleteControl.bind(this);\n        this.handleConfigureButtonClicked = this.handleConfigureButtonClicked.bind(this);\n        this.handleDeleteButtonClicked = this.handleDeleteButtonClicked.bind(this);\n        this.handleDeleteDialogConfirmation = this.handleDeleteDialogConfirmation.bind(this);\n        this.handleDeleteDialogDismiss = this.handleDeleteDialogDismiss.bind(this);\n        this.handleWindowBlur = this.handleWindowBlur.bind(this);\n        this.reclaimFocus = this.reclaimFocus.bind(this);\n        this.scrollIntoView = this.scrollIntoView.bind(this);\n        this.openToolbox = this.openToolbox.bind(this);\n        this._render = render;\n        this._controlComponentMap = new Map();\n        this._controlsProps = [];\n        this._displayMode = mode;\n        this._handleCanvasChanged = handleCanvasChanged;\n        this._isDeleteDialogOpen = false;\n        this._pollActiveElement = this._pollActiveElement.bind(this);\n        this._scrollThreshold = scrollThreshold || 0;\n        this._webPartManager = new sp_webpart_base_1.ClientSideWebPartManager(new CanvasWebPartHost_1.default(serviceScope, this.scrollIntoView.bind(this, 'full'), handleCanvasChanged, this.reclaimFocus));\n        var defaultLayout = undefined;\n        if (CanvasStore.isLayoutSupported) {\n            this._canvasLayout = new CanvasLayout_1.default();\n            defaultLayout = CanvasLayout_1.default.undefinedControlPosition;\n        }\n        this._toolboxProps = {\n            isLoading: true,\n            isOpen: false,\n            onItemClick: this.handleToolboxItemClick.bind(this, CanvasStore.isLayoutSupported ? defaultLayout : 0),\n            row: undefined,\n            toolboxItems: [],\n            verticalPosition: undefined,\n            controlPosition: defaultLayout\n        };\n        this._fetchWebParts();\n    }\n    Object.defineProperty(CanvasStore, \"_isCanvasJsonFlightEnabled\", {\n        get: function () {\n            return sp_core_library_1._SPFlight.isEnabled(957 );\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(CanvasStore, \"isLayoutSupported\", {\n        get: function () {\n            return sp_core_library_1._SPFlight.isEnabled(963 );\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(CanvasStore.prototype, \"addReference\", {\n        get: function () {\n            return this._addReference;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(CanvasStore.prototype, \"a11yManager\", {\n        get: function () {\n            return this._a11yManager;\n        },\n        set: function (elem) {\n            this._a11yManager = elem;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(CanvasStore.prototype, \"canvasElement\", {\n        get: function () {\n            return this._canvasElement;\n        },\n        set: function (elem) {\n            this._canvasElement = elem;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(CanvasStore.prototype, \"controlsProps\", {\n        get: function () {\n            return this._canvasControls;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(CanvasStore.prototype, \"canvasLayout\", {\n        get: function () {\n            return this._canvasLayout;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(CanvasStore.prototype, \"deletedRow\", {\n        get: function () {\n            return this._deletedRow;\n        },\n        set: function (row) {\n            this._deletedRow = row;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(CanvasStore.prototype, \"deletedControlLayout\", {\n        get: function () {\n            return CanvasStore.isLayoutSupported ?\n                this._canvasLayout.controlsState.deletedControlLayout :\n                undefined;\n        },\n        set: function (layout) {\n            if (CanvasStore.isLayoutSupported) {\n                this._canvasLayout.controlsState.deletedControlLayout = layout;\n            }\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(CanvasStore.prototype, \"displayMode\", {\n        get: function () {\n            return this._displayMode;\n        },\n        set: function (newMode) {\n            if (this._displayMode !== newMode) {\n                this._displayMode = newMode;\n                for (var _i = 0, _a = this._canvasControls; _i < _a.length; _i++) {\n                    var control = _a[_i];\n                    var controlComponent = this._getControlComponentById(control.id);\n                    if (controlComponent) {\n                        controlComponent.setDisplayMode(newMode);\n                    }\n                }\n                if (this._displayMode === sp_core_library_1.DisplayMode.Read) {\n                    this._selectedControlIdInternal = undefined;\n                    this.webPartManager.setPropertyPaneState(undefined, sp_webpart_base_1.PropertyPaneState.Close);\n                    this._toolboxProps.isOpen = false;\n                }\n                this._fetchWebParts();\n                this._render();\n            }\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(CanvasStore.prototype, \"isDeleteDialogOpen\", {\n        get: function () {\n            return this._isDeleteDialogOpen;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(CanvasStore.prototype, \"notifyChanged\", {\n        get: function () {\n            return this._notifyChanged;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(CanvasStore.prototype, \"scrollableParent\", {\n        get: function () {\n            return this._scrollableParentElement;\n        },\n        set: function (elem) {\n            this._scrollableParentElement = elem;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(CanvasStore.prototype, \"scrollThreshold\", {\n        get: function () {\n            return this._scrollThreshold;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(CanvasStore.prototype, \"hoveredControlId\", {\n        get: function () {\n            return CanvasStore.isLayoutSupported ?\n                this._canvasLayout.controlsState.hoveredControlId :\n                this._hoveredControlId;\n        },\n        set: function (id) {\n            if (CanvasStore.isLayoutSupported) {\n                this._canvasLayout.controlsState.hoveredControlId = id;\n            }\n            else {\n                this._hoveredControlId = id;\n            }\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(CanvasStore.prototype, \"selectedControlId\", {\n        get: function () {\n            return this._selectedControlIdInternal;\n        },\n        set: function (id) {\n            if (this._selectedControlIdInternal !== id) {\n                this._selectedControlIdInternal = id;\n                var controlComponent = this._getControlComponentById(id);\n                if (controlComponent && controlComponent.props.controlType !== CanvasControlType_1.default.WebPartZone) {\n                    this._webPartManager.setPropertyPaneState(undefined);\n                }\n                else {\n                    this._webPartManager.setPropertyPaneState(id);\n                }\n                this._render();\n            }\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(CanvasStore.prototype, \"toolboxProps\", {\n        get: function () {\n            return this._toolboxProps;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(CanvasStore.prototype, \"webPartManager\", {\n        get: function () {\n            return this._webPartManager;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    CanvasStore.prototype.handleToolboxItemClick = function (position, itemProps) {\n        var qos = this.createQosScope('ToolboxItemClicked');\n        if (this._displayMode === sp_core_library_1.DisplayMode.Edit) {\n            this._selectedControlIdInternal = itemProps.id = sp_core_library_1.Guid.newGuid().toString();\n            this._addControlToCanvas(position, itemProps);\n            if (itemProps.controlType === CanvasControlType_1.default.WebPartZone) {\n                var webPartZoneProps = itemProps;\n                if (webPartZoneProps.webPartManifest) {\n                    var logEntry = new sp_telemetry_1._LogEntry('CanvasStore', 'AddWebPart', sp_telemetry_1._LogType.Event, {\n                        'manifestId': webPartZoneProps.webPartManifest.id\n                    });\n                    sp_telemetry_1._EngagementLogger.logEventWithLogEntry(logEntry);\n                }\n            }\n            else if (itemProps.controlType === CanvasControlType_1.default.RTE) {\n                sp_telemetry_1._EngagementLogger.logEvent('AddRTE.Click');\n            }\n            this._render();\n            this._notifyChanged();\n            qos.writeSuccess();\n        }\n        else {\n            qos.writeUnexpectedFailure('ReadMode');\n        }\n    };\n    CanvasStore.prototype.deleteControl = function (row, layout) {\n        this.deletedRow = row;\n        this.deletedControlLayout = layout;\n        if (CanvasStore.isLayoutSupported) {\n            this._canvasLayout.removeControl(this.deletedControlLayout);\n        }\n        else {\n            this._controlsProps.splice(row, 1);\n        }\n        if (this._canvasControls.length === 0) {\n            this._webPartManager.setPropertyPaneState(undefined, sp_webpart_base_1.PropertyPaneState.Close);\n        }\n        this._render();\n        this._notifyChanged();\n    };\n    CanvasStore.prototype.getControl = function (id) {\n        return this._getControlComponentById(id);\n    };\n    CanvasStore.prototype.openToolbox = function (position, verticalPosition, horizontalPosition) {\n        if (this._toolboxProps.isOpen) {\n            this.closeToolbox();\n        }\n        this._fillToolboxItems();\n        this._toolboxProps.isOpen = true;\n        this._toolboxProps.onItemClick = this.handleToolboxItemClick.bind(this, position);\n        this._toolboxProps.verticalPosition = verticalPosition;\n        this._toolboxProps.horizontalPosition = horizontalPosition;\n        if (CanvasStore.isLayoutSupported) {\n            var pos = position;\n            this._toolboxProps.controlPosition = pos;\n            this._toolboxProps.row = pos.zoneIndex - 1;\n        }\n        else {\n            this._toolboxProps.row = position;\n        }\n        document.addEventListener('click', this.closeToolbox);\n        this._render();\n    };\n    CanvasStore.prototype.closeToolbox = function () {\n        this._toolboxProps.isOpen = false;\n        this._toolboxProps.row = undefined;\n        if (CanvasStore.isLayoutSupported) {\n            this._toolboxProps.controlPosition = CanvasLayout_1.default.undefinedControlPosition;\n        }\n        document.removeEventListener('click', this.closeToolbox);\n        this._render();\n    };\n    CanvasStore.prototype.createQosScope = function (scope) {\n        return new sp_telemetry_1._QosMonitor(\"Canvas\" + scope);\n    };\n    CanvasStore.prototype.handleConfigureButtonClicked = function (id) {\n        var isCurrentlySelected = this._selectedControlIdInternal === id;\n        var controlComponent = this._getControlComponentById(id);\n        if (controlComponent) {\n            controlComponent.handleConfigureButtonClicked(isCurrentlySelected);\n            this._selectedControlIdInternal = id;\n            this._render();\n        }\n    };\n    CanvasStore.prototype.handleDeleteButtonClicked = function (row, layout) {\n        this._rowToBeDeleted = row;\n        this._positionCandidateForDeletion = layout;\n        var selectedControl = CanvasStore.isLayoutSupported ?\n            this._canvasLayout.fetchControl(this._positionCandidateForDeletion) :\n            this._controlsProps[this._rowToBeDeleted];\n        this._selectedControlIdInternal = selectedControl.id;\n        this._webPartManager.setPropertyPaneState(selectedControl.controlType === CanvasControlType_1.default.WebPartZone ? this._selectedControlIdInternal : undefined);\n        this._isDeleteDialogOpen = true;\n        this._render();\n    };\n    CanvasStore.prototype.handleDeleteDialogConfirmation = function () {\n        var qos = this.createQosScope('DeleteWebPart');\n        var selectedControl;\n        try {\n            selectedControl = CanvasStore.isLayoutSupported ?\n                this._canvasLayout.fetchControl(this._positionCandidateForDeletion) :\n                this._controlsProps[this._rowToBeDeleted];\n            if (selectedControl.controlType === CanvasControlType_1.default.WebPartZone) {\n                var controlComponent = this._getControlComponentById(selectedControl.id);\n                controlComponent.handleDeleteButtonClicked();\n            }\n            this._isDeleteDialogOpen = false;\n            this.deleteControl(this._rowToBeDeleted, this._positionCandidateForDeletion);\n            qos.writeSuccess();\n        }\n        catch (err) {\n            this._handleMonitoredException(qos, err, selectedControl);\n        }\n    };\n    CanvasStore.prototype.handleDeleteDialogDismiss = function () {\n        this._rowToBeDeleted = undefined;\n        this._positionCandidateForDeletion = CanvasLayout_1.default.undefinedControlPosition;\n        this._isDeleteDialogOpen = false;\n        this._render();\n    };\n    CanvasStore.prototype.handleWindowBlur = function (e) {\n        if (this._hoveredControlId && document.activeElement && document.activeElement.tagName === 'IFRAME') {\n            this.selectedControlId = this.hoveredControlId;\n            this._oldActiveElement = document.activeElement;\n            window.clearInterval(this._pollId);\n            this._pollId = window.setInterval(this._pollActiveElement, 250);\n        }\n    };\n    CanvasStore.prototype.deserialize = function (serializedCanvas) {\n        var qos = this.createQosScope('Deserialize');\n        var controlProps;\n        try {\n            this._controlsProps = [];\n            this._controlComponentMap = new Map();\n            if (CanvasStore.isLayoutSupported) {\n                this._canvasLayout.dispose();\n            }\n            if (serializedCanvas) {\n                var controlAttribute = 'data-sp-canvascontrol';\n                var tryJson = true;\n                if (serializedCanvas.indexOf(controlAttribute) !== -1) {\n                    var wrapper = document.createElement('div');\n                    wrapper.innerHTML = serializedCanvas;\n                    var rows = wrapper.querySelectorAll(\"[\" + controlAttribute + \"]\");\n                    var rowLength = rows.length;\n                    if (rowLength > 0) {\n                        tryJson = false;\n                        for (var i = 0; i < rowLength; ++i) {\n                            var row = rows[i];\n                            controlProps = JSON.parse(decodeURI(row.getAttribute('data-sp-controldata')));\n                            controlProps.displayMode = this._displayMode;\n                            controlProps.addedFromPersistedData = true;\n                            this._addControlToCanvas(CanvasStore.isLayoutSupported ? CanvasComponent_1.default.createEmptyZoneLayout(i + 1) : i, controlProps);\n                        }\n                    }\n                }\n                if (tryJson && CanvasStore._isCanvasJsonFlightEnabled) {\n                    this._processCanvasContent(serializedCanvas);\n                }\n            }\n            qos.writeSuccess();\n        }\n        catch (err) {\n            this._handleMonitoredException(qos, err, controlProps);\n        }\n    };\n    CanvasStore.prototype.reclaimFocus = function () {\n        var controlComponent = this._getControlComponentById(this._selectedControlIdInternal);\n        if (controlComponent) {\n            controlComponent.focus();\n        }\n    };\n    CanvasStore.prototype.scrollIntoView = function (type, element, duration, margin) {\n        if (margin === void 0) { margin = 0; }\n        if (!this.scrollableParent || !element) {\n            return;\n        }\n        var viewportHeight = Math.max(document.documentElement.clientHeight, window.innerHeight || 0);\n        var frameBottom = Math.min(viewportHeight, this.scrollableParent.getBoundingClientRect().bottom);\n        var elementClientRect = element.getBoundingClientRect();\n        if ((type === 'partial' ? elementClientRect.bottom : elementClientRect.top) > frameBottom) {\n            this._scrollElementIntoView(frameBottom, element, duration, margin);\n        }\n    };\n    CanvasStore.prototype.serialize = function () {\n        return CanvasStore._isCanvasJsonFlightEnabled ?\n            this._serializeAsJson() :\n            this._serializeAsHtml();\n    };\n    CanvasStore.prototype.tryGeneratePreviewImageUrl = function () {\n        var qos = this.createQosScope('GeneratePreviewImageUrl');\n        try {\n            var webpartIds = [];\n            for (var _i = 0, _a = this._canvasControls; _i < _a.length; _i++) {\n                var control = _a[_i];\n                if (control.controlType === CanvasControlType_1.default.WebPartZone) {\n                    webpartIds.push(control.id);\n                }\n            }\n            var previewUrl = this.webPartManager.tryGeneratePreviewImageUrl(webpartIds);\n            qos.writeSuccess();\n            return previewUrl;\n        }\n        catch (err) {\n            this._handleMonitoredException(qos, err);\n        }\n    };\n    CanvasStore.prototype._getControlComponentById = function (id) {\n        return CanvasStore.isLayoutSupported ?\n            this._canvasLayout.fetchControlComponentById(id) :\n            this._controlComponentMap.get(id);\n    };\n    CanvasStore.prototype._setControlComponentById = function (id, component) {\n        if (CanvasStore.isLayoutSupported) {\n            this._canvasLayout.addControlComponent(id, component);\n        }\n        else {\n            this._controlComponentMap.set(id, component);\n        }\n    };\n    Object.defineProperty(CanvasStore.prototype, \"_canvasControls\", {\n        get: function () {\n            return CanvasStore.isLayoutSupported ?\n                this._canvasLayout.fetchAllControls() :\n                this._controlsProps;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(CanvasStore.prototype, \"_selectedControlIdInternal\", {\n        get: function () {\n            return CanvasStore.isLayoutSupported ?\n                this._canvasLayout.controlsState.selectedControlId :\n                this._selectedControlId;\n        },\n        set: function (id) {\n            if (CanvasStore.isLayoutSupported) {\n                this._canvasLayout.controlsState.selectedControlId = id;\n            }\n            else {\n                this._selectedControlId = id;\n            }\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(CanvasStore.prototype, \"_positionCandidateForDeletion\", {\n        get: function () {\n            return CanvasStore.isLayoutSupported ?\n                this._canvasLayout.controlsState.deleteCandidateControlLayout :\n                undefined;\n        },\n        set: function (layout) {\n            if (CanvasStore.isLayoutSupported) {\n                this._canvasLayout.controlsState.deleteCandidateControlLayout = layout;\n            }\n        },\n        enumerable: true,\n        configurable: true\n    });\n    CanvasStore.prototype._serializeAsHtml = function () {\n        var qos = this.createQosScope('Serialize');\n        var controlData;\n        try {\n            var body = document.createElement('div');\n            var controlRow = document.createElement('div');\n            controlRow.setAttribute('data-sp-canvascontrol', '');\n            var componentIdElement = document.createElement('div');\n            componentIdElement.setAttribute('data-sp-componentId', '');\n            var htmlPropertiesElement = document.createElement('div');\n            htmlPropertiesElement.setAttribute('data-sp-htmlproperties', '');\n            for (var _i = 0, _a = this._canvasControls; _i < _a.length; _i++) {\n                var control = _a[_i];\n                var row = controlRow.cloneNode();\n                if (control.id === CanvasSectionPart_1.default.emptySectionId) {\n                    control.id = undefined;\n                    controlData = control;\n                }\n                else {\n                    var controlComponent = this._getControlComponentById(control.id);\n                    controlData = controlComponent.serialize();\n                    if (!CanvasStore.isLayoutSupported &&\n                        controlData.position) {\n                        controlData.position = undefined;\n                    }\n                    if (control.controlType === CanvasControlType_1.default.RTE) {\n                        row.innerHTML = controlData.innerHTML;\n                    }\n                    else if (control.controlType === CanvasControlType_1.default.WebPartZone) {\n                        var componentId = componentIdElement.cloneNode();\n                        componentId.textContent = controlData.webPartId;\n                        row.appendChild(componentId);\n                        var webPartData = controlData.webPartData;\n                        if (webPartData) {\n                            var htmlProperties = htmlPropertiesElement.cloneNode();\n                            htmlProperties.innerHTML = sp_webpart_base_1.WebPartDataConverter.convertServerProcessedDataToHtml(webPartData.serverProcessedContent);\n                            row.appendChild(htmlProperties);\n                        }\n                    }\n                }\n                row.setAttribute('data-sp-controldata', encodeURI(JSON.stringify(controlData)));\n                body.appendChild(row);\n            }\n            var wrapper = document.createElement('div');\n            wrapper.appendChild(body);\n            qos.writeSuccess();\n            return wrapper.innerHTML;\n        }\n        catch (err) {\n            this._handleMonitoredException(qos, err, controlData);\n            throw err;\n        }\n    };\n    CanvasStore.prototype._serializeAsJson = function () {\n        var qos = this.createQosScope('SerializeAsJson');\n        var controlDataCollection = [];\n        var controlData;\n        try {\n            for (var _i = 0, _a = this._canvasControls; _i < _a.length; _i++) {\n                var control = _a[_i];\n                if (control.id === CanvasSectionPart_1.default.emptySectionId) {\n                    control.id = undefined;\n                    controlData = control;\n                }\n                else {\n                    var controlComponent = this._getControlComponentById(control.id);\n                    controlData = controlComponent.serialize();\n                    if (!CanvasStore.isLayoutSupported &&\n                        controlData.position) {\n                        controlData.position = undefined;\n                    }\n                }\n                controlDataCollection.push(controlData);\n            }\n            qos.writeSuccess();\n        }\n        catch (err) {\n            this._handleMonitoredException(qos, err, controlData);\n            throw err;\n        }\n        return encodeURI(JSON.stringify(controlDataCollection));\n    };\n    CanvasStore.prototype._processCanvasContent = function (serializedCanvas) {\n        var _this = this;\n        var canvasControls = JSON.parse(serializedCanvas);\n        if (canvasControls) {\n            canvasControls.forEach(function (control, index) {\n                var controlProp = control;\n                if (controlProp) {\n                    controlProp.displayMode = _this.displayMode;\n                    controlProp.addedFromPersistedData = true;\n                    _this._addControlToCanvas(CanvasStore._isCanvasJsonFlightEnabled ? CanvasComponent_1.default.createEmptyZoneLayout(index) : index, controlProp);\n                }\n            });\n        }\n    };\n    CanvasStore.prototype._addControlToCanvas = function (position, control) {\n        if (!control.id) {\n            control.id = sp_core_library_1.Guid.newGuid().toString();\n        }\n        if (control.controlType === CanvasControlType_1.default.WebPartZone &&\n            !control.webPartManifest) {\n            var webPartProps = control;\n            webPartProps.webPartManifest = this._getManifestMap().get(webPartProps.webPartId);\n            if (webPartProps.webPartData && webPartProps.webPartData.htmlProperties) {\n                webPartProps.webPartData.serverProcessedContent = sp_webpart_base_1.WebPartDataConverter.convertServerProcessedHtmlToData(webPartProps.webPartData.htmlProperties);\n            }\n        }\n        if (CanvasStore.isLayoutSupported) {\n            control.position = control.position || position;\n            this._canvasLayout.addControl(control);\n        }\n        else {\n            this.controlsProps.splice(position, 0, control);\n        }\n    };\n    CanvasStore.prototype._addReference = function (ref) {\n        if (ref) {\n            this._setControlComponentById(ref.props.id, ref);\n        }\n    };\n    CanvasStore.prototype._calculateEasing = function (time, start, diff, duration) {\n        time /= duration / 2;\n        if (time < 1) {\n            return diff / 2 * time * time + start;\n        }\n        else {\n            --time;\n            return -diff / 2 * (time * (time - 2) - 1) + start;\n        }\n    };\n    CanvasStore.prototype._fetchWebParts = function () {\n        var _this = this;\n        if (!this._fetchedWebParts && sp_core_library_1.DisplayMode.Edit === this._displayMode) {\n            this._webPartManager.fetchWebPartManifests().then(function () {\n                _this._fetchedWebParts = true;\n                _this._toolboxProps.errorMessage = undefined;\n                _this._fillToolboxItems();\n            }, function (error) {\n                _this._toolboxProps.errorMessage = CanvasStrings_resx_1.default.ToolboxErrorMessage;\n                _this._fillToolboxItems();\n            });\n        }\n    };\n    CanvasStore.prototype._fillToolboxItems = function () {\n        var _this = this;\n        var qos = this.createQosScope('LoadWebPartsInToolbox');\n        this._toolboxProps.toolboxItems = [];\n        try {\n            this._getManifestMap().forEach(function (manifest, cid) {\n                var i = 0;\n                for (var _i = 0, _a = manifest.preconfiguredEntries; _i < _a.length; _i++) {\n                    var entry = _a[_i];\n                    var itemProps = {\n                        controlType: CanvasControlType_1.default.WebPartZone,\n                        displayMode: sp_core_library_1.DisplayMode.Edit,\n                        id: undefined,\n                        webPartId: cid,\n                        webPartData: _this._extractWebPartData(manifest, entry),\n                        webPartManifest: manifest\n                    };\n                    var toolboxItem = {\n                        itemProps: itemProps,\n                        description: entry.description.default,\n                        displayName: entry.title.default,\n                        msIconName: entry.officeFabricIconFontName,\n                        key: manifest.id + \"_\" + i++\n                    };\n                    _this._toolboxProps.toolboxItems.push(toolboxItem);\n                }\n            });\n            this._toolboxProps.isLoading = false;\n            qos.writeSuccess();\n        }\n        catch (err) {\n            this._handleMonitoredException(qos, err);\n        }\n        if (this._toolboxProps.isOpen) {\n            this._render();\n        }\n    };\n    CanvasStore.prototype._extractWebPartData = function (manifest, entry) {\n        var webPartData = {\n            id: manifest.id,\n            instanceId: undefined,\n            title: entry.title.default,\n            description: entry.description.default,\n            dataVersion: entry.dataVersion,\n            properties: entry.properties\n        };\n        return webPartData;\n    };\n    CanvasStore.prototype._getManifestMap = function () {\n        var tempMap = new Map();\n        var manifests = this._webPartManager.getWebPartManifests();\n        for (var _i = 0, manifests_1 = manifests; _i < manifests_1.length; _i++) {\n            var manifest = manifests_1[_i];\n            tempMap.set(manifest.id, manifest);\n        }\n        return tempMap;\n    };\n    CanvasStore.prototype._pollActiveElement = function () {\n        var activeElement = document.activeElement;\n        if (activeElement.tagName !== 'IFRAME') {\n            window.clearInterval(this._pollId);\n        }\n        else if (this._oldActiveElement !== activeElement && this.hoveredControlId) {\n            this._oldActiveElement = activeElement;\n            this._selectedControlIdInternal = this.hoveredControlId;\n        }\n    };\n    CanvasStore.prototype._scroll = function (start, end, duration, time) {\n        var _this = this;\n        if (time === void 0) { time = 0; }\n        var diff = end - start;\n        var deltaTime = 20;\n        if (time < duration) {\n            requestAnimationFrame(function () {\n                time += deltaTime;\n                _this.scrollableParent.scrollTop = _this._calculateEasing(time, start, diff, duration);\n                _this._scroll(start, end, duration, time);\n            });\n        }\n    };\n    CanvasStore.prototype._scrollElementIntoView = function (frameBottom, element, duration, margin) {\n        var elementClientRect = element.getBoundingClientRect();\n        var scrollPosition = elementClientRect.bottom - this.canvasElement.getBoundingClientRect().top;\n        var frameTop = Math.max(0, this.scrollableParent.getBoundingClientRect().top);\n        var offset = frameTop - frameBottom + this._scrollThreshold + margin;\n        var newScrollTop = scrollPosition + offset + this._scrollThreshold;\n        this._scroll(this.scrollableParent.scrollTop, newScrollTop, duration);\n    };\n    CanvasStore.prototype._notifyChanged = function () {\n        if (this._handleCanvasChanged) {\n            this._handleCanvasChanged();\n        }\n    };\n    CanvasStore.prototype._handleMonitoredException = function (qos, err, props) {\n        var extraData; \n        if (props && props.controlType === CanvasControlType_1.default.WebPartZone) {\n            extraData = { 'id': props.webPartId };\n        }\n        qos.writeUnexpectedFailure('Exception', err, extraData);\n    };\n    return CanvasStore;\n}());\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.default = CanvasStore;\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./lib/local/appBase/components/sp-canvas/canvas/canvasComponent/CanvasStore.js\n// module id = 147\n// module chunks = 0\n\n\n// WEBPACK FOOTER //\n// webpack:///lib/local/appBase/components/sp-canvas/canvas/canvasComponent/CanvasStore.js","\"use strict\";\nvar sp_core_library_1 = require('@microsoft/sp-core-library');\nvar CanvasLayout_1 = require('./CanvasLayout');\nvar CanvasControlType_1 = require('../canvasControl/CanvasControlType');\nvar CanvasSectionPart = (function () {\n    function CanvasSectionPart(sectionIdx, factor) {\n        this._index = sectionIdx;\n        this._factor = factor;\n        this._controlsMap = new Map();\n    }\n    Object.defineProperty(CanvasSectionPart.prototype, \"emptySectionControl\", {\n        get: function () {\n            return {\n                controlType: undefined,\n                displayMode: sp_core_library_1.DisplayMode.Edit,\n                id: CanvasSectionPart.emptySectionId,\n                position: {\n                    zoneIndex: undefined,\n                    sectionIndex: this._index,\n                    controlIndex: undefined,\n                    sectionFactor: this._factor\n                }\n            };\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(CanvasSectionPart.prototype, \"factor\", {\n        get: function () {\n            return this._factor;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(CanvasSectionPart.prototype, \"index\", {\n        get: function () {\n            return this._index;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(CanvasSectionPart.prototype, \"controls\", {\n        get: function () {\n            var _this = this;\n            var canvasControls = [];\n            this._controlsMap.forEach(function (control) {\n                control.position.sectionFactor = _this._factor;\n                canvasControls.push(control);\n            });\n            return canvasControls.sort(function (ctrl1, ctrl2) {\n                return ctrl1.position.controlIndex - ctrl2.position.controlIndex;\n            });\n        },\n        enumerable: true,\n        configurable: true\n    });\n    CanvasSectionPart.prototype.addControl = function (canvasControl) {\n        if (canvasControl.controlType === CanvasControlType_1.default.WebPartZone ||\n            canvasControl.controlType === CanvasControlType_1.default.RTE) {\n            if (!canvasControl || !canvasControl.position) {\n                return undefined;\n            }\n            var curControlIndex = canvasControl.position.controlIndex;\n            if (curControlIndex === undefined) {\n                return undefined;\n            }\n            var sectionControl = this._controlsMap.get(curControlIndex);\n            if (!sectionControl) {\n                this._controlsMap.set(curControlIndex, canvasControl);\n            }\n            else {\n                var layoutControlItems = this.controls.map(function (control) {\n                    return {\n                        index: control.position.controlIndex\n                    };\n                });\n                canvasControl.position.controlIndex = CanvasLayout_1.default._generateNewLayoutIndex(layoutControlItems, curControlIndex);\n                if (canvasControl.position.controlIndex === undefined) {\n                    return undefined;\n                }\n                this._controlsMap.set(canvasControl.position.controlIndex, canvasControl);\n            }\n        }\n        return canvasControl.id;\n    };\n    CanvasSectionPart.prototype.removeControl = function (controlPosition) {\n        if (!controlPosition) {\n            return undefined;\n        }\n        var control = this._controlsMap.get(controlPosition.controlIndex);\n        if (!control) {\n            return undefined;\n        }\n        this._controlsMap.delete(control.position.controlIndex);\n        return control.id;\n    };\n    CanvasSectionPart.prototype.fetchControl = function (controlPosition) {\n        if (!controlPosition) {\n            return undefined;\n        }\n        return this._controlsMap.get(controlPosition.controlIndex);\n    };\n    CanvasSectionPart.prototype.fetchAllControls = function () {\n        return this.controls;\n    };\n    CanvasSectionPart.prototype.isEmpty = function () {\n        return this.fetchAllControls().length === 0;\n    };\n    CanvasSectionPart.prototype.dispose = function () {\n        this._controlsMap.clear();\n    };\n    return CanvasSectionPart;\n}());\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.default = CanvasSectionPart;\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./lib/local/appBase/components/sp-canvas/canvas/canvasLayout/CanvasSectionPart.js\n// module id = 148\n// module chunks = 0\n\n\n// WEBPACK FOOTER //\n// webpack:///lib/local/appBase/components/sp-canvas/canvas/canvasLayout/CanvasSectionPart.js","\"use strict\";\nvar sp_core_library_1 = require('@microsoft/sp-core-library');\nvar CanvasZonePart_1 = require('./CanvasZonePart');\nvar CanvasLayout = (function () {\n    function CanvasLayout() {\n        this._initialize();\n    }\n    CanvasLayout._generateNewLayoutIndex = function (sortedChildren, currentIdx) {\n        if (!sortedChildren) {\n            return undefined;\n        }\n        var sortedIndexes = sortedChildren.map(function (child) {\n            return child.index;\n        }).filter(function (item) {\n            return item < currentIdx;\n        });\n        var newIdx = currentIdx;\n        if (sortedIndexes.length > 0) {\n            newIdx += sortedIndexes[sortedIndexes.length - 1];\n        }\n        return newIdx / 2;\n    };\n    Object.defineProperty(CanvasLayout.prototype, \"zones\", {\n        get: function () {\n            var canvasZones = [];\n            this._zonePartMap.forEach(function (zone) {\n                canvasZones.push(zone);\n            });\n            return canvasZones.sort(function (zone1, zone2) {\n                return zone1.index - zone2.index;\n            });\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(CanvasLayout.prototype, \"controlsState\", {\n        get: function () {\n            return this._activeControlsState;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    CanvasLayout.prototype.fetchControlComponentById = function (controlId) {\n        var componentValue = this._controlComponentMap.get(controlId);\n        return componentValue && componentValue.component;\n    };\n    CanvasLayout.prototype.fetchControlPositionById = function (controlId) {\n        if (!controlId) {\n            return CanvasLayout.undefinedControlPosition;\n        }\n        var componentValue = this._controlComponentMap.get(controlId);\n        if (componentValue) {\n            return componentValue.position;\n        }\n        return CanvasLayout.undefinedControlPosition;\n    };\n    CanvasLayout.prototype.addControlComponent = function (controlId, controlComponent) {\n        var componentValue = this._controlComponentMap.get(controlId);\n        sp_core_library_1.Validate.isNotNullOrUndefined(componentValue, 'componentValue');\n        componentValue.component = controlComponent;\n        this._controlComponentMap.set(controlId, componentValue);\n    };\n    CanvasLayout.prototype.addControl = function (canvasControl) {\n        if (!canvasControl ||\n            !canvasControl.position ||\n            canvasControl.position.zoneIndex === undefined) {\n            return undefined;\n        }\n        var curZoneIndex = canvasControl.position.zoneIndex;\n        var controlId;\n        var zone = this._zonePartMap.get(curZoneIndex);\n        if (!zone) {\n            var newCanvasZone = new CanvasZonePart_1.default(curZoneIndex);\n            if (canvasControl.position.sectionIndex === undefined) {\n                canvasControl.position.sectionIndex = CanvasLayout.firstLayoutIndex;\n            }\n            controlId = newCanvasZone.addControl(canvasControl);\n            if (controlId) {\n                this._zonePartMap.set(curZoneIndex, newCanvasZone);\n            }\n        }\n        else {\n            if (canvasControl.position.sectionIndex !== undefined) {\n                controlId = zone.addControl(canvasControl);\n            }\n            else {\n                canvasControl.position.zoneIndex = CanvasLayout._generateNewLayoutIndex(this.zones, curZoneIndex);\n                if (canvasControl.position.zoneIndex === undefined) {\n                    return undefined;\n                }\n                var newSecondaryZone = new CanvasZonePart_1.default(canvasControl.position.zoneIndex);\n                canvasControl.position.sectionIndex = CanvasLayout.firstLayoutIndex;\n                controlId = newSecondaryZone.addControl(canvasControl);\n                if (controlId) {\n                    this._zonePartMap.set(canvasControl.position.zoneIndex, newSecondaryZone);\n                }\n            }\n        }\n        if (controlId) {\n            var componentValue = {\n                component: undefined,\n                position: canvasControl.position\n            };\n            this._controlComponentMap.set(controlId, componentValue);\n        }\n        return controlId;\n    };\n    CanvasLayout.prototype.removeControl = function (controlPosition) {\n        if (!controlPosition) {\n            return undefined;\n        }\n        var zone = this._zonePartMap.get(controlPosition.zoneIndex);\n        if (!zone) {\n            return undefined;\n        }\n        var controlId = zone.removeControl(controlPosition);\n        if (controlId) {\n            if (zone.isEmpty()) {\n                zone.dispose();\n                this._zonePartMap.delete(controlPosition.zoneIndex);\n            }\n            this._controlComponentMap.delete(controlId);\n        }\n        return controlId;\n    };\n    CanvasLayout.prototype.fetchControl = function (controlPosition) {\n        if (!controlPosition) {\n            return undefined;\n        }\n        var zone = this._zonePartMap.get(controlPosition.zoneIndex);\n        if (!zone) {\n            return undefined;\n        }\n        return zone.fetchControl(controlPosition);\n    };\n    CanvasLayout.prototype.fetchAllControls = function () {\n        var canvasControls = [];\n        this.zones.forEach(function (zone) {\n            var controls = zone.fetchAllControls();\n            canvasControls = canvasControls.concat(controls);\n        });\n        return canvasControls;\n    };\n    CanvasLayout.prototype.isEmpty = function () {\n        return this.fetchAllControls().length === 0;\n    };\n    CanvasLayout.prototype.dispose = function () {\n        this._zonePartMap.clear();\n        this._controlComponentMap.clear();\n        this._resetActiveControlState();\n    };\n    CanvasLayout.prototype._initialize = function () {\n        this._zonePartMap = new Map();\n        this._controlComponentMap = new Map();\n        this._resetActiveControlState();\n    };\n    CanvasLayout.prototype._resetActiveControlState = function () {\n        this._activeControlsState = {\n            hoveredControlId: undefined,\n            selectedControlId: undefined,\n            deletedControlLayout: CanvasLayout.undefinedControlPosition,\n            deleteCandidateControlLayout: CanvasLayout.undefinedControlPosition\n        };\n    };\n    CanvasLayout.firstLayoutIndex = 1;\n    CanvasLayout.undefinedControlPosition = {\n        zoneIndex: undefined,\n        sectionIndex: undefined,\n        controlIndex: undefined\n    };\n    return CanvasLayout;\n}());\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.default = CanvasLayout;\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./lib/local/appBase/components/sp-canvas/canvas/canvasLayout/CanvasLayout.js\n// module id = 149\n// module chunks = 0\n\n\n// WEBPACK FOOTER //\n// webpack:///lib/local/appBase/components/sp-canvas/canvas/canvasLayout/CanvasLayout.js","\"use strict\";\nvar CanvasControlType_1 = require('../canvasControl/CanvasControlType');\nvar CanvasLayout_1 = require('./CanvasLayout');\nvar CanvasSectionPart_1 = require('./CanvasSectionPart');\nvar CanvasZonePart = (function () {\n    function CanvasZonePart(zoneIdx) {\n        this._index = zoneIdx;\n        this._sectionsMap = new Map();\n    }\n    Object.defineProperty(CanvasZonePart.prototype, \"index\", {\n        get: function () {\n            return this._index;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(CanvasZonePart.prototype, \"sections\", {\n        get: function () {\n            var sections = [];\n            this._sectionsMap.forEach(function (section) {\n                sections.push(section);\n            });\n            return sections.sort(function (section1, section2) {\n                return section1.index - section2.index;\n            });\n        },\n        enumerable: true,\n        configurable: true\n    });\n    CanvasZonePart.prototype.addControl = function (canvasControl) {\n        if (!canvasControl || !canvasControl.position) {\n            return undefined;\n        }\n        var curSectionIndex = canvasControl.position.sectionIndex;\n        if (curSectionIndex === undefined) {\n            return undefined;\n        }\n        var controlId;\n        var sectionsToAdd = 1;\n        var colDef = CanvasZonePart.columnDefinitionMap.get(canvasControl.controlType);\n        if (colDef) {\n            sectionsToAdd = colDef.sections;\n        }\n        for (var i = 0; i < sectionsToAdd; ++i, ++curSectionIndex) {\n            var section = this._sectionsMap.get(curSectionIndex);\n            if (!section) {\n                var factor = void 0;\n                if (colDef) {\n                    factor = colDef.factor[i];\n                }\n                var newSection = new CanvasSectionPart_1.default(curSectionIndex, factor || canvasControl.position.sectionFactor);\n                if (canvasControl.position.controlIndex === undefined) {\n                    canvasControl.position.controlIndex = CanvasLayout_1.default.firstLayoutIndex;\n                }\n                controlId = newSection.addControl(canvasControl);\n                if (controlId) {\n                    this._sectionsMap.set(curSectionIndex, newSection);\n                }\n            }\n            else {\n                if (canvasControl.position.controlIndex !== undefined) {\n                    controlId = section.addControl(canvasControl);\n                }\n                else {\n                    canvasControl.position.sectionIndex = CanvasLayout_1.default._generateNewLayoutIndex(this.sections, curSectionIndex);\n                    if (canvasControl.position.sectionIndex === undefined) {\n                        return undefined;\n                    }\n                    var newSecondarySection = new CanvasSectionPart_1.default(canvasControl.position.sectionIndex);\n                    canvasControl.position.controlIndex = CanvasLayout_1.default.firstLayoutIndex;\n                    controlId = newSecondarySection.addControl(canvasControl);\n                    if (controlId) {\n                        this._sectionsMap.set(canvasControl.position.sectionIndex, newSecondarySection);\n                    }\n                }\n            }\n        }\n        return controlId;\n    };\n    CanvasZonePart.prototype.removeControl = function (controlPosition) {\n        if (!controlPosition) {\n            return undefined;\n        }\n        var section = this._sectionsMap.get(controlPosition.sectionIndex);\n        if (!section) {\n            return undefined;\n        }\n        var controlId = section.removeControl(controlPosition);\n        return controlId;\n    };\n    CanvasZonePart.prototype.fetchControl = function (controlPosition) {\n        if (!controlPosition) {\n            return undefined;\n        }\n        var section = this._sectionsMap.get(controlPosition.sectionIndex);\n        if (!section) {\n            return undefined;\n        }\n        return section.fetchControl(controlPosition);\n    };\n    CanvasZonePart.prototype.fetchAllControls = function (includeEmptySections) {\n        var _this = this;\n        if (includeEmptySections === void 0) { includeEmptySections = true; }\n        var canvasControls = [];\n        var sections = this.sections;\n        sections.forEach(function (section) {\n            var controls = section.fetchAllControls();\n            if (includeEmptySections && controls.length === 0) {\n                var emptySection = section.emptySectionControl;\n                emptySection.position.zoneIndex = _this._index;\n                controls.push(emptySection);\n            }\n            canvasControls = canvasControls.concat(controls);\n        });\n        return canvasControls;\n    };\n    CanvasZonePart.prototype.isEmpty = function () {\n        return this.fetchAllControls(false).length === 0;\n    };\n    CanvasZonePart.prototype.dispose = function () {\n        this._sectionsMap.clear();\n    };\n    CanvasZonePart.columnDefinitionMap = new Map([\n        [CanvasControlType_1.default.TwoColumns, { sections: 2, factor: [6, 6] }],\n        [CanvasControlType_1.default.ThreeColumns, { sections: 3, factor: [4, 4, 4] }],\n        [CanvasControlType_1.default.OneThirdColumnRight, { sections: 2, factor: [8, 4] }]\n    ]);\n    return CanvasZonePart;\n}());\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.default = CanvasZonePart;\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./lib/local/appBase/components/sp-canvas/canvas/canvasLayout/CanvasZonePart.js\n// module id = 150\n// module chunks = 0\n\n\n// WEBPACK FOOTER //\n// webpack:///lib/local/appBase/components/sp-canvas/canvas/canvasLayout/CanvasZonePart.js","\"use strict\";\nvar sp_webpart_base_1 = require('@microsoft/sp-webpart-base');\nvar CanvasWebPartHost = (function () {\n    function CanvasWebPartHost(serviceScope, handleResize, handleCanvasChanged, reclaimFocus) {\n        this._handleCanvasChanged = handleCanvasChanged;\n        this._handleResize = handleResize;\n        this._reclaimFocus = reclaimFocus;\n        this._serviceScope = serviceScope;\n        this.webPartConfigurationEventCallback = this.webPartConfigurationEventCallback.bind(this);\n    }\n    Object.defineProperty(CanvasWebPartHost.prototype, \"serviceScope\", {\n        get: function () {\n            return this._serviceScope;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    CanvasWebPartHost.prototype.setDirty = function (wpInstanceId) {\n        if (this._handleCanvasChanged) {\n            this._handleCanvasChanged();\n        }\n    };\n    CanvasWebPartHost.prototype.webPartConfigurationEventCallback = function (event) {\n        if (event === sp_webpart_base_1.WebPartConfigurationEvent.PropertyPaneOpened) {\n            this._handleResize(document.querySelector('.ControlZone--selected'), 500, 44);\n        }\n        else if (event === sp_webpart_base_1.WebPartConfigurationEvent.PropertyPaneClosed ||\n            event === sp_webpart_base_1.WebPartConfigurationEvent.PropertyPaneLostFocus) {\n            this._reclaimFocus();\n        }\n    };\n    return CanvasWebPartHost;\n}());\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.default = CanvasWebPartHost;\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./lib/local/appBase/components/sp-canvas/canvas/CanvasWebPartHost/CanvasWebPartHost.js\n// module id = 151\n// module chunks = 0\n\n\n// WEBPACK FOOTER //\n// webpack:///lib/local/appBase/components/sp-canvas/canvas/CanvasWebPartHost/CanvasWebPartHost.js","\"use strict\";\nvar strings = UNIT_TEST\n    ? require('../../../../../resx-strings/en-us.json')\n    : require('resx-strings');\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.default = (strings['_oflHTFVm9vC1S7l66uvnQQ'] || {});\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./lib/local/appBase/components/sp-canvas/loc/CanvasStrings.resx.js\n// module id = 152\n// module chunks = 0\n\n\n// WEBPACK FOOTER //\n// webpack:///lib/local/appBase/components/sp-canvas/loc/CanvasStrings.resx.js","\"use strict\";\nvar __extends = (this && this.__extends) || function (d, b) {\n    for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p];\n    function __() { this.constructor = d; }\n    d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n};\nvar React = require('react');\nvar office_ui_fabric_react_1 = require('office-ui-fabric-react');\nvar sp_core_library_1 = require('@microsoft/sp-core-library');\nvar odsp_utilities_bundle_1 = require('@ms/odsp-utilities-bundle');\nvar sp_webpart_base_1 = require('@microsoft/sp-webpart-base');\nvar sp_client_base_1 = require('@microsoft/sp-client-base');\nvar CanvasControlType_1 = require('../canvasControl/CanvasControlType');\nvar CanvasStore_1 = require('../canvasComponent/CanvasStore');\nvar CanvasA11y_1 = require('../../a11y/CanvasA11y');\nvar CanvasStrings_resx_1 = require('../../loc/CanvasStrings.resx');\nif (CanvasStore_1.default.isLayoutSupported) {\n    require('./LayoutControlZone.css');\n}\nelse {\n    require('./ControlZone.css');\n}\nvar ControlZone = (function (_super) {\n    __extends(ControlZone, _super);\n    function ControlZone(props, context) {\n        _super.call(this, props, context);\n        this._handleClickCapture = this._handleClickCapture.bind(this);\n        this._handleKeydownCapture = this._handleKeydownCapture.bind(this);\n        this._handleMouseOut = this._handleMouseOut.bind(this);\n        this._handleMouseOver = this._handleMouseOver.bind(this);\n        this._handleToolbarKeydown = this._handleToolbarKeydown.bind(this);\n        this._handleTrapFocus = this._handleTrapFocus.bind(this);\n        this._handleControlFocus = this._handleControlFocus.bind(this);\n        this._selectControl = this._selectControl.bind(this);\n    }\n    ControlZone.prototype.shouldComponentUpdate = function (nextProps) {\n        var _a = this.props, displayMode = _a.displayMode, isSelected = _a.isSelected, row = _a.row, position = _a.position;\n        return (displayMode !== nextProps.displayMode ||\n            isSelected !== nextProps.isSelected ||\n            row !== nextProps.row ||\n            !sp_client_base_1.Compare.shallowCompare(position, nextProps.position));\n    };\n    ControlZone.prototype.componentDidMount = function () {\n        if (this.context.store.selectedControlId === this.props.id) {\n            this.context.store.scrollIntoView('partial', this._domElement, 500, ControlZone._VERTICAL_MARGIN * 2);\n            this.context.store.a11yManager.navigateTo(this._domElement);\n        }\n        this._childControl = this.context.store.getControl(this.props.id);\n        if (this.props.displayMode === sp_core_library_1.DisplayMode.Edit) {\n            this._toolbarElement.addEventListener('keydown', this._handleToolbarKeydown);\n            this._childControlElement.addEventListener('keydown', this._handleKeydownCapture, true);\n        }\n    };\n    ControlZone.prototype.componentDidUpdate = function (prevProps) {\n        var displayMode = this.props.displayMode;\n        if (prevProps.displayMode !== displayMode) {\n            if (displayMode === sp_core_library_1.DisplayMode.Edit) {\n                this._toolbarElement.addEventListener('keydown', this._handleToolbarKeydown);\n                this._childControlElement.addEventListener('keydown', this._handleKeydownCapture, true);\n            }\n            else if (displayMode === sp_core_library_1.DisplayMode.Read) {\n                this._toolbarElement.removeEventListener('keydown', this._handleToolbarKeydown);\n                this._childControlElement.removeEventListener('keydown', this._handleKeydownCapture, true);\n            }\n        }\n    };\n    ControlZone.prototype.render = function () {\n        var _this = this;\n        var _a = this.props, children = _a.children, displayMode = _a.displayMode, isSelected = _a.isSelected, id = _a.id;\n        var controlType = children[0].props.controlType;\n        var isReadMode = displayMode === sp_core_library_1.DisplayMode.Read;\n        var accessibleLabel = '';\n        var ariaPrimaryLabelById = \"cswpAccessibleLabel_\" + id;\n        var ariaContextualLabelId = \"cswpAccessibleLabelContextual_\" + id;\n        var ariaLabelledBy;\n        if (controlType === CanvasControlType_1.default.WebPartZone) {\n            ariaLabelledBy = ariaContextualLabelId;\n        }\n        else if (controlType === CanvasControlType_1.default.RTE) {\n            accessibleLabel = odsp_utilities_bundle_1.StringHelper.format(CanvasStrings_resx_1.default.CanvasZoneAriaWebpartName || '', CanvasStrings_resx_1.default.TextWebPartDisplayName || '') || '';\n            ariaLabelledBy = ariaPrimaryLabelById;\n        }\n        if (displayMode === sp_core_library_1.DisplayMode.Edit) {\n            accessibleLabel = odsp_utilities_bundle_1.StringHelper.format(CanvasStrings_resx_1.default.AriaWebPartEnterTemplate || '', accessibleLabel) || '';\n            if (controlType === CanvasControlType_1.default.WebPartZone) {\n                ariaLabelledBy += \" \" + ariaPrimaryLabelById;\n            }\n        }\n        var zoneClassName = office_ui_fabric_react_1.css('ControlZone', {\n            'ControlZone--edit': !isReadMode,\n            'ControlZone--selected': isSelected\n        });\n        return (\n        React.createElement(\"div\", {\"aria-labelledby\": ariaLabelledBy, className: zoneClassName, ref: function (ref) { return _this._domElement = ref; }, onMouseOut: this._handleMouseOut, onMouseOver: this._handleMouseOver, tabIndex: isReadMode ? -1 : 0, \"data-automation-id\": 'ControlZone'}, \n            React.createElement(\"div\", null, \n                React.createElement(\"div\", {className: 'ControlZone-control', onClickCapture: isReadMode ? undefined : this._handleClickCapture, onFocus: isReadMode ? undefined : this._handleControlFocus, ref: function (ref) { return _this._childControlElement = ref; }}, children[0]), \n                React.createElement(\"div\", {ref: function (ref) { return _this._toolbarElement = ref; }}, children[1]), \n                React.createElement(\"div\", {id: ariaPrimaryLabelById, className: 'ControlZone-screenReaderOnly'}, accessibleLabel))\n        ));\n    };\n    ControlZone.prototype._handleControlFocus = function (e) {\n        this._selectControl();\n    };\n    ControlZone.prototype._handleClickCapture = function (e) {\n        this._selectControl();\n    };\n    ControlZone.prototype._handleKeydownCapture = function (evt) {\n        if (this._childControl && this._childControl.props.controlType === CanvasControlType_1.default.WebPartZone) {\n            if (CanvasA11y_1.isEscape(evt)) {\n                this.context.store.a11yManager.navigateTo(this._domElement);\n                evt.stopPropagation();\n                evt.preventDefault();\n            }\n            else if (CanvasA11y_1.isKey(CanvasA11y_1.KeyCodes.F10, evt, true)) {\n                this.context.store.a11yManager.navigateTo(this._toolbarElement);\n                this.context.store.a11yManager.ariaAlert(CanvasStrings_resx_1.default.ToolbarNavigationArrowKeys);\n                evt.stopPropagation();\n                evt.preventDefault();\n            }\n            else if (CanvasA11y_1.isKey(CanvasA11y_1.KeyCodes.P, evt, true)) {\n                this.context.store.webPartManager.setPropertyPaneState(this._childControl.props.id, sp_webpart_base_1.PropertyPaneState.Open);\n                evt.stopPropagation();\n                evt.preventDefault();\n            }\n            else if (!CanvasA11y_1.isShiftTab(evt) || evt.target !== CanvasA11y_1.getFirstFocusableChild(this._childControlElement)) {\n                this.context.store.a11yManager.skipEvent(evt);\n            }\n        }\n    };\n    ControlZone.prototype._handleToolbarKeydown = function (evt) {\n        if (this._childControl && this._childControl.props.controlType === CanvasControlType_1.default.RTE) {\n            if (CanvasA11y_1.isEscape(evt)) {\n                this._childControl.focus();\n                evt.stopPropagation();\n                evt.preventDefault();\n            }\n            else if (CanvasA11y_1.isTab(evt)) {\n                this._childControl.focusFormattingBar();\n                evt.stopPropagation();\n                evt.preventDefault();\n            }\n        }\n    };\n    ControlZone.prototype._handleMouseOut = function (e) {\n        this.context.store.hoveredControlId = undefined;\n    };\n    ControlZone.prototype._handleMouseOver = function (e) {\n        this.context.store.hoveredControlId = this.props.id;\n    };\n    ControlZone.prototype._handleTrapFocus = function (e) {\n        if (e.target === this._trapDiv) {\n            this._childControl.focus();\n        }\n    };\n    ControlZone.prototype._selectControl = function () {\n        if (this.context.store.selectedControlId !== this.props.id) {\n            this.context.store.selectedControlId = this.props.id;\n        }\n    };\n    ControlZone.contextTypes = {\n        store: React.PropTypes.object.isRequired\n    };\n    ControlZone._VERTICAL_MARGIN = 22;\n    return ControlZone;\n}(React.Component));\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.default = ControlZone;\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./lib/local/appBase/components/sp-canvas/canvas/controlZone/ControlZone.js\n// module id = 153\n// module chunks = 0\n\n\n// WEBPACK FOOTER //\n// webpack:///lib/local/appBase/components/sp-canvas/canvas/controlZone/ControlZone.js","module.exports = __WEBPACK_EXTERNAL_MODULE_9__;\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"@microsoft/sp-client-base\"\n// module id = 9\n// module chunks = 0","var content = require(\"!!./../../../../../../../../../common/node_modules/css-loader/index.js?-minimize!./LayoutControlZone.css\");\nvar loader = require(\"D:\\\\agent\\\\1\\\\_work\\\\24\\\\s\\\\common\\\\node_modules\\\\@microsoft\\\\load-themed-styles\\\\lib\\\\index.js\");\n\nif(typeof content === \"string\") content = [[module.id, content]];\n\n// add the styles to the DOM\nfor (var i = 0; i < content.length; i++) loader.loadStyles(content[i][1]);\n\nif(content.locals) module.exports = content.locals;\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./lib/local/appBase/components/sp-canvas/canvas/controlZone/LayoutControlZone.css\n// module id = 155\n// module chunks = 0\n\n\n// WEBPACK FOOTER //\n// webpack:///lib/local/appBase/components/sp-canvas/canvas/controlZone/LayoutControlZone.css?8749","exports = module.exports = require(\"./../../../../../../../../../common/node_modules/css-loader/lib/css-base.js\")();\n// imports\n\n\n// module\nexports.push([module.id, \".ControlZone{padding:8px}.ControlZone .ControlZone-target{bottom:0;cursor:pointer;left:0;position:absolute;right:0;top:0}.ControlZone .ControlZone-target:focus{outline:0}.ControlZone .ControlZone-target.ControlZone-target--hidden{z-index:-1}.ControlZone::after{border:1px solid \\\"[theme:neutralTertiary, default: #a6a6a6]\\\";color:\\\"[theme:neutralTertiary, default: #a6a6a6]\\\";bottom:0;content:\\\"\\\";left:0;pointer-events:none;position:absolute;right:0;top:0;-webkit-transition:all .3s ease;transition:all .3s ease}.ControlZone .CanvasControlToolbar,.ControlZone::after{opacity:0;-webkit-transition:all .3s ease;transition:all .3s ease}.ControlZone.ControlZone--edit{margin:32px 0 32px 0;outline:0;position:relative}.ControlZone.ControlZone--edit.ControlZone--selected .CanvasControlToolbar,.ControlZone.ControlZone--edit.ControlZone--selected::after,.ControlZone.ControlZone--edit:focus .CanvasControlToolbar,.ControlZone.ControlZone--edit:focus::after,.ControlZone.ControlZone--edit:hover .CanvasControlToolbar,.ControlZone.ControlZone--edit:hover::after{opacity:1}.ControlZone.ControlZone--selected::after{border:1px solid \\\"[theme:themePrimary, default:#0078d7]\\\";color:\\\"[theme:themePrimary, default:#0078d7]\\\"}.ControlZone.ControlZone--selected+button.CanvasToolboxHint{opacity:1}.ControlZone .ControlZone-screenReaderOnly{position:absolute;text-indent:-9999px;width:1px;height:1px;padding:0;margin:-1px;overflow:hidden;border:0}\", \"\"]);\n\n// exports\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// D:/agent/1/_work/24/s/common/~/css-loader?-minimize!./lib/local/appBase/components/sp-canvas/canvas/controlZone/LayoutControlZone.css\n// module id = 156\n// module chunks = 0\n\n\n// WEBPACK FOOTER //\n// webpack:///lib/local/appBase/components/sp-canvas/canvas/controlZone/LayoutControlZone.css","var content = require(\"!!./../../../../../../../../../common/node_modules/css-loader/index.js?-minimize!./ControlZone.css\");\nvar loader = require(\"D:\\\\agent\\\\1\\\\_work\\\\24\\\\s\\\\common\\\\node_modules\\\\@microsoft\\\\load-themed-styles\\\\lib\\\\index.js\");\n\nif(typeof content === \"string\") content = [[module.id, content]];\n\n// add the styles to the DOM\nfor (var i = 0; i < content.length; i++) loader.loadStyles(content[i][1]);\n\nif(content.locals) module.exports = content.locals;\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./lib/local/appBase/components/sp-canvas/canvas/controlZone/ControlZone.css\n// module id = 157\n// module chunks = 0\n\n\n// WEBPACK FOOTER //\n// webpack:///lib/local/appBase/components/sp-canvas/canvas/controlZone/ControlZone.css?f1f9","exports = module.exports = require(\"./../../../../../../../../../common/node_modules/css-loader/lib/css-base.js\")();\n// imports\n\n\n// module\nexports.push([module.id, \".ControlZone{padding:8px;margin:16px 0 32px 0;outline:0;position:relative}.ControlZone .ControlZone-target{bottom:0;cursor:pointer;left:0;position:absolute;right:0;top:0}.ControlZone .ControlZone-target:focus{outline:0}.ControlZone .ControlZone-target.ControlZone-target--hidden{z-index:-1}.ControlZone::after{border:1px solid \\\"[theme:neutralTertiary, default: #a6a6a6]\\\";color:\\\"[theme:neutralTertiary, default: #a6a6a6]\\\";bottom:0;content:\\\"\\\";left:0;pointer-events:none;position:absolute;right:0;top:0;-webkit-transition:all .3s ease;transition:all .3s ease}.ControlZone .CanvasControlToolbar,.ControlZone::after{opacity:0;-webkit-transition:all .3s ease;transition:all .3s ease}.ControlZone.ControlZone--edit.ControlZone--selected .CanvasControlToolbar,.ControlZone.ControlZone--edit.ControlZone--selected::after,.ControlZone.ControlZone--edit:focus .CanvasControlToolbar,.ControlZone.ControlZone--edit:focus::after,.ControlZone.ControlZone--edit:hover .CanvasControlToolbar,.ControlZone.ControlZone--edit:hover::after{opacity:1}.ControlZone.ControlZone--selected::after{border:1px solid \\\"[theme:themePrimary, default:#0078d7]\\\";color:\\\"[theme:themePrimary, default:#0078d7]\\\"}.ControlZone.ControlZone--selected+button.CanvasToolboxHint{opacity:1}.ControlZone .ControlZone-screenReaderOnly{position:absolute;text-indent:-9999px;width:1px;height:1px;padding:0;margin:-1px;overflow:hidden;border:0}\", \"\"]);\n\n// exports\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// D:/agent/1/_work/24/s/common/~/css-loader?-minimize!./lib/local/appBase/components/sp-canvas/canvas/controlZone/ControlZone.css\n// module id = 158\n// module chunks = 0\n\n\n// WEBPACK FOOTER //\n// webpack:///lib/local/appBase/components/sp-canvas/canvas/controlZone/ControlZone.css","\"use strict\";\nvar __extends = (this && this.__extends) || function (d, b) {\n    for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p];\n    function __() { this.constructor = d; }\n    d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n};\nvar office_ui_fabric_react_1 = require('office-ui-fabric-react');\nvar sp_core_library_1 = require('@microsoft/sp-core-library');\nvar React = require('react');\nvar ReactDOM = require('react-dom');\nvar CanvasStore_1 = require('../canvasComponent/CanvasStore');\nif (CanvasStore_1.default.isLayoutSupported) {\n    require('./LayoutCanvasToolboxHint.css');\n}\nelse {\n    require('./CanvasToolboxHint.css');\n}\nvar CanvasToolboxHint = (function (_super) {\n    __extends(CanvasToolboxHint, _super);\n    function CanvasToolboxHint(props, context) {\n        _super.call(this, props, context);\n        this._handleClick = this._handleClick.bind(this);\n    }\n    CanvasToolboxHint.prototype.componentDidMount = function () {\n        this._domNode = ReactDOM.findDOMNode(this);\n        if (this.props.shouldFocus) {\n            this.focus();\n        }\n    };\n    CanvasToolboxHint.prototype.componentDidUpdate = function () {\n        this.componentDidMount();\n    };\n    CanvasToolboxHint.prototype.render = function () {\n        var _a = this.props, ariaLabel = _a.ariaLabel, isVisible = _a.isVisible;\n        var hintClassName = office_ui_fabric_react_1.css('CanvasToolboxHint', {\n            'is-visible': isVisible\n        });\n        return this.context.store.displayMode === sp_core_library_1.DisplayMode.Edit && (React.createElement(\"button\", {\"aria-haspopup\": true, \"aria-label\": ariaLabel, className: hintClassName, onClick: this._handleClick, \"data-automation-id\": 'toolboxHintButton'}, \n            React.createElement(\"div\", {className: 'CanvasToolboxHint-plusButton'}, \n                React.createElement(\"i\", {className: 'ms-Icon ms-Icon--Add'})\n            )\n        ));\n    };\n    CanvasToolboxHint.prototype.focus = function () {\n        var _this = this;\n        window.setTimeout(function () { return _this._domNode.focus(); }, 0);\n    };\n    CanvasToolboxHint.prototype._handleClick = function () {\n        this.context.store.selectedControlId = undefined;\n        var verticalPosition;\n        var horizontalPosition;\n        if (this._domNode) {\n            var _a = this._domNode, clientWidth = _a.clientWidth, offsetTop = _a.offsetTop, offsetLeft = _a.offsetLeft, parentElement = _a.parentElement;\n            if (this.props.layout && this.props.layout.sectionIndex) {\n                verticalPosition = parentElement.offsetTop;\n                horizontalPosition = offsetLeft + parentElement.offsetLeft + (clientWidth / 2) - 146;\n            }\n            else {\n                verticalPosition = offsetTop;\n            }\n        }\n        this.context.store.openToolbox(this.props.layout || this.props.row, verticalPosition, horizontalPosition);\n    };\n    CanvasToolboxHint.contextTypes = {\n        store: React.PropTypes.object.isRequired\n    };\n    return CanvasToolboxHint;\n}(React.Component));\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.default = CanvasToolboxHint;\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./lib/local/appBase/components/sp-canvas/canvas/canvasToolboxHint/CanvasToolboxHint.js\n// module id = 159\n// module chunks = 0\n\n\n// WEBPACK FOOTER //\n// webpack:///lib/local/appBase/components/sp-canvas/canvas/canvasToolboxHint/CanvasToolboxHint.js","var content = require(\"!!./../../../../../../../../../common/node_modules/css-loader/index.js?-minimize!./LayoutCanvasToolboxHint.css\");\nvar loader = require(\"D:\\\\agent\\\\1\\\\_work\\\\24\\\\s\\\\common\\\\node_modules\\\\@microsoft\\\\load-themed-styles\\\\lib\\\\index.js\");\n\nif(typeof content === \"string\") content = [[module.id, content]];\n\n// add the styles to the DOM\nfor (var i = 0; i < content.length; i++) loader.loadStyles(content[i][1]);\n\nif(content.locals) module.exports = content.locals;\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./lib/local/appBase/components/sp-canvas/canvas/canvasToolboxHint/LayoutCanvasToolboxHint.css\n// module id = 160\n// module chunks = 0\n\n\n// WEBPACK FOOTER //\n// webpack:///lib/local/appBase/components/sp-canvas/canvas/canvasToolboxHint/LayoutCanvasToolboxHint.css?0752","exports = module.exports = require(\"./../../../../../../../../../common/node_modules/css-loader/lib/css-base.js\")();\n// imports\n\n\n// module\nexports.push([module.id, \".CanvasToolboxHint{background:0 0;border:none;cursor:pointer;height:24px;left:48px;margin-top:-26px;opacity:0;outline:0;padding:0;position:relative;right:48px;-webkit-transition:all .3s ease;transition:all .3s ease;width:calc(100% - 96px);color:\\\"[theme:neutralTertiary, default: #a6a6a6]\\\"}.CanvasToolboxHint .CanvasToolboxHint-plusButton{background-color:\\\"[theme:neutralTertiary, default: #a6a6a6]\\\";border-radius:50%;color:\\\"[theme:white, default: #ffffff]\\\";font-size:15px;height:24px;left:calc(50% - 12px);line-height:24px;padding:0;position:absolute;text-align:center;top:0;width:24px;z-index:1;-webkit-transition:all .3s ease;transition:all .3s ease}.CanvasToolboxHint .CanvasToolboxHint-plusButton .ms-Icon{position:relative}.CanvasToolboxHint::after{border-top:1px solid \\\"[theme:neutralTertiary, default: #a6a6a6]\\\";content:'';height:1px;left:0;position:absolute;top:12px;width:100%;-webkit-transition:all .3s ease;transition:all .3s ease}.CanvasToolboxHint.is-visible{opacity:1}.CanvasToolboxHint:nth-of-type(1):nth-last-of-type(1){margin-top:0;opacity:1}.CanvasToolboxHint:focus,.CanvasToolboxHint:hover{opacity:1}.CanvasToolboxHint:focus .CanvasToolboxHint-plusButton,.CanvasToolboxHint:hover .CanvasToolboxHint-plusButton{background-color:\\\"[theme:themePrimary, default:#0078d7]\\\"}.CanvasToolboxHint:focus::after,.CanvasToolboxHint:hover::after{border-color:\\\"[theme:themePrimary, default:#0078d7]\\\"}.CanvasSection button.CanvasToolboxHint{width:calc(100% - 144px);left:72px}@media screen and (min-width:640px){.CanvasToolboxHint:first-of-type{margin-top:0}}@media screen and (-ms-high-contrast:active){.CanvasToolboxHint{color:#1AEBFF}}@media screen and (-ms-high-contrast:black-on-white){.CanvasToolboxHint{color:#37006E}}\", \"\"]);\n\n// exports\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// D:/agent/1/_work/24/s/common/~/css-loader?-minimize!./lib/local/appBase/components/sp-canvas/canvas/canvasToolboxHint/LayoutCanvasToolboxHint.css\n// module id = 161\n// module chunks = 0\n\n\n// WEBPACK FOOTER //\n// webpack:///lib/local/appBase/components/sp-canvas/canvas/canvasToolboxHint/LayoutCanvasToolboxHint.css","var content = require(\"!!./../../../../../../../../../common/node_modules/css-loader/index.js?-minimize!./CanvasToolboxHint.css\");\nvar loader = require(\"D:\\\\agent\\\\1\\\\_work\\\\24\\\\s\\\\common\\\\node_modules\\\\@microsoft\\\\load-themed-styles\\\\lib\\\\index.js\");\n\nif(typeof content === \"string\") content = [[module.id, content]];\n\n// add the styles to the DOM\nfor (var i = 0; i < content.length; i++) loader.loadStyles(content[i][1]);\n\nif(content.locals) module.exports = content.locals;\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./lib/local/appBase/components/sp-canvas/canvas/canvasToolboxHint/CanvasToolboxHint.css\n// module id = 162\n// module chunks = 0\n\n\n// WEBPACK FOOTER //\n// webpack:///lib/local/appBase/components/sp-canvas/canvas/canvasToolboxHint/CanvasToolboxHint.css?54c1","exports = module.exports = require(\"./../../../../../../../../../common/node_modules/css-loader/lib/css-base.js\")();\n// imports\n\n\n// module\nexports.push([module.id, \".CanvasToolboxHint{background:0 0;border:none;cursor:pointer;height:24px;left:48px;margin-top:-26px;opacity:0;outline:0;padding:0;position:absolute;right:48px;-webkit-transition:all .3s ease;transition:all .3s ease;width:calc(100% - 96px);color:\\\"[theme:neutralTertiary, default: #a6a6a6]\\\"}.CanvasToolboxHint .CanvasToolboxHint-plusButton{background-color:\\\"[theme:neutralTertiary, default: #a6a6a6]\\\";border-radius:50%;color:\\\"[theme:white, default: #ffffff]\\\";font-size:15px;height:24px;left:calc(50% - 12px);line-height:24px;padding:0;position:absolute;text-align:center;top:0;width:24px;z-index:1;-webkit-transition:all .3s ease;transition:all .3s ease}.CanvasToolboxHint .CanvasToolboxHint-plusButton .ms-Icon{position:relative}.CanvasToolboxHint::after{border-top:1px solid \\\"[theme:neutralTertiary, default: #a6a6a6]\\\";content:'';height:1px;left:0;position:absolute;top:12px;width:100%;-webkit-transition:all .3s ease;transition:all .3s ease}.CanvasToolboxHint.is-visible{opacity:1}.CanvasToolboxHint:nth-of-type(1):nth-last-of-type(1){margin-top:-13px;opacity:1}.CanvasToolboxHint:focus,.CanvasToolboxHint:hover{opacity:1}.CanvasToolboxHint:focus .CanvasToolboxHint-plusButton,.CanvasToolboxHint:hover .CanvasToolboxHint-plusButton{background-color:\\\"[theme:themePrimary, default:#0078d7]\\\"}.CanvasToolboxHint:focus::after,.CanvasToolboxHint:hover::after{border-color:\\\"[theme:themePrimary, default:#0078d7]\\\"}@media screen and (min-width:640px){.CanvasToolboxHint:first-of-type{margin-top:-13px}}@media screen and (-ms-high-contrast:active){.CanvasToolboxHint{color:#1AEBFF}}@media screen and (-ms-high-contrast:black-on-white){.CanvasToolboxHint{color:#37006E}}\", \"\"]);\n\n// exports\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// D:/agent/1/_work/24/s/common/~/css-loader?-minimize!./lib/local/appBase/components/sp-canvas/canvas/canvasToolboxHint/CanvasToolboxHint.css\n// module id = 163\n// module chunks = 0\n\n\n// WEBPACK FOOTER //\n// webpack:///lib/local/appBase/components/sp-canvas/canvas/canvasToolboxHint/CanvasToolboxHint.css","\"use strict\";\nvar React = require('react');\nvar office_ui_fabric_react_1 = require('office-ui-fabric-react');\nvar CanvasStrings_resx_1 = require('../../loc/CanvasStrings.resx');\nfunction ConfirmationDialog(props) {\n    var isOpen = props.isOpen, message = props.message, onConfirmation = props.onConfirmation, onDismiss = props.onDismiss, title = props.title;\n    return (React.createElement(office_ui_fabric_react_1.Dialog, {isOpen: isOpen, onDismiss: onDismiss, title: title, subText: message}, \n        React.createElement(office_ui_fabric_react_1.DialogFooter, null, \n            React.createElement(office_ui_fabric_react_1.Button, {buttonType: office_ui_fabric_react_1.ButtonType.primary, onClick: onConfirmation, ariaLabel: CanvasStrings_resx_1.default.ConfirmationDialogYes, \"data-automation-id\": 'confirmButton'}, CanvasStrings_resx_1.default.ConfirmationDialogYes), \n            React.createElement(office_ui_fabric_react_1.Button, {onClick: onDismiss, ariaLabel: CanvasStrings_resx_1.default.ConfirmationDialogNo, \"data-automation-id\": 'cancelButton'}, CanvasStrings_resx_1.default.ConfirmationDialogNo))\n    ));\n}\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.default = ConfirmationDialog;\nConfirmationDialog.contextTypes = {\n    store: React.PropTypes.object.isRequired\n};\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./lib/local/appBase/components/sp-canvas/canvas/confirmationDialog/ConfirmationDialog.js\n// module id = 164\n// module chunks = 0\n\n\n// WEBPACK FOOTER //\n// webpack:///lib/local/appBase/components/sp-canvas/canvas/confirmationDialog/ConfirmationDialog.js","\"use strict\";\nvar __extends = (this && this.__extends) || function (d, b) {\n    for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p];\n    function __() { this.constructor = d; }\n    d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n};\nvar React = require('react');\nvar office_ui_fabric_react_1 = require('office-ui-fabric-react');\nvar sp_core_library_1 = require('@microsoft/sp-core-library');\nvar CanvasSection_1 = require('../canvasSection/CanvasSection');\nvar CanvasZone = (function (_super) {\n    __extends(CanvasZone, _super);\n    function CanvasZone(props, context) {\n        _super.call(this, props, context);\n    }\n    CanvasZone.prototype.render = function () {\n        var _this = this;\n        var store = this.context.store;\n        var displayMode = store.displayMode;\n        var _a = this.props, zone = _a.zone, selectedPosition = _a.selectedPosition;\n        var isCurZoneSelected = selectedPosition.zoneIndex === zone.index;\n        var sectionComponents = [];\n        var sections = zone.sections;\n        sections.forEach(function (curSection, curIdx) {\n            sectionComponents.push(React.createElement(CanvasSection_1.default, {zoneIndex: zone.index, section: curSection, selectedPosition: selectedPosition, key: curSection.index}));\n        });\n        var isReadMode = displayMode === sp_core_library_1.DisplayMode.Read;\n        var layoutZoneClassName = office_ui_fabric_react_1.css('CanvasZone', 'ms-Grid-row', {\n            'CanvasZone--edit': !isReadMode,\n            'CanvasZone--selected': isCurZoneSelected\n        });\n        return (React.createElement(\"div\", {className: layoutZoneClassName, ref: function (ref) { return _this._domElement = ref; }, \"data-automation-id\": 'CanvasZone'}, sectionComponents));\n    };\n    CanvasZone.contextTypes = {\n        store: React.PropTypes.object.isRequired\n    };\n    return CanvasZone;\n}(React.Component));\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.default = CanvasZone;\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./lib/local/appBase/components/sp-canvas/canvas/canvasZone/CanvasZone.js\n// module id = 165\n// module chunks = 0\n\n\n// WEBPACK FOOTER //\n// webpack:///lib/local/appBase/components/sp-canvas/canvas/canvasZone/CanvasZone.js","\"use strict\";\nvar __extends = (this && this.__extends) || function (d, b) {\n    for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p];\n    function __() { this.constructor = d; }\n    d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n};\nvar React = require('react');\nvar office_ui_fabric_react_1 = require('office-ui-fabric-react');\nvar sp_core_library_1 = require('@microsoft/sp-core-library');\nvar CanvasControlFactory_1 = require('../canvasControl/CanvasControlFactory');\nvar CanvasLayout_1 = require('../canvasLayout/CanvasLayout');\nvar CanvasToolboxHint_1 = require('../canvasToolboxHint/CanvasToolboxHint');\nvar ControlZone_1 = require('../controlZone/ControlZone');\nvar CanvasStrings_resx_1 = require('../../loc/CanvasStrings.resx');\nvar Toolbar_1 = require('../../toolbar/toolbar/Toolbar');\nrequire('CanvasSection.scss');\nvar CanvasSection = (function (_super) {\n    __extends(CanvasSection, _super);\n    function CanvasSection(props, context) {\n        _super.call(this, props, context);\n    }\n    CanvasSection._createEmptyControlLayout = function (zoneIndex, sectionIndex, controlIndex) {\n        return {\n            zoneIndex: zoneIndex,\n            sectionIndex: sectionIndex,\n            controlIndex: controlIndex\n        };\n    };\n    CanvasSection.prototype.render = function () {\n        var _this = this;\n        var store = this.context.store;\n        var displayMode = store.displayMode;\n        var _a = this.props, zoneIndex = _a.zoneIndex, section = _a.section, selectedPosition = _a.selectedPosition;\n        var isSectionSelected = selectedPosition.zoneIndex === zoneIndex &&\n            selectedPosition.sectionIndex === section.index;\n        var controlComponents = [];\n        var controls = section.controls;\n        var numControls = controls.length;\n        controls.forEach(function (curCtrl, curIdx) {\n            var isControlSelected = isSectionSelected &&\n                selectedPosition.controlIndex === curCtrl.position.controlIndex;\n            controlComponents.push(React.createElement(ControlZone_1.default, {displayMode: displayMode, id: curCtrl.id, isSelected: isControlSelected, key: curCtrl.id, row: undefined, position: curCtrl.position}, \n                CanvasControlFactory_1.default.CreateCanvasControl(curCtrl, store), \n                React.createElement(Toolbar_1.default, {controlType: curCtrl.controlType, displayMode: displayMode, id: curCtrl.id, row: undefined, onConfigureButtonClick: store.handleConfigureButtonClicked, onDeleteButtonClick: store.handleDeleteButtonClicked, controlPosition: curCtrl.position})));\n            var nextControlIndex = (curIdx + 1 === numControls) ?\n                curCtrl.position.controlIndex + 1 :\n                controls[curIdx + 1].position.controlIndex;\n            var nextCtrlPosition = CanvasSection._createEmptyControlLayout(curCtrl.position.zoneIndex, curCtrl.position.sectionIndex, nextControlIndex);\n            controlComponents.push(React.createElement(CanvasToolboxHint_1.default, {ariaLabel: CanvasStrings_resx_1.default.ToolboxHintTitle, row: undefined, layout: nextCtrlPosition, key: \"hint.\" + nextCtrlPosition.controlIndex}));\n        });\n        var firstControlIdx = controls.length > 0 ?\n            controls[0].position.controlIndex :\n            CanvasLayout_1.default.firstLayoutIndex;\n        var firstControlLayout = {\n            zoneIndex: zoneIndex,\n            sectionIndex: section.index,\n            controlIndex: firstControlIdx\n        };\n        var isReadMode = displayMode === sp_core_library_1.DisplayMode.Read;\n        var layoutSectionClassName = office_ui_fabric_react_1.css('CanvasSection', 'ms-Grid-col', 'ms-u-sm12', \"ms-u-lg\" + (this.props.section.factor || 12), {\n            'CanvasSection--edit': !isReadMode,\n            'CanvasSection--selected': isSectionSelected\n        });\n        return (React.createElement(\"div\", {className: layoutSectionClassName, ref: function (ref) { return _this._domElement = ref; }, \"data-automation-id\": 'CanvasSection'}, \n            React.createElement(CanvasToolboxHint_1.default, {ariaLabel: CanvasStrings_resx_1.default.ToolboxHintTitle, row: undefined, layout: firstControlLayout}), \n            controlComponents));\n    };\n    CanvasSection.contextTypes = {\n        store: React.PropTypes.object.isRequired\n    };\n    return CanvasSection;\n}(React.Component));\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.default = CanvasSection;\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./lib/local/appBase/components/sp-canvas/canvas/canvasSection/CanvasSection.js\n// module id = 166\n// module chunks = 0\n\n\n// WEBPACK FOOTER //\n// webpack:///lib/local/appBase/components/sp-canvas/canvas/canvasSection/CanvasSection.js","\"use strict\";\nvar __extends = (this && this.__extends) || function (d, b) {\n    for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p];\n    function __() { this.constructor = d; }\n    d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n};\nvar sp_core_library_1 = require('@microsoft/sp-core-library');\nvar office_ui_fabric_react_1 = require('office-ui-fabric-react');\nvar React = require('react');\nvar CanvasControlType_1 = require('../../canvas/canvasControl/CanvasControlType');\nvar ToolbarButton_1 = require('../toolbarButton/ToolbarButton');\nrequire('./Toolbar.scss');\nvar CanvasStrings_resx_1 = require('../../loc/CanvasStrings.resx');\nvar Toolbar = (function (_super) {\n    __extends(Toolbar, _super);\n    function Toolbar(props) {\n        _super.call(this, props);\n        this._handleConfigureButtonClicked = this._handleConfigureButtonClicked.bind(this);\n        this._handleDeleteButtonClicked = this._handleDeleteButtonClicked.bind(this);\n    }\n    Toolbar.prototype.render = function () {\n        var configureButton;\n        if (this.props.controlType === CanvasControlType_1.default.WebPartZone) {\n            configureButton = (React.createElement(ToolbarButton_1.default, {key: 'edit' + this.props.key, canBeActive: false, fabricIconKey: 'Edit', onClick: this._handleConfigureButtonClicked, title: CanvasStrings_resx_1.default.ToolbarConfigButtonTitle, automationId: 'configureButton'}));\n        }\n        return (this.props.displayMode === sp_core_library_1.DisplayMode.Edit &&\n            React.createElement(office_ui_fabric_react_1.FocusZone, {isCircularNavigation: true}, \n                React.createElement(\"div\", {className: 'CanvasControlToolbar', role: 'toolbar'}, \n                    configureButton, \n                    React.createElement(ToolbarButton_1.default, {key: 'delete' + this.props.key, canBeActive: false, fabricIconKey: 'Delete', onClick: this._handleDeleteButtonClicked, title: CanvasStrings_resx_1.default.ToolbarDeleteButtonTitle, automationId: 'deleteButton'}))\n            ));\n    };\n    Toolbar.prototype._handleConfigureButtonClicked = function () {\n        this.props.onConfigureButtonClick(this.props.id);\n    };\n    Toolbar.prototype._handleDeleteButtonClicked = function () {\n        this.props.onDeleteButtonClick(this.props.row, this.props.controlPosition);\n    };\n    return Toolbar;\n}(React.Component));\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.default = Toolbar;\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./lib/local/appBase/components/sp-canvas/toolbar/toolbar/Toolbar.js\n// module id = 167\n// module chunks = 0\n\n\n// WEBPACK FOOTER //\n// webpack:///lib/local/appBase/components/sp-canvas/toolbar/toolbar/Toolbar.js","require('Toolbar.css');\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./lib/local/appBase/components/sp-canvas/toolbar/toolbar/Toolbar.scss.js\n// module id = 168\n// module chunks = 0\n\n\n// WEBPACK FOOTER //\n// webpack:///lib/local/appBase/components/sp-canvas/toolbar/toolbar/Toolbar.scss.js","var content = require(\"!!./../../../../../../../../../common/node_modules/css-loader/index.js?-minimize!./Toolbar.css\");\nvar loader = require(\"D:\\\\agent\\\\1\\\\_work\\\\24\\\\s\\\\common\\\\node_modules\\\\@microsoft\\\\load-themed-styles\\\\lib\\\\index.js\");\n\nif(typeof content === \"string\") content = [[module.id, content]];\n\n// add the styles to the DOM\nfor (var i = 0; i < content.length; i++) loader.loadStyles(content[i][1]);\n\nif(content.locals) module.exports = content.locals;\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./lib/local/appBase/components/sp-canvas/toolbar/toolbar/Toolbar.css\n// module id = 169\n// module chunks = 0\n\n\n// WEBPACK FOOTER //\n// webpack:///lib/local/appBase/components/sp-canvas/toolbar/toolbar/Toolbar.css?67a4","exports = module.exports = require(\"./../../../../../../../../../common/node_modules/css-loader/lib/css-base.js\")();\n// imports\n\n\n// module\nexports.push([module.id, \".CanvasControlToolbar{position:absolute;top:0;width:32px;z-index:1}[dir=ltr] .CanvasControlToolbar{left:-40px}[dir=rtl] .CanvasControlToolbar{right:-40px}[dir=ltr] .CanvasControlToolbar{padding-right:10px}[dir=rtl] .CanvasControlToolbar{padding-left:10px}\", \"\"]);\n\n// exports\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// D:/agent/1/_work/24/s/common/~/css-loader?-minimize!./lib/local/appBase/components/sp-canvas/toolbar/toolbar/Toolbar.css\n// module id = 170\n// module chunks = 0\n\n\n// WEBPACK FOOTER //\n// webpack:///lib/local/appBase/components/sp-canvas/toolbar/toolbar/Toolbar.css","require('CanvasSection.css');\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./lib/local/appBase/components/sp-canvas/canvas/canvasSection/CanvasSection.scss.js\n// module id = 171\n// module chunks = 0\n\n\n// WEBPACK FOOTER //\n// webpack:///lib/local/appBase/components/sp-canvas/canvas/canvasSection/CanvasSection.scss.js","var content = require(\"!!./../../../../../../../../../common/node_modules/css-loader/index.js?-minimize!./CanvasSection.css\");\nvar loader = require(\"D:\\\\agent\\\\1\\\\_work\\\\24\\\\s\\\\common\\\\node_modules\\\\@microsoft\\\\load-themed-styles\\\\lib\\\\index.js\");\n\nif(typeof content === \"string\") content = [[module.id, content]];\n\n// add the styles to the DOM\nfor (var i = 0; i < content.length; i++) loader.loadStyles(content[i][1]);\n\nif(content.locals) module.exports = content.locals;\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./lib/local/appBase/components/sp-canvas/canvas/canvasSection/CanvasSection.css\n// module id = 172\n// module chunks = 0\n\n\n// WEBPACK FOOTER //\n// webpack:///lib/local/appBase/components/sp-canvas/canvas/canvasSection/CanvasSection.css?15ec","exports = module.exports = require(\"./../../../../../../../../../common/node_modules/css-loader/lib/css-base.js\")();\n// imports\n\n\n// module\nexports.push([module.id, \".CanvasSection--edit{margin:32px 0 32px 0;border:2px dashed transparent}.CanvasSection--edit.CanvasSection--selected{border:2px dashed \\\"[theme:neutralTertiary, default: #a6a6a6]\\\"}\", \"\"]);\n\n// exports\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// D:/agent/1/_work/24/s/common/~/css-loader?-minimize!./lib/local/appBase/components/sp-canvas/canvas/canvasSection/CanvasSection.css\n// module id = 173\n// module chunks = 0\n\n\n// WEBPACK FOOTER //\n// webpack:///lib/local/appBase/components/sp-canvas/canvas/canvasSection/CanvasSection.css","\"use strict\";\nvar __extends = (this && this.__extends) || function (d, b) {\n    for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p];\n    function __() { this.constructor = d; }\n    d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n};\nvar __assign = (this && this.__assign) || Object.assign || function(t) {\n    for (var s, i = 1, n = arguments.length; i < n; i++) {\n        s = arguments[i];\n        for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p))\n            t[p] = s[p];\n    }\n    return t;\n};\nvar React = require('react');\nvar office_ui_fabric_react_1 = require('office-ui-fabric-react');\nvar sp_core_library_1 = require('@microsoft/sp-core-library');\nvar odsp_utilities_bundle_1 = require('@ms/odsp-utilities-bundle');\nvar CanvasControlType_1 = require('../../canvas/canvasControl/CanvasControlType');\nvar ToolboxGroup_1 = require('../toolboxGroup/ToolboxGroup');\nvar ToolboxItem_1 = require('../toolboxItem/ToolboxItem');\nvar ToolBoxItemClassifier_1 = require('../toolboxItem/ToolBoxItemClassifier');\nvar CanvasA11y_1 = require('../../a11y/CanvasA11y');\nrequire('./Toolbox.scss');\nvar CanvasStrings_resx_1 = require('../../loc/CanvasStrings.resx');\nvar CLIENT_SIDE_TEAM_NEWS_FLIGHT = 953;\nvar LINK_PREVIEW_FLIGHT = 904;\nvar NEWSFEED_ID = 'a5df8fdf-b508-4b66-98a6-d83bc2597f63';\nvar NEWSREEL_ID = '0ef418ba-5d19-4ade-9db0-b339873291d0';\nvar LINK_PREVIEW_ID = '6410b3b6-d440-4663-8744-378976dc041e';\nvar Toolbox = (function (_super) {\n    __extends(Toolbox, _super);\n    function Toolbox(props, context) {\n        _super.call(this, props, context);\n        this._handleKeyDownCapture = this._handleKeyDownCapture.bind(this);\n        this.state = {\n            horizontalPosition: props.horizontalPosition,\n            verticalPosition: props.verticalPosition\n        };\n    }\n    Toolbox.prototype.componentDidMount = function () {\n        if (this._domNode) {\n            this._domNode.addEventListener('keydown', this._handleKeyDownCapture, true);\n        }\n    };\n    Toolbox.prototype.componentDidUpdate = function (prevProps) {\n        if (this.props.isOpen !== prevProps.isOpen) {\n            if (this.props.isOpen) {\n                if (this.props.isLoading) {\n                    this.context.store.a11yManager.ariaAlert(CanvasStrings_resx_1.default.ToolboxAriaLoadingAlert);\n                }\n                else {\n                    if (prevProps.isLoading) {\n                        this.context.store.a11yManager.ariaAlert(CanvasStrings_resx_1.default.ToolboxAriaLoadingFinishedAlert);\n                    }\n                    this.context.store.a11yManager.saveState();\n                    this.context.store.a11yManager.navigateTo(this._domNode);\n                    var localizedItemCount = odsp_utilities_bundle_1.StringHelper.formatWithLocalizedCountValue(CanvasStrings_resx_1.default.CanvasItems, CanvasStrings_resx_1.default.CanvasItemsInterval, this.props.toolboxItems.length + 1);\n                    var message = odsp_utilities_bundle_1.StringHelper.format(CanvasStrings_resx_1.default.ToolboxNavigationArrowKeys, localizedItemCount);\n                    this.context.store.a11yManager.ariaAlert(message);\n                }\n            }\n            else {\n                this.context.store.a11yManager.clearState();\n            }\n        }\n    };\n    Toolbox.prototype.componentWillReceiveProps = function (nextProps) {\n        if (nextProps.isOpen && this.context.store.scrollableParent) {\n            var _a = this.context.store.scrollableParent.getBoundingClientRect(), top_1 = _a.top, bottom = _a.bottom;\n            var toolboxHeight = 330;\n            var canvasTop = this.context.store.canvasElement.getBoundingClientRect().top;\n            var hintOffset = 28;\n            var verticalPosition = nextProps.verticalPosition;\n            if ((verticalPosition + toolboxHeight + hintOffset + canvasTop > bottom) &&\n                (verticalPosition - toolboxHeight - hintOffset > top_1)) {\n                verticalPosition -= toolboxHeight + hintOffset;\n            }\n            this.setState({ verticalPosition: verticalPosition, horizontalPosition: nextProps.horizontalPosition });\n        }\n    };\n    Toolbox.prototype.render = function () {\n        var _this = this;\n        var _a = this.props, errorMessage = _a.errorMessage, isLoading = _a.isLoading, isOpen = _a.isOpen, onItemClick = _a.onItemClick, toolboxItems = _a.toolboxItems;\n        var toolboxContent;\n        if (isLoading) {\n            toolboxContent = (React.createElement(\"div\", {className: 'ms-Spinner-container'}, \n                React.createElement(office_ui_fabric_react_1.Spinner, {type: office_ui_fabric_react_1.SpinnerType.large})\n            ));\n        }\n        else {\n            var errorLabel = void 0;\n            if (errorMessage) {\n                errorLabel = React.createElement(\"div\", {className: 'CanvasToolbox-Error'}, \n                    \" \", \n                    errorMessage, \n                    \" \");\n            }\n            var classifier = new ToolBoxItemClassifier_1.default();\n            for (var _i = 0, toolboxItems_1 = toolboxItems; _i < toolboxItems_1.length; _i++) {\n                var item = toolboxItems_1[_i];\n                var webPartManifest = item.itemProps.webPartManifest;\n                if (!sp_core_library_1._SPFlight.isEnabled(CLIENT_SIDE_TEAM_NEWS_FLIGHT) &&\n                    (webPartManifest.id === NEWSREEL_ID || webPartManifest.id === NEWSFEED_ID)) {\n                    continue;\n                }\n                if (sp_core_library_1.Environment.type !== sp_core_library_1.EnvironmentType.Local &&\n                    webPartManifest.id === LINK_PREVIEW_ID &&\n                    !sp_core_library_1._SPFlight.isEnabled(LINK_PREVIEW_FLIGHT)) {\n                    continue;\n                }\n                item.onClick = onItemClick;\n                classifier.registerItem(item.key, item);\n            }\n            var featuredItemViews_1 = [];\n            featuredItemViews_1.push(React.createElement(ToolboxItem_1.default, {description: CanvasStrings_resx_1.default.TextWebpartDescription, displayName: CanvasStrings_resx_1.default.TextWebPartDisplayName, itemProps: { controlType: CanvasControlType_1.default.RTE, displayMode: sp_core_library_1.DisplayMode.Edit, id: undefined }, key: 0, msIconName: 'Font', onClick: onItemClick, automationId: 'RTE'}));\n            var featuredItemProps = classifier.classify(true);\n            featuredItemProps.forEach(function (item) {\n                featuredItemViews_1.push(React.createElement(ToolboxItem_1.default, __assign({}, item)));\n            });\n            var featuredGroup = React.createElement(ToolboxGroup_1.default, {groupName: CanvasStrings_resx_1.default.ToolboxGroupNameFeatured, key: CanvasStrings_resx_1.default.ToolboxGroupNameFeatured, hasHeader: true}, featuredItemViews_1);\n            var nonFeaturedItemViews_1 = [];\n            var nonFeaturedItemProps = classifier.classify(false, function (item1, item2) {\n                return item1.displayName.localeCompare(item2.displayName);\n            });\n            nonFeaturedItemProps.forEach(function (item) {\n                nonFeaturedItemViews_1.push(React.createElement(ToolboxItem_1.default, __assign({}, item)));\n            });\n            var nonFeaturedGroup = React.createElement(ToolboxGroup_1.default, {groupName: CanvasStrings_resx_1.default.ToolboxGroupNameNonFeatured, key: CanvasStrings_resx_1.default.ToolboxGroupNameNonFeatured, hasHeader: false}, nonFeaturedItemViews_1);\n            var sectionGroup = React.createElement(ToolboxGroup_1.default, {groupName: CanvasStrings_resx_1.default.ToolboxSectionHeader, key: 'Sections', hasHeader: true}, \n                React.createElement(ToolboxItem_1.default, {description: CanvasStrings_resx_1.default.ToolboxTwoColumnPart, displayName: CanvasStrings_resx_1.default.ToolboxTwoColumnPart, itemProps: this._createSectionItemProps(CanvasControlType_1.default.TwoColumns), msIconName: 'LargeGrid', onClick: onItemClick}), \n                React.createElement(ToolboxItem_1.default, {description: CanvasStrings_resx_1.default.ToolboxThreeColumnPart, displayName: CanvasStrings_resx_1.default.ToolboxThreeColumnPart, itemProps: this._createSectionItemProps(CanvasControlType_1.default.ThreeColumns), msIconName: 'LargeGrid', onClick: onItemClick}), \n                React.createElement(ToolboxItem_1.default, {description: CanvasStrings_resx_1.default.ToolboxOneThirdRightColumnPart, displayName: CanvasStrings_resx_1.default.ToolboxOneThirdRightColumnPart, itemProps: this._createSectionItemProps(CanvasControlType_1.default.OneThirdColumnRight), msIconName: 'LargeGrid', onClick: onItemClick}));\n            toolboxContent = (React.createElement(office_ui_fabric_react_1.FocusZone, {direction: office_ui_fabric_react_1.FocusZoneDirection.horizontal, isCircularNavigation: true}, \n                errorLabel, \n                featuredGroup, \n                (!(this.props.controlPosition && !this.props.controlPosition.sectionIndex)) || sectionGroup, \n                nonFeaturedGroup));\n        }\n        return (React.createElement(\"div\", {role: 'toolbar', className: 'CanvasToolbox', ref: function (ref) { return _this._domNode = ref; }, style: {\n            display: isOpen ? 'block' : 'none',\n            top: this.state.verticalPosition,\n            left: this.state.horizontalPosition,\n            right: this.state.horizontalPosition === undefined ? 0 : undefined\n        }}, toolboxContent));\n    };\n    Toolbox.prototype._createSectionItemProps = function (controlType) {\n        return {\n            controlType: controlType,\n            displayMode: sp_core_library_1.DisplayMode.Edit,\n            id: undefined\n        };\n    };\n    Toolbox.prototype._handleKeyDownCapture = function (e) {\n        if (CanvasA11y_1.isEscape(e)) {\n            this.context.store.a11yManager.restoreState();\n            this.context.store.closeToolbox();\n            e.stopPropagation();\n            e.preventDefault();\n        }\n        else if (CanvasA11y_1.isTab(e)) {\n            e.stopPropagation();\n            e.preventDefault();\n        }\n    };\n    Toolbox.contextTypes = {\n        store: React.PropTypes.object.isRequired\n    };\n    return Toolbox;\n}(React.Component));\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.default = Toolbox;\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./lib/local/appBase/components/sp-canvas/toolbox/toolbox/Toolbox.js\n// module id = 174\n// module chunks = 0\n\n\n// WEBPACK FOOTER //\n// webpack:///lib/local/appBase/components/sp-canvas/toolbox/toolbox/Toolbox.js","\"use strict\";\nvar React = require('react');\nrequire('./ToolboxGroup.scss');\nfunction ToolboxGroup(props) {\n    var banner = props.hasHeader ?\n        React.createElement(\"header\", {className: 'CanvasToolboxItemsGroup-header'}, props.groupName) :\n        React.createElement(\"hr\", {className: 'CanvasToolboxItemsGroup-divider'});\n    return (React.createElement(\"section\", {\"aria-label\": props.groupName, role: 'group', className: 'CanvasToolboxItemsGroup'}, \n        banner, \n        React.createElement(\"div\", {className: 'CanvasToolboxItemsGroup-items'}, props.children)));\n}\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.default = ToolboxGroup;\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./lib/local/appBase/components/sp-canvas/toolbox/toolboxGroup/ToolboxGroup.js\n// module id = 175\n// module chunks = 0\n\n\n// WEBPACK FOOTER //\n// webpack:///lib/local/appBase/components/sp-canvas/toolbox/toolboxGroup/ToolboxGroup.js","require('ToolboxGroup.css');\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./lib/local/appBase/components/sp-canvas/toolbox/toolboxGroup/ToolboxGroup.scss.js\n// module id = 176\n// module chunks = 0\n\n\n// WEBPACK FOOTER //\n// webpack:///lib/local/appBase/components/sp-canvas/toolbox/toolboxGroup/ToolboxGroup.scss.js","var content = require(\"!!./../../../../../../../../../common/node_modules/css-loader/index.js?-minimize!./ToolboxGroup.css\");\nvar loader = require(\"D:\\\\agent\\\\1\\\\_work\\\\24\\\\s\\\\common\\\\node_modules\\\\@microsoft\\\\load-themed-styles\\\\lib\\\\index.js\");\n\nif(typeof content === \"string\") content = [[module.id, content]];\n\n// add the styles to the DOM\nfor (var i = 0; i < content.length; i++) loader.loadStyles(content[i][1]);\n\nif(content.locals) module.exports = content.locals;\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./lib/local/appBase/components/sp-canvas/toolbox/toolboxGroup/ToolboxGroup.css\n// module id = 177\n// module chunks = 0\n\n\n// WEBPACK FOOTER //\n// webpack:///lib/local/appBase/components/sp-canvas/toolbox/toolboxGroup/ToolboxGroup.css?6353","exports = module.exports = require(\"./../../../../../../../../../common/node_modules/css-loader/lib/css-base.js\")();\n// imports\n\n\n// module\nexports.push([module.id, \".CanvasToolboxItemsGroup{clear:both}.CanvasToolboxItemsGroup-header{background-color:\\\"[theme:neutralLighter, default: #f4f4f4]\\\";color:\\\"[theme:neutralPrimary, default: #333333]\\\";font-family:\\\"Segoe UI Semibold WestEuropean\\\",\\\"Segoe UI Semibold\\\",\\\"Segoe WP Semibold\\\",\\\"Segoe UI\\\",\\\"Segoe WP\\\",Tahoma,Arial,sans-serif;font-size:12px;height:32px;letter-spacing:1px;line-height:32px;padding:0 12px}.CanvasToolboxItemsGroup-divider{margin:0;border:0;border-top:1px solid \\\"[theme:neutralLight, default: #eaeaea]\\\";color:\\\"[theme:neutralLight, default: #eaeaea]\\\"}\", \"\"]);\n\n// exports\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// D:/agent/1/_work/24/s/common/~/css-loader?-minimize!./lib/local/appBase/components/sp-canvas/toolbox/toolboxGroup/ToolboxGroup.css\n// module id = 178\n// module chunks = 0\n\n\n// WEBPACK FOOTER //\n// webpack:///lib/local/appBase/components/sp-canvas/toolbox/toolboxGroup/ToolboxGroup.css","\"use strict\";\nvar React = require('react');\nrequire('./ToolboxItem.scss');\nfunction ToolboxItem(props) {\n    return (React.createElement(\"button\", {className: 'CanvasToolboxItem', title: props.description, onClick: function () { return props.onClick(JSON.parse(JSON.stringify(props.itemProps))); }, \"data-automation-id\": props.automationId}, \n        React.createElement(\"span\", {className: \"CanvasToolboxItem-icon ms-Icon ms-Icon--\" + props.msIconName}), \n        React.createElement(\"span\", {className: 'CanvasToolboxItem-title'}, props.displayName)));\n}\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.default = ToolboxItem;\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./lib/local/appBase/components/sp-canvas/toolbox/toolboxItem/ToolboxItem.js\n// module id = 179\n// module chunks = 0\n\n\n// WEBPACK FOOTER //\n// webpack:///lib/local/appBase/components/sp-canvas/toolbox/toolboxItem/ToolboxItem.js","require('ToolboxItem.css');\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./lib/local/appBase/components/sp-canvas/toolbox/toolboxItem/ToolboxItem.scss.js\n// module id = 180\n// module chunks = 0\n\n\n// WEBPACK FOOTER //\n// webpack:///lib/local/appBase/components/sp-canvas/toolbox/toolboxItem/ToolboxItem.scss.js","var content = require(\"!!./../../../../../../../../../common/node_modules/css-loader/index.js?-minimize!./ToolboxItem.css\");\nvar loader = require(\"D:\\\\agent\\\\1\\\\_work\\\\24\\\\s\\\\common\\\\node_modules\\\\@microsoft\\\\load-themed-styles\\\\lib\\\\index.js\");\n\nif(typeof content === \"string\") content = [[module.id, content]];\n\n// add the styles to the DOM\nfor (var i = 0; i < content.length; i++) loader.loadStyles(content[i][1]);\n\nif(content.locals) module.exports = content.locals;\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./lib/local/appBase/components/sp-canvas/toolbox/toolboxItem/ToolboxItem.css\n// module id = 181\n// module chunks = 0\n\n\n// WEBPACK FOOTER //\n// webpack:///lib/local/appBase/components/sp-canvas/toolbox/toolboxItem/ToolboxItem.css?8503","exports = module.exports = require(\"./../../../../../../../../../common/node_modules/css-loader/lib/css-base.js\")();\n// imports\n\n\n// module\nexports.push([module.id, \".CanvasToolboxItem{background-color:transparent;border:1px solid transparent;float:left;height:88px;overflow:hidden;padding:0;width:33.333%}.CanvasToolboxItem:focus,.CanvasToolboxItem:hover{background-color:\\\"[theme:themeLighter, default:#deecf9]\\\";cursor:pointer}.CanvasToolboxItem:focus .CanvasToolboxItem-icon,.CanvasToolboxItem:focus .CanvasToolboxItem-title,.CanvasToolboxItem:hover .CanvasToolboxItem-icon,.CanvasToolboxItem:hover .CanvasToolboxItem-title{color:\\\"[theme:themeDarkAlt, default:#106ebe]\\\"}.CanvasToolboxItem-icon{color:\\\"[theme:neutralPrimary, default: #333333]\\\";display:block;font-size:28px;line-height:48px}.CanvasToolboxItem-title{color:\\\"[theme:neutralSecondary, default: #666666]\\\";display:block;font-family:\\\"Segoe UI Regular WestEuropean\\\",\\\"Segoe UI\\\",\\\"Segoe WP\\\",Tahoma,Arial,sans-serif;font-size:13px;padding:0 8px;text-align:center;overflow:hidden;text-overflow:ellipsis}@media screen and (-ms-high-contrast:active){.CanvasToolboxItem:focus,.CanvasToolboxItem:hover{color:#1AEBFF}}@media screen and (-ms-high-contrast:black-on-white){.CanvasToolboxItem:focus,.CanvasToolboxItem:hover{color:#37006E}}\", \"\"]);\n\n// exports\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// D:/agent/1/_work/24/s/common/~/css-loader?-minimize!./lib/local/appBase/components/sp-canvas/toolbox/toolboxItem/ToolboxItem.css\n// module id = 182\n// module chunks = 0\n\n\n// WEBPACK FOOTER //\n// webpack:///lib/local/appBase/components/sp-canvas/toolbox/toolboxItem/ToolboxItem.css","\"use strict\";\nvar sp_core_library_1 = require('@microsoft/sp-core-library');\nvar GENERIC_ITEM_ID = '00000000-0000-0000-0000-000000000000';\nvar LINK_PREVIEW_ITEM_ID = '6410b3b6-d440-4663-8744-378976dc041e_0';\nvar VIDEO_ITEM_ID = '275c0095-a77e-4f6d-a2a0-6a7626911518_0';\nvar FEATURED_ITEM_IDS = [\n    'd1d91016-032f-456d-98a4-721247c305e8_0',\n    'b7dd04e1-19ce-4b24-9132-b60a1c2b910d_0',\n    VIDEO_ITEM_ID,\n    '490d7c76-1824-45b2-9de3-676421c997fa_0',\n    'daf0b71c-6de8-4ef7-b511-faae7c388708_0' \n];\nvar LINK_PREVIEW_FLIGHT = 904;\nvar ToolBoxItemClassifier = (function () {\n    function ToolBoxItemClassifier() {\n        var _this = this;\n        this._toolBoxItemIdToPropsMap = new Map();\n        FEATURED_ITEM_IDS.forEach(function (id) {\n            if (id === VIDEO_ITEM_ID && sp_core_library_1._SPFlight.isEnabled(LINK_PREVIEW_FLIGHT)) {\n                id = LINK_PREVIEW_ITEM_ID;\n            }\n            _this._toolBoxItemIdToPropsMap.set(id, []);\n        });\n        this._toolBoxItemIdToPropsMap.set(GENERIC_ITEM_ID, []);\n    }\n    ToolBoxItemClassifier.prototype.registerItem = function (itemId, itemProps) {\n        var registeredItemProps = this._toolBoxItemIdToPropsMap.get(itemId);\n        if (Array.isArray(registeredItemProps)) {\n            registeredItemProps.push(itemProps);\n        }\n        else {\n            this._toolBoxItemIdToPropsMap.get(GENERIC_ITEM_ID).push(itemProps);\n        }\n    };\n    ToolBoxItemClassifier.prototype.classify = function (isFeatured, sortPredicate) {\n        var toolBoxItemProps = [];\n        if (isFeatured) {\n            this._toolBoxItemIdToPropsMap.forEach(function (items, id) {\n                if (id !== GENERIC_ITEM_ID && items.length > 0) {\n                    toolBoxItemProps.push(items[0]);\n                }\n            });\n        }\n        else {\n            toolBoxItemProps = this._toolBoxItemIdToPropsMap.get(GENERIC_ITEM_ID);\n        }\n        if (Boolean(sortPredicate)) {\n            toolBoxItemProps = toolBoxItemProps.sort(sortPredicate);\n        }\n        return toolBoxItemProps;\n    };\n    return ToolBoxItemClassifier;\n}());\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.default = ToolBoxItemClassifier;\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./lib/local/appBase/components/sp-canvas/toolbox/toolboxItem/ToolBoxItemClassifier.js\n// module id = 183\n// module chunks = 0\n\n\n// WEBPACK FOOTER //\n// webpack:///lib/local/appBase/components/sp-canvas/toolbox/toolboxItem/ToolBoxItemClassifier.js","require('Toolbox.css');\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./lib/local/appBase/components/sp-canvas/toolbox/toolbox/Toolbox.scss.js\n// module id = 184\n// module chunks = 0\n\n\n// WEBPACK FOOTER //\n// webpack:///lib/local/appBase/components/sp-canvas/toolbox/toolbox/Toolbox.scss.js","var content = require(\"!!./../../../../../../../../../common/node_modules/css-loader/index.js?-minimize!./Toolbox.css\");\nvar loader = require(\"D:\\\\agent\\\\1\\\\_work\\\\24\\\\s\\\\common\\\\node_modules\\\\@microsoft\\\\load-themed-styles\\\\lib\\\\index.js\");\n\nif(typeof content === \"string\") content = [[module.id, content]];\n\n// add the styles to the DOM\nfor (var i = 0; i < content.length; i++) loader.loadStyles(content[i][1]);\n\nif(content.locals) module.exports = content.locals;\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./lib/local/appBase/components/sp-canvas/toolbox/toolbox/Toolbox.css\n// module id = 185\n// module chunks = 0\n\n\n// WEBPACK FOOTER //\n// webpack:///lib/local/appBase/components/sp-canvas/toolbox/toolbox/Toolbox.css?0dfb","exports = module.exports = require(\"./../../../../../../../../../common/node_modules/css-loader/lib/css-base.js\")();\n// imports\n\n\n// module\nexports.push([module.id, \".CanvasToolbox{background:\\\"[theme:white, default: #ffffff]\\\";border:1px solid #d6d6d6;box-shadow:0 0 8px 0 rgba(0,0,0,.2);box-sizing:border-box;height:330px;margin-top:26px;overflow-y:auto;position:absolute;width:292px;z-index:10;left:0;margin-left:auto;margin-right:auto}.CanvasToolbox .CanvasToolbox-Error{background-color:#fde7e9;font-family:\\\"Segoe UI Semibold WestEuropean\\\",\\\"Segoe UI Semibold\\\",\\\"Segoe WP Semibold\\\",\\\"Segoe UI\\\",\\\"Segoe WP\\\",Tahoma,Arial,sans-serif;font-size:12px;letter-spacing:1px;padding:0 12px}.CanvasToolbox .ms-Spinner-container{margin-left:132px;margin-top:151px}\", \"\"]);\n\n// exports\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// D:/agent/1/_work/24/s/common/~/css-loader?-minimize!./lib/local/appBase/components/sp-canvas/toolbox/toolbox/Toolbox.css\n// module id = 186\n// module chunks = 0\n\n\n// WEBPACK FOOTER //\n// webpack:///lib/local/appBase/components/sp-canvas/toolbox/toolbox/Toolbox.css","require('Canvas.css');\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./lib/local/appBase/components/sp-canvas/canvas/canvas/Canvas.scss.js\n// module id = 187\n// module chunks = 0\n\n\n// WEBPACK FOOTER //\n// webpack:///lib/local/appBase/components/sp-canvas/canvas/canvas/Canvas.scss.js","var content = require(\"!!./../../../../../../../../../common/node_modules/css-loader/index.js?-minimize!./Canvas.css\");\nvar loader = require(\"D:\\\\agent\\\\1\\\\_work\\\\24\\\\s\\\\common\\\\node_modules\\\\@microsoft\\\\load-themed-styles\\\\lib\\\\index.js\");\n\nif(typeof content === \"string\") content = [[module.id, content]];\n\n// add the styles to the DOM\nfor (var i = 0; i < content.length; i++) loader.loadStyles(content[i][1]);\n\nif(content.locals) module.exports = content.locals;\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./lib/local/appBase/components/sp-canvas/canvas/canvas/Canvas.css\n// module id = 188\n// module chunks = 0\n\n\n// WEBPACK FOOTER //\n// webpack:///lib/local/appBase/components/sp-canvas/canvas/canvas/Canvas.css?54dd","exports = module.exports = require(\"./../../../../../../../../../common/node_modules/css-loader/lib/css-base.js\")();\n// imports\n\n\n// module\nexports.push([module.id, \".Canvas{padding:0 12px;position:relative}@media screen and (min-width:640px){.Canvas:not(.Canvas--edit){padding:8px 32px}.Canvas--edit{padding-top:16px;padding-bottom:16px}[dir=ltr] .Canvas--edit{padding-left:48px}[dir=rtl] .Canvas--edit{padding-right:48px}[dir=ltr] .Canvas--edit{padding-right:32px}[dir=rtl] .Canvas--edit{padding-left:32px}}.Canvas-screenReaderOnly{position:absolute;text-indent:-9999px;width:1px;height:1px;padding:0;margin:-1px;overflow:hidden;border:0}\", \"\"]);\n\n// exports\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// D:/agent/1/_work/24/s/common/~/css-loader?-minimize!./lib/local/appBase/components/sp-canvas/canvas/canvas/Canvas.css\n// module id = 189\n// module chunks = 0\n\n\n// WEBPACK FOOTER //\n// webpack:///lib/local/appBase/components/sp-canvas/canvas/canvas/Canvas.css","\"use strict\";\nvar Shell_1 = require('./Shell');\nvar _spShell = Shell_1.default.getInstance();\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.default = _spShell;\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./lib/local/framework/shell/_spShell.js\n// module id = 190\n// module chunks = 0\n\n\n// WEBPACK FOOTER //\n// webpack:///lib/local/framework/shell/_spShell.js","\"use strict\";\nvar sp_telemetry_1 = require('@ms/sp-telemetry');\nvar sp_core_library_1 = require('@microsoft/sp-core-library');\nvar sp_page_context_1 = require('@microsoft/sp-page-context');\nvar sp_http_1 = require('@microsoft/sp-http');\nvar SuiteNavManager_1 = require('../../common/suiteNav/SuiteNavManager');\nvar SPPageChrome_1 = require('../../common/spPageChrome/SPPageChrome');\nvar PreloadedDataReader_1 = require('./PreloadedDataReader');\nvar AppPageContext_1 = require('../pageContext/AppPageContext');\nvar Shell = (function () {\n    function Shell() {\n    }\n    Shell.getInstance = function () {\n        if (Shell._instance === undefined) {\n            Shell._instance = new Shell();\n        }\n        return Shell._instance;\n    };\n    Object.defineProperty(Shell.prototype, \"serviceScope\", {\n        get: function () {\n            return this._rootServiceScope;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(Shell.prototype, \"pageContext\", {\n        get: function () {\n            return this._pageContext;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(Shell.prototype, \"appPageContext\", {\n        get: function () {\n            return this._appPageContext;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(Shell.prototype, \"httpClient\", {\n        get: function () {\n            return this._httpClient;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(Shell.prototype, \"spHttpClient\", {\n        get: function () {\n            return this._spHttpClient;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(Shell.prototype, \"suiteNav\", {\n        get: function () {\n            return this._suiteNav;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(Shell.prototype, \"environment\", {\n        get: function () {\n            return this._environment;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(Shell.prototype, \"manifestPreloads\", {\n        get: function () {\n            return this._manifestPreloads;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(Shell.prototype, \"pageManager\", {\n        get: function () {\n            return this._pageManager;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Shell.prototype.start = function (module, preloadedData) {\n        var application = module.default ||\n            module;\n        this._initializePreload(preloadedData, application);\n        sp_telemetry_1._PerformanceLogger.markApplicationStart();\n        return this._startApplication(application, preloadedData);\n    };\n    Shell.prototype._startApplication = function (application, preloadedData) {\n        var _this = this;\n        return new Promise(function (resolve, reject) {\n            if (application['__type'] !== 'ClientSideApplication') {\n                reject(new Error('The application is not a subclass of ClientSideApplication'));\n                return;\n            }\n            var qosMonitor = new sp_telemetry_1._QosMonitor('ClientApplication');\n            var qosApplicationData = {\n                alias: application.alias || preloadedData.manifests[0].alias,\n                isInternal: preloadedData.manifests[0].isInternal,\n                manifestId: preloadedData.manifests[0].id\n            };\n            try {\n                _this._application = application;\n                _this._application.load(_this);\n                if (sp_core_library_1.Environment.type !== sp_core_library_1.EnvironmentType.ClassicSharePoint) {\n                    _this._spPageChrome = SPPageChrome_1.default.getInstance(_this._rootServiceScope);\n                    _this._suiteNav = new SuiteNavManager_1.default(_this._application.suiteNavConfiguration(), _this._spPageChrome.suiteNavDiv, _this.serviceScope);\n                    _this._suiteNav.loadSuiteNav();\n                    _this._application.render(_this._spPageChrome.appDiv);\n                }\n                qosMonitor.writeSuccess(qosApplicationData);\n                resolve(_this._application);\n            }\n            catch (e) {\n                qosMonitor.writeUnexpectedFailure('GeneralError', e, qosApplicationData);\n                reject(e);\n            }\n        });\n    };\n    Shell.prototype._initializePreload = function (preloadedData, application) {\n        sp_telemetry_1._TraceLogger.logVerbose(Shell._logSource, 'Starting sp-client-preview');\n        this._rootServiceScope = sp_core_library_1.ServiceScope.startNewRoot();\n        this._rootServiceScope.provide(sp_telemetry_1._logSourceServiceKey, Shell._logSource);\n        this._pageManager = this._rootServiceScope\n            .createDefaultAndProvide(sp_page_context_1.PageManager.serviceKey);\n        this._pageContext = this._rootServiceScope\n            .createDefaultAndProvide(sp_page_context_1.PageContext.serviceKey);\n        this._appPageContext = this._rootServiceScope\n            .createDefaultAndProvide(AppPageContext_1.appPageContextServiceKey);\n        this._httpClient = this._rootServiceScope.createAndProvide(sp_http_1.HttpClient.serviceKey, sp_http_1.HttpClient);\n        this._spHttpClient = this._rootServiceScope.createAndProvide(sp_http_1.SPHttpClient.serviceKey, sp_http_1.SPHttpClient);\n        this._rootServiceScope.finish();\n        this._pageManager.navigateToPage(preloadedData.spPageContextInfo.webServerRelativeUrl, \n        sp_page_context_1.SharePointPageContextDataProvider._createPageContextData(preloadedData.spPageContextInfo), \n        preloadedData.spPageContextInfo);\n        this._preloadedDataReader = new PreloadedDataReader_1.default(preloadedData);\n        this._preloadedDataReader.initializeDigestCache(this._rootServiceScope);\n        this._preloadedDataReader.initializePageContext(this._appPageContext);\n        this._spPageChrome = SPPageChrome_1.default.getInstance(this._rootServiceScope);\n        this._manifestPreloads = preloadedData;\n        this._manifestPreloads.spPageContextInfo = undefined;\n    };\n    Shell._logSource = sp_telemetry_1._LogSource.create('Shell');\n    Shell._instance = undefined;\n    return Shell;\n}());\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.default = Shell;\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./lib/local/framework/shell/Shell.js\n// module id = 191\n// module chunks = 0\n\n\n// WEBPACK FOOTER //\n// webpack:///lib/local/framework/shell/Shell.js","module.exports = __WEBPACK_EXTERNAL_MODULE_10__;\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"@microsoft/sp-http\"\n// module id = 10\n// module chunks = 0","\"use strict\";\nvar sp_telemetry_1 = require('@ms/sp-telemetry');\nvar sp_http_1 = require('@microsoft/sp-http');\nvar sp_loader_1 = require('@microsoft/sp-loader');\nvar odsp_utilities_bundle_1 = require('@ms/odsp-utilities-bundle');\nvar ISuiteNavDataSource_1 = require('./dataAccess/ISuiteNavDataSource');\nvar SPOSuiteNavDataSource_1 = require('./dataAccess/SPOSuiteNavDataSource');\nvar OnPremSuiteNavDataSource_1 = require('./dataAccess/OnPremSuiteNavDataSource');\nvar O365ShellWrapper_1 = require('./O365ShellWrapper');\nvar SPPageChrome_1 = require('../spPageChrome/SPPageChrome');\nvar SuiteNavManager = (function () {\n    function SuiteNavManager(suiteNavManagerConfiguration, suiteNavDiv, serviceScope) {\n        var _this = this;\n        this._suiteNavManagerConfiguration = suiteNavManagerConfiguration;\n        this._suiteNavDataSource = undefined;\n        this._o365Shell = undefined;\n        this._suiteNavManagerConfiguration.o365ShellRenderSettings.top = suiteNavDiv.id;\n        this._suiteNavDiv = suiteNavDiv;\n        this._serviceScope = serviceScope;\n        serviceScope.whenFinished(function () {\n            _this._httpClient = serviceScope.consume(sp_http_1.SPHttpClient.serviceKey);\n        });\n        if (!suiteNavManagerConfiguration.isSuiteNavDisabled()) {\n            SPPageChrome_1.default.getInstance(this._serviceScope).changeSuiteNavHeight(SuiteNavManager._defaultSuiteNavHeight);\n        }\n    }\n    SuiteNavManager._updateCache = function (model, service) {\n        SuiteNavManager._cache.setValue(SuiteNavManager.DATA_KEY, model);\n        SuiteNavManager._cache.setValue(SuiteNavManager.DATE_KEY, new Date());\n        SuiteNavManager._cache.setValue(SuiteNavManager.VERSION_KEY, SuiteNavManager.CACHE_VERSION);\n        SuiteNavManager._cache.setValue(SuiteNavManager.SESSION_KEY, true, odsp_utilities_bundle_1.DataStoreCachingType.session);\n        SuiteNavManager._cache.setValue(SuiteNavManager.SERVICE_KEY, service);\n    };\n    SuiteNavManager._clearCache = function () {\n        SuiteNavManager._cache.remove(SuiteNavManager.DATA_KEY);\n        SuiteNavManager._cache.remove(SuiteNavManager.DATE_KEY);\n        SuiteNavManager._cache.remove(SuiteNavManager.VERSION_KEY);\n        SuiteNavManager._cache.remove(SuiteNavManager.SERVICE_KEY);\n    };\n    SuiteNavManager.prototype.setComponentVisibility = function (setVisible) {\n        var _this = this;\n        this._suiteNavDiv.hidden = !setVisible;\n        if (this._suiteNavModel) {\n            this._suiteNavModel.then(function (model) {\n                SPPageChrome_1.default.getInstance(_this._serviceScope).changeSuiteNavHeight(setVisible ?\n                    model.NavBarData.Dimensions.Top :\n                    '0px');\n            });\n        }\n    };\n    SuiteNavManager.prototype.loadSuiteNav = function () {\n        var _this = this;\n        if (!this._suiteNavManagerConfiguration.isSuiteNavDisabled()) {\n            this._suiteNavModel = this._getSuiteNavModel();\n            this._suiteNavModel\n                .then(function (suiteNavModel) { return _this._modifySuiteNavModel(suiteNavModel); })\n                .then(function (suiteNavModel) { return _this._getSuiteNavShell(suiteNavModel); })\n                .then(function (o365ShellWrapper) { return _this._renderSuiteNav(o365ShellWrapper); });\n        }\n    };\n    SuiteNavManager.prototype._getSuiteNavModel = function () {\n        if (this._isCacheValid() && !this._isCacheOutdated()) {\n            return this._loadSuiteNavFromCache();\n        }\n        else {\n            SuiteNavManager._clearCache();\n            return this._loadSuiteNavFromServer();\n        }\n    };\n    SuiteNavManager.prototype._loadSuiteNavFromCache = function () {\n        var _this = this;\n        return new Promise(function (complete) {\n            SuiteNavManager._cache.getValue(SuiteNavManager.SERVICE_KEY) ===\n                ISuiteNavDataSource_1.SuiteNavSource.SPO ?\n                _this._suiteNavDataSource = _this._createSPODataSource() :\n                _this._suiteNavDataSource = _this._createOnPremDataSource();\n            complete(SuiteNavManager._cache.getValue(SuiteNavManager.DATA_KEY));\n        });\n    };\n    SuiteNavManager.prototype._loadSuiteNavFromServer = function () {\n        var _this = this;\n        this._suiteNavDataSource = this._createSPODataSource();\n        var onPremDataSource = this._createOnPremDataSource();\n        var onPremSuiteNavResponse = onPremDataSource.loadData();\n        onPremSuiteNavResponse.catch(function () {\n            _this._createSuiteNavErrorLogEntry('loadData', 'Failed to retrieve Hybrid SuiteNavData');\n        });\n        return this._suiteNavDataSource.loadData().then(function (response) {\n            return response;\n        }).catch(function () {\n            _this._createSuiteNavErrorLogEntry('loadData', 'Failed to retrieve SPO SuiteNavData');\n            _this._suiteNavDataSource = onPremDataSource;\n            return onPremSuiteNavResponse;\n        });\n    };\n    SuiteNavManager.prototype._modifySuiteNavModel = function (suiteNavResponse) {\n        suiteNavResponse.NavBarData =\n            this._suiteNavManagerConfiguration.modifySuiteNavData(suiteNavResponse.NavBarData);\n        return suiteNavResponse;\n    };\n    SuiteNavManager.prototype._getSuiteNavShell = function (suiteNavModel) {\n        if (!suiteNavModel) {\n            this._createSuiteNavErrorLogEntry('getO365Shell', 'SuiteNavModel is undefined');\n        }\n        suiteNavModel.CacheToken = this._suiteNavManagerConfiguration.cacheToken;\n        suiteNavModel.UserIdentifier = this._suiteNavManagerConfiguration.systemUserKey;\n        SuiteNavManager._updateCache(suiteNavModel, this._suiteNavDataSource.suiteNavService);\n        SPPageChrome_1.default.getInstance(this._serviceScope).changeSuiteNavHeight(suiteNavModel.NavBarData.Dimensions.Top);\n        var element = document.createElement('link');\n        element.rel = 'stylesheet';\n        element.type = 'text/css';\n        element.href = suiteNavModel.CssUrl;\n        document.head.appendChild(element);\n        var promise = new Promise(function (complete) {\n            sp_loader_1.SPComponentLoader.loadScript(suiteNavModel.JsUrl, { globalExportsName: '_o365su' }).then(function () {\n                var o365Shell = new O365ShellWrapper_1.default();\n                o365Shell.SetData(suiteNavModel.NavBarData);\n                complete(o365Shell);\n            });\n        });\n        return promise;\n    };\n    SuiteNavManager.prototype._renderSuiteNav = function (o365Shell) {\n        var _this = this;\n        this._o365Shell = o365Shell;\n        this._o365Shell.RenderAsync(this._suiteNavManagerConfiguration.o365ShellRenderSettings, function () {\n            _this._onRender(o365Shell);\n        }, function () {\n            _this._onPostRender();\n        });\n        this._o365Shell.OnHasMember('LoadShellPlus', function () {\n            _this._loadShellPlus(_this._o365Shell);\n        });\n    };\n    SuiteNavManager.prototype._onRender = function (o365Shell) {\n        if (this._suiteNavManagerConfiguration.hamburgerCallback) {\n            if (o365Shell.Navigation.OnHamburgerButtonClick) {\n                o365Shell.Navigation.OnHamburgerButtonClick(this._suiteNavManagerConfiguration.hamburgerCallback);\n            }\n        }\n    };\n    SuiteNavManager.prototype._onPostRender = function () {\n        if (this._suiteNavManagerConfiguration.suiteNavPostRenderCallback) {\n            this._suiteNavManagerConfiguration.suiteNavPostRenderCallback();\n        }\n    };\n    SuiteNavManager.prototype._loadShellPlus = function (o365Shell) {\n        var _this = this;\n        return new Promise(function () {\n            o365Shell.LoadShellPlus();\n        }).catch(function (errorMessage) {\n            _this._createSuiteNavErrorLogEntry('loadShellPlus', errorMessage);\n        });\n    };\n    SuiteNavManager.prototype._isCacheValid = function () {\n        var model = SuiteNavManager._cache.getValue(SuiteNavManager.DATA_KEY);\n        var oldVersion = SuiteNavManager._cache.getValue(SuiteNavManager.VERSION_KEY);\n        return (model && model.NavBarData &&\n            ((model.JsUrl && model.CssUrl)) &&\n            oldVersion === SuiteNavManager.CACHE_VERSION &&\n            model.UserIdentifier &&\n            model.UserIdentifier === this._suiteNavManagerConfiguration.systemUserKey &&\n            model.CacheToken === this._suiteNavManagerConfiguration.cacheToken);\n    };\n    SuiteNavManager.prototype._isCacheOutdated = function () {\n        var cacheDate = Date.parse(SuiteNavManager._cache.getValue(SuiteNavManager.DATE_KEY));\n        var currentDate = new Date();\n        var cachedThisSession = SuiteNavManager._cache.getValue(SuiteNavManager.SESSION_KEY, odsp_utilities_bundle_1.DataStoreCachingType.session);\n        return (isNaN(cacheDate) ||\n            currentDate.getTime() - cacheDate > 24 * 60 * 60 * 1000 ||\n            (odsp_utilities_bundle_1.DataStore.hasStorageType(odsp_utilities_bundle_1.DataStoreCachingType.session) && !cachedThisSession));\n    };\n    SuiteNavManager.prototype._createSPODataSource = function () {\n        return new SPOSuiteNavDataSource_1.default(this._httpClient, this._suiteNavManagerConfiguration.currentUICultureName, this._suiteNavManagerConfiguration.webServerRelativeUrl);\n    };\n    SuiteNavManager.prototype._createOnPremDataSource = function () {\n        return new OnPremSuiteNavDataSource_1.default(this._httpClient, this._suiteNavManagerConfiguration.currentUICultureName, this._suiteNavManagerConfiguration.webServerRelativeUrl);\n    };\n    SuiteNavManager.prototype._createSuiteNavErrorLogEntry = function (moduleName, errorMessage) {\n        sp_telemetry_1._TraceLogger.logVerbose(SuiteNavManager._logSource, 'SuiteNavManager ' + moduleName + ' ' + errorMessage);\n    };\n    SuiteNavManager._defaultSuiteNavHeight = '50px';\n    SuiteNavManager.CACHE_PREFIX = 'SPPPLATSuiteNav';\n    SuiteNavManager.SERVICE_KEY = 'SuiteNavService';\n    SuiteNavManager.DATA_KEY = 'Data';\n    SuiteNavManager.DATE_KEY = 'CacheDate';\n    SuiteNavManager.VERSION_KEY = 'CacheVersion';\n    SuiteNavManager.SESSION_KEY = 'CachedThisSession';\n    SuiteNavManager.CACHE_VERSION = 1;\n    SuiteNavManager._cache = new odsp_utilities_bundle_1.DataStore(SuiteNavManager.CACHE_PREFIX, odsp_utilities_bundle_1.DataStoreCachingType.local);\n    SuiteNavManager._logSource = sp_telemetry_1._LogSource.create('SuiteNavManager');\n    return SuiteNavManager;\n}());\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.default = SuiteNavManager;\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./lib/local/common/suiteNav/SuiteNavManager.js\n// module id = 193\n// module chunks = 0\n\n\n// WEBPACK FOOTER //\n// webpack:///lib/local/common/suiteNav/SuiteNavManager.js","module.exports = __WEBPACK_EXTERNAL_MODULE_11__;\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"@microsoft/sp-loader\"\n// module id = 11\n// module chunks = 0","\"use strict\";\n(function (SuiteNavSource) {\n    SuiteNavSource[SuiteNavSource[\"SPO\"] = 0] = \"SPO\";\n    SuiteNavSource[SuiteNavSource[\"OnPrem\"] = 1] = \"OnPrem\";\n})(exports.SuiteNavSource || (exports.SuiteNavSource = {}));\nvar SuiteNavSource = exports.SuiteNavSource;\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./lib/local/common/suiteNav/dataAccess/ISuiteNavDataSource.js\n// module id = 195\n// module chunks = 0\n\n\n// WEBPACK FOOTER //\n// webpack:///lib/local/common/suiteNav/dataAccess/ISuiteNavDataSource.js","\"use strict\";\nvar ISuiteNavDataSource_1 = require('./ISuiteNavDataSource');\nvar sp_telemetry_1 = require('@ms/sp-telemetry');\nvar sp_http_1 = require('@microsoft/sp-http');\nvar SPOSuiteNavDataSource = (function () {\n    function SPOSuiteNavDataSource(httpClient, currentUICultureName, webServerRelativeUrl) {\n        this.suiteNavService = ISuiteNavDataSource_1.SuiteNavSource.SPO;\n        this._currentUICultureName = currentUICultureName;\n        this._spHttpClient = httpClient;\n        this._siteRelUrl = webServerRelativeUrl === '/' ? '' : webServerRelativeUrl;\n    }\n    SPOSuiteNavDataSource.prototype.loadData = function () {\n        var url = this._siteRelUrl\n            + '/_layouts/15/online/handlers/SpoSuiteLinks.ashx?Locale='\n            + this._currentUICultureName\n            + '&v=2&mobilereq=0&msajax=1';\n        return this._spHttpClient.post(url, sp_http_1.SPHttpClientConfigurations.v1, {})\n            .then(function (response) {\n            if (response.status !== 200 || response.headers.get('SharePointError')) {\n                sp_telemetry_1._TraceLogger.logVerbose(SPOSuiteNavDataSource._logSource, 'Failed to retrieve SPO SuiteNavData');\n                return Promise.reject('Failed to retrieve SPO SuiteNavData');\n            }\n            return response.json().then(function (jsonResponse) {\n                return jsonResponse;\n            });\n        });\n    };\n    SPOSuiteNavDataSource._logSource = sp_telemetry_1._LogSource.create('SPOSuiteNavDataSource');\n    return SPOSuiteNavDataSource;\n}());\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.default = SPOSuiteNavDataSource;\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./lib/local/common/suiteNav/dataAccess/SPOSuiteNavDataSource.js\n// module id = 196\n// module chunks = 0\n\n\n// WEBPACK FOOTER //\n// webpack:///lib/local/common/suiteNav/dataAccess/SPOSuiteNavDataSource.js","\"use strict\";\nvar SuiteNavManager_1 = require('../SuiteNavManager');\nvar ISuiteNavDataSource_1 = require('./ISuiteNavDataSource');\nvar sp_telemetry_1 = require('@ms/sp-telemetry');\nvar sp_http_1 = require('@microsoft/sp-http');\nvar OnPremSuiteNavDataSource = (function () {\n    function OnPremSuiteNavDataSource(httpClient, currentUICultureName, webServerRelativeUrl) {\n        this.suiteNavService = ISuiteNavDataSource_1.SuiteNavSource.OnPrem;\n        this._currentUICultureName = currentUICultureName;\n        this._spHttpClient = httpClient;\n        this._siteRelUrl = webServerRelativeUrl === '/' ? '' : webServerRelativeUrl;\n    }\n    OnPremSuiteNavDataSource.prototype.loadData = function () {\n        var _this = this;\n        var url = this._siteRelUrl\n            + '/_api/Microsoft.SharePoint.Portal.SuiteNavData.GetSuiteNavData?v=2&Locale='\n            + this._currentUICultureName;\n        return this._spHttpClient.get(url, sp_http_1.SPHttpClientConfigurations.v1)\n            .then(function (response) {\n            if (response.status !== 200) {\n                _this._logAndThrowSuiteNavLoadingError();\n            }\n            return response.json().then(function (jsonString) {\n                if (jsonString.value === '') {\n                    _this._logAndThrowSuiteNavLoadingError();\n                }\n                else {\n                    var suiteNavResponse = JSON.parse(jsonString.value);\n                    if (!suiteNavResponse.NavBarData.Dimensions) {\n                        suiteNavResponse.NavBarData.Dimensions = { Top: SuiteNavManager_1.default._defaultSuiteNavHeight };\n                    }\n                    return suiteNavResponse;\n                }\n            });\n        });\n    };\n    OnPremSuiteNavDataSource.prototype._logAndThrowSuiteNavLoadingError = function () {\n        sp_telemetry_1._TraceLogger.logVerbose(OnPremSuiteNavDataSource._logSource, 'Failed to retrieve Hybrid SuiteNavData');\n        throw new Error('Failed to retrieve Hybrid SuiteNavData');\n    };\n    OnPremSuiteNavDataSource._logSource = sp_telemetry_1._LogSource.create('OnPremSuiteNavDataSource');\n    return OnPremSuiteNavDataSource;\n}());\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.default = OnPremSuiteNavDataSource;\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./lib/local/common/suiteNav/dataAccess/OnPremSuiteNavDataSource.js\n// module id = 197\n// module chunks = 0\n\n\n// WEBPACK FOOTER //\n// webpack:///lib/local/common/suiteNav/dataAccess/OnPremSuiteNavDataSource.js","\"use strict\";\nvar FlexPaneWrapper_1 = require('./FlexPaneWrapper');\nvar NavigationWrapper_1 = require('./NavigationWrapper');\nvar O365ShellWrapper = (function () {\n    function O365ShellWrapper() {\n        this._postRenderSignal = new Promise(function () {\n            return;\n        });\n        this.FlexPane = new FlexPaneWrapper_1.default();\n        this.Navigation = new NavigationWrapper_1.default();\n    }\n    O365ShellWrapper.prototype.SetData = function (shellData) {\n        O365Shell.SetData(shellData);\n    };\n    O365ShellWrapper.prototype.Render = function (renderSettings, postRendercallback) {\n        O365Shell.Render(renderSettings, postRendercallback);\n    };\n    O365ShellWrapper.prototype.RenderAsync = function (renderSettings, renderCallback, postRenderCallback) {\n        O365Shell.RenderAsync(renderSettings, renderCallback, postRenderCallback);\n    };\n    O365ShellWrapper.prototype.LoadShellPlus = function () {\n        O365Shell.LoadShellPlus();\n    };\n    O365ShellWrapper.prototype.DoesShellExist = function () {\n        return typeof O365Shell !== 'undefined';\n    };\n    O365ShellWrapper.prototype.OnHasMember = function (memberName, callback) {\n        var _this = this;\n        if (this._hasMember(memberName)) {\n            callback();\n        }\n        else {\n            this._postRenderSignal.then(function () { return _this.OnHasMember(memberName, callback); });\n        }\n    };\n    O365ShellWrapper.prototype._hasMember = function (memberName) {\n        return this.DoesShellExist() && Boolean(O365Shell[memberName]);\n    };\n    return O365ShellWrapper;\n}());\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.default = O365ShellWrapper;\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./lib/local/common/suiteNav/O365ShellWrapper.js\n// module id = 198\n// module chunks = 0\n\n\n// WEBPACK FOOTER //\n// webpack:///lib/local/common/suiteNav/O365ShellWrapper.js","\"use strict\";\nvar sp_telemetry_1 = require('@ms/sp-telemetry');\nvar FlexPaneWrapper = (function () {\n    function FlexPaneWrapper() {\n    }\n    FlexPaneWrapper.prototype.OnFlexPaneVisibilityChanged = function (callback) {\n        try {\n            return O365Shell.FlexPane.OnFlexPaneVisibilityChanged(callback);\n        }\n        catch (e) {\n            this._createFlexPaneWrapperErrorLogEntry('OnFlexPaneVisibilityChanged', e);\n        }\n    };\n    FlexPaneWrapper.prototype.OpenFlexPaneForProvider = function (provider) {\n        try {\n            O365Shell.FlexPane.OpenFlexPaneForProvider(provider);\n        }\n        catch (e) {\n            this._createFlexPaneWrapperErrorLogEntry('OpenFlexPaneForProvider', e);\n        }\n    };\n    FlexPaneWrapper.prototype._createFlexPaneWrapperErrorLogEntry = function (moduleName, errorMessage) {\n        sp_telemetry_1._TraceLogger.logVerbose(FlexPaneWrapper.logSource, 'FlexPaneWrapper ' + moduleName + ' ' + errorMessage);\n    };\n    FlexPaneWrapper.logSource = sp_telemetry_1._LogSource.create('FlexPaneWrapper');\n    return FlexPaneWrapper;\n}());\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.default = FlexPaneWrapper;\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./lib/local/common/suiteNav/FlexPaneWrapper.js\n// module id = 199\n// module chunks = 0\n\n\n// WEBPACK FOOTER //\n// webpack:///lib/local/common/suiteNav/FlexPaneWrapper.js","\"use strict\";\nvar NavigationWrapper = (function () {\n    function NavigationWrapper() {\n    }\n    NavigationWrapper.prototype.OnLinkClick = function (callback) {\n        return O365Shell.Navigation.OnLinkClick(callback);\n    };\n    NavigationWrapper.prototype.OnHamburgerButtonClick = function (callback) {\n        return O365Shell.Navigation.OnHamburgerButtonClick(callback);\n    };\n    return NavigationWrapper;\n}());\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.default = NavigationWrapper;\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./lib/local/common/suiteNav/NavigationWrapper.js\n// module id = 200\n// module chunks = 0\n\n\n// WEBPACK FOOTER //\n// webpack:///lib/local/common/suiteNav/NavigationWrapper.js","\"use strict\";\nrequire('office-ui-fabric-react');\nvar SPThemeProvider_1 = require('./SPThemeProvider');\nvar sp_core_library_1 = require('@microsoft/sp-core-library');\nvar sp_client_base_1 = require('@microsoft/sp-client-base');\nrequire('./SPPageChrome.scss');\nvar SPPageChrome = (function () {\n    function SPPageChrome(serviceScope) {\n        this._createPageChrome();\n        if (!sp_core_library_1._SPKillSwitch.isActivated(sp_core_library_1.Guid.tryParse('48CB5A9D-4E94-40F0-B51F-24480C28E565'), '7/13/2016', 'EnableTheming')) {\n            this._spThemeProvider = new SPThemeProvider_1.default(serviceScope);\n            this._spThemeProvider.loadThemedStyles();\n        }\n    }\n    SPPageChrome.getInstance = function (serviceScope) {\n        if (SPPageChrome._instance === undefined) {\n            SPPageChrome._instance = new SPPageChrome(serviceScope);\n        }\n        return SPPageChrome._instance;\n    };\n    SPPageChrome.prototype.changeSuiteNavHeight = function (pixels) {\n        var top = parseInt(pixels, 10) + 'px';\n        this.appDiv.style.top = top;\n        this.appDiv.style.height = \"calc(100% - \" + top + \")\";\n        this.propertyPaneContainerDiv.style.top = top;\n        this.suiteNavDiv.style.height = top;\n    };\n    SPPageChrome.prototype._createPageChrome = function () {\n        document.body.className = 'ms-font-m';\n        var pageChromeDiv = document.createElement('div');\n        pageChromeDiv.setAttribute('class', 'SPPageChrome');\n        this.suiteNavDiv = document.createElement('div');\n        this.suiteNavDiv.setAttribute('id', 'SuiteNavPlaceHolder');\n        this.appDiv = document.createElement('div');\n        this.appDiv.setAttribute('class', 'SPPageChrome-app spPageContentTransition');\n        this.appDiv.setAttribute('id', 'spPageChromeAppDiv');\n        this.propertyPaneContainerDiv = document.createElement('div');\n        this.propertyPaneContainerDiv.setAttribute('class', 'spPropertyPaneContainer spPageContentTransition');\n        this.propertyPaneContainerDiv.setAttribute('id', 'spPropertyPaneContainer');\n        pageChromeDiv.appendChild(this.suiteNavDiv);\n        pageChromeDiv.appendChild(this.appDiv);\n        pageChromeDiv.appendChild(this.propertyPaneContainerDiv);\n        document.body.appendChild(pageChromeDiv);\n        if (this._shouldHandleGlobalErrors && !window.onerror) {\n            window.onerror = sp_client_base_1.SPGlobalErrorHandler.basicTracingHandler;\n        }\n    };\n    Object.defineProperty(SPPageChrome.prototype, \"_shouldHandleGlobalErrors\", {\n        get: function () {\n            return !sp_core_library_1._SPKillSwitch.isActivated(sp_core_library_1.Guid.tryParse('BAC66CD5-F1C1-4BDD-9FFD-A8C6044EB285'), '10/13/2016', 'GlobalErrorHandler');\n        },\n        enumerable: true,\n        configurable: true\n    });\n    return SPPageChrome;\n}());\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.default = SPPageChrome;\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./lib/local/common/spPageChrome/SPPageChrome.js\n// module id = 201\n// module chunks = 0\n\n\n// WEBPACK FOOTER //\n// webpack:///lib/local/common/spPageChrome/SPPageChrome.js","\"use strict\";\nvar odsp_utilities_bundle_1 = require('@ms/odsp-utilities-bundle');\nvar odsp_utilities_bundle_2 = require('@ms/odsp-utilities-bundle');\nvar odsp_utilities_bundle_3 = require('@ms/odsp-utilities-bundle');\nvar sp_telemetry_1 = require('@ms/sp-telemetry');\nvar sp_http_1 = require('@microsoft/sp-http');\nvar AppPageContext_1 = require('../../framework/pageContext/AppPageContext');\nvar SPWebTemplateIds_1 = require('./SPWebTemplateIds');\nvar load_themed_styles_1 = require('@microsoft/load-themed-styles');\nvar SPThemeProvider = (function () {\n    function SPThemeProvider(serviceScope) {\n        var _this = this;\n        serviceScope.whenFinished(function () {\n            _this._pageContext = serviceScope.consume(AppPageContext_1.appPageContextServiceKey);\n            _this._httpClient = serviceScope.consume(sp_http_1.SPHttpClient.serviceKey);\n            _this._themeProvider = new odsp_utilities_bundle_3.ThemeProvider(_this.loadData.bind(_this));\n            try {\n                var contextUri = new odsp_utilities_bundle_3.Uri(window.location.href);\n                _this._themeOverride = contextUri.getQueryParameter('ThemeOverride');\n            }\n            catch (ignoredUrlException) {\n            }\n        });\n    }\n    SPThemeProvider.prototype.loadThemedStyles = function () {\n        var cacheToken = this.getCacheToken();\n        this._themeProvider.loadThemeTokenMap(cacheToken)\n            .then(function (palette) {\n            load_themed_styles_1.loadTheme(palette);\n        });\n    };\n    SPThemeProvider.prototype.loadData = function () {\n        var _this = this;\n        var tagName = 'SPThemeProvider.loadData';\n        var qosMonitor = new sp_telemetry_1._QosMonitor(tagName);\n        if (this._pageContext.core.webTemplate) {\n            if (this._pageContext.core.webTemplate === SPWebTemplateIds_1.default.teamSite ||\n                this._pageContext.core.webTemplate === SPWebTemplateIds_1.default.groupSite) {\n                if (this._pageContext.core.themedCssFolderUrl) {\n                    var getThemeDataUrl_1 = odsp_utilities_bundle_3.WebTheme.makeWebThemeRestUrl(this._pageContext.core.siteServerRelativeUrl, this._pageContext.core.currentUICultureName, this._themeOverride);\n                    return new odsp_utilities_bundle_1.Promise(function (resolve, reject) {\n                        _this._httpClient.get(getThemeDataUrl_1, sp_http_1.SPHttpClientConfigurations.v1)\n                            .then(function (response) {\n                            if (response.status === 200) {\n                                return response.json()\n                                    .then(function (json) {\n                                    var themeDataRaw = JSON.parse(json.value);\n                                    if (themeDataRaw) {\n                                        var themeData = odsp_utilities_bundle_3.WebTheme.processRawThemeData(themeDataRaw);\n                                        themeData.cacheToken = _this._pageContext.core.themedCssFolderUrl;\n                                        qosMonitor.writeSuccess();\n                                        resolve(themeData);\n                                    }\n                                    else {\n                                        qosMonitor.writeUnexpectedFailure();\n                                        resolve(undefined);\n                                    }\n                                });\n                            }\n                            else {\n                                qosMonitor.writeUnexpectedFailure(tagName, new Error(response.statusText));\n                                resolve(undefined);\n                            }\n                        });\n                    });\n                }\n                else if (this._pageContext.core.groupColor) {\n                    var htmlThemeColor = this._pageContext.core.groupColor;\n                    var rgbaThemeColor = odsp_utilities_bundle_2.RgbaColor.fromHtmlColor(htmlThemeColor);\n                    if (rgbaThemeColor) {\n                        var fabTheme = {\n                            backgroundImageUri: undefined,\n                            cacheToken: this.getCacheToken(),\n                            isDefault: false,\n                            isInverted: false,\n                            palette: odsp_utilities_bundle_2.FabricTheming.generateFabricColors(rgbaThemeColor),\n                            version: '1'\n                        };\n                        return odsp_utilities_bundle_1.Promise.wrap(fabTheme);\n                    }\n                    else {\n                        return odsp_utilities_bundle_1.Promise.wrap();\n                    }\n                }\n                else {\n                    qosMonitor.writeSuccess();\n                    return odsp_utilities_bundle_1.Promise.wrap(this.createDefaultTheme());\n                }\n            }\n            else {\n                qosMonitor.writeExpectedFailure(\"Unsuppted WebTemplate: \" + this._pageContext.core.webTemplate);\n                return odsp_utilities_bundle_1.Promise.wrap(this.createDefaultTheme());\n            }\n        }\n        else {\n            qosMonitor.writeUnexpectedFailure(\"pageContext.core.webTemplate is undefined\");\n            return odsp_utilities_bundle_1.Promise.wrap(this.createDefaultTheme());\n        }\n    };\n    SPThemeProvider.prototype.createDefaultTheme = function () {\n        var themeData = {\n            backgroundImageUri: undefined,\n            cacheToken: undefined,\n            isDefault: undefined,\n            isInverted: false,\n            palette: undefined,\n            version: '1.0'\n        };\n        return themeData;\n    };\n    SPThemeProvider.prototype.getCacheToken = function () {\n        var webTemplate = String(this._pageContext.core.webTemplate);\n        var groupColor = webTemplate === SPWebTemplateIds_1.default.teamSite ||\n            webTemplate === SPWebTemplateIds_1.default.groupSite ? this._pageContext.core.groupColor : undefined;\n        var groupColorToken = groupColor && (groupColor + ';web#' + webTemplate);\n        return this._themeOverride || this._pageContext.core.themedCssFolderUrl || groupColorToken;\n    };\n    return SPThemeProvider;\n}());\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.default = SPThemeProvider;\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./lib/local/common/spPageChrome/SPThemeProvider.js\n// module id = 202\n// module chunks = 0\n\n\n// WEBPACK FOOTER //\n// webpack:///lib/local/common/spPageChrome/SPThemeProvider.js","\"use strict\";\nvar SPWebTemplateIds = (function () {\n    function SPWebTemplateIds() {\n    }\n    SPWebTemplateIds.teamSite = '1';\n    SPWebTemplateIds.groupSite = '64';\n    return SPWebTemplateIds;\n}());\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.default = SPWebTemplateIds;\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./lib/local/common/spPageChrome/SPWebTemplateIds.js\n// module id = 203\n// module chunks = 0\n\n\n// WEBPACK FOOTER //\n// webpack:///lib/local/common/spPageChrome/SPWebTemplateIds.js","require('SPPageChrome.css');\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./lib/local/common/spPageChrome/SPPageChrome.scss.js\n// module id = 204\n// module chunks = 0\n\n\n// WEBPACK FOOTER //\n// webpack:///lib/local/common/spPageChrome/SPPageChrome.scss.js","var content = require(\"!!./../../../../../../common/node_modules/css-loader/index.js?-minimize!./SPPageChrome.css\");\nvar loader = require(\"D:\\\\agent\\\\1\\\\_work\\\\24\\\\s\\\\common\\\\node_modules\\\\@microsoft\\\\load-themed-styles\\\\lib\\\\index.js\");\n\nif(typeof content === \"string\") content = [[module.id, content]];\n\n// add the styles to the DOM\nfor (var i = 0; i < content.length; i++) loader.loadStyles(content[i][1]);\n\nif(content.locals) module.exports = content.locals;\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./lib/local/common/spPageChrome/SPPageChrome.css\n// module id = 205\n// module chunks = 0\n\n\n// WEBPACK FOOTER //\n// webpack:///lib/local/common/spPageChrome/SPPageChrome.css?a787","exports = module.exports = require(\"./../../../../../../common/node_modules/css-loader/lib/css-base.js\")();\n// imports\n\n\n// module\nexports.push([module.id, \"body{overflow:hidden}#SuiteNavPlaceHolder{background-color:#333;position:absolute;width:100%;z-index:5}.SPPageChrome-app{position:absolute;right:0;bottom:0;left:0;overflow:visible}.spPropertyPaneContainer{top:50px;position:fixed;right:-340px;bottom:0;z-index:999}.spPageContentTransition{transition:right 367ms cubic-bezier(.1,.9,.2,1);-webkit-transition:right 367ms cubic-bezier(.1,.9,.2,1)}\", \"\"]);\n\n// exports\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// D:/agent/1/_work/24/s/common/~/css-loader?-minimize!./lib/local/common/spPageChrome/SPPageChrome.css\n// module id = 206\n// module chunks = 0\n\n\n// WEBPACK FOOTER //\n// webpack:///lib/local/common/spPageChrome/SPPageChrome.css","\"use strict\";\nvar sp_telemetry_1 = require('@ms/sp-telemetry');\nvar sp_core_library_1 = require('@microsoft/sp-core-library');\nvar sp_http_1 = require('@microsoft/sp-http');\nvar GuidHelpers_1 = require('../basicTypes/GuidHelpers');\nvar SPNavigationNode_1 = require('../pageContext/SPNavigationNode');\nvar PreloadedDataReader = (function () {\n    function PreloadedDataReader(preloadedData) {\n        this._preloadedData = preloadedData;\n        this._isValid = false;\n        if (this._preloadedData === undefined ||\n            !GuidHelpers_1.default.isValid(this._preloadedData.clientSideApplicationId)) {\n            sp_telemetry_1._TraceLogger.logVerbose(PreloadedDataReader._logSource, 'Warning: PreloadedDataReader: No preloaded data was found');\n        }\n        else {\n            this._isValid = true;\n        }\n    }\n    PreloadedDataReader._toNavNodes = function (srcNodes, pageContext) {\n        var items = new Array();\n        if (srcNodes) {\n            for (var i = 0; i < srcNodes.length; i++) {\n                var srcItem = srcNodes[i];\n                var item = new SPNavigationNode_1.default(pageContext);\n                item.load({ id: srcItem.Id });\n                item.updateOdataObject(srcItem);\n                items.push(item);\n            }\n        }\n        return items;\n    };\n    PreloadedDataReader.prototype.initializeDigestCache = function (serviceScope) {\n        var _this = this;\n        if (this._isValid) {\n            if (this._preloadedData.contextWebInfo\n                && this._preloadedData.spPageContextInfo\n                && this._preloadedData.spPageContextInfo.webServerRelativeUrl) {\n                serviceScope.whenFinished(function () {\n                    var digestCache = serviceScope.consume(sp_http_1.DigestCache.serviceKey);\n                    sp_telemetry_1._TraceLogger.logVerbose(PreloadedDataReader._logSource, 'PreloadedDataReader: Added preloaded FormDigestValue to cache');\n                    var expirationTimestamp = performance.now()\n                        + 1000 * _this._preloadedData.contextWebInfo.FormDigestTimeoutSeconds;\n                    digestCache.addDigestToCache(_this._preloadedData.spPageContextInfo.webServerRelativeUrl, _this._preloadedData.contextWebInfo.FormDigestValue, expirationTimestamp);\n                    digestCache.addDigestToCache(_this._preloadedData.spPageContextInfo.webAbsoluteUrl, _this._preloadedData.contextWebInfo.FormDigestValue, expirationTimestamp);\n                });\n            }\n        }\n    };\n    PreloadedDataReader.prototype.initializePageContext = function (pageContext) {\n        if (this._isValid) {\n            pageContext.application.load({\n                clientSideApplicationId: this._preloadedData.clientSideApplicationId,\n                hostedByClassicPage: false\n            });\n            pageContext.application.updateOdataObject(undefined);\n            pageContext.web.updateOdataObject(undefined);\n            pageContext.list.updateOdataObject(undefined);\n            pageContext.listItem.updateOdataObject(undefined);\n            pageContext.core.updateOdataObject(undefined);\n            if (sp_core_library_1._SPFlight.isEnabled(957 )) {\n                var pageData = this._preloadedData.page;\n                if (pageData) {\n                    pageContext.application.updateOdataObject(pageData);\n                }\n            }\n            var web = this._preloadedData.web;\n            if (web) {\n                pageContext.web.load({\n                    id: GuidHelpers_1.default.getNormalized(web.Id),\n                    serverRelativeUrl: web.ServerRelativeUrl,\n                    title: web.Title\n                });\n                pageContext.web.updateOdataObject(web);\n            }\n            var list = this._preloadedData.list;\n            if (list) {\n                pageContext.list.load({\n                    id: GuidHelpers_1.default.getNormalized(list.Id),\n                    title: list.Title,\n                    description: list.Description\n                });\n                pageContext.list.updateOdataObject(list);\n            }\n            var listItem = this._preloadedData.item;\n            if (listItem) {\n                pageContext.listItem.load({\n                    id: listItem.ID\n                });\n                pageContext.listItem.updateOdataObject(listItem);\n            }\n            var user = this._preloadedData.user;\n            if (user) {\n                pageContext.user.load({\n                    id: user.Id\n                });\n                pageContext.user.updateOdataObject(user);\n            }\n            var spPageContextInfo = this._preloadedData.spPageContextInfo;\n            if (spPageContextInfo) {\n                pageContext.core.load({\n                    MenuData: spPageContextInfo.MenuData,\n                    currentCultureName: spPageContextInfo.currentCultureName,\n                    currentUICultureName: spPageContextInfo.currentUICultureName,\n                    correlationId: spPageContextInfo.CorrelationId,\n                    spoEnvironment: spPageContextInfo.env,\n                    farmLabel: spPageContextInfo.farmLabel,\n                    groupColor: spPageContextInfo.groupColor,\n                    hasManageWebPermission: spPageContextInfo.hasManageWebPermission,\n                    isWebWelcomePage: spPageContextInfo.isWebWelcomePage,\n                    layoutsUrl: spPageContextInfo.layoutsUrl,\n                    listPermsMask: spPageContextInfo.listPermsMask,\n                    siteAbsoluteUrl: spPageContextInfo.siteAbsoluteUrl,\n                    siteClientTag: spPageContextInfo.siteClientTag,\n                    siteId: spPageContextInfo.siteId,\n                    sitePagesEnabled: spPageContextInfo.sitePagesEnabled,\n                    siteServerRelativeUrl: spPageContextInfo.siteServerRelativeUrl,\n                    siteSubscriptionId: spPageContextInfo.siteSubscriptionId,\n                    systemUserKey: spPageContextInfo.systemUserKey,\n                    themedCssFolderUrl: spPageContextInfo.themedCssFolderUrl,\n                    userDisplayName: spPageContextInfo.userDisplayName,\n                    userLoginName: spPageContextInfo.userLoginName,\n                    webAbsoluteUrl: spPageContextInfo.webAbsoluteUrl,\n                    webId: spPageContextInfo.webId,\n                    webLogoUrl: spPageContextInfo.webLogoUrl,\n                    webServerRelativeUrl: spPageContextInfo.webServerRelativeUrl,\n                    webTitle: spPageContextInfo.webTitle,\n                    webTemplate: spPageContextInfo.webTemplate,\n                    webPermMasks: spPageContextInfo.webPermMasks\n                });\n                pageContext.core.updateOdataObject(spPageContextInfo);\n            }\n        }\n        else if (window['_spPageContextInfo'] !== undefined) {\n            pageContext.application.load({\n                clientSideApplicationId: '00000000-0000-0000-0000-000000000000',\n                hostedByClassicPage: true\n            });\n            pageContext.web.load({\n                id: '00000000-0000-0000-0000-000000000000',\n                serverRelativeUrl: _spPageContextInfo.webServerRelativeUrl,\n                title: _spPageContextInfo.webTitle\n            });\n            if (_spPageContextInfo.pageListId) {\n                pageContext.list.load({\n                    id: GuidHelpers_1.default.getNormalized(_spPageContextInfo.pageListId),\n                    title: '',\n                    description: ''\n                });\n                if (_spPageContextInfo.pageItemId) {\n                    pageContext.listItem.load({\n                        id: _spPageContextInfo.pageItemId\n                    });\n                }\n            }\n        }\n        else {\n        }\n        if (this._preloadedData.spPageContextInfo && this._preloadedData.spPageContextInfo.navigationInfo) {\n            this._initNav(pageContext.quickLaunch, this._preloadedData.spPageContextInfo.navigationInfo.quickLaunch, pageContext);\n            this._initNav(pageContext.topNav, this._preloadedData.spPageContextInfo.navigationInfo.topNav, pageContext);\n        }\n    };\n    PreloadedDataReader.prototype._initNav = function (target, source, pageContext) {\n        if (!target || !source) {\n            return;\n        }\n        target.updateOdataObject(source);\n        var items = PreloadedDataReader._toNavNodes(source, pageContext);\n        target.items = items;\n    };\n    PreloadedDataReader._logSource = sp_telemetry_1._LogSource.create('PreloadedDataReader');\n    return PreloadedDataReader;\n}());\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.default = PreloadedDataReader;\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./lib/local/framework/shell/PreloadedDataReader.js\n// module id = 207\n// module chunks = 0\n\n\n// WEBPACK FOOTER //\n// webpack:///lib/local/framework/shell/PreloadedDataReader.js","\"use strict\";\nvar odsp_utilities_bundle_1 = require('@ms/odsp-utilities-bundle');\nvar sp_telemetry_1 = require('@ms/sp-telemetry');\n(function (UserPhotoSize) {\n    UserPhotoSize[UserPhotoSize[\"Small\"] = 1] = \"Small\";\n    UserPhotoSize[UserPhotoSize[\"Medium\"] = 2] = \"Medium\";\n    UserPhotoSize[UserPhotoSize[\"Large\"] = 3] = \"Large\";\n})(exports.UserPhotoSize || (exports.UserPhotoSize = {}));\nvar UserPhotoSize = exports.UserPhotoSize;\nvar AlternativeUrlMap = (function () {\n    function AlternativeUrlMap() {\n    }\n    AlternativeUrlMap.tryGetAlternativeUrl = function (primaryUrl) {\n        var qosMonitor = new sp_telemetry_1._QosMonitor('tryGetAlternativeUrl');\n        try {\n            if (AlternativeUrlMap._urlTable) {\n                var alternativeUrl = AlternativeUrlMap._urlTable.get(primaryUrl);\n                if (alternativeUrl) {\n                    var uri = new odsp_utilities_bundle_1.Uri(alternativeUrl);\n                    if (uri) {\n                        var authToken = uri.getQueryParameter('_eat_');\n                        if (authToken) {\n                            var split = authToken.split('_');\n                            if (split && split.length === 2 && split[0] && Number(split[0])) {\n                                var expirationTime = Number(split[0]);\n                                expirationTime -= 30;\n                                if (((new Date()).getTime() / 1000) > expirationTime) {\n                                    AlternativeUrlMap._urlTable.delete(primaryUrl);\n                                    qosMonitor.writeExpectedFailure('PrivateCdnUrlExpired');\n                                    return undefined;\n                                }\n                            }\n                            else {\n                                qosMonitor.writeUnexpectedFailure('EatParamUnexpectedFormat', undefined, [{ 'eatParam': authToken }]);\n                            }\n                        }\n                    }\n                    qosMonitor.writeSuccess([{ 'alternativeUrlFound': true }]);\n                    return alternativeUrl;\n                }\n            }\n        }\n        catch (error) {\n            qosMonitor.writeUnexpectedFailure('Unexpected', error);\n        }\n        qosMonitor.writeSuccess([{ 'alternativeUrlFound': false }]);\n        return undefined;\n    };\n    AlternativeUrlMap.updateMap = function (alternativeUrlTable) {\n        if (!alternativeUrlTable) {\n            return;\n        }\n        Object.keys(alternativeUrlTable).forEach(function (key) {\n            AlternativeUrlMap._urlTable.set(key, alternativeUrlTable[key]);\n        });\n    };\n    Object.defineProperty(AlternativeUrlMap, \"UrlTable\", {\n        get: function () {\n            return AlternativeUrlMap._urlTable;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    AlternativeUrlMap.getUserPhotoUrl = function (accountName, size) {\n        var userPhotoBaseUrl = AlternativeUrlMap.tryGetAlternativeUrl('UserPhotoAspx');\n        if (!userPhotoBaseUrl) {\n            userPhotoBaseUrl = '/_layouts/15/userphoto.aspx';\n        }\n        var userPhotoUri = new odsp_utilities_bundle_1.Uri(userPhotoBaseUrl);\n        if (!size) {\n            size = UserPhotoSize.Small;\n        }\n        if (!accountName) {\n            accountName = '';\n        }\n        var sizeLetter;\n        switch (size) {\n            case UserPhotoSize.Medium:\n                sizeLetter = 'M';\n                break;\n            case UserPhotoSize.Large:\n                sizeLetter = 'L';\n                break;\n            default:\n                sizeLetter = 'S';\n        }\n        userPhotoUri.setQueryParameter('size', sizeLetter);\n        userPhotoUri.setQueryParameter('accountname', accountName);\n        return userPhotoUri.toString();\n    };\n    AlternativeUrlMap._urlTable = new Map();\n    return AlternativeUrlMap;\n}());\nexports.AlternativeUrlMap = AlternativeUrlMap;\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./lib/local/alternativeUrls/alternativeUrls.js\n// module id = 208\n// module chunks = 0\n\n\n// WEBPACK FOOTER //\n// webpack:///lib/local/alternativeUrls/alternativeUrls.js","\"use strict\";\nvar lodash = require('@microsoft/sp-lodash-subset');\nfunction getPathNameFromAbsoluteUrl(url) {\n    var anchorElement = document.createElement('a');\n    anchorElement.href = url;\n    var pathName = anchorElement.pathname;\n    if (pathName.charAt(0) !== '/') {\n        pathName = '/' + pathName;\n    }\n    return pathName;\n}\nexports.getPathNameFromAbsoluteUrl = getPathNameFromAbsoluteUrl;\nfunction combineURLPaths() {\n    var url = [];\n    for (var _i = 0; _i < arguments.length; _i++) {\n        url[_i - 0] = arguments[_i];\n    }\n    var fullURLPath = '';\n    for (var i = 0; i < url.length; i++) {\n        fullURLPath += lodash.trimEnd(url[i], '/');\n    }\n    return fullURLPath;\n}\nexports.combineURLPaths = combineURLPaths;\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./lib/local/utilities/url/UrlUtilities.js\n// module id = 209\n// module chunks = 0\n\n\n// WEBPACK FOOTER //\n// webpack:///lib/local/utilities/url/UrlUtilities.js","module.exports = __WEBPACK_EXTERNAL_MODULE_12__;\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"@microsoft/sp-lodash-subset\"\n// module id = 12\n// module chunks = 0","\"use strict\";\nvar __extends = (this && this.__extends) || function (d, b) {\n    for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p];\n    function __() { this.constructor = d; }\n    d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n};\nvar __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\n};\nvar ReactDom = require('react-dom');\nvar sp_telemetry_1 = require('@ms/sp-telemetry');\nvar odsp_utilities_bundle_1 = require('@ms/odsp-utilities-bundle');\nvar office_ui_fabric_react_1 = require('office-ui-fabric-react');\nvar sp_lodash_subset_1 = require('@microsoft/sp-lodash-subset');\nvar BaseRte_1 = require('../BaseRte');\nvar CKEditorForWebPartRte_1 = require('./CKEditorForWebPartRte');\nvar SPRteCKEditorConfiguration_1 = require('../SPRteCKEditorConfiguration');\nvar RteA11y_1 = require('../../a11y/RteA11y');\nvar RteStrings_resx_1 = require('../../loc/RteStrings.resx');\nvar WebPartRte = (function (_super) {\n    __extends(WebPartRte, _super);\n    function WebPartRte(props) {\n        _super.call(this, props, WebPartRte.defaultOptions);\n        this.TAG_NAME = 'WebPartRte.';\n    }\n    WebPartRte._getFormattingBarDefaultPosition = function (isRtl) {\n        if (isRtl === void 0) { isRtl = false; }\n        var left = isRtl ? undefined : 0;\n        var top = -202;\n        var position = 'relative';\n        var right = isRtl ? 0 : undefined;\n        return { left: left, top: top, position: position, right: right };\n    };\n    WebPartRte.prototype._initState = function () {\n        this.state = {\n            displayMode: this.props.displayMode,\n            formattingBarPosition: WebPartRte._getFormattingBarDefaultPosition(this._isRtl),\n            isFormattingBarHidden: false,\n            isLinkDialogOpen: false\n        };\n    };\n    WebPartRte.prototype._afterEditorCreated = function (editor) {\n        this._editor = editor;\n        this._handleTextChange();\n        var formattingbarElement = ReactDom.findDOMNode(this._formattingbar);\n        this._editorElement.style.position = 'relative';\n        this._editorElement.style.top = formattingbarElement.offsetHeight + \"px\";\n        formattingbarElement.style.top = \"-\" + this._editorElement.offsetHeight + \"px\";\n        this._editorElement.setAttribute('aria-label', odsp_utilities_bundle_1.StringHelper.format(RteStrings_resx_1.default.RichTextEditorIframeTitle, this.props.ariaLabel || '', RteStrings_resx_1.default.RichTextEditorAriaLabel));\n        var iframe = this._editorElement.querySelector('iframe');\n        if (iframe) {\n            iframe.contentDocument.addEventListener('paste', this._onBeforePaste, true);\n            iframe.contentDocument.addEventListener('keydown', this._handleKeyDown);\n        }\n    };\n    WebPartRte.prototype._finalizeAction = function (ariaActionName) {\n        _super.prototype._finalizeAction.call(this, ariaActionName);\n        if (this.props.onChanged) {\n            this.props.onChanged(this._editor ? this._editor.getHTML() : this.props.innerHTML);\n        }\n    };\n    WebPartRte.prototype._handleKeyDown = function (evt) {\n        if (RteA11y_1.isKey(RteA11y_1.KeyCodes.F10, evt, true) && this._formattingbarElement) {\n            sp_telemetry_1._EngagementLogger.logEvent(this.TAG_NAME + 'ToolbarByKeyboardShortcut.Focus', evt.type);\n            RteA11y_1.navigateInside(this._formattingbarElement);\n            var screenReaderInstruction = odsp_utilities_bundle_1.StringHelper.format(RteStrings_resx_1.default.RichTextNavigationAltF10Keys, RteStrings_resx_1.default.ToolbarNavigationArrowKeys, RteStrings_resx_1.default.ToolbarNavigationShiftTabKey);\n            RteA11y_1.ariaAlert(screenReaderInstruction);\n            evt.stopPropagation();\n            evt.preventDefault();\n        }\n        else if (RteA11y_1.isKey('K'.charCodeAt(0), evt, false, true)) {\n            this._handleLink();\n            evt.stopPropagation();\n            evt.preventDefault();\n        }\n        else {\n            this._redispatchKeyboardEvent(evt);\n        }\n    };\n    WebPartRte.prototype._redispatchKeyboardEvent = function (evt) {\n        var emptyEvent = document.createEvent('Event');\n        emptyEvent.initEvent(evt.type, true, true);\n        var clonedEvent = sp_lodash_subset_1.merge(emptyEvent, {\n            keyCode: evt.keyCode,\n            code: evt.code,\n            which: evt.which,\n            altKey: evt.altKey,\n            ctrlKey: evt.ctrlKey\n        });\n        if (this._editorElement) {\n            this._editorElement.dispatchEvent(clonedEvent);\n        }\n    };\n    WebPartRte.defaultOptions = {\n        editor: CKEditorForWebPartRte_1.default,\n        config: new SPRteCKEditorConfiguration_1.default(),\n        loader: CKEditorForWebPartRte_1.default.moduleLoader\n    };\n    __decorate([\n        office_ui_fabric_react_1.autobind\n    ], WebPartRte.prototype, \"_handleKeyDown\", null);\n    return WebPartRte;\n}(BaseRte_1.BaseRte));\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.default = WebPartRte;\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./lib/local/appBase/components/sp-rte/rte/webPartRte/WebPartRte.js\n// module id = 211\n// module chunks = 0\n\n\n// WEBPACK FOOTER //\n// webpack:///lib/local/appBase/components/sp-rte/rte/webPartRte/WebPartRte.js","\"use strict\";\nvar __extends = (this && this.__extends) || function (d, b) {\n    for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p];\n    function __() { this.constructor = d; }\n    d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n};\nvar sp_telemetry_1 = require('@ms/sp-telemetry');\nvar CKTextEditor_1 = require('../../ckeditor/CKTextEditor');\nvar CKEditorForWebPartRte = (function (_super) {\n    __extends(CKEditorForWebPartRte, _super);\n    function CKEditorForWebPartRte(config, currentHTML, editorElement, selectionChangeCallback, textChangeCallback, startUpFocus, onReadyCallback) {\n        _super.call(this, config, currentHTML, editorElement, selectionChangeCallback, textChangeCallback, startUpFocus, onReadyCallback);\n        this._ckEditorConfig = {\n            allowedContent: true,\n            disableNativeSpellChecker: false,\n            on: {\n                change: this._handleTextChange,\n                selectionChange: this._handleSelectionChangeConvert\n            },\n            removePlugins: 'toolbar,contextmenu,menubutton,scayt,liststyle,tabletools,magicline,link ,resize,autogrow,elementspath',\n            extraPlugins: 'justify',\n            removeButtons: '',\n            stylesSet: false,\n            toolbar: [],\n            startupFocus: this._startupFocus,\n            fullPage: false,\n            resize_enabled: false,\n            width: '100%',\n            height: 200\n        };\n        this._initialize(currentHTML);\n    }\n    CKEditorForWebPartRte.createNewEditor = function (config, currentHTML, editorElement, selectionChangeCallback, textChangeCallback, startupFocus) {\n        return new Promise(function (resolve) {\n            CKEditorForWebPartRte.moduleLoader.loadModule(config.editorSource).then(function () {\n                var editor = new CKEditorForWebPartRte(config, currentHTML, editorElement, selectionChangeCallback, textChangeCallback, startupFocus, function () { resolve(editor); });\n            }).catch(function (error) {\n                sp_telemetry_1._TraceLogger.logError(CKEditorForWebPartRte.logSource, error);\n            });\n        });\n    };\n    CKEditorForWebPartRte.prototype._initialize = function (currentHTML) {\n        if (!this._ckEditorConfig) {\n            return;\n        }\n        var textPart = document.createElement('textarea');\n        this._editorElement.appendChild(textPart);\n        this._editor = CKEDITOR.replace(textPart, this._ckEditorConfig);\n        this._editor.setData(currentHTML);\n        this._addCustomToolbarCommands();\n    };\n    CKEditorForWebPartRte.logSource = sp_telemetry_1._LogSource.create('CKEditorForWebPartRte');\n    return CKEditorForWebPartRte;\n}(CKTextEditor_1.default));\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.default = CKEditorForWebPartRte;\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./lib/local/appBase/components/sp-rte/rte/webPartRte/CKEditorForWebPartRte.js\n// module id = 212\n// module chunks = 0\n\n\n// WEBPACK FOOTER //\n// webpack:///lib/local/appBase/components/sp-rte/rte/webPartRte/CKEditorForWebPartRte.js","define([], function() {\r\n  var strings = {\n    \"_oflHTFVm9vC1S7l66uvnQQ\": {\n      \"AriaWebPartEnterTemplate\": \"{0}. Press Enter to enter the web part. When inside, use Alt+F10 to go to toolbar, use Alt+P to move focus to the property pane and use Escape to exit the web part.\",\n      \"CanvasZoneAriaGoToToolbar\": \"Press enter to focus inside the web part. After you are in the web part, press escape to return to the toolbar.\",\n      \"CanvasZoneAriaGoToWebPart\": \"Press enter to go to the web part's toolbar, you can then press escape to return here.\",\n      \"CanvasZoneAriaWebpartName\": \"{0} Web Part\",\n      \"ConfirmationDialogYes\": \"Yes\",\n      \"ConfirmationDialogNo\": \"No\",\n      \"DeleteConfirmationDialogTitle\": \"Delete Confirmation\",\n      \"DeleteConfirmationDialogMessage\": \"Are you sure you want to delete this web part?\",\n      \"TextWebPartPlaceholder\": \"Type your text here\",\n      \"TextWebPartDisplayName\": \"Text\",\n      \"TextWebpartDescription\": \"Add text to your page\",\n      \"ToolbarConfigButtonTitle\": \"Configure element\",\n      \"ToolbarDeleteButtonTitle\": \"Delete element\",\n      \"ToolbarNavigationArrowKeys\": \"Use arrow keys to navigate inside the toolbar.\",\n      \"ToolboxAriaLoadingAlert\": \"The toolbox is loading web parts.\",\n      \"ToolboxAriaLoadingFinishedAlert\": \"The toolbox finished loading web parts.\",\n      \"ToolboxErrorMessage\": \"There was an error fetching the web parts. Not all web parts may be available.\",\n      \"ToolboxGroupNameFeatured\": \"Featured\",\n      \"ToolboxGroupNameNonFeatured\": \"Non Featured\",\n      \"ToolboxHintTitle\": \"Add a new web part\",\n      \"ToolboxNavigationArrowKeys\": \"{0} Use Left or Right to navigate. Use Enter to add the selected web part.\",\n      \"CanvasItems\": \"{0} items in the toolbar.||{0} item in the toolbar.||{0} items in the toolbar.\",\n      \"CanvasItemsInterval\": \"0||1||2-\",\n      \"ToolboxSectionHeader\": \"Section\",\n      \"ToolboxTwoColumnPart\": \"Two Columns\",\n      \"ToolboxThreeColumnPart\": \"Three Columns\",\n      \"ToolboxOneThirdRightColumnPart\": \"One Third Right Column\"\n    },\n    \"_HZH0fzNkDqTJ/5fF9kAU6A\": {\n      \"FormattingBarAlignCenterButtonTitle\": \"Center\",\n      \"FormattingBarAlignLeftButtonTitle\": \"Align left\",\n      \"FormattingBarAlignRightButtonTitle\": \"Align right\",\n      \"FormattingBarBoldButtonTitle\": \"Bold\",\n      \"FormattingBarBulletListButtonTitle\": \"Bulleted list\",\n      \"FormattingBarClearFormattingButtonTitle\": \"Clear all formatting\",\n      \"FormattingBarConfirmAction\": \"Action {0} performed.\",\n      \"FormattingBarConfirmActionOnSelection\": \"Action {0} performed on selected text: {1}\",\n      \"FormattingBarNormalTextButtonTitle\": \"Normal text\",\n      \"FormattingBarHeading2ButtonTitle\": \"Heading 1\",\n      \"FormattingBarHeading3ButtonTitle\": \"Heading 2\",\n      \"FormattingBarHeading4ButtonTitle\": \"Heading 3\",\n      \"FormattingBarQuoteButtonTitle\": \"Pull quote\",\n      \"FormattingBarItalicButtonTitle\": \"Italic\",\n      \"FormattingBarLinkButtonTitle\": \"Hyperlink\",\n      \"FormattingBarNumberedListButtonTitle\": \"Numbered list\",\n      \"FormattingBarUnderlineButtonTitle\": \"Underline\",\n      \"FormattingBarUnlinkButtonTitle\": \"Remove hyperlink\",\n      \"LinkDialogErrorNotSupportedLink\": \"This link type is not supported.\",\n      \"LinkDialogTextFieldAriaLabel\": \"Web address to link to\",\n      \"LinkDialogTextFieldLabel\": \"Web address:\",\n      \"LinkDialogTitle\": \"Insert link\",\n      \"RichTextEditorAriaLabel\": \"Rich Text Editor. Use Alt+F10 to go to toolbars.\",\n      \"RichTextEditorTitle\": \"Rich Text Editor.\",\n      \"RichTextEditorIframeTitle\": \"***{0} {1}\",\n      \"RichTextLinkDialogCancelButtonLabel\": \"Cancel\",\n      \"RichTextLinkDialogSaveButtonLabel\": \"Save\",\n      \"RichTextNavigationAltF10Keys\": \"***{0} {1}\",\n      \"TextWebPartPlaceholder\": \"Type your text here\",\n      \"ToolbarNavigationArrowKeys\": \"Use arrow keys to navigate inside the toolbar.\",\n      \"ToolbarNavigationTabKeys\": \"Use tab to switch between toolbars.\",\n      \"ToolbarNavigationShiftTabKey\": \"***Use shift + tab to navigate back to textbox\"\n    }\n  };\r\n\r\n  strings.default = strings;\r\n  return strings;\r\n});\n\n\n//////////////////\n// WEBPACK FOOTER\n// ../lib/resx-strings/en-us.js\n// module id = 7\n// module chunks = 0"],"sourceRoot":""}