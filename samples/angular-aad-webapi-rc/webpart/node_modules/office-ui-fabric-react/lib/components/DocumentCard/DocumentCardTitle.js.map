{"version":3,"sources":["components/DocumentCard/DocumentCardTitle.tsx"],"names":[],"mappings":"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","file":"components/DocumentCard/DocumentCardTitle.js","sourcesContent":["/* tslint:disable:no-unused-variable */\r\nimport * as React from 'react';\r\n/* tslint:enable:no-unused-variable */\r\n\r\nimport { IDocumentCardTitleProps } from './DocumentCard.Props';\r\nimport { BaseComponent } from '../../common/BaseComponent';\r\nimport { autobind } from '../../utilities/autobind';\r\nimport './DocumentCardTitle.scss';\r\n\r\nexport interface IDocumentCardTitleState {\r\n  truncatedTitleFirstPiece?: string;\r\n  truncatedTitleSecondPiece?: string;\r\n}\r\n\r\nconst TRUNCATION_SEPARATOR = '&hellip;';\r\nconst TRUNCATION_MINIMUM_LENGTH = 40; // This is the length we know can fit into the min width of DocumentCard.\r\nconst TRUNCATION_MAXIMUM_LENGTH = 90 - TRUNCATION_SEPARATOR.length;\r\nconst TRUNCATION_FIRST_PIECE_LONGER_BY = 10;\r\nconst TRUNCATION_VERTICAL_OVERFLOW_THRESHOLD = 5;\r\n\r\nexport class DocumentCardTitle extends BaseComponent<IDocumentCardTitleProps, IDocumentCardTitleState> {\r\n  private _titleElement: HTMLDivElement;\r\n  private _scrollTimerId: number;\r\n  private _truncatedTitleAtWidth: number;\r\n  private _isTruncated: boolean;\r\n\r\n  constructor(props: IDocumentCardTitleProps) {\r\n    super(props);\r\n\r\n    this.state = {\r\n      truncatedTitleFirstPiece: '',\r\n      truncatedTitleSecondPiece: ''\r\n    };\r\n  }\r\n\r\n  public componentDidMount() {\r\n    let { title, shouldTruncate } = this.props;\r\n    if (shouldTruncate && title && title.length > TRUNCATION_MINIMUM_LENGTH) {\r\n      if (this._doesTitleOverflow()) {\r\n        this._startTruncation(this.props);\r\n      }\r\n      this._events.on(window, 'resize', this._updateTruncation);\r\n    }\r\n  }\r\n\r\n  public componentWillReceiveProps(newProps: IDocumentCardTitleProps) {\r\n    this._events.off(window, 'resize');\r\n    this._isTruncated = false;\r\n\r\n    if (newProps.shouldTruncate && newProps.title && newProps.title.length > TRUNCATION_MINIMUM_LENGTH) {\r\n      this._startTruncation(newProps);\r\n      this._events.on(window, 'resize', this._updateTruncation);\r\n    }\r\n  }\r\n\r\n  public componentDidUpdate() {\r\n    // If we're truncating, make sure the title fits\r\n    if (this.props.shouldTruncate) {\r\n      this._shrinkTitle();\r\n    }\r\n  }\r\n\r\n  public render() {\r\n    let { title, shouldTruncate } = this.props;\r\n    let { truncatedTitleFirstPiece, truncatedTitleSecondPiece } = this.state;\r\n\r\n    let documentCardTitle;\r\n    if (shouldTruncate && this._isTruncated) {\r\n      documentCardTitle = (\r\n        <div className='ms-DocumentCardTitle' ref={ this._resolveRef('_titleElement') } title={ title }>{ truncatedTitleFirstPiece }&hellip;{ truncatedTitleSecondPiece }</div>\r\n      );\r\n    } else {\r\n      documentCardTitle = (\r\n        <div className='ms-DocumentCardTitle' ref={ this._resolveRef('_titleElement') } title={ title }>{ title }</div>\r\n      );\r\n    }\r\n\r\n    return documentCardTitle;\r\n  }\r\n\r\n  @autobind\r\n  private _startTruncation(props: IDocumentCardTitleProps) {\r\n    let originalTitle = props.title;\r\n    this._isTruncated = false;\r\n\r\n    // If the title is really short, there's no need to truncate it\r\n    if (originalTitle && originalTitle.length >= TRUNCATION_MINIMUM_LENGTH) {\r\n\r\n      // Break the text into two pieces for assembly later\r\n      if (originalTitle.length > TRUNCATION_MAXIMUM_LENGTH) {\r\n        // The text is really long, so we can take a chunk out of the middle so the two pieces combine for the maximum length\r\n        this._isTruncated = true;\r\n        this.setState({\r\n          truncatedTitleFirstPiece: originalTitle.slice(0, TRUNCATION_MAXIMUM_LENGTH / 2 + TRUNCATION_FIRST_PIECE_LONGER_BY),\r\n          truncatedTitleSecondPiece: originalTitle.slice(originalTitle.length - (TRUNCATION_MAXIMUM_LENGTH / 2 - TRUNCATION_FIRST_PIECE_LONGER_BY))\r\n        });\r\n      } else {\r\n        // The text is not so long, so we'll just break it into two pieces\r\n        this.setState({\r\n          truncatedTitleFirstPiece: originalTitle.slice(0, Math.ceil(originalTitle.length / 2) + TRUNCATION_FIRST_PIECE_LONGER_BY),\r\n          truncatedTitleSecondPiece: originalTitle.slice(originalTitle.length - Math.floor(originalTitle.length / 2) + TRUNCATION_FIRST_PIECE_LONGER_BY)\r\n        });\r\n      }\r\n    }\r\n\r\n    // Save the width we just started truncation at, so that later we will only update truncation if necessary\r\n    this._truncatedTitleAtWidth = this._titleElement.clientWidth;\r\n\r\n  }\r\n\r\n  private _shrinkTitle() {\r\n    if (this._doesTitleOverflow()) {\r\n      let { truncatedTitleFirstPiece, truncatedTitleSecondPiece } = this.state;\r\n      this._isTruncated = true;\r\n\r\n      if (!truncatedTitleFirstPiece && !truncatedTitleSecondPiece) {\r\n        this._startTruncation(this.props);\r\n      }\r\n\r\n      this.setState({\r\n        truncatedTitleFirstPiece: truncatedTitleFirstPiece.slice(0, truncatedTitleFirstPiece.length - 1),\r\n        truncatedTitleSecondPiece: truncatedTitleSecondPiece.slice(1)\r\n      });\r\n    }\r\n  }\r\n\r\n  private _doesTitleOverflow(): boolean {\r\n    let titleElement = this._titleElement;\r\n    return titleElement.scrollHeight > titleElement.clientHeight + TRUNCATION_VERTICAL_OVERFLOW_THRESHOLD || titleElement.scrollWidth > titleElement.clientWidth;\r\n  }\r\n\r\n  private _updateTruncation() {\r\n    // Only update truncation if the title's size has changed since the last time we truncated\r\n    if (this._titleElement.clientWidth !== this._truncatedTitleAtWidth) {\r\n      // Throttle truncation so that it doesn't happen during a window resize\r\n      clearTimeout(this._scrollTimerId);\r\n      this._scrollTimerId = this._async.setTimeout(this._startTruncation.bind(this, this.props), 250);\r\n    }\r\n  }\r\n\r\n}\r\n"],"sourceRoot":"..\\..\\..\\src"}