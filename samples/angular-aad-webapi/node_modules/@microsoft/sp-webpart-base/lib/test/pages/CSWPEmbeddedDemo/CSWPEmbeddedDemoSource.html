<!DOCTYPE html>
<html dir="ltr">

<head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />

    <title>SharePoint embedded web part source</title>

    <link rel="stylesheet" href="//appsforoffice.microsoft.com/fabric/2.0.1/fabric.min.css">
    <link rel="stylesheet" href="//appsforoffice.microsoft.com/fabric/2.0.1/fabric.components.min.css">

    <script type="text/javascript">
        window.DEBUG = true;
        window.SP = {};
        window._spClientRenderedPageContext = {
          siteAbsoluteUrl: "",
          webAbsoluteUrl: "",        // ex. "http://example.com/sites/PubSite"
          webTitle: "",
          webServerRelativeUrl: "",  // ex. "/sites/PubSite"
          siteServerRelativeUrl: "",
          currentUICultureName: "",
          serverRequestPath: ""      // ex. "/sites/PubSite/Pages/default.aspx"
        };
        window._spClientRenderedPageContext = {
          appId: "",
          contextWebInfo: {},
          item: {},
          list: {},
          user: {},
          web: {
            ServerRelativeUrl: "",
            Url: ""
          }
        };
    </script>
    <script type="text/javascript" src="/jspm_packages/system.src.js"></script>
    <script type="text/javascript" src="/dist/ClassicTestPage.config.js"></script>

    <script type="text/javascript" src="/dist/ClassicPageBootstrapper.bundle.js"></script>
    <script type="text/javascript" src="/dist/ClassicTestPage.bundle.js"></script>
    <script type="text/javascript" >System.import("lib/test/pages/CSWPClassicPageDemo/cswp-classic-page-demo.css.js");</script>
</head>
<body>
    <div id="webpart" class="cswp" data-sp-cs-webpartid='demo_cswp_104'>
    </div>

    <script type="text/javascript">
    (function() {
        function getParameterByName(name) {
            name = name.replace(/[\[]/, "\\[").replace(/[\]]/, "\\]");
            var regex = new RegExp("[\\?&]" + name + "=([^&#]*)"),
            results = regex.exec(location.search);
            return results === null ? "" : decodeURIComponent(results[1].replace(/\+/g, " "));
        }

        try {
            var id = getParameterByName('id');
            var height = getParameterByName('height');
            var width = getParameterByName('width');

            var webpart = document.getElementById("webpart");

            if (!id || !height || !width) {
                webpart.innerHTML = 'Missing id, height or width webpart parameter.';
                return;
            }

            webpart.setAttribute('style', 'background-color:#ffffff; padding:10px; overflow:hidden;');
            webpart.style.height = height;
            webpart.style.width = width;

            g_cswp.loadClientSideWebPartOnTestPage('demo_cswp_104');
        } catch (e) {
            g_cswp.logClientSideWebPartLoadError('demo_cswp_104', e.message)
        }
    })();
    </script>
</body>
</html>
