{
  "id": "clientSideWebPartManifestSchema.json",
  "title": "Client-side webpart manifest",
  "description": "A client-side webpart is a drop-in control that is part of the end user page authoring experience.",

  "definitions": {
    "propertyNamesArray": {
      "type": "array",
      "minItems": 0,
      "items": {
        "type": "string",
        "minLength": 1
      }
    }
  },

  "type": "object",
  "allOf": [
    {
      "type": "object",
      "properties": {
        "$schema": { "type": "string" },

        "manifestVersion": { "$ref": "anyValue.json" },
        "id": { "$ref": "anyValue.json" },
        "alias": { "$ref": "anyValue.json" },
        "version": { "$ref": "anyValue.json" },
        "loaderConfig": { "$ref": "anyValue.json" },
        "preconfiguredEntries": { "$ref": "anyValue.json" },
        "componentType": { "$ref": "anyValue.json" },
        "searchablePropertyNames": { "$ref": "anyValue.json" },
        "linkPropertyNames": { "$ref": "anyValue.json" },
        "imageLinkPropertyNames": { "$ref": "anyValue.json" }
      },
      "additionalProperties": false
    },
    {
      "$ref": "clientSideComponentManifestSchema.json#/definitions/clientSideComponentManifest"
    },
    {
      "type": "object",
      "required": [
        "preconfiguredEntries",
        "componentType"
      ],
      "properties": {
        "componentType": {
          "type": "string",
          "enum": [
            "WebPart"
          ]
        },

        "searchablePropertyNames": {
          "title": "Searchable Property Names",
          "description": "List of names of Web Part properties that need to be indexed for search.",
          "$ref": "#/definitions/propertyNamesArray"
        },

        "linkPropertyNames": {
          "title": "Link Property Names",
          "description": "List of names of Web Part properties that are links and need to be link fixed up. Link fixup is a SharePoint feature to help make sure SharePoint internal links in the content are correct. Pages and content can be moved around within SharePoint site hierarchy.",
          "$ref": "#/definitions/propertyNamesArray"
        },

        "imageLinkPropertyNames": {
          "title": "Image Link Property Names",
          "description": "List of names of Web Part properties that are image sources and need to be link fixed up and potentially preloaded for performance reasons.",
          "$ref": "#/definitions/propertyNamesArray"
        },

        "preconfiguredEntries": {
          "title": "Pre-configured Entries",
          "description": "A Web Part can have pre-configured properties like the title, description, toolbox group name and Web Part specific custom properties.",
          "type": "array",
          "minItems": 1,
          "items": {
            "description": "This interface specifies the set of properties that can be pre-configured by a Web Part developer. Each pre-configured instance of the Web Part will need a copy of these properties. Organization admins and content authors can modify these properties on a need basis.",
            "type": "object",

            "properties": {
              "title": {
                "title": "Title",
                "description": "Title of the web part represented as a single a dictionary of locale keys to title values. This value will be displayed to the user in the toolbox. A dictionary must contain a \"default\" key. This title should be used in the Toolbox and other display areas. The Web Part developer may give an initial title to the webpart. The organization admin and page author will have the ability to change this title as per need.",
                "$ref": "localizedString.json"
              },

              "description": {
                "title": "Description",
                "description": "Description of the web part represented as a dictionary of locale keys to description values. This value will be displayed to the user in the toolbox. A dictionary must contain a 'default' key. This description should be used in the Toolbox tooltip and other display areas. The Web Part developer may give an initial description to the webpart. The organization admin and page author will have the ability to change this description as per need.",
                "$ref": "localizedString.json"
              },

              "officeFabricIconFontName": {
                "title": "Office Fabric Icon Name",
                "description": " The icon for the Web Part, to be displayed in the toolbox, represented as a character name in the Office 365 icon font file. The icon font is specified here: http://o365icons.cloudapp.net/. If this field has a value, the 'iconImageUrl' field will be ignored.",
                "type": "string",
                "minLength": 1
              },

              "iconImageUrl": {
                "title": "Icon Image URL",
                "description": " The icon for the WebPart, to be displayed in the toolbox, represented an image URL. The image at the URL must be exactly 38x38 px (SPPPLAT VSO#218660 to fix the size of the icon image). If the 'officeFabricIconName' field does not have a value, this field must have a value.",
                "type": "string",
                "minLength": 10
              },

              "groupId": {
                "title": "Group ID",
                "description": "A group id. This group id should be used to decide which toolbox group the web part should be placed into. The client side framework has reserved group ids for default groups. The developer can pick one of those groups. In that case the group field will be ignored. Alternatively, the developer can pick a completely unique id and a group name. The toolbox will then show the web part in its own group.",
                "type": "string",
                "minLength": 5
              },

              "group": {
                "title": "Group",
                "description": "This field is used to help decide the Toolbox group for the Web Part in the authoring experience. In the server rendered page, the Web Part gallery is equivalent of the Toolbox. If no value is provided, the Web Part will be displayed in the \"Custom\" group.",
                "$ref": "localizedString.json"
              },

              "properties": {
                "title": "Properties",
                "description": "every Web Part is expected to have some custom properties. e.g. an image Web Part may have the image url and caption text as custom properties, a list Web Part may have the list id and list title as custom properties, and so on.",
                "$ref": "anyValue.json"
              }
            },

            "anyOf": [
              {
                "required": [
                  "title",
                  "description",
                  "officeFabricIconFontName",
                  "groupId",
                  "properties"
                ]
              },
              {
                "required": [
                  "title",
                  "description",
                  "iconImageUrl",
                  "groupId",
                  "properties"
                ]
              }
            ],

            "additionalProperties": false
          }
        }
      },

      "additionalProperties": true
    }
  ]
}
