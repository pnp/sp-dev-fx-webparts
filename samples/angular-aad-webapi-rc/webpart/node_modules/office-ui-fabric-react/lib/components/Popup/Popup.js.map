{"version":3,"sources":["components/Popup/Popup.tsx"],"names":[],"mappings":"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","file":"components/Popup/Popup.js","sourcesContent":["import * as React from 'react';\r\nimport { IPopupProps } from './Popup.Props';\r\nimport { KeyCodes } from '../../utilities/KeyCodes';\r\nimport { BaseComponent } from '../../common/BaseComponent';\r\nimport { getNativeProps, divProperties } from '../../Utilities';\r\nimport { doesElementContainFocus } from '../../utilities/focus';\r\nimport { getDocument } from '../../utilities/dom';\r\n\r\n/**\r\n * This adds accessibility to Dialog and Panel controls\r\n */\r\nexport class Popup extends BaseComponent<IPopupProps, {}> {\r\n\r\n  public static defaultProps: IPopupProps = {\r\n    shouldRestoreFocus: true\r\n  };\r\n\r\n  public refs: {\r\n    [key: string]: React.ReactInstance;\r\n    root: HTMLElement;\r\n  };\r\n\r\n  private _originalFocusedElement: HTMLElement;\r\n  private _containsFocus: boolean;\r\n\r\n  public componentWillMount() {\r\n    this._originalFocusedElement = getDocument().activeElement as HTMLElement;\r\n  }\r\n\r\n  public componentDidMount(): void {\r\n    this._events.on(this.refs.root, 'keydown', this._onKeyDown);\r\n    this._events.on(this.refs.root, 'focus', () => this._containsFocus = true, true);\r\n    this._events.on(this.refs.root, 'blur', () => this._containsFocus = false, true);\r\n    if (doesElementContainFocus(this.refs.root)) {\r\n      this._containsFocus = true;\r\n    }\r\n  }\r\n\r\n  public componentWillUnmount(): void {\r\n    if (\r\n      this.props.shouldRestoreFocus &&\r\n      this._originalFocusedElement &&\r\n      this._containsFocus &&\r\n      this._originalFocusedElement as any !== window) {\r\n      // This slight delay is required so that we can unwind the stack, let react try to mess with focus, and then\r\n      // apply the correct focus. Without the setTimeout, we end up focusing the correct thing, and then React wants\r\n      // to reset the focus back to the thing it thinks should have been focused.\r\n      setTimeout(() => {\r\n        if (this._originalFocusedElement) {\r\n          this._originalFocusedElement.focus();\r\n        }\r\n      }, 0);\r\n    }\r\n  }\r\n\r\n  public render() {\r\n    let { role, className, ariaLabelledBy, ariaDescribedBy } = this.props;\r\n\r\n    return (\r\n      <div\r\n        ref='root'\r\n        { ...getNativeProps(this.props, divProperties) }\r\n        className={ className }\r\n        role={ role }\r\n        aria-labelledby={ ariaLabelledBy }\r\n        aria-describedby={ ariaDescribedBy }>\r\n        { this.props.children }\r\n      </div>\r\n    );\r\n  }\r\n\r\n  private _onKeyDown(ev: React.KeyboardEvent<HTMLElement>) {\r\n    switch (ev.which) {\r\n      case KeyCodes.escape:\r\n\r\n        if (this.props.onDismiss) {\r\n          this.props.onDismiss();\r\n\r\n          ev.preventDefault();\r\n          ev.stopPropagation();\r\n        }\r\n\r\n        break;\r\n    }\r\n  }\r\n}\r\n"],"sourceRoot":"..\\..\\..\\src"}