{"version":3,"sources":["EventGroup.ts"],"names":[],"mappings":"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","file":"EventGroup.js","sourcesContent":["/* tslint:disable:no-string-literal */\r\n\r\nexport interface IEventRecord {\r\n  target: any;\r\n  eventName: string;\r\n  parent: any;\r\n  callback: (args?: any) => void;\r\n  elementCallback: (...args: any[]) => void;\r\n  objectCallback: (args?: any) => void;\r\n  useCapture: boolean;\r\n}\r\n\r\nexport interface IEventRecordsByName {\r\n  [eventName: string]: IEventRecordList;\r\n}\r\n\r\nexport interface IEventRecordList {\r\n  [id: string]: IEventRecord[] | number;\r\n  count: number;\r\n}\r\n\r\nexport interface IDeclaredEventsByName {\r\n  [eventName: string]: boolean;\r\n}\r\n\r\n/** An instance of EventGroup allows anything with a handle to it to trigger events on it.\r\n *  If the target is an HTMLElement, the event will be attached to the element and can be\r\n *  triggered as usual (like clicking for onclick).\r\n *  The event can be triggered by calling EventGroup.raise() here. If the target is an\r\n *  HTMLElement, the event gets raised and is handled by the browser. Otherwise, it gets\r\n *  handled here in EventGroup, and the handler is called in the context of the parent\r\n *  (which is passed in in the constructor).\r\n */\r\nexport class EventGroup {\r\n  private static _uniqueId = 0;\r\n  private _parent;\r\n  private _eventRecords: IEventRecord[];\r\n  private _id = EventGroup._uniqueId++;\r\n  private _isDisposed: boolean;\r\n\r\n  /** For IE8, bubbleEvent is ignored here and must be dealt with by the handler.\r\n   *  Events raised here by default have bubbling set to false and cancelable set to true.\r\n   *  This applies also to built-in events being raised manually here on HTMLElements,\r\n   *  which may lead to unexpected behavior if it differs from the defaults.\r\n   */\r\n  public static raise(\r\n    target: any,\r\n    eventName: string,\r\n    eventArgs?: any,\r\n    bubbleEvent?: boolean\r\n  ) {\r\n    let retVal;\r\n\r\n    if (EventGroup._isElement(target)) {\r\n      if (document.createEvent) {\r\n        let ev = document.createEvent('HTMLEvents');\r\n\r\n        ev.initEvent(eventName, bubbleEvent, true);\r\n        ev['args'] = eventArgs;\r\n        retVal = target.dispatchEvent(ev);\r\n      } else if (document['createEventObject']) { // IE8\r\n        let evObj = document['createEventObject'](eventArgs);\r\n        // cannot set cancelBubble on evObj, fireEvent will overwrite it\r\n        target.fireEvent('on' + eventName, evObj);\r\n      }\r\n    } else {\r\n      while (target && retVal !== false) {\r\n        let events = <IEventRecordsByName>target.__events__;\r\n        let eventRecords = events ? events[eventName] : null;\r\n\r\n        for (let id in eventRecords) {\r\n          if (eventRecords.hasOwnProperty(id)) {\r\n            let eventRecordList = <IEventRecord[]>eventRecords[id];\r\n\r\n            for (let listIndex = 0; retVal !== false && listIndex < eventRecordList.length; listIndex++) {\r\n              let record = eventRecordList[listIndex];\r\n\r\n              if (record.objectCallback) {\r\n                retVal = record.objectCallback.call(record.parent, eventArgs);\r\n              }\r\n            }\r\n          }\r\n        }\r\n\r\n        // If the target has a parent, bubble the event up.\r\n        target = bubbleEvent ? target.parent : null;\r\n      }\r\n    }\r\n\r\n    return retVal;\r\n  }\r\n\r\n  public static isObserved(target: any, eventName: string): boolean {\r\n    let events = target && <IEventRecordsByName>target.__events__;\r\n\r\n    return !!events && !!events[eventName];\r\n  }\r\n\r\n  /** Check to see if the target has declared support of the given event. */\r\n  public static isDeclared(target: any, eventName: string): boolean {\r\n    let declaredEvents = target && <IDeclaredEventsByName>target.__declaredEvents;\r\n\r\n    return !!declaredEvents && !!declaredEvents[eventName];\r\n  }\r\n\r\n  public static stopPropagation(event: any) {\r\n    if (event.stopPropagation) {\r\n      event.stopPropagation();\r\n    } else { // IE8\r\n      event.cancelBubble = true;\r\n    }\r\n  }\r\n\r\n  private static _isElement(target: HTMLElement) {\r\n    return !!target && (target.addEventListener || target instanceof HTMLElement);\r\n  }\r\n\r\n  /** parent: the context in which events attached to non-HTMLElements are called */\r\n  public constructor(parent: any) {\r\n    this._parent = parent;\r\n    this._eventRecords = [];\r\n  }\r\n\r\n  public dispose() {\r\n    if (!this._isDisposed) {\r\n      this._isDisposed = true;\r\n\r\n      this.off();\r\n      this._parent = null;\r\n    }\r\n  }\r\n\r\n  /** On the target, attach a set of events, where the events object is a name to function mapping. */\r\n  public onAll(target: any, events: { [key: string]: (args?: any) => void; }, useCapture?: boolean) {\r\n    for (let eventName in events) {\r\n      if (events.hasOwnProperty(eventName)) {\r\n        this.on(target, eventName, events[eventName], useCapture);\r\n      }\r\n    }\r\n  }\r\n\r\n  /** On the target, attach an event whose handler will be called in the context of the parent\r\n   * of this instance of EventGroup.\r\n   */\r\n  public on(target: any, eventName: string, callback: (args?: any) => void, useCapture?: boolean) {\r\n    if (eventName.indexOf(',') > -1) {\r\n      let events = eventName.split(/[ ,]+/);\r\n\r\n      for (let i = 0; i < events.length; i++) {\r\n        this.on(target, events[i], callback, useCapture);\r\n      }\r\n    } else {\r\n      let parent = this._parent;\r\n      let eventRecord: IEventRecord = {\r\n        target: target,\r\n        eventName: eventName,\r\n        parent: parent,\r\n        callback: callback,\r\n        objectCallback: null,\r\n        elementCallback: null,\r\n        useCapture: useCapture\r\n      };\r\n\r\n      // Initialize and wire up the record on the target, so that it can call the callback if the event fires.\r\n      let events = <IEventRecordsByName>(target.__events__ = target.__events__ || {});\r\n      events[eventName] = events[eventName] || <IEventRecordList>{\r\n        count: 0\r\n      };\r\n      events[eventName][this._id] = events[eventName][this._id] || [];\r\n      (<IEventRecord[]>events[eventName][this._id]).push(eventRecord);\r\n      events[eventName].count++;\r\n\r\n      if (EventGroup._isElement(target)) {\r\n        let processElementEvent = (...args: any[]) => {\r\n          if (this._isDisposed) {\r\n            return;\r\n          }\r\n\r\n          let result;\r\n          try {\r\n            result = callback.apply(parent, args);\r\n            if (result === false && args[0]) {\r\n              let e = args[0];\r\n\r\n              if (e.preventDefault) {\r\n                e.preventDefault();\r\n              }\r\n\r\n              if (e.stopPropagation) {\r\n                e.stopPropagation();\r\n              }\r\n\r\n              e.cancelBubble = true;\r\n            }\r\n          } catch (e) {\r\n            /* ErrorHelper.log(e); */\r\n          }\r\n\r\n          return result;\r\n        };\r\n\r\n        eventRecord.elementCallback = processElementEvent;\r\n\r\n        if (target.addEventListener) {\r\n          /* tslint:disable:ban-native-functions */\r\n          (<EventTarget>target).addEventListener(eventName, processElementEvent, useCapture);\r\n          /* tslint:enable:ban-native-functions */\r\n        } else if (target.attachEvent) { // IE8\r\n          target.attachEvent('on' + eventName, processElementEvent);\r\n        }\r\n      } else {\r\n        let processObjectEvent = (...args: any[]) => {\r\n          if (this._isDisposed) {\r\n            return;\r\n          }\r\n\r\n          return callback.apply(parent, args);\r\n        };\r\n\r\n        eventRecord.objectCallback = processObjectEvent;\r\n      }\r\n\r\n      // Remember the record locally, so that it can be removed.\r\n      this._eventRecords.push(eventRecord);\r\n    }\r\n  }\r\n\r\n  public off(target?: any, eventName?: string, callback?: (args?: any) => void, useCapture?: boolean) {\r\n    for (let i = 0; i < this._eventRecords.length; i++) {\r\n      let eventRecord = this._eventRecords[i];\r\n      if ((!target || target === eventRecord.target) &&\r\n        (!eventName || eventName === eventRecord.eventName) &&\r\n        (!callback || callback === eventRecord.callback) &&\r\n        ((typeof useCapture !== 'boolean') || useCapture === eventRecord.useCapture)) {\r\n        let events = <IEventRecordsByName>eventRecord.target.__events__;\r\n        let targetArrayLookup = events[eventRecord.eventName];\r\n        let targetArray = targetArrayLookup ? <IEventRecord[]>targetArrayLookup[this._id] : null;\r\n\r\n        // We may have already target's entries, so check for null.\r\n        if (targetArray) {\r\n          if (targetArray.length === 1 || !callback) {\r\n            targetArrayLookup.count -= targetArray.length;\r\n            delete events[eventRecord.eventName][this._id];\r\n          } else {\r\n            targetArrayLookup.count--;\r\n            targetArray.splice(targetArray.indexOf(eventRecord), 1);\r\n          }\r\n\r\n          if (!targetArrayLookup.count) {\r\n            delete events[eventRecord.eventName];\r\n          }\r\n        }\r\n\r\n        if (eventRecord.elementCallback) {\r\n          if (eventRecord.target.removeEventListener) {\r\n            eventRecord.target.removeEventListener(eventRecord.eventName, eventRecord.elementCallback, eventRecord.useCapture);\r\n          } else if (eventRecord.target.detachEvent) { // IE8\r\n            eventRecord.target.detachEvent('on' + eventRecord.eventName, eventRecord.elementCallback);\r\n          }\r\n        }\r\n\r\n        this._eventRecords.splice(i--, 1);\r\n      }\r\n    }\r\n  }\r\n\r\n  /** Trigger the given event in the context of this instance of EventGroup. */\r\n  public raise(eventName: string, eventArgs?: any, bubbleEvent?: boolean): any {\r\n    return EventGroup.raise(this._parent, eventName, eventArgs, bubbleEvent);\r\n  }\r\n\r\n  /** Declare an event as being supported by this instance of EventGroup. */\r\n  public declare(event: any) {\r\n    let declaredEvents = this._parent.__declaredEvents = this._parent.__declaredEvents || {};\r\n\r\n    if (typeof event === 'string') {\r\n      declaredEvents[event] = true;\r\n    } else {\r\n      for (let i = 0; i < event.length; i++) {\r\n        declaredEvents[event[i]] = true;\r\n      }\r\n    }\r\n  }\r\n}\r\n"],"sourceRoot":"..\\src"}