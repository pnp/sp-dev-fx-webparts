{"version":3,"sources":["components/Callout/CalloutContent.tsx"],"names":[],"mappings":"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","file":"components/Callout/CalloutContent.js","sourcesContent":["/* tslint:disable:no-unused-variable */\r\nimport * as React from 'react';\r\n/* tslint:enable:no-unused-variable */\r\nimport { ICalloutProps } from './Callout.Props';\r\nimport { DirectionalHint } from '../../common/DirectionalHint';\r\nimport {\r\n  autobind,\r\n  css,\r\n  elementContains,\r\n  getWindow,\r\n  getDocument\r\n} from '../../Utilities';\r\nimport { getRelativePositions, IPositionInfo, IPositionProps } from '../../utilities/positioning';\r\nimport { IRectangle } from '../../common/IRectangle';\r\nimport { focusFirstChild } from '../../utilities/focus';\r\nimport { assign } from '../../Utilities';\r\nimport { Popup } from '../../Popup';\r\nimport { BaseComponent } from '../../common/BaseComponent';\r\nimport './Callout.scss';\r\n\r\nconst BEAK_ORIGIN_POSITION = { top: 0, left: 0 };\r\nconst OFF_SCREEN_POSITION = { top: -9999, left: 0 };\r\nconst BORDER_WIDTH: number = 1;\r\nconst SPACE_FROM_EDGE: number = 8;\r\nexport interface ICalloutState {\r\n  positions?: any;\r\n  slideDirectionalClassName?: string;\r\n  calloutElementRect?: ClientRect;\r\n}\r\n\r\nexport class CalloutContent extends BaseComponent<ICalloutProps, ICalloutState> {\r\n\r\n  public static defaultProps = {\r\n    isBeakVisible: true,\r\n    beakWidth: 16,\r\n    gapSpace: 16,\r\n    directionalHint: DirectionalHint.bottomAutoEdge\r\n  };\r\n\r\n  private _didSetInitialFocus: boolean;\r\n  private _hostElement: HTMLDivElement;\r\n  private _calloutElement: HTMLDivElement;\r\n  private _targetWindow: Window;\r\n  private _bounds: IRectangle;\r\n  private _maxHeight: number;\r\n  private _positionAttempts: number;\r\n  private _target: HTMLElement | MouseEvent;\r\n\r\n  constructor(props: ICalloutProps) {\r\n    super(props, { 'beakStyle': 'beakWidth' });\r\n\r\n    this._didSetInitialFocus = false;\r\n    this.state = {\r\n      positions: null,\r\n      slideDirectionalClassName: null,\r\n      calloutElementRect: null\r\n    };\r\n    this._positionAttempts = 0;\r\n  }\r\n\r\n  public componentDidUpdate() {\r\n    this._setInitialFocus();\r\n    this._updatePosition();\r\n  }\r\n\r\n  public componentWillMount() {\r\n    let target = this.props.targetElement ? this.props.targetElement : this.props.target;\r\n    this._setTargetWindowAndElement(target);\r\n  }\r\n\r\n  public componentWillUpdate(newProps: ICalloutProps) {\r\n    if (newProps.targetElement !== this.props.targetElement || newProps.target !== this.props.target) {\r\n      let newTarget = newProps.targetElement ? newProps.targetElement : newProps.target;\r\n      this._setTargetWindowAndElement(newTarget);\r\n    }\r\n  }\r\n  public componentDidMount() {\r\n    this._onComponentDidMount();\r\n  }\r\n\r\n  public render() {\r\n    // If there is no target window then we are likely in server side rendering and we should not render anything.\r\n    if (!this._targetWindow) {\r\n      return null;\r\n    }\r\n    let {\r\n      className,\r\n      target,\r\n      targetElement,\r\n      isBeakVisible,\r\n      beakStyle,\r\n      children,\r\n      beakWidth } = this.props;\r\n    let { positions, slideDirectionalClassName } = this.state;\r\n    let beakStyleWidth = beakWidth;\r\n\r\n    // This is here to support the old way of setting the beak size until version 1.0.0.\r\n    // beakStyle is now deprecated and will be be removed at version 1.0.0\r\n    if (beakStyle === 'ms-Callout-smallbeak') {\r\n      beakStyleWidth = 16;\r\n    }\r\n\r\n    let beakReactStyle: React.CSSProperties = {\r\n      top: positions && positions.beak ? positions.beak.top : BEAK_ORIGIN_POSITION.top,\r\n      left: positions && positions.beak ? positions.beak.left : BEAK_ORIGIN_POSITION.left,\r\n      height: beakStyleWidth,\r\n      width: beakStyleWidth\r\n    };\r\n\r\n    let contentMaxHeight: number = this._getMaxHeight();\r\n    let beakVisible: boolean = isBeakVisible && (!!targetElement || !!target);\r\n    let content = (\r\n      <div ref={ this._resolveRef('_hostElement') } className={ 'ms-Callout-container' }>\r\n        <div\r\n          className={\r\n            css(\r\n              'ms-Callout',\r\n              className,\r\n              slideDirectionalClassName ? `ms-u-${slideDirectionalClassName}` : ''\r\n            ) }\r\n          style={ positions ? positions.callout : OFF_SCREEN_POSITION }\r\n          ref={ this._resolveRef('_calloutElement') }\r\n          >\r\n\r\n          { beakVisible ? (\r\n            <div\r\n              className={ 'ms-Callout-beak' }\r\n              style={ beakReactStyle }\r\n              />) : (null) }\r\n\r\n          { beakVisible ?\r\n            (<div className='ms-Callout-beakCurtain' />) :\r\n            (null) }\r\n          <Popup\r\n            className='ms-Callout-main'\r\n            onDismiss={ this.dismiss }\r\n            shouldRestoreFocus={ true }\r\n            style={ { maxHeight: contentMaxHeight } }>\r\n            { children }\r\n          </Popup>\r\n        </div>\r\n      </div>\r\n    );\r\n    return content;\r\n  }\r\n\r\n  @autobind\r\n  public dismiss(ev?: Event | React.MouseEvent<HTMLElement>) {\r\n    let { onDismiss } = this.props;\r\n\r\n    if (onDismiss) {\r\n      onDismiss(ev);\r\n    }\r\n  }\r\n\r\n  protected _dismissOnLostFocus(ev: Event) {\r\n    let target = ev.target as HTMLElement;\r\n    if (ev.target !== this._targetWindow &&\r\n      this._hostElement &&\r\n      !elementContains(this._hostElement, target) &&\r\n      ((this._target as MouseEvent).stopPropagation ||\r\n        (!this._target || (target !== this._target && !elementContains(this._target as HTMLElement, target))))) {\r\n      this.dismiss(ev);\r\n    }\r\n  }\r\n\r\n  @autobind\r\n  protected _setInitialFocus() {\r\n    if (this.props.setInitialFocus && !this._didSetInitialFocus && this.state.positions) {\r\n      this._didSetInitialFocus = true;\r\n      focusFirstChild(this._calloutElement);\r\n    }\r\n  }\r\n\r\n  @autobind\r\n  protected _onComponentDidMount() {\r\n    // This is added so the callout will dismiss when the window is scrolled\r\n    // but not when something inside the callout is scrolled.\r\n    this._events.on(this._targetWindow, 'scroll', this._dismissOnLostFocus, true);\r\n    this._events.on(this._targetWindow, 'resize', this.dismiss, true);\r\n    this._events.on(this._targetWindow, 'focus', this._dismissOnLostFocus, true);\r\n    this._events.on(this._targetWindow, 'click', this._dismissOnLostFocus, true);\r\n\r\n    if (this.props.onLayerMounted) {\r\n      this.props.onLayerMounted();\r\n    }\r\n\r\n    this._updatePosition();\r\n  }\r\n\r\n  private _updatePosition() {\r\n    let { positions } = this.state;\r\n    let hostElement: HTMLElement = this._hostElement;\r\n    let calloutElement: HTMLElement = this._calloutElement;\r\n\r\n    if (hostElement && calloutElement) {\r\n      let currentProps: IPositionProps;\r\n      currentProps = assign(currentProps, this.props);\r\n      currentProps.bounds = this._getBounds();\r\n      // Temporary to be removed when targetElement is removed. Currently deprecated.\r\n      if (this.props.targetElement) {\r\n        currentProps.targetElement = this._target as HTMLElement;\r\n      } else {\r\n        currentProps.target = this._target;\r\n      }\r\n      let positionInfo: IPositionInfo = getRelativePositions(currentProps, hostElement, calloutElement);\r\n\r\n      // Set the new position only when the positions are not exists or one of the new callout positions are different.\r\n      // The position should not change if the position is within 2 decimal places.\r\n      if ((!positions && positionInfo) ||\r\n        (positions && positionInfo &&\r\n          (positions.callout.top.toFixed(2) !== positionInfo.calloutPosition.top.toFixed(2) ||\r\n            positions.callout.left.toFixed(2) !== positionInfo.calloutPosition.left.toFixed(2))\r\n          && this._positionAttempts < 5)) {\r\n        // We should not reposition the callout more than a few times, if it is then the content is likely resizing\r\n        // and we should stop trying to reposition to prevent a stack overflow.\r\n        this._positionAttempts++;\r\n        this.setState({\r\n          positions: {\r\n            callout: positionInfo.calloutPosition,\r\n            beak: positionInfo.beakPosition,\r\n          },\r\n          slideDirectionalClassName: positionInfo.directionalClassName\r\n        });\r\n      } else {\r\n        this._positionAttempts = 0;\r\n      }\r\n    }\r\n  }\r\n\r\n  private _getBounds(): IRectangle {\r\n    if (!this._bounds) {\r\n      let currentBounds = this.props.bounds;\r\n\r\n      if (!currentBounds) {\r\n        currentBounds = {\r\n          top: 0 + SPACE_FROM_EDGE,\r\n          left: 0 + SPACE_FROM_EDGE,\r\n          right: this._targetWindow.innerWidth - SPACE_FROM_EDGE,\r\n          bottom: this._targetWindow.innerHeight - SPACE_FROM_EDGE,\r\n          width: this._targetWindow.innerWidth - SPACE_FROM_EDGE * 2,\r\n          height: this._targetWindow.innerHeight - SPACE_FROM_EDGE * 2\r\n        };\r\n      }\r\n      this._bounds = currentBounds;\r\n    }\r\n    return this._bounds;\r\n  }\r\n\r\n  private _getMaxHeight(): number {\r\n    if (!this._maxHeight) {\r\n      this._maxHeight = this._getBounds().height - BORDER_WIDTH * 2;\r\n    }\r\n    return this._maxHeight;\r\n  }\r\n\r\n  private _setTargetWindowAndElement(target: HTMLElement | string | MouseEvent): void {\r\n    if (target) {\r\n      if (typeof target === 'string') {\r\n        let currentDoc: Document = getDocument();\r\n        this._target = currentDoc ? currentDoc.querySelector(target) as HTMLElement : null;\r\n        this._targetWindow = getWindow();\r\n      } else if ((target as MouseEvent).stopPropagation) {\r\n        this._target = target;\r\n        this._targetWindow = getWindow((target as MouseEvent).toElement as HTMLElement);\r\n      } else {\r\n        let targetElement: HTMLElement = target as HTMLElement;\r\n        this._target = target;\r\n        this._targetWindow = getWindow(targetElement);\r\n      }\r\n    } else {\r\n      this._targetWindow = getWindow();\r\n    }\r\n  }\r\n}\r\n"],"sourceRoot":"..\\..\\..\\src"}